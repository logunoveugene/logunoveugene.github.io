function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}function FilterBlockCompatibleProduct(t){FilterBlock.apply(this,[t])}function FilterBlockCheckboxList(t){FilterBlock.apply(this,[t])}function FilterBlockCheckbox(t){FilterBlock.apply(this,[t])}function FilterBlockInterval(t){FilterBlock.apply(this,[t])}function FilterBlockRadioList(t){FilterBlock.apply(this,[t])}function FilterBlockSelectShops(t){FilterBlock.apply(this,[t])}function FilterBlock(t){window.EVENT_FILTER_BLOCK_AFTER_CHANGE="filter-block:after-change",this.id=t,this.$block=void 0,this.isInitiated=!1}function RemainsFilterBlockShopWorkTime(t){window.FilterBlock.apply(this,[t])}function FilterBlockMarkdownProductType(t){FilterBlock.apply(this,[t])}function FilterBlockMarkdownShops(t){FilterBlockSelectShops.apply(this,[t])}var _get=function t(e,a,i){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,a);if(void 0===o){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,a,i)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(i)},_createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,a,i){return a&&t(e.prototype,a),i&&t(e,i),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){t(document).ready(function(){t("#action-marketing-code-filter").on("keyup",function(){var e=t(this).val().toUpperCase().trim(),a=t(".actions-list .action");a.removeClass("hidden"),a.filter(function(){return-1==t(this).data("code").toUpperCase().indexOf(e)}).addClass("hidden")})})}(jQuery),function(t){t(document).ready(function(){function e(){var t=a.outerHeight(),e=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,o=e/2-t/2+window.screenTop;o<0&&(o=0),i.css("padding-top",o+"px")}var a=t("#actions-slider"),i=t(".actions-on-tv");0!==a.length&&(a.owlCarousel({autoPlay:1e4,navigation:!1,pagination:!1,slideSpeed:1e3,singleItem:!0}),t("img",a).on("load",function(){e()}),t(window).resize(e))})}(jQuery),function(t,e){function a(a){function u(){n(i(p),p)}var f=e(r);e(t).on("click",function(t){e(t.target).hasClass(l)||e(s).fadeOut()});var p=a.find("FORM"),h=f.find("FORM");p.on("submit",u);var v=e();v.push.apply(v,p),v.push.apply(v,h),v.aggregateForm(function(t){t.each(function(){o(e(this))})}),v.change(u),v.on("change",function(t){var a=e(t.target).parents("[data-control-type]:first");if(a.length){var o=i(p);""!==o?a.find("label").addClass("selected"):a.find("label").removeClass("selected"),c.changeFilter(c.urlParamName,o)}}),p.find(d).on("click",function(){var t=e(this),a=t.data("action-value");t.closest('form[data-id="action-filter"]').find("input:checkbox").prop("checked",!1),c.chooseOneAction(a)})}function i(t){var e=[];return t.find("input[type=checkbox]:checked").each(function(){e.push(this.value)}),e.join("-")}function o(t){t.find('input[type=hidden][name^="'+c.urlParamName+'"]').remove()}function n(t,e){""!==t&&(o(e),e.append('<input type="hidden" name="'+c.urlParamName+'" value="'+t+'" />'))}var r="#w-catalog-action-filter-mobile-widget",d="span.one-action-submit",l="apply-filters-btn",s="."+l,c={},u={urlParamName:"action",changeFilter:function(t,e){},chooseOneAction:function(t){}};e.fn.catalogActionFilter=function(t){c=e.extend({},u,t),a(e(this))},e(function(){var t=e('[data-role="action-filter-widget"]');if(0!==t.length){var a=null;t.catalogActionFilter({urlParamName:t.data("url-param-name"),chooseOneAction:function(t){null===a&&(clearTimeout(a),a=setTimeout(function(){clearTimeout(a),setUrlParameter("action",t)},250))}})}})}(document,jQuery),$(document).ready(function(){var t=$(".partners-container").add(".landlord-container").add(".supplier-container").add(".transport-container").add(".credit-container");t.on("click",".file-input-button",function(){$(this).closest("div").find("#ajaxfileuploadform-uploadedfile").click()}),t.on("change","#ajaxfileuploadform-uploadedfile",function(){t.find(".file-input-text").text($(this).val())}),t.on("click",'[data-role="open-message-form"]',function(){t.find(".message-form-container").slideDown(500),$(this).closest("div").addClass("hidden")})}),function(t,e){var a=void 0;e(function(){a=e("[data-role=blog-post-anchors]"),0!==a.length&&a.on("click","[data-role=anchor-link]",function(t){t.preventDefault();var a=e(this).attr("href"),i=e(a).offset().top-65;e("body,html").animate({scrollTop:i},{duration:1e3,easing:"swing"})})})}(document,jQuery),function(t,e){window.EVENT_CART_BUTTON_APPLY_MAIN_BTN_COUNT="cart-button-widget:apply-main-btn-count",e(function(){var t=e(window.SELECTOR_CART_BTN_GLOBAL);0!==t.length&&(t.initSets(!1),window.addEventListener(window.EVENT_CART_BUTTON_APPLY_MAIN_BTN_COUNT,function(a){var i=a.detail;i.totalCount?t.applySets("active",{totalCount:window.numberFormat(i.totalCount,0,"."," "),totalPrice:window.numberFormat(i.totalPrice,0,"."," ")}):t.applySets("default"),e(window).trigger(window.EVENT_MOBILE_UPDATE_NOTIFIER,{activity:window.NOTIFY_ACTIVITY_CART,count:i.totalCount})}))})}(document,jQuery),function(t,e,a,i){"use strict";a.EVENT_UPDATE_CART="cart:update",a.EVENT_CART_PRODUCTS_UPDATED="cart:productsUpdated",a.EVENT_LOAD_CART_DATA="cart:loadCartData",a.EVENT_ONE_CLICK_BUTTON_PUSH="cart:oneClickPush",a.SELECTOR_CART_BUTTON="[data-id=cart-button]";var o="add",n="go_to_cart",r="product-guid",d="add-optional-product-guid",l="group-guid",s="related-services",c="is-use-discount-logistic";a.DATA_MARKER="marker",a.SELECTOR_MARKERS="[data-"+a.DATA_MARKER+"]",e(t.body).ready(function(){function u(e){var i=t.createEvent("CustomEvent");i.initCustomEvent(a.EVENT_CART_BUTTON_APPLY_MAIN_BTN_COUNT,!1,!0,e),a.dispatchEvent(i)}function f(t){var e={guid:t.data(r),type:t.data("product-type")};return i!==t.attr("data-"+l)&&(e.groupGuid=t.attr("data-"+l)),i!==t.attr("data-"+d)&&(e.optionalProductGuid=t.attr("data-"+d)),t.is(a.SELECTOR_MARKERS)&&(e.markers=t.data(a.DATA_MARKER).toString().match(/[A-z0-9_-]+/g)),t.data("shop-id")&&(e.shopId=t.data("shop-id")),t.data("postamat-id")&&(e.postamatId=t.data("postamat-id")),t.data("warranty-years")&&(e.warrantyYears=t.data("warranty-years")),e.warrantyType=t.data("warranty-type")?t.data("warranty-type"):0,t.data(s)&&(e.relatedServicesGuids=t.data(s)),i!==t.data(c)&&(e.isUseDiscountLogistic=t.data(c)),e}function p(){e(a.SELECTOR_CART_BUTTON+"[data-state="+n+"]").each(function(t,a){v[e(a).data(r)]=o})}function h(t){for(var i in t)t.hasOwnProperty(i)&&(v[t[i].guid]=n);for(var o in v)v.hasOwnProperty(o)&&e(a.SELECTOR_CART_BUTTON+"[data-product-guid="+o+"]").setState(v[o])}var v={},m=e(a.SELECTOR_CART_BUTTON);e(t.body).on("click",a.SELECTOR_CART_BUTTON,function(){var t=e(this);if(t.attr("disabled",!0),n===t.data("state"))return void(a.location.href=t.data("url"));p();var i=f(t);e.ajax({type:"POST",url:t.data("url"),dataType:"json",data:i,success:function(i){if(!0===i.result){t.attr("disabled",!1),u(i.data),h(i.data.items),t.trigger(a.EVENT_UPDATE_CART,[i.data.items]),e(a).trigger(a.EVENT_MOBILE_UPDATE_NOTIFIER,{activity:a.NOTIFY_ACTIVITY_CART,count:i.data.totalCount});var o=new CustomEvent(a.EVENT_UPDATE_CART);a.dispatchEvent(o)}else if(""!==i.html){t.attr("disabled",!1);var n=e("#cart-limit-modal");0===n.length&&(n=e(i.html),n.appendTo("body")),n.modal(),n.on("submit","#cart-limit-captcha-form",function(){var a=e(this),i=a.find('[data-role="submit-form"]');return i.attr("disabled",!0),e.ajax({type:"POST",url:i.data("url"),dataType:"json",data:a.serializeArray(),success:function(a){!0===a.result?(n.modal("hide"),t.trigger("click")):e(".modal-body",n).html(a.html)}}),!1}),n.on("hidden.bs.modal",function(){n.remove()})}else{var r=i.message?i.message:"Произошла ошибка. Повторите попытку позднее.";alert(r)}}}).always(function(){try{t.tooltip("hide")}catch(t){}})}),e(a).on(a.EVENT_CART_PRODUCTS_UPDATED,function(){p(),e.ajax({type:"POST",url:"/cart/get-state/",dataType:"json",success:function(t){if(!0===t.result)u(t.data),h(t.data.items);else{var e=t.message?t.message:"Произошла ошибка. Повторите попытку позднее.";alert(e)}}})}),e(a).on(a.EVENT_LOAD_CART_DATA,function(t,i){u(i),h(i.items),e(a).trigger(a.EVENT_MOBILE_UPDATE_NOTIFIER,{activity:a.NOTIFY_ACTIVITY_CART,count:i.totalCount})}),e(a).on(a.EVENT_PRODUCTS_LOADED,function(){var t=e(a.SELECTOR_CART_BUTTON),i=t.not(m);i.length&&(i.initSets(),m=t)}),e(a).on(a.EVENT_OS_VARIANT_CHANGED,function(t,e){var a=m.filter("[data-"+r+'="'+e.baseProductGuid+'"]');if(0!==a.length){var i=e.isOsInCart?n:o;a.attr("data-"+d,e.guid).setState(i)}})})}(document,jQuery,window),FilterBlockCompatibleProduct.prototype=Object.create(FilterBlock.prototype),FilterBlockCompatibleProduct.prototype.constructor=FilterBlockCompatibleProduct,FilterBlockCompatibleProduct.prototype.getSelectedValue=function(){var t="";return this.$block.find("select").each(function(){""!==$(this).val()&&(t+=(t.length?"-":"")+$(this).val())}),this.$block.find("label").first().toggleClass("selected",""!==t),""!==t?t:void 0},FilterBlockCompatibleProduct.prototype.reset=function(){this.$block.find("select").each(function(){$(this).val("")})},FilterBlockCompatibleProduct.prototype.updateFilterValues=function(t){},function(t,e){var a=void 0,i=void 0,o=void 0,n=void 0,r=100;e(function(){function d(){o=a.offset().top}function l(){var d=e(t).scrollTop()-r;n=a.height()-i.innerHeight(),d>o&&d<n?i.css("margin-top",d+"px"):d<=o-r&&i.css("margin-top","0px")}a=e('[data-role="null-result-container"]'),0!==a.length&&(i=a.find(".null-result"),d(),l(),e(t).resize(function(){d(),l()}),e(t).scroll(function(){l()}))})}(window,jQuery),function(t,e,a,i){function o(t,a){var i=e(".image-slider",t).owlCarousel(a),o=i.data("owlCarousel");return e(".button-right",t).click(function(){return o.next(),!1}).show(),e(".button-left",t).click(function(){return o.prev(),!1}).show(),o}a.CreditCalculatorEvents="creditCalc:reInit",a.AdditionalWarrantyEvents="additionalWarranty:reInit";var n="[data-role=price-hint]",r="[data-role=price-hint-popover]",d="[data-role=price-hint-popover-content-container]",l="[data-role=price-hint-popover-content]",s=void 0,c=void 0,u=void 0,f=void 0,p=void 0,h=void 0,v=void 0,m=void 0,g=void 0,w=void 0,b=void 0,T=new Map,E=new Map,y=void 0,k=void 0,C=void 0;e(function(){function _(t,o){var n=arguments.length>2&&arguments[2]!==i?arguments[2]:0,r=arguments.length>3&&arguments[3]!==i?arguments[3]:0;if(0!==u.length){0!==o?E.set(t,{price:o,previousPrice:n,bonusPrice:r}):i!==E.get(t)&&E.delete(t);var d=parseFloat(f.attr("data-price-value")),l=parseFloat(p.attr("data-price-value")),s=parseFloat(h.attr("data-price-value")),c=void 0;if(E.forEach(function(t){d+=t.price,l+=t.previousPrice,s+=t.bonusPrice}),f.text(String.formatPrice(d)),0!==p.length&&p.text(String.formatPrice(l)),0!==h.length){h.text(String.formatPrice(s));var m=0===s;h.closest(".buy-cheaper").toggleClass("hidden",m)}if(0!==v.length){var g=parseFloat(v.attr("data-credit-percent")),w=v.attr("data-installment-month-count");c=i!==w?Math.round(d/parseInt(w)):Math.round(d*g),v.find('[data-role="credit-payment-value"]').text(c)}e(a).trigger(a.CreditCalculatorEvents,[d])}}function I(t,a,o){i!==T.get(t)&&S(t);var n=e("<li/>",{"data-id":t}),r=e("<span/>",{class:"dots"}),d=e("<span/>",{class:"name"});d.text("+ "+a),r.append(d),n.append(r);var l=e(" <span/>",{class:"value"});l.text(String.formatPrice(o)),e("<i/>",{class:"rub-icon"}).text("").appendTo(l),n.append(l),b.find("UL").append(n),0===T.size&&(m.removeClass("hidden"),u.addClass("price-changed")),T.set(t,!0)}function S(t){i!==T.get(t)&&(b.find("UL LI[data-id="+t+"]").remove(),T.delete(t),0===T.size&&(m.addClass("hidden"),u.removeClass("price-changed")))}var O=function(){function t(){w=s.find(u+" .accordion-item .selector"),w.click(function(t){e(t.target).closest(".accordion-item").toggleClass("active")}),s.find(u+" .accordion-item .content-block").click(function(t){e(t.target).find("INPUT[type=radio]").click()}),m=s.find(d),g=s.find(d).find("option"),b=s.find(l),T=w.find(h),E=w.find(v),m.change(function(t){b.prop("checked",!1);var e=t.target,a=parseInt(e.value),i=b.filter(function(t){return a===parseInt(b.eq(t).val())});i.prop("checked",!0).change();var d=r(i.val()),l=e.querySelector('[value="'+a+'"]').getAttribute("data-additional-years"),s=e.querySelector('[value="'+a+'"]').getAttribute("data-additional-type");n(l,d),o(s)}).change(),b.change(function(t){var e=t.target,a=parseInt(e.value),i=g;i.prop("selected",!1);var o=i.filter(function(t){return a===parseInt(i.eq(t).val())});o.prop("selected",!0);var d=r(o.val());n(e.getAttribute("data-additional-warranty-years"),d)})}function o(t){[].concat(_toConsumableArray(s.find("["+f+"]"))).forEach(function(e){null!==t&&(e.hidden=e.getAttribute(f)!==t)})}function n(t,e){if(null!==t){var a=String.countPostfix(t,["год","года","лет"],"",!1)+" (+ "+String.formatPrice(e)+'<i class="rub-icon"></i>)';E.html(a),T.addClass("sup-text")}else E.text(""),T.removeClass("sup-text")}function r(t){var o=g.filter(function(e){return t===g.eq(e).val()}),n=0,r=0,d=void 0;o.length>0&&i!==o.attr("data-additional-price")&&(n=parseFloat(o.attr("data-additional-price")),r=parseInt(o.attr("data-additional-years")),d=parseInt(o.attr("data-additional-type"))),null!==n&&_("additionalWarranty",n),n>0?(I(p,"Дополнительная гарантия",n),a.productAdditionsDispatcher.setAdditionalWarranty(r,d,n)):(S(p),a.productAdditionsDispatcher.setAdditionalWarranty(null,null));var l=e(a.SELECTOR_CART_BUTTON+'[data-product-guid="'+c+'"]');return l.data("warranty-years",r),l.data("warranty-type",d),n}var d="[data-role=additional-warranty] SELECT",l="[data-role=additional-warranty] INPUT[type=radio]",u="[data-role=accordion]",f="data-type-warranty",p="additionalWarrantyPriceId",h="[data-role=title]",v="[data-role=selected-label]",m=void 0,g=void 0,w=void 0,b=void 0,T=void 0,E=void 0;return{init:function(){return t()}}}();if(s=e("#product-page"),C=e("#mainImageSliderWrap"),0!==s.length){if(c=s.data("id"),k=o(e("#thumbsSliderWrap"),{items:4,itemsMobile:[479,4],itemsTablet:[a.SCREEN_TABLET_MAX_WIDTH,4],itemsDesktopSmall:[a.SCREEN_DESKTOP_MAX_WIDTH,4],itemsDesktop:[a.SCREEN_DESKTOP_MAX_WIDTH,4],dots:!1,afterAction:!1}),e("#mainImageSliderWrap .img").length){if(e(a).width()>="992"){e(a).width()>="1900"&&e("#mainImageSliderWrap .img img").each(function(t){var a=e(this).data("original");e(this).parent().attr("href",a);var i=e(".thumb-slider-wrap .owl-item").eq(t).find("a");"iframe"!==i.data("fancybox-type")&&i.attr("href",a)});var N=e(".main-image-slider-wrap .img img[data-original]");N.length&&N.zoomer({drawIn:e('[data-role="zoom-preview"]'),viewContainer:e('[data-role="zoom-preview-wrap"]'),srcImgContainerWidth:e(".main-image-slider-wrap .image-slider").width()})}y=o(C,{items:1,itemsMobile:[479,1],itemsTablet:[a.SCREEN_TABLET_MAX_WIDTH,1],itemsDesktopSmall:[a.SCREEN_DESKTOP_MAX_WIDTH,1],itemsDesktop:[a.SCREEN_DESKTOP_MAX_WIDTH,1],dots:!1,afterAction:function(){"object"===(void 0===k?"undefined":_typeof(k))&&(e("#thumbsSliderWrap .owl-item .thumb").removeClass("active").eq(this.owl.currentItem).addClass("active"),k.visibleItems[k.visibleItems.length-1]<this.owl.currentItem?k.goTo(this.owl.currentItem):k.visibleItems[0]>this.owl.currentItem&&k.goTo(this.owl.currentItem))},afterInit:function(){C.find(".img").removeClass("transparent").removeAttr("hidden");var t=C.find('[data-fancybox-group="itemGroup"]').index(e("[data-active-img]"));-1!==t&&this.goTo(t),setTimeout(function(){e(".main-image-slider-wrap").removeClass("opacity-container")},1e3)}})}e("#thumbsSliderWrap .owl-item .thumb").hover(function(){y.goTo(e(this).parent().index())}),u=e('[data-role="item-order-price"]'),v=e('[data-role="credit-info"]'),f=u.find('[data-role="current-price-value"]'),p=u.find('[data-role="previous-price-value"]'),h=u.find('[data-role="bonus-price-value"]'),function(){var t="right";a.checkScreenType(a.SCREEN_MOBILE,a.SCREEN_TABLET)&&(t="bottom"),m=e(n),g=m.find(r),w=m.find(d),b=m.find(l),g.popover({html:!0,content:function(){return w.html()},trigger:"focus",placement:t}).click(function(){return!1}),m.on("click","[data-role=close]",function(){return g.popover("hide"),!1})}(),O.init(),a.addEventListener(a.AdditionalWarrantyEvents,O.init),a.productAdditionsDispatcher.setBaseProductGuid(c),a.productAdditionsDispatcher.addOptionalProductsListener(function(t,e){if(null!==e){_("osconstiant",e.currentPrice,e.previousPrice,e.bonus),e.currentPrice>0&&I("osVariantId","Опциональная ОС",e.currentPrice);var a=s.find('[data-role="remains-overlimit-message"]');0!==a.length&&(a.toggleClass("hidden",""===e.overlimitMessage),a.html(e.overlimitMessage))}else _("osconstiant",0),S("osVariantId")}),a.productAdditionsDispatcher.addKbtServiceListener(function(t){var o=t.relatedKbtService,n=e(a.SELECTOR_CART_BUTTON+'[data-product-guid="'+t.baseProductGuid+'"]'),r=n.attr("data-related-services");if(r=i===r?[]:JSON.parse(r),o.checked)I(o.guid,'Услуга "'+o.title+'"',o.price),_(o.guid,parseFloat(o.price)),r.push(o.guid);else{S(o.guid),_(o.guid,0);var d=r.indexOf(o.guid);r.splice(d,1)}n.attr("data-related-services",JSON.stringify(r))}),e(function(){var e=t.querySelector('[data-role="loadable-widgets-menu"]');if(null!==e){var a=function(){return[].slice.call(e.childNodes).some(function(t){return 0!==t.childNodes.length})};if(a())return void(e.style.display="block");new MutationObserver(function(t){t.forEach(function(){a()&&(e.style.display="block")})}).observe(e,{childList:!0})}}),s.on("click","[data-video]",function(t){t.preventDefault(),e('[data-unpacking-video="true"]').click()}),s.on("click",'[data-role="video-from-device-button"]',function(t){t.preventDefault(),e('[data-video-from-device="true"]').click()}),s.on("click",'[data-id="show-reviewthree-button"]',function(t){t.preventDefault(),e('[data-role="show-reviewthree"]').click()}),s.on("click","[data-image-3d]",function(){return e('[data-3d-image="true"]').click(),!1}),s.on("click","[data-replace-with]",function(){e(this).replaceWith(e(this).data("replace-with"))})}}),function(){[].concat(_toConsumableArray(t.querySelectorAll("[data-go-back-catalog]"))).forEach(function(e){e.addEventListener("click",function(a){-1!==t.referrer.search("catalog/"+e.getAttribute("data-go-back-catalog"))&&(a.preventDefault(),a.stopImmediatePropagation(),history.back())})})}()}(document,jQuery,window,void 0);var ProductAdditionsDispatcherClass=function(){function t(){_classCallCheck(this,t),this.optionalProduct=null,this.additionalWarranty=null,this.relatedKbtService=null,this.callbacks=[],this.baseProductGuid=null,this.EVENT_ID_OPTIONAL_PRODUCT="optionalProducts",this.EVENT_ID_ADDITIONAL_WARRANTY="additionalWarranty",this.EVENT_ID_RELATED_KBT_SERVICE="relatedKbtServices"}return _createClass(t,[{key:"setBaseProductGuid",value:function(t){this.baseProductGuid=t}},{key:"setOptionalProduct",value:function(t){null!==this.baseProductGuid&&(window.Constants.UUID_NILL!==t.guid?this.optionalProduct=t:this.optionalProduct=null,this.trigger(this.EVENT_ID_OPTIONAL_PRODUCT,this.baseProductGuid,this.optionalProduct))}},{key:"setAdditionalWarranty",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null!==this.baseProductGuid&&(this.additionalWarranty=null!==t&&null!==e?{period:t,price:a,type:e}:null,this.trigger(this.EVENT_ID_ADDITIONAL_WARRANTY,this.baseProductGuid,this.additionalWarranty))}},{key:"setKbtService",value:function(t){if(null!==this.baseProductGuid){window.Constants.UUID_NILL!==t.guid?this.relatedKbtService=t:this.relatedKbtService=null;var e={baseProductGuid:this.baseProductGuid,relatedKbtService:this.relatedKbtService};this.trigger(this.EVENT_ID_RELATED_KBT_SERVICE,e)}}},{key:"trigger",value:function(t){var e=Array.from(arguments);e.shift(),void 0!==this.callbacks[t]&&this.callbacks[t].forEach(function(t){t.apply(void 0,_toConsumableArray(e))})}},{key:"addOptionalProductsListener",value:function(t){void 0===this.callbacks[this.EVENT_ID_OPTIONAL_PRODUCT]&&(this.callbacks[this.EVENT_ID_OPTIONAL_PRODUCT]=[]),this.callbacks[this.EVENT_ID_OPTIONAL_PRODUCT].push(t)}},{key:"addAdditionalWarrantyListener",value:function(t){void 0===this.callbacks[this.EVENT_ID_ADDITIONAL_WARRANTY]&&(this.callbacks[this.EVENT_ID_ADDITIONAL_WARRANTY]=[]),this.callbacks[this.EVENT_ID_ADDITIONAL_WARRANTY].push(t)}},{key:"addKbtServiceListener",value:function(t){void 0===this.callbacks[this.EVENT_ID_RELATED_KBT_SERVICE]&&(this.callbacks[this.EVENT_ID_RELATED_KBT_SERVICE]=[]),this.callbacks[this.EVENT_ID_RELATED_KBT_SERVICE].push(t)}}]),t}();window.productAdditionsDispatcher=new ProductAdditionsDispatcherClass,function(t,e,a){function i(t){var a=e(window),i=a.scrollTop(),o=i+a.height(),n=t.offset().top;return n>=i&&n<=o}function o(a){a===g&&r(g),a===m&&r(m),e(t).trigger(window.EVENT_DESTROY_POPOVERS),setTimeout(function(){e(t).trigger(window.EVENT_INIT_POPOVERS)},500)}function n(i){if(a===i){if(i=C.find(".r-tabs-tab.active").attr("data-tab-name"),0!==window.location.hash.length)return void c(i);var n=N.text();""!==n?N.removeClass("hidden"):N.addClass("hidden"),k[i]={metaTitle:t.title,metaDescription:e('meta[name="description"]').attr("content"),seoText:n,header:x.text(),breadcrumbs:[e(".breadcrumb li:not(.initial-breadcrumb):first").text().trim()]}}if(m===i&&(l(),d(e(E)),setTimeout(s(),300),o(i),_=C.find(".all-characteristics-btn"),0===_.length||_.data("inited")||(_.data("inited",!0),_.on("click",function(){e("a[aria-controls=characteristics]").trigger("click")}))),g===i&&o(i),h===i){var r=new CustomEvent(window.EVENT_INIT_OPINION_WIDGETS);window.dispatchEvent(r),e(window).trigger(window.EVENT_INIT_COMMENTS_WIDGET)}if(v===i&&e(window).trigger(window.EVENT_INIT_COMMENTS_WIDGET),w===i){var u=new CustomEvent(window.EVENT_INIT_FAQ_WIDGETS);window.dispatchEvent(u)}if(b===i){var f=new CustomEvent(window.EVENT_INIT_REVIEWS_WIDGETS);window.dispatchEvent(f)}}function r(t){if(a!==window.characteristicsDescriptions){var i=e("#"+t);i.find("a[data-descr]").each(function(){var t=e(this).attr("data-descr"),i=window.characteristicsDescriptions[t];if(a!==i){e(this).addClass("icon"),e(this).attr("data-toggle","popover"),e(this).data("content-target","#popover-"+t),e(this).data("html",!0),window.SCREEN_MOBILE===window.getScreenType()?e(this).data("placement","bottom"):e(this).data("placement","right"),e(this).data("trigger","click");var o=e("<div/>",{id:"popover-"+t,class:"popover",role:"tooltip"});o.append(e("<i/>",{class:"close-btn"})),o.append(i.content),""!==i.url&&o.append(e("<a/>",{href:i.url,html:"Описания всех характеристик и значений <i/>",class:"knowledge-base-link"})),e(this).closest(".dots").after(o)}}),i.find('[data-toggle="popover"]').click(function(){return!1}),i.on("shown.bs.popover",function(){window.getVisible('[role="tooltip"]').forEach(function(t){e(t).on("click",function(t){if("close-btn"!==t.target.className&&"A"!==t.target.tagName)return!1})}),window.dispatchLazyLoadUpdateEvent()})}}function d(t){e("tbody > tr",t).removeClass("highlight"),e("tbody > tr:not(.hidden):odd",t).addClass("highlight")}function l(){a!==window.richContentProviderName&&L["init"+window.richContentProviderName]()}function s(){a!==window.richContentProviderName&&(!1===S&&(S=!0,L["get"+window.richContentProviderName]()),!0===O&&e(T).show())}function c(i){var o=C.find('[data-tab-name="'+i+'"]'),r=o.find('[data-role="real-tab-link"]').attr("href");if(window.history.pushState(null,"",r),a!==k[i])f(k[i]);else{var d=C.data(y).split("&");t.body.classList.add("loading"),e.ajax({url:d[0]+"&activeTab="+i,context:t.body,success:function(e){var a=e.data[i];k[i]={metaTitle:a.metaTitle,metaDescription:a.metaDescription,seoText:a.seoText,header:a.header,breadcrumbs:a.breadcrumbs},u(i,a.content),f(k[i]),n(i),t.body.classList.remove("loading")}})}}function u(t,a){var i=e("#"+t);0!==i.length&&i.html(a)}function f(i){x.text(i.header),t.title=i.metaTitle,e('meta[name="description"]').attr("content",i.metaDescription),a!==i.seoText&&(0!==i.seoText.length?(N.removeClass("hidden"),N.text(i.seoText)):N.addClass("hidden")),p(i.breadcrumbs)}function p(e){Array.from(t.querySelectorAll(".breadcrumb")).forEach(function(a){Array.from(a.querySelectorAll("li:not(.initial-breadcrumb)")).forEach(function(t){t.parentNode.removeChild(t)}),e.forEach(function(e){var i="object"===(void 0===e?"undefined":_typeof(e)),o=t.createElement("span");if(o.textContent=i?e.label:e,!0===i){var n=t.createElement("a");n.href=e.url,n.appendChild(o),o=n}var r=t.createElement("li");r.appendChild(o),a.appendChild(r)})})}window.EVENT_PRODUCT_CARD_TAB_RENDER="product-card-tabs:render",window.EVENT_CARD_TABS_PROCESSED="product-card-tabs:processed";var h="opinion",v="comment",m="description",g="characteristics",w="faq",b="review",T="#vendor-price-item-description",E="#description .table-params",y="get-tabs-url",k={},C=void 0,_=void 0,I=0,S=!1,O=!1,N=void 0,x=void 0;e(function(){C=e("#item-tabs-block"),N=e('[data-role="product-view-seo-text"]'),x=e('h1[data-product-param="name"]');var t=C.is("[data-product-tabs]"),o=!1,r=C.data("active-tab"),u=C.find('[aria-controls="'+r+'"]');if(0!==u.length&&(I=C.find("li").index(u.parent())),0!==C.length){var f={stateDefault:"r-tabs-state-default",stateActive:"active",stateDisabled:"r-tabs-state-disabled",stateExcluded:"r-tabs-state-excluded",tab:"r-tabs-tab",anchor:"r-tabs-anchor",panel:"r-tabs-panel",accordionTitle:"r-tabs-accordion-title"},p=function(n,r){var d=e(r.selector),l=C.find('[href="'+r.selector+'"]').attr("aria-controls");if(!0===o&&!0===t&&c(l),a===d.data("is-default")){var s=0,u=0,f=void 0;setTimeout(function(){window.checkScreenType(window.SCREEN_MOBILE,window.SCREEN_TABLET)?(f=e(".mobile-top-header"),s=e(r.accordionTab).offset().top-f.height()):(f=e("#header-search"),!1===f.hasClass("navbar-fixed-top")&&!1===i(d)&&(f.addClass("navbar-fixed-top"),u=f.height()),s=C.offset().top),e("body").scrollTo(s+u)},2e3)}else e(window).scroll(function(){if(!0===O){e(E).position().top+e(E).height()<e(this).scrollTop()&&e(T).show()}});e(r.selector).trigger("tabSelected")},h=function(){o=!0};C.responsiveTabs({active:I,setHash:!1===t,collapsible:"accordion",classes:f,activate:p,load:h})}l(),d(e(E)),setTimeout(s(),300),C.on("click","#description .options-primary-switch",function(){var t=parseInt(e(this).data("state"));return e(".price-item #description .table-params > tbody >tr").removeClass("hidden").filter(function(){return parseInt(e(this).data("state"))>t}).addClass("hidden"),d(e(".price-item #description .table-params")),t=3-t,e(this).data("state",t),1===t?e(this).text("Краткое описание"):e(this).text("Подробное описание"),!1}),C.on("click","#description .options-group .info-tabs-control a",function(){e(this).siblings().each(function(){e(this).removeClass("active"),e("#"+e(this).data("target")).addClass("hidden")}),e(this).addClass("active"),e("#"+e(this).data("target")).removeClass("hidden")}),C.on("click","#review .show-all-reviews",function(){return e(this).closest(".block-group").find(".objects").removeClass("cutted"),e(this).hide(),!1}),n()});var L={initFlix:function(){var t=e('[data-role="flix-setup"]');0!==t.length&&t.data("is-requested",!1)},initWebcollage:function(){var t=this,i=e("#wc-power-page");0!==i.length&&a===i.attr("data-is-requested")&&window.loadScript(i.attr("data-src")).then(function(){i.data("is-requested",!1),t.getWebcollage()})},getFlix:function(){var t=e('[data-role="flix-setup"]');if(0!==t.length&&!0!==t.data("is-requested")){t.data("is-requested",!0);var a={};a.flixInpage=t.attr("id"),a.flixDistributor=t.data("flix-distributor"),a.flixLanguage=t.data("flix-language"),a.flixBrand=t.data("flix-brand"),a.flixMpn=t.data("flix-mpn"),a.flixEan=t.data("flix-ean"),a.flixSku=t.data("flix-sku"),a.flixButton=t.data("flix-button"),a.flixButtonImage=t.data("flix-button-image"),a.flixPrice=t.data("flix-price"),window.loadScript(t.data("flix-src"),a).then(function(){"object"===_typeof(window.flixJsCallbacks)&&window.flixJsCallbacks.setLoadCallback(function(){O=!0,e(T).show()},"inpage"),setTimeout(function(){!1===O&&(e("#flix-inpage").length&&e(T).show(),O=!0)},1e3)})}},getWebcollage:function(){var t=e("#wc-power-page");if(0!==t.length&&!0!==t.data("is-requested")){var i=function(i){a!==window.Webcollage&&!0!==t.attr("data-is-requested")&&(window.Webcollage.loadProductContent(t.attr("data-site-id"),i,{"power-page":{autoPlayAndStop:!0,hasPowerPageContentCallback:function(){O=!0,e(T).show()}}}),t.attr("data-is-requested",!0))},o=t.attr("data-code");setTimeout(function(){i("1"+o),setTimeout(function(){t.is(":empty")&&i(o)},2e3)},1e3)}}}}(document,jQuery),function(t){var e=void 0,a=void 0,i=void 0,o=void 0,n=function(t){t.preventDefault();var e=document.location.href.split("?");if(2===e.length){var a=e.pop();return window.location.href=this.href+"?"+a,!1}return window.location.href=this.href,!1};t(function(){a=t('[data-role="compare-page"]'),e=t("#product-page"),0===a.length&&0===e.length||(window.checkScreenType(window.SCREEN_DESKTOP,window.SCREEN_WIDE)?t(".breadcrumb").length>0&&(i=t('[itemprop="name"]').parent("A")):t(".category-up").length>0&&(i=t(".category-up").find("A")),o=t('[data-role="compare-link-with-filters"]'),a.on("click",['[data-role="compare-link-with-filters"]','[itemprop="name"]'].join(","),n),void 0!==i&&i.length>0&&i.on("click",n))})}(jQuery),function(t){function e(e,v){var m=e.find(s),g=t(v.mobileFilterSelector),w=t(v.desktopFilterSelector),b=t(r);m.on("submit",function(){var e=[];t(this).find("[data-control-type]").each(function(){var n,r=t(this);switch(parseInt(r.data("control-type"))){case u:n=a(r);break;case f:case p:n=i(r);break;case h:n=o(r)}if(void 0!==n){var d=r.data("id");e.push('<input type=hidden name="'+v.urlParamName+"["+d+']" value="'+n+'" />')}}),t(this).append(e.join(""))});var T=null;if(w.on("change",function(e){var a=t(this),i=t(e.target),o=0,n=i.parents("[data-control-type]:first");if(a.find(l).hide(0,function(){t(this).remove()}),!0==(1===t(this).data(c)||void 0===t(this).data(c))&&n.length){var r=t('<div class="'+d+'">Показать</div>');switch(n.append(r),n.data("control-type")){case f:case p:var s=i.parents(".checkbox:first");o+=s.get(0).getBoundingClientRect().top+s.outerHeight()/2;break;default:o+=i.get(0).getBoundingClientRect().top+i.outerHeight()/2}o-=n.get(0).getBoundingClientRect().top,o-=r.outerHeight()/2,r.css({top:o}),r.on("click",function(){v.applyFilters(r)}),clearTimeout(T),T=setTimeout(function(){clearTimeout(T),r.fadeIn(300)},250)}}),m.on("change",function(e){var n=t(e.target).parents("[data-control-type]:first");if(n.length){var r;switch(parseInt(n.data("control-type"))){case u:r=a(n);break;case f:case p:r=i(n);break;case h:r=o(n)}void 0!==r?n.find("label").addClass("selected"):n.find("label").removeClass("selected"),v.changeFilter(n.data("id"),r)}}),t("html, body").on("click",function(e){t(e.target).hasClass(d)||t("."+d).fadeOut()}),g.length){var E=function(){C=!0,g.addClass("shown"),g.get(0).scrollTop=0,t(window).trigger(window.EVENT_OPENED_MOBILE_FILTERS_MENU)},y=function(){C=!1,g.removeClass("shown"),
t(window).trigger(window.EVENT_CLOSED_MOBILE_FILTERS_MENU)},k=t(n),C=k.is(".shown");t(window).on(window.EVENT_OPEN_MOBILE_FILTERS_MENU,E),t(window).on(window.EVENT_CLOSE_MOBILE_FILTERS_MENU,y),k.on("click",function(){t(window).trigger(C?window.EVENT_CLOSE_MOBILE_FILTERS_MENU:window.EVENT_OPEN_MOBILE_FILTERS_MENU)}),g.aggregateForm(function(e){e.each(function(){t(this).find('input[type=hidden][name^="'+v.urlParamName+'"]').remove()})}),t("[data-role=submit-mobile-filters]").on("click",function(){v.applyFilters(g.find("[type=submit]:first"))});var _=t(".filters-content");if(!_.length)return;t(document).on("click",".hide-filter",function(){var e=t(this).closest(".filter"),a=e.get(0).getBoundingClientRect(),i=a.top-filtersContainerBBox.top;i>0||(_.get(0).scrollTop=_.get(0).scrollTop+i)})}v.afterInit(m,w);var I={};m.filter("[name]").each(function(){var e=this.name;I.hasOwnProperty(e)||(I[e]=t()),I[e].push(this)});for(var S in I)I.hasOwnProperty(S)&&I[S].change(function(t){var e="value";/^input$/i.test(t.target.tagName)&&/^(radio)|(checkbox)$/i.test(t.target.type)&&(e="checked"),I[S].not(this).find('[data-id="'+t.target.dataset.id+'"]').each(function(){this[e]=t.target[e]})});if(b.length){var O=w.find(".apply-filters-box:not(.sticky)");t(window).on("scroll resize",function(){if(0!==O.length){if(O.get(0).getBoundingClientRect().top+O.outerHeight()/2<t(window).height())return void w.find(".apply-filters-box.sticky").fadeOut(300,function(){t(this).remove()});var e=w.find(".apply-filters-box.sticky");e.length||(e=O.clone(),e.addClass("sticky"),w.find("form").append(e));var a=t(window).height()-e.outerHeight(),i=b.get(0).getBoundingClientRect().left,o=b.outerWidth();e.css("cssText","top: "+a+"px !important; left: "+i+"px !important; width: "+o+"px !important;"),e.show()}})}}function a(t){var e=t.find("SELECT");if(""!==e.val())return e.val()}function i(e){var a=[];if(e.find('INPUT[type="checkbox"]').each(function(){var e=t(this);e.is(":checked")&&a.push(e.data("id"))}),0!==a.length)return a.join("-")}function o(t){var e=t.find('[data-name="min"]'),a=t.find('[data-name="max"]'),i=e.val().trim(),o=a.val().trim();if(""===i&&(i=e.attr("placeholder")),""===o&&(o=a.attr("placeholder")),i!==e.attr("placeholder")||o!==a.attr("placeholder"))return i+"-"+o}window.EVENT_OPEN_MOBILE_FILTERS_MENU="filters-menu:mobile:open",window.EVENT_CLOSE_MOBILE_FILTERS_MENU="filters-menu:mobile:close",window.EVENT_OPENED_MOBILE_FILTERS_MENU="filters-menu:mobile:opened",window.EVENT_CLOSED_MOBILE_FILTERS_MENU="filters-menu:mobile:closed";var n="[data-toggle-mobile-filters]",r=".extended-filters-wrap",d="apply-filters-btn",l="."+d,s="form[name=characteristics]",c="need-display-btn-apply",u=1,f=2,p=3,h=4,v={urlParamName:"f",desktopFilterSelector:'#desktop-characteristic-filters, [data-role="desktop-characteristic-filters"]',mobileFilterSelector:'#menu-filters-aside, [data-role="menu-filters-aside"]',afterInit:function(){},applyFilters:function(t){},changeFilter:function(t,e){}};t(function(){var e=t(".catalog-filters");0!==e.length&&e.catalogCharacteristicFilters({urlParamName:e.data("url-param-name"),afterInit:function(e,a){e.each(function(){t(this).aggregateForm(function(e){e.each(function(){t(this).find('input[type=hidden][name^="'+m.urlParamName+'"]').remove()})})}),a.aggregateForm(function(e){e.each(function(){t(this).find('input[type=hidden][name^="'+m.urlParamName+'"]').remove()})})},applyFilters:function(t){t.parents("form:first").submit()}})});var m;t.fn.catalogCharacteristicFilters=function(a){var i=t(this);m=t.extend({},v,a),e(i,m)}}(jQuery),function(t,e){window.EVENT_COMPARE_BUTTON_APPLY_MAIN_BTN_COUNT="compare-button-widget:apply-main-btn-count",e(function(){var t=e(window.SELECTOR_COMPARE_BTN_GLOBAL);0!==t.length&&(t.initSets(!1),window.addEventListener(window.EVENT_COMPARE_BUTTON_APPLY_MAIN_BTN_COUNT,function(a){var i=a.detail,o=i>0?"active":"default";t.applySets(o,{totalCount:i}),e(window).trigger(window.EVENT_MOBILE_UPDATE_NOTIFIER,{activity:window.NOTIFY_ACTIVITY_COMPARE,count:i})}))})}(document,jQuery),function(t,e){window.EVENT_INIT_PRODUCTS_SLIDER="productSlider:init";e.fn.productsSliderWidget=function(){var a=e(this);if(!0!==a.data("initiated")){var i=function(t){e(".nav-btn",a).removeClass("disabled"),-1!==t.visibleItems.indexOf(0)&&e(".btn-prev",a).addClass("disabled"),-1!==t.visibleItems.indexOf(t.owlItems.length-1)&&e(".btn-next",a).addClass("disabled")},o=a.find("[data-role=products-slider]");if(0!==o.length){var n=function(){var t=a.width();return 1099<t?5:1099>t&&860<=t?4:860>t&&500<=t?3:500>t&&380<=t?2:1};if(a.width()<220)return void setTimeout(function(){a.productsSliderWidget()},1e3);if("object"!==_typeof(o.data("owlCarousel"))){var r=n();o.owlCarousel({items:r,itemsDesktop:!1,itemsDesktopSmall:!1,itemsTablet:!1,itemsTabletSmall:!1,itemsMobile:!1,navigation:!1,pagination:!1,rewindNav:!0,autoPlay:!1,scrollPerPage:!1,afterInit:function(){e(".product",a).removeClass("transparent"),i(this.owl)},afterAction:function(){if(window.checkScreenType(window.SCREEN_MOBILE)){a.toggleClass("all-items-visible",this.itemsAmount===this.visibleItems.length);var t=this.visibleItems.pop()+1;a.toggleClass("last-item-visible",this.itemsAmount===t)}i(this.owl)}}),a.data("itemsCount",r),e(window).on("resize",function(){if(0!==e(t).find(o).length){var i=n();a.data("itemsCount")!==i&&(o.data("owlCarousel").reinit({items:i}),a.data("itemsCount",i))}})}else i(o.data("owlCarousel").owl);e(".nav-btn",a).off("click"),e(".btn-next",a).click(function(){e(this).is(".disabled")||o.trigger("owl.next")}),e(".btn-prev",a).click(function(){e(this).is(".disabled")||o.trigger("owl.prev")}),a.data("initiated",!0)}}};var a=function(){e("[data-role=products-slider-wrap]").each(function(){if(window.checkScreenType(window.SCREEN_MOBILE)&&0!==e(this).parents("[data-role=related-products-card-widget]").length)return void e(this).find(".product").removeClass("transparent");e(this).productsSliderWidget()})};e(window).on(window.EVENT_INIT_PRODUCTS_SLIDER,a),e(window).on("resize",a),e(function(){a()})}(document,jQuery),function(t){var e="search-history.v2",a=6;t(function(){function i(a){if(!0!==a.data("ac-initialized")&&a.length){var i=a.closest("form")[0],d=void 0,l=void 0,s=void 0;a.searchAutoComplete({source:function(e,i){clearTimeout(d),e.term=e.term.trim(),0===e.term.length?(i(o()),void 0!==s&&s.abort()):e.term.length>=3?l!==e.term&&(void 0!==s&&s.abort(),l=e.term,d=setTimeout(function(){s=t.get(a.data("url"),{term:e.term},function(t){i(t)})},500)):(void 0!==s&&s.abort(),i())},minLength:0,search:function(){c=a.val(),u=n()},select:function(t,o){return o.item.isHistoryClearBtn?(window.localStorage.removeItem(e),a.searchAutoComplete("close"),void t.preventDefault()):(void 0!==window.ga&&window.ga("send","pageview",a.data("ga-url")+encodeURIComponent(c)),void 0!==o.item.logGuid&&window.AddToLogActivityTarget([o.item.logGuid],o.item.id,o.item.targetType),r(o.item.label,o.item.url),""===o.item.url?(a.val(o.item.label),void i.submit()):void(window.location.href=o.item.url))},open:function(){t("body").setScrollingStateFor(!0,[window.SCREEN_MOBILE,window.SCREEN_TABLET]),t(window).on("scroll",h)},close:function(){t("body").setScrollingStateFor(!1,[window.SCREEN_MOBILE,window.SCREEN_TABLET]),t(window).off("scroll",h)}}),a.data("ac-initialized",!0),a.focus(function(){t(this).searchAutoComplete("search")}),i.addEventListener("submit",function(){r(a.val())})}}function o(){if(0!==u.length){var t=[];return u.forEach(function(e){var a={group:"История поиска",label:e.label,url:e.url};t.push(a)}),t.push({group:"История поиска",isHistoryClearBtn:!0,label:"Очистить историю"}),t}}function n(){var t=window.localStorage.getItem(e);return null===t?[]:JSON.parse(t)}function r(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(0!==t.trim().length){for(var o in u)t===u[o].label&&u.splice(o,1);var n={label:t,url:i};u.unshift(n),u.length>a&&(u=u.slice(0,a)),window.localStorage.setItem(e,JSON.stringify(u))}}function d(){return f.filter(":visible")}function l(){d(),i(d())}function s(){var t=p.get(0).getBoundingClientRect(),e=0<=t.top&&t.top<=window.innerHeight,a=0<=t.bottom&&t.bottom<=window.innerHeight;return e&&a}var c="",u=[],f=t("[data-role=search-input]"),p=t("#header-search"),h=function(){var t=d();0!==t.length&&!1===s()&&t.searchAutoComplete("close")};t(window).on([window.EVENT_CHANGE_SCREEN_TYPE,window.EVENT_OPEN_SEARCH].join(" "),l),f.each(function(){var e=t(this);e.is(":visible")&&i(e)}),t(window).on(window.EVENT_CHANGE_HEADER_FIXED_STATE,function(t,e){if(!window.checkScreenType(window.SCREEN_MOBILE,window.SCREEN_TABLET)){var a=d();if(a.length){var i=a.data("custom-searchAutoComplete");if(void 0!==i){var o=i.menu.element,n=a.get(0).getBoundingClientRect(),r=n.bottom;o.toggleClass("fixed",e),!1===e&&(r+=window.pageYOffset),o.css({top:r,left:n.left,minWidth:n.width})}}}}),t(window).trigger(window.EVENT_HARD_CHECK_HEADER_FIXED_STATE)})}(jQuery),$.widget("custom.searchAutoComplete",$.ui.autocomplete,{_renderMenu:function(t,e){var a=this,i="";t.addClass("b-search-autocomplete");var o=this.term;a.searchVariants=[];var n=o.split(" ");for(var r in n)if(n.hasOwnProperty(r)){var d=n[r];if(d.length<2&&!0===isNaN(parseInt(d)))continue;a.searchVariants.push(String.escapeRegExp(d)),a.searchVariants.push(String.escapeRegExp(String.eToYoTransition(d))),a.searchVariants.push(String.escapeRegExp(String.YoToETransition(d))),a.searchVariants.push(String.escapeRegExp(String.switchKeyboard("lat",d))),a.searchVariants.push(String.escapeRegExp(String.escapeRegExp(String.switchKeyboard("rus",d))))}$.each(e,function(e,o){if(o.group!==i){var n=$("<li>").html(o.group);n.data("ui-autocomplete-item",o),n.addClass("ui-autocomplete-group-title"),o.isCategory&&n.addClass("ui-autocomplete-category"),o.isProduct&&n.addClass("ui-autocomplete-product"),t.append(n),i=o.group}var r=a._renderItemData(t,o);o.group&&r.attr("aria-label",o.group+" : "+o.label)})},_renderItem:function(t,e){var a=$("<li>"),i=$('<a class="ui-link" />'),o=new RegExp("("+this.searchVariants.join("|")+")","gi"),n=e.label.replace(o,"<mark>$1</mark>");return a.attr("data-value",e.value),i.html(n),e.isCategory&&a.addClass("category-el"),e.isProduct&&a.addClass("product-el"),e.isHistoryClearBtn&&a.addClass("history-clear-btn"),a.append(i).appendTo(t),a}}),function(t,e){e(function(){var t=e("#f-check-invoice-payment");0!==t.length&&t.on("submit",function(){return t.find('INPUT[type="text"]').val().trim().length<10?(alert("Номер счёта введён неправильно."),!1):"ajax"===t.data("method")?(e.post(t.attr("action"),t.serialize(),function(t){e("#b-check-invoice-payment-result").html(t)}),!1):void 0})})}(document,jQuery),function(){var t="show-3d-image",e=-1,a=function(){function a(i){var o=this;_classCallCheck(this,a),this.container=document.getElementById(i),null!==this.container&&(this.shots=[],this.currentShotIndex=0,this.rotationTimeoutId=void 0,this.image3D=void 0,this.preloader=void 0,this.directions=new Map,this.shotUrlKey=void 0,this.autoPlayDirection=e,this.currentPanDirection=void 0,this.panStartX=void 0,this.shotsDelta=0,this.panHandler=function(t){if(o.stopRotation(),!1!==o.directions.has(t.direction)){var e=o.directions.get(t.direction);e!==o.currentPanDirection&&(o.panStartX=t.center.x,o.currentPanDirection=e);for(var a=Math.min(o.container.getBoundingClientRect().width),i=Math.min(Math.abs(o.panStartX-t.center.x),a),n=Math.round(a/2/o.shots.length),r=Math.round(i/n),d=0;d<r-o.shotsDelta;d++)o.rotate(e);o.shotsDelta=r}},document.addEventListener("click",function(e){void 0!==e.target&&t===e.target.dataset.role&&o.init()},!0))}return _createClass(a,[{key:"init",value:function(){var t=this;if(void 0===this.image3D){this.preloader=this.container.querySelector('[data-role="ajax-loader-circular"]'),this.preloader.classList.remove("hidden");var a=document.createElement("div"),i=0,o=void 0,n=function(){t.container.removeChild(a);var i=t.container.querySelector('[data-role="image-container"]');if(null!==i){var o=i.querySelector("img");null===o&&(o=document.createElement("img"),i.appendChild(o)),t.image3D=o,0===t.directions.size&&(t.directions.set(Hammer.DIRECTION_RIGHT,1),t.directions.set(Hammer.DIRECTION_LEFT,e));var n=new Hammer(t.image3D);n.on("panleft panright press",t.panHandler),n.on("tap",function(){void 0===t.rotationTimeoutId?t.startRotation():t.stopRotation()}),n.on("panend",function(){t.stopRotation(),t.currentPanDirection=void 0,t.panStartX=void 0}),n.on("panstart",function(e){t.panStartX=e.center.x,t.currentPanDirection=e.direction,t.shotsDelta=0}),t.preloader.classList.add("hidden"),t.rotate(0),t.startRotation()}};this.setupShotUrl(),this._disableNativeEvents(),a.style.display="none",a.addEventListener("event:shots-loaded",n),this.shots.forEach(function(e){o=document.createElement("img"),o.src=e[t.shotUrlKey],o.onload=function(){++i===t.shots.length&&a.dispatchEvent(new CustomEvent("event:shots-loaded"))},a.appendChild(o)}),this.container.appendChild(a),window.onresize=function(){t.setupShotUrl()}}}},{key:"setupShotUrl",value:function(){this.shotUrlKey="desktopUrl",window.checkScreenType(window.SCREEN_TABLET)?this.shotUrlKey="tabletUrl":window.checkScreenType(window.SCREEN_MOBILE)&&(this.shotUrlKey="mobileUrl")}},{key:"startRotation",value:function(){var t=this,a=e===this.autoPlayDirection&&0===this.currentShotIndex,i=1===this.autoPlayDirection&&this.shots.length===this.currentShotIndex+1,o=a||i?700:150;this.rotationTimeoutId=setTimeout(function(){i?t.autoPlayDirection=e:a&&(t.autoPlayDirection=1),t.rotate(t.autoPlayDirection),t.startRotation()},o)}},{key:"stopRotation",value:function(){clearTimeout(this.rotationTimeoutId),this.rotationTimeoutId=void 0}},{key:"rotate",value:function(t){this.currentShotIndex+=t,this.currentShotIndex>=this.shots.length?this.currentShotIndex=this.shots.length-1:this.currentShotIndex<0&&(this.currentShotIndex=0),this.image3D.src=this.shots[this.currentShotIndex][this.shotUrlKey]}},{key:"_disableNativeEvents",value:function(){this.container.onselectstart=function(){return!1},this.container.ondblclick=function(){return!1}}}]),a}(),i=new Map;window.slider3DImage=function(t){return!1===i.has(t)&&i.set(t,new a(t)),i.get(t)}}(),function(t,e,a){window.EVENT_INIT_COMMENTS_WIDGET="commentsWidget:init",window.EVENT_SUBMIT_COMMENTS_WIDGET="commentsWidget:submit";var i="[data-role=comments-widget]";e.fn.commentsWidget=function(){function o(){C.closest("opinion-item")?(C.closest(".opinion-item").find(".comments-form").removeClass("visible"),_.prop("disabled",!1)):_.prop("disabled",!1).show(),I.hide()}function n(t,a){if(a=void 0!==a?a:"00000000-0000-0000-0000-000000000000",!(t instanceof Function))throw"Не указан обязательный параметр cb";var i=C.find(w+'[data-parent-id="'+a+'"]');return 0!==i.length?t(i):e.ajax({url:C.find(h).data("form-url"),type:"GET",data:{parentId:a},dataType:"JSON",success:function(i){!0===i.result&&(t(e(i.html)),C.find(w+'[data-parent-id="'+a+'"]').find(T).select2().next().css("display","block"))}})}function r(){return C.find("["+k+"]")}function d(t){var a=t?e(this).closest(w):r();if(0!==a.length){var i=void 0;a.is(w)?i=a.prev():(i=a,a=i.next()),a.is(w)&&a.hide(),i.removeAttr(k);i.find(m).removeClass("active")}}function l(){var a=e(this),i=a.closest(g),r=i.find(m);return r.addClass("active"),I.html().trim().length&&o(),d(),n(function(a){i.after(a);var o=a.find(b),n=(e(t).width()-e("main").width())/2,l=r.offset().left-n-o.width()-12;o.css({left:l}).show(),a.show(),a.find(window.SELECTOR_CAPTCHA_RELOAD).trigger("reload"),i.attr(k,""),a.find(v).click(d)},i.data("id")),!1}function s(t){t.find(m).click(l),t.find(".vote-widget-container[data-has-many-negative]").each(function(){e(this).closest(g).addClass("has-many-negative")})}function c(){S.show()}function u(){S.hide()}function f(){var t=arguments.length>0&&arguments[0]!==a&&arguments[0],i={};i.page=x,i.limit=N,c(),e.ajax({url:C.data("request-url"),type:"GET",data:i,dataType:"JSON",success:function(a){if(!0===a.result){u();var i=e(a.html);s(i),C.find(".comments").append(i),x++,!0===t&&p(),e(window).trigger(window.EVENT_INIT_VOTE_WIDGET),e(window).trigger(window.EVENT_INIT_CLAIM_WIDGETS)}}})}function p(){var t=e(y),a=e(E),o=void 0;0!==a.length?o=a.parent().offset().top-t.height():(a=e(i),o=a.offset().top-t.height()-30),e("html, body").animate({scrollTop:o},"slow")}var h='[data-role="add-form"]',v='[data-role="cancel"]',m=".sub-add-comment",g=".comment",w=".comment.reply",b=".border-triangle",T='[data-role="city-selector"]',E='a[href="\\#comment"]:visible',y="#header-search",k="data-opened",C=e(this);if(!C.data("initiated")){C.data("initiated",1);var _=C.find(h),I=C.find(".add-form-container"),S=C.find('[data-role="comments-loader"]'),O=C.find(".comments-container"),N=parseInt(C.data("limit")),x=parseInt(O.find('[data-role="pagination"]').data("current-page"))+1;s(O.find(g)),C.on("click","a[data-page]",function(){return x=parseInt(e(this).data("page"))+1,C.find(".comments").html(""),f(!0),!1}),C.on("click",'[data-role="show-more"]',function(){return C.find(".pagination-container").remove(),f(),!1}),C.on("click",v,o),C.on("click",h,function(){e(this).prop("disabled",!0),n(function(t){d(),C.find(".add-form-container").html(t).show()},a)}),C.on("submit","FORM",function(){var t=e(this),a=t.serializeArray();return window.dispatchEvent(new CustomEvent(window.EVENT_SUBMIT_COMMENTS_WIDGET,{detail:{params:a}})),e.ajax({url:t.attr("action"),type:"POST",dataType:"JSON",data:a,success:function(a){if(!0===a.result){var i=a.data,o=t.closest(w),n=C.find(g+'[data-id="'+o.data("parent-id")+'"]');if(o.remove(),C.find(".add-form-container").html(i.content).show(),C.closest("opinion-item")?C.find(h).prop("disabled",!1):C.find(h).prop("disabled",!1).show(),i.comment&&"string"==typeof i.comment.valueOf()){var r=e(i.comment);0!==n.length?(r.attr("data-child",n.data("child")+1),n.last().after(r)):C.find(".comments-container").prepend(r),r.addClass("new"),r.on("click",m,l)}window.setTimeout(function(){C.find(".add-form-container").find(".alert-success").fadeTo(500,0).slideUp(500,function(){e(this).remove()})},4e3)}},error:function(){C.find(h).prop("disabled",!1).show()}}),!1}),C.on("click",'[data-role="open-answer"]',function(){var t=e(this),a=t.find(".open-close-answer-text"),i=t.find('[data-role="open-close-answer-icon"]'),o=t.parents(g),n=C.find('.comment-answer[data-parent-comment-guid="'+o.attr("data-id")+'"]');i.toggleClass("close"),n.hasClass("hidden")?(n.removeClass("hidden"),a.html("Свернуть ответы")):(n.addClass("hidden"),a.html("Развернуть ответы ("+n.find('[data-child="1"]').length+")"))})}};var o=function(){e(i).each(function(){e(this).commentsWidget()})};e(function(){o(),e(window).on(window.EVENT_INIT_COMMENTS_WIDGET,o)})}(document,jQuery),function(t,e){function a(){function a(t){t.addClass("hidden"),t.after(S.clone())}function w(t){var e=t.next(".loading-dots");e.length&&e.detach(),t.removeClass("hidden")}function b(){a(E),e.ajax({url:E.data("request-url"),type:"GET",dataType:"JSON",success:function(t){if(!0===t.result){var a=e(t.content);E.replaceWith(a),E=a}w(E),e(window).trigger(window.EVENT_INIT_CLAIM_WIDGETS)}})}var T=e("#faq"),E=T.find("[data-role=faq-tab-content]"),y=e(".faq-controls"),k=e(".faq-best-assistants"),C=e("[data-role=question-form-container]"),_=E.find('[data-role="questions-counter"]'),I=E.find('[data-role="answer-counter"]');if(0!==E.length){var S=e("<div><span /><span /><span /><span /></div>").addClass("loading-dots");e(t).on("tabSelected","#faq",function(){E.is(":empty")&&b()}),T.on("click","[data-role=toggle-topic]",function(){return e(this).closest("[data-role=topic]").toggleClass("expand"),!1}),T.on("click","[data-role=toggle-question]",function(){return e(this).closest("[data-role=question]").find("[data-role=question-content]").toggleClass("hidden"),!1}),T.on("click","[data-role=show-question-form]",function(t){t.preventDefault();var i=e(this);0===e(g).length?(a(C),e.ajax({url:i.data("get-form-url"),type:"GET",dataType:"JSON",success:function(t){if(!0===t.result){var a=e(t.content);C.append(a),e(g).removeClass("hidden")}w(C)}})):e(g).removeClass("hidden"),k.addClass("hidden"),i.addClass("hidden"),y.addClass("hidden")}),T.on("click","[data-role=hide-question-form]",function(t){t.preventDefault(),e("[data-role=question-form]").addClass("hidden"),e("[data-role=show-question-form]").removeClass("hidden"),e(".faq-best-assistants").removeClass("hidden"),e(".faq-controls").removeClass("hidden")}),T.on("click","[data-role=submit-question-form]",function(t){t.preventDefault();var i=e(this),o=e(g).serializeArray();return window.dispatchEvent(new CustomEvent(window.EVENT_SUBMIT_QUESTION_WIDGET,{detail:{params:o}})),a(C),e.ajax({url:i.data("submit-form-url"),type:"POST",dataType:"JSON",data:o,success:function(t){if(!0===t.result){if(C.html(t.content),t.errors.hasOwnProperty("fatal"))return C.find(".alert-danger").append(t.errors.fatal).removeClass("hidden"),void window.setTimeout(function(){C.find(".alert-danger").fadeTo(500,0).slideUp(500)},5e3);if(!0===t.hasOwnProperty("updateTab")&&!0===t.updateTab)b();else{var a=e('[data-role="topic-container"]');e(t.question).addClass("new"),a.prepend(e(t.message)),a.append('<div class="topic" data-role="topic" data-topic-id="'+t.topicGuid+'"></div>').append('<div class="questions"></div>').append(e(t.question)),_.text(1+parseInt(_.text())),e("[data-role=show-question-form]").removeClass("hidden"),e(g).remove(),window.setTimeout(function(){a.find(".alert-warning").fadeTo(500,0).slideUp(500)},12e3)}}}}),w(C),!1}),T.on("click","[data-role=show-answer-form]",function(t){t.preventDefault();var i=e(this),o=e("[data-role=show-answer-form]"),n=i.closest('[data-role="question"]').find("[data-role=answer-form-container]"),r=n.find("[data-role=answer-form]");0===r.length?(a(n),e.ajax({url:i.data("get-form-url"),type:"GET",dataType:"JSON",success:function(t){if(!0===t.result){var a=e(t.content);n.append(a),r=a,r.removeClass("hidden")}w(n)}})):(r.appendTo(n),r.removeClass("hidden")),o.removeClass("hidden"),i.addClass("active")}),T.on("click","[data-role=hide-answer-form]",function(t){t.preventDefault(),e("[data-role=answer-form]").addClass("hidden"),e("[data-role=show-answer-form]").removeClass("active")}),T.on("click","[data-role=submit-answer-form]",function(t){t.preventDefault();var i=e(this),o=i.closest("[data-role=answer-form]"),n=o.closest("[data-role=answer-form-container]");a(n);var r=o.serializeArray();return window.dispatchEvent(new CustomEvent(window.EVENT_SUBMIT_ANSWER_WIDGET,{detail:{params:r}})),e.ajax({url:i.data("submit-form-url"),type:"POST",dataType:"JSON",data:r,success:function(t){if(!0===t.result)if(!0===t.hasOwnProperty("updateTab")&&!0===t.updateTab)b();else{w(n);var a=e(t.answer),i=e('[data-role="topic-container"]'),o=e('[data-role="show-answer-form"]');a.addClass("new"),o.removeClass("active"),n.next('[data-role="answers-container"]').prepend(a),i.prepend(e(t.message)),I.text(1+parseInt(I.text())),n.html(""),window.setTimeout(function(){i.find(".alert-warning").fadeTo(500,0).slideUp(500)},4e3)}}}),!1}),T.on("click",s,function(t){t.preventDefault();var a=e(this),i=a.closest(l),o=i.find(f),n=o.find(p),r=o.find(h),d=o.find(v);return!i.is("[data-voted]")&&(i.attr("data-voted",!0),e.ajax({url:i.data("url"),type:"POST",dataType:"JSON",data:{vote:a.data("vote-type")},success:function(t){if(!1===t.result||t.hasOwnProperty("error"))return i.removeAttr("data-voted"),!1;var e=parseInt(n.text())||0,l=parseInt(r.text())||0,s=parseInt(d.text())||0;a.is(c)?(e+=1,l+=1):a.is(u)&&(e-=1,s-=1),n.text(e),r.text(l),d.text(s),0>e?o.removeClass("positive").addClass("negative"):0<e?o.removeClass("negative").addClass("positive"):o.removeClass("negative").removeClass("positive"),a.addClass("voted")},error:function(){i.removeAttr("data-voted")}}),!1)}),T.on("click",f,function(){e(this).find(i).show()}).on("mouseleave",f,function(){0!==window.getVisible(i).length&&e(this).find(i).hide()}),T.on("click",d,function(){e("input[type=checkbox]:checked",this).length>0?(1===e("input[type=checkbox]:checked",".faq-controls .dropdown-menu").length&&e(".topic",T).addClass("hidden"),e("[data-topic-id="+e("input[type=checkbox]",this).val()+"]").removeClass("hidden")):e("[data-topic-id="+e("input[type=checkbox]",this).val()+"]").addClass("hidden"),0===e("input[type=checkbox]:checked",".faq-controls .dropdown-menu").length&&e(".topic",T).removeClass("hidden")}),T.on("click",n,function(){e(o).hasClass("open")?(e(this).removeClass("open"),e(this).find("a").text("Развернуть"),e(o).removeClass("open")):(e(this).addClass("open"),e(this).find("a").text("Свернуть"),e(o).addClass("open"))}),T.on("click",r,function(){e(this).addClass("hidden").prev(".answers").find(".answer").removeClass("hidden")}),e(m).prop("checked")||e(m).prop("disabled",!1),T.on("click",m,function(){var t="Произошла ошибка. Повторите попытку позже.",a=e(this);e.ajax({url:a.data("url"),type:"GET",dataType:"JSON",success:function(e){!0===e.result&&(t=a.prop("checked")?"Вы подписаны на уведомления о новых вопросах к данному товару,уведомления будут приходить на электронную почту. Отписаться от уведомлений,Вы сможете в карточке спустя некоторое время или в письме с уведомлением о новом вопросе.":"Вы отписались от рассылки по вопросам")}}).always(function(){a.prop("disabled",!0),e(".subscribe-alert").css("display","block"),e(".subscribe-alert > SPAN").text(t),setTimeout(function(){e(".subscribe-alert").fadeOut("slow")},1e4)})})}}window.EVENT_SUBMIT_QUESTION_WIDGET="questionWidget:submit",window.EVENT_SUBMIT_ANSWER_WIDGET="answerWidget:submit";var i=".vote-counter-expand",o=".disclaimer",n=".disclaimer .expand-btn",r=".question .show-remain-answers",d=".faq-controls .dropdown-menu .checkbox",l="[data-role=faq-vote-container]",s="[data-role=vote]",c="[data-vote-type=up]",u="[data-vote-type=down]",f="[data-role=counter-container]",p="[data-role=counter-all]",h="[data-role=counter-up]",v="[data-role=counter-down]",m="#subscribe-on-questions",g="[data-role=question-form]";e(t).ready(function(){a(),window.addEventListener(window.EVENT_INIT_FAQ_WIDGETS,a)})}(document,jQuery),function(t,e,a){var i="#b-feedback-upload-images";e(function(){i=e(i),0!==i.length&&i.find('[data-action="remove"]').click(function(){var t=e(this).closest("[data-image-index]");t.find(".image-preview IMG").removeAttr("src"),t.find("INPUT[data-ajax-image-id]").val("")})})}(document,jQuery),function(t){function e(t){s.closest(".form-group").addClass("has-error").find(".help-block-error").text(t)}function a(){s.closest(".form-group").removeClass("has-error").find(".help-block-error").empty()}function i(t){l.val(t)}var o=t("#feedback-answer-form"),n=t("[data-role=show-answer-create-form-btn]"),r=t("[data-role=hide-answer-create-form-btn]"),d=t("[data-role=ticket-charter-input]"),l=t("[data-role=ticket-theme-input]"),s=t("[data-role=themes-container]"),c=t("[data-role=mute-block]"),u=t("[data-role=btn-submit]"),f=t("[data-role=comment]"),p=t("[data-role=message-toggle]"),h=t("#email-confirm-modal"),v=t("#ticket-create-form"),m=t("#ticketcreateform-useremail"),g=t("#email-modal-submit"),w=t("#feedback-my-tickets-tabs-block");0!==w.length&&w.responsiveTabs({active:0,setHash:!0,collapsible:"accordion",classes:{stateDefault:"r-tabs-state-default",stateActive:"active",stateDisabled:"r-tabs-state-disabled",stateExcluded:"r-tabs-state-excluded",tab:"r-tabs-tab",anchor:"r-tabs-anchor",panel:"r-tabs-panel",accordionTitle:"r-tabs-accordion-title"}}),0!==s.find(".selected").length&&c.addClass("hidden"),n.on("click",function(){n.addClass("hidden"),o.removeClass("hidden")}),r.on("click",function(){o.addClass("hidden"),n.removeClass("hidden")}),p.on("click",function(){t(this).closest("[data-role=message-block]").toggleClass("opened")}),d.on("change",function(){t.ajax({url:d.data("url"),type:"GET",dataType:"JSON",data:{charterGuid:d.val()},success:function(t){t?(a(),s.html(t),c.removeClass("hidden"),i(null)):e("В выбранном разделе отсутствуют темы")},error:function(){e("Ошибка. Повторите попытку позже.")}})}),s.on("click","[data-role=theme]",function(){var e=t(this);t("[data-role=theme]").removeClass("selected"),e.addClass("selected"),a(),c.addClass("hidden"),i(e.attr("data-theme-id"))}),f.on("input",function(){u.prop("disabled",t(this).attr("data-min-length")>t(this).val().trim().length)}),v.on("submit",function(){if(!1===m.hasClass("send-empty")){var e=m.val();if(""===t.trim(e))return h.modal("show"),!1}}),g.on("click",function(){m.addClass("send-empty"),v.submit()})}(jQuery),function(t,e){t(function(){t(e).on("submit","[data-role=inform-about-product-availability-form]",function(){var e=t(this);if(e.data("disabled"))return!1;e.data("disabled",!0);var a=e.find("button");return a.toggleClass("disabled",!0),e.find(".alert").remove(),t.ajax({url:e.attr("action"),dataType:"JSON",type:"POST",data:e.serialize(),success:function(t){!0===t.result?(setTimeout(function(){e.closest(".modal").modal("hide")},3e3),e.replaceWith('<div class="alert alert-success">Спасибо за ваше обращение. Специалисты его рассмотрят и свяжутся с вами в ближайшее время.</div>')):0!==t.errors.length?e.prepend('<div class="alert alert-danger">Исправьте следующие ошибки:<ul><li>'+t.errors.join("</li><li>")+"</li></ul></div>"):e.prepend('<div class="alert alert-danger">Не удалось выполнить запрос</div>')},error:function(){e.prepend('<div class="alert alert-danger">Не удалось выполнить запрос</div>')}}).always(function(){e.data("disabled",!1),a.toggleClass("disabled",!1)}),!1})})}(jQuery,document),FilterBlockCheckboxList.prototype=Object.create(FilterBlock.prototype),FilterBlockCheckboxList.prototype.constructor=FilterBlockCheckboxList,FilterBlockCheckboxList.prototype.init=function(t){var e=this,a='[data-role="filter-block-item"]',i="empty-result";if(FilterBlock.prototype.init.apply(this,[t]),window.checkScreenType(window.SCREEN_MOBILE,window.SCREEN_TABLET)){if(1===parseInt(this.$block.data("variants-count")))return;this.$block.find('[data-toggle="collapse"]').attr("aria-expanded","false").addClass("collapsed").end().find(".filter-block-items").removeClass("in")}var o=this,n=o.$block.find('[data-role="'+i+'"]'),r=o.$block.find('[data-role="clear-search-container"]'),d=o.$block.find('[data-role="clear-search-button"]');o.$block.on("keyup",'input[data-role="filter-items-search"]',function(t){function e(){o.$block.find('[data-role="'+i+'"]').addClass("hidden"),o.$block.find("mark").each(function(){$(this).parent().text($(this).parent().text())}),r.addClass("hidden"),o.$block.find(a).removeClass("hidden")}var l=$(this),s=o.$block.find(a+':not(".hidden")');KeyboardCodes.ENTER===t.keyCode&&1===s.length&&!1===s.find('[type="checkbox"]').prop("checked")&&(s.find('[type="checkbox"]').prop("checked",!0),o.$block.trigger(window.EVENT_FILTER_BLOCK_AFTER_CHANGE),$(window).trigger(window.EVENT_DESTROY_TOOLTIPS));var c=$(this).val().toLowerCase();if(e(),d.addClass("hidden"),0===c.length)l.tooltip("destroy");else{0===d.length&&(d=$("<span/>"),d.attr("data-role","clear-search-button"),d.attr("class","hidden-md hidden-lg"),l.after(d),d.on("click",function(){e(),l.val(""),d.addClass("hidden")})),d.removeClass("hidden"),0===r.length&&(r=$("<div/>"),r.attr("data-role","clear-search-container"),r.append($("<a/>",{html:"Сбросить поиск",href:"#"})),o.$block.find(".filter-block-items").append(r),r.find("a").on("click",function(){return e(),l.val(""),d.addClass("hidden"),!1})),r.removeClass("hidden");var u=String.getSearchStringVariants(c),f=[];o.$block.find("label:not(.filter-block-title)").each(function(){var t=$(this);f[t.attr("for")]=t.text(),t.text(t.text().toLowerCase()),t.attr("data-found",0)});for(var p in u)u.hasOwnProperty(p)&&o.$block.find('label:not(.filter-block-title):contains("'+u[p]+'")').attr("data-found",1);var h=o.$block.find("[data-found=1]");for(var v in f)f.hasOwnProperty(v)&&o.$block.find('label[for="'+v+'"]').text(f[v]);if(0===h.length)return o.$block.find(a).addClass("hidden"),0===n.length?(n=$("<div/>",{
html:"К сожалению, ничего не найдено"}),n.attr("data-role",i),l.parent().after(n)):n.removeClass("hidden"),!1;o.$block.find(a).addClass("hidden"),h.each(function(){var t=$(this),e=t.closest(a),i=t.text().replace(new RegExp("("+u.join("|")+")","gi"),"<mark>$1</mark>");t.html(i),e.removeClass("hidden")}),1!==h.length||window.checkScreenType(window.SCREEN_MOBILE,window.SCREEN_TABLET)?l.tooltip("destroy"):l.tooltip({html:!0,placement:"right",trigger:"focus",title:"Чтобы выбрать <b>"+h.text()+"</b>, нажмите Enter"}).tooltip("show")}}),o.$block.on("change",function(){var t=e.$block.find(':input[type="checkbox"]:checked').length;e.$block.find("[data-role=selected-filters-counter]").text("("+t+")").toggleClass("hidden",0===t)})},FilterBlockCheckboxList.prototype.getSelectedValue=function(){var t=[];return this.$block.find(':input[type="checkbox"]:checked').each(function(){t.push($(this).data("id"))}),this.$block.find("label").first().toggleClass("selected",0!==t.length),0!==t.length?t.join("-"):void 0},FilterBlockCheckboxList.prototype.reset=function(){this.$block.find("[data-role=selected-filters-counter]").addClass("hidden"),this.$block.find('[type="checkbox"]').prop("checked",!1)},FilterBlockCheckbox.prototype=Object.create(FilterBlock),FilterBlockCheckbox.prototype.constructor=FilterBlockCheckbox,FilterBlockCheckbox.prototype.getSelectedValue=function(){var t=this.$block.find(':input[type="checkbox"]:checked').first();return this.$block.find("label").first().toggleClass("selected",0!==t.length),0!==t.length?t.data("id"):void 0},FilterBlockCheckbox.prototype.reset=function(){this.$block.find('[type="checkbox"]').prop("checked",!1)};var SELECTOR_INTERVAL_SLIDER='[data-role="interval-slider"]',SELECTOR_FILTER_INTERVAL_TO='[data-type="to"]',SELECTOR_FILTER_INTERVAL_FROM='[data-type="from"]';FilterBlockInterval.prototype=Object.create(FilterBlock.prototype),FilterBlockInterval.prototype.constructor=FilterBlockInterval,FilterBlockInterval.prototype.init=function(t){FilterBlock.prototype.init.apply(this,[t]);var e=this,a=this.$block.find("[data-role=presets-block]");0!==a&&(a.on("change","[type=radio]",function(){var t=$(this);if(t.is("[data-role=preset-all]"))e.reset();else{var a=e.$block.find(SELECTOR_FILTER_INTERVAL_FROM).first(),i=e.$block.find(SELECTOR_FILTER_INTERVAL_TO).first();a.val(t.data("min")||a.data("default")),i.val(t.data("max")||i.data("default")),a.change(),i.change()}}),this.$block.on("change",[SELECTOR_FILTER_INTERVAL_FROM,SELECTOR_FILTER_INTERVAL_TO].join(", "),function(){var t=e.$block.find(SELECTOR_FILTER_INTERVAL_FROM).first(),i=parseFloat(t.val().trim()),o=t.data("default");i=isNaN(i)?o:i;var n=e.$block.find(SELECTOR_FILTER_INTERVAL_TO).first(),r=parseFloat(n.val().trim()),d=n.data("default");r=isNaN(r)?d:r;var l=void 0;l=i===o&&r===d?a.find("[type=radio][data-role=preset-all]"):i===o?a.find('[type=radio][data-max="'+r+'"]:not([data-min])'):r===d?a.find('[type=radio][data-min="'+i+'"]:not([data-max])'):a.find('[type=radio][data-min="'+i+'"][data-max="'+r+'"]'),0===l.length&&(l=a.find("[type=radio][data-role=preset-all]")),l.prop("checked",!0)}))},FilterBlockInterval.prototype.getSelectedValue=function(){var t=this.$block.find(SELECTOR_FILTER_INTERVAL_FROM).first(),e=this.$block.find(SELECTOR_FILTER_INTERVAL_TO).first(),a=t.val()||t.data("default"),i=e.val()||e.data("default");a=parseFloat(a),i=parseFloat(i);var o=parseFloat(t.data("default"))!==a||parseFloat(e.data("default"))!==i;return this.$block.find("label").first().toggleClass("selected",o),o?a+"-"+i:void 0},FilterBlockInterval.prototype.reset=function(){var t=[SELECTOR_FILTER_INTERVAL_FROM,SELECTOR_FILTER_INTERVAL_TO].join(",");this.$block.find(t).each(function(){var t=$(this);t.val(t.data("default")).change()})},FilterBlockInterval.prototype.updateFilterValues=function(t){var e=this.$block.attr("id");if(void 0!==e){var a=document.getElementById(e);if(null!==a){var i=a.querySelector(SELECTOR_INTERVAL_SLIDER);if(!0===t.showActual?(i.setAttribute("data-filtered-min",t.min),i.setAttribute("data-filtered-max",t.max)):(i.removeAttribute("data-filtered-min"),i.removeAttribute("data-filtered-max")),t.hasOwnProperty("presetsCounts"))for(var o in t.presetsCounts)if(t.presetsCounts.hasOwnProperty(o)){var n=t.presetsCounts[o],r=this.$block.find('[data-id="'+o+'"]');r.find("[data-filter-block-item-count]").attr("data-filter-block-item-count",n),r.toggleClass("empty",0===n)}}}},FilterBlockRadioList.prototype=Object.create(FilterBlock.prototype),FilterBlockRadioList.prototype.constructor=FilterBlockRadioList,FilterBlockRadioList.prototype.init=function(t){if(FilterBlock.prototype.init.apply(this,[t]),window.checkScreenType(window.SCREEN_MOBILE,window.SCREEN_TABLET)){if(1===parseInt(this.$block.data("variants-count")))return;this.$block.find('[data-toggle="collapse"]').attr("aria-expanded","false").addClass("collapsed").end().find(".filter-block-items").removeClass("in")}},FilterBlockRadioList.prototype.getSelectedValue=function(){var t=this.$block.find(':input[type="radio"]:checked').first();return this.$block.find("label").first().toggleClass("selected",0!==t.data("id")),0!==t.data("id")?t.data("id"):void 0},FilterBlockRadioList.prototype.reset=function(){this.$block.find('[type="radio"]:first').prop("checked",!0)},window.EVENT_FILTER_BLOCK_REESET="filter-block:block-reset",FilterBlockSelectShops.prototype=Object.create(FilterBlock.prototype),FilterBlockSelectShops.prototype.constructor=FilterBlockSelectShops,FilterBlockSelectShops.prototype.init=function(t){function e(){var t=C.$block.find(':input[type="checkbox"]:checked:not(#'+l+")"),e=C.$block.find("button .title"),a=C.$block.find(':input[type="checkbox"]:not(#'+l+")").length;1===parseInt(t.length)?e.text(t.closest("div").find("label")[0].innerText):0===parseInt(t.length)||a===t.length?e.text("Все"):e.text(String.countPostfix(t.length,["магазин","магазина","магазинов"],"",!1,""))}function a(){if(0<C.$block.find(':input[type="checkbox"]:checked:not(#'+l+")").length)return C.$block.find('[data-role="clear-selected-shops"]').removeClass("hidden"),void C.$block.find("button").addClass(u);C.$block.find('[data-role="clear-selected-shops"]').addClass("hidden"),C.$block.closest("div").find("button").removeClass(u)}function i(t){if(E=t,!(0<w.getElementsByTagName("div").length)){O.setAttribute("checked","checked"),n();for(var e=2>=T.length?T.length:3,a=0;a<e;a++)!function(t){var e=T[t].closest("div").cloneNode(!0);e.getElementsByTagName("input")[0].checked&&e.getElementsByTagName("label")[0].classList.add("selected"),e.getElementsByTagName("label")[0].setAttribute("data-id",e.getElementsByTagName("input")[0].getAttribute("data-id")),e.getElementsByTagName("label")[0].addEventListener("click",function(){e.getElementsByTagName("label")[0].classList.toggle("selected"),void 0!==y&&clearTimeout(y),y=setTimeout(function(){w.classList.add("hidden")},3e3),void 0!==w.getAttribute(f)&&void 0!==window.ga&&ga("send","event","button","click",w.getAttribute(f)),o(this.getAttribute("data-id"))}),e.getElementsByTagName("input")[0].remove(),w.appendChild(e)}(a);S.classList.remove("hidden"),w.classList.remove("hidden")}}function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=new XMLHttpRequest;e.open("GET",w.getAttribute("data-request-set-cookie-url")+"?"+t),e.send(t)}function n(){var t=document.querySelector(s),e=t.getElementsByTagName("input");e=[].slice.call(e),1===e.length?!0===e[0].hasAttribute(p)&&!0===e[0].hasAttribute(h)&&e[0].setAttribute(v,getDistanceFromLatLonInKm(parseFloat(e[0].getAttribute(p)),parseFloat(e[0].getAttribute(h)),E.coords.latitude,E.coords.longitude)):!0===e[0].hasAttribute(p)&&!0===e[0].hasAttribute(h)&&e.sort(function(t,e){var a=getDistanceFromLatLonInKm(parseFloat(t.getAttribute(p)),parseFloat(t.getAttribute(h)),E.coords.latitude,E.coords.longitude),i=getDistanceFromLatLonInKm(parseFloat(e.getAttribute(p)),parseFloat(e.getAttribute(h)),E.coords.latitude,E.coords.longitude);return null===t.getAttribute(v)&&t.setAttribute(v,parseInt(1e3*a)),null===e.getAttribute(v)&&e.setAttribute(v,parseInt(1e3*i)),a-i});var a=void 0,i=void 0;T=[],T.push(e[0]),t.innerHTML="";for(var o=0;o<e.length;o++)!1!==e[o].hasAttribute(v)&&(a=parseInt(e[o].getAttribute(v)),parseInt(T[0].getAttribute(v))+c>=a&&T[0].getAttribute("id")!==e[o].getAttribute("id")&&T.push(e[o]),i=e[o].closest("div"),null===i.querySelector(".distance")&&(parseInt(a)>3e3?i.getElementsByTagName("label")[0].innerHTML+='<label class="distance"> - '+parseInt(a/1e3)+" км.</label>":i.getElementsByTagName("label")[0].innerHTML+='<label class="distance"> - '+a+" м.</label>"),t.appendChild(e[o].closest("li").cloneNode(!0)));var n=document.createElement("li"),r=document.createElement("li");n.innerHTML='<div class="group-name">Остальные магазины</div>',r.innerHTML='<div class="group-name">Ближайшие магазины</div>',n.setAttribute(m,g),r.setAttribute(m,g),e.length>T.length&&t.insertBefore(n,t.children[T.length]),t.insertBefore(r,t.firstChild),void 0!==window.ga&&ga("send","event","button","click",document.getElementById(l).getAttribute("data-analytics"))}function r(){var t=document.querySelector(s),e=t.getElementsByTagName("li");e=[].slice.call(e),e.sort(function(t,e){return parseInt(t.getAttribute(m))-parseInt(e.getAttribute(m))}),t.innerHTML="";for(var a=0;a<e.length;a++)g!==e[a].getAttribute(m)&&t.appendChild(e[a].cloneNode(!0))}function d(t){console.log(t),console.log("Неудалось получить координаты")}FilterBlock.prototype.init.apply(this,[t]);var l="sort-by-distance",s='[data-role="shops-list"]',c=1e3,u="shops-select",f="data-analytics-apply",p="data-location-latitude",h="data-location-longitude",v="distance",m="data-sort-order",g="true",w=void 0,b=void 0,T=[],E=void 0,y=void 0,k=document.querySelector(this.getContainerSelector());if(null!==k&&"true"!==k.getAttribute("init")){k.setAttribute("init",!0);var C=this,_=k.querySelector('[data-role="clear-selected-shops"]'),I=k.querySelector("[role=menu]"),S=k.querySelector(".sort-distance-container"),O=S.querySelector("#"+l),N=k.querySelectorAll('[data-toggle="dropdown"]'),x=document.getElementsByTagName("body");C.$block.on("change",'input:not([data-role="filter-items-search"]), select',function(){if(l===this.getAttribute("id"))return!1;e(),a()});var L=!0,R=!1,A=void 0;try{for(var D,P=N[Symbol.iterator]();!(L=(D=P.next()).done);L=!0){D.value.addEventListener("click",function(){C.$block.hasClass("open")?x[0].classList.add("lock"):x[0].classList.remove("lock")})}}catch(t){R=!0,A=t}finally{try{!L&&P.return&&P.return()}finally{if(R)throw A}}!1!="geolocation"in navigator&&null!==(w=k.querySelector("#near-shops-filter-container"))&&(b=w.querySelector('[data-role="close-near-shops-container"]'),b.addEventListener("click",function(){w.classList.add("hidden"),void 0!==w.getAttribute("data-analytics-close")&&void 0!==window.ga&&ga("send","event","button","click",w.getAttribute("data-analytics-close")),o()}),navigator.geolocation.getCurrentPosition(i,d)),C.$block.on(window.EVENT_FILTER_BLOCK_REESET,function(){a(),e()}),I.addEventListener("click",function(t){t.stopPropagation()}),_.addEventListener("click",function(){C.reset(),C.$block.trigger(window.EVENT_FILTER_BLOCK_AFTER_CHANGE),C.$block.change(),C.$block.closest("div").find("button").removeClass(u),a(),e()}),O.addEventListener("click",function(){if(this.checked)return void n();r()})}},FilterBlockSelectShops.prototype.getSelectedValue=function(){var t=[];return this.$block.find(':input[type="checkbox"]:checked').each(function(){t.push($(this).data("id"))}),0!==t.length?t.join(","):void 0},FilterBlockSelectShops.prototype.reset=function(){this.$block.find('[type="checkbox"]').prop("checked",!1),this.$block.trigger(window.EVENT_FILTER_BLOCK_REESET)},FilterBlockSelectShops.prototype.getContainerSelector=function(){return window.SELECTOR_FILTER_LIST_CONTAINER+'[data-id="shop-catalog"][data-side="top"][data-submit-type="change"]'},FilterBlock.prototype.init=function(t){this.$block=t;var e=this;e.$block.on("change",'input:not([data-role="filter-items-search"]), select',function(){e.$block.trigger(window.EVENT_FILTER_BLOCK_AFTER_CHANGE)}),this.isInitiated=!0},FilterBlock.prototype.getSelectedValue=function(){},FilterBlock.prototype.reset=function(){},FilterBlock.prototype.updateFilterValues=function(t){var e=this.$block.attr("id");if(void 0!==e){var a=document.getElementById(e);if(null!==a){var i=0,o=0;for(var n in t)if(!1!==t.hasOwnProperty(n)){var r=t[n],d=a.querySelector('[data-id="'+r.id+'"]');if(null!==d){d=d.parentNode;var l=!0===r.show||void 0===r.show?1:0;d.setAttribute("data-visibilty",l),0===l&&i++;var s=0===parseInt(r.count);!0===s?(o++,d.classList.add("empty")):d.classList.remove("empty");var c=d.querySelector("[data-filter-block-item-count]");null!==c&&c.setAttribute("data-filter-block-item-count",r.count)}}"action"===this.$block.attr("data-id")?this.showFilter():1<parseInt(this.$block.attr("data-variants-count"))&&1<parseInt(this.$block.attr("data-variants-count"))-i&&0<parseInt(this.$block.attr("data-variants-count"))-o?this.showFilter():!1===this.$block.hasClass("hidden")&&this.hideFilter()}}},FilterBlock.prototype.hideFilter=function(){!1===this.$block.hasClass("hidden")&&this.$block.addClass("hidden")},FilterBlock.prototype.showFilter=function(){this.$block.removeClass("hidden")},FilterBlock.prototype.setLockState=function(t){this.$block.find("input, select").prop("disabled",t)},function(t,e,a){function i(i){var n=this,r=void 0,d=new Map,l=void 0,s=void 0,c=!1;n.id=i;var u=function(e){s=p(),e.trigger(t.EVENT_FILTER_LIST_AFTER_CHANGE,s),e.trigger(t.EVENT_FILTER_LIST_AFTER_ALL_CHANGE,n),t.FILTER_LIST_SUBMIT_TYPE_CHANGE===e.data("submit-type")&&f()},f=function(){s=p(),r.first().trigger(t.EVENT_FILTER_LIST_SUBMIT,s)},p=function(){s={},s.data=[],s.filterListId=n.id;var t=void 0;return d.forEach(function(e){if(t=e.getSelectedValue(),a!==t){var i=e.id,o=i.indexOf(".");-1<o&&(i=i.substr(0,o)+"["+i.substr(o+1)+"]"),s.data.push({key:i,value:t})}}),s};this.init=function(){return c?this:(c=!0,r=e(t.SELECTOR_FILTER_LIST_CONTAINER+"[data-id="+n.id+"]"),d.forEach(function(a){var i=e(t.SELECTOR_FILTER_LIST_CONTAINER+"[data-id="+n.id+"] "+o+'[data-id="'+a.id+'"]');!1===a.isInitiated&&a.init(i)}),r.each(function(){var a=e(this);a.on(t.EVENT_FILTER_BLOCK_AFTER_CHANGE,o,function(){0!==a.find(this).length&&u(a)})}),e(document).ajaxSuccess(function(t,e){if(a!==e.responseJSON&&a!==e.responseJSON.data&&null!==e.responseJSON.data){var i=e.responseJSON.data.filterChanges,o=e.responseJSON.data.filterListId;if(a!==i&&a!==o&&0!==i.length&&n.id===o){var r=JSON.parse(i),l=void 0;for(var s in r)!1!==r.hasOwnProperty(s)&&!1!==d.has(s)&&(l=r[s],!1===l.isViewable?d.get(s).hideFilter():d.get(s).showFilter(),d.get(s).updateFilterValues(l))}}}),this)},this.addBlock=function(t){return d.has(t.id)?this:(d.set(t.id,t),this)},this.resetFilter=function(t){return d.has(t)&&d.get(t).reset(),f(),this},this.resetList=function(){return d.forEach(function(t){t.reset()}),f(),this},this.show=function(){return r.closest(t.SELECTOR_FILTER_LIST_CONTAINER).removeClass("initial-state").addClass("active"),e("body, html").addClass("blocked"),this},this.hide=function(){return r.closest(t.SELECTOR_FILTER_LIST_CONTAINER).removeClass("active"),e("body, html").removeClass("blocked"),this},this.submitFilters=function(t){var i=0;return r.each(function(){var o=e(this);i=i||(!1!==t&&a!==o.attr("data-trigger-timeout")?parseInt(o.attr("data-trigger-timeout")):0)}),a!==l&&clearTimeout(l),l=setTimeout(f,i),this},this.toggleLockState=function(t){d.forEach(function(e){e.setLockState(t)})},this.getBlocks=function(){return d},this.getSelectedFilters=function(){return s}}t.EVENT_FILTER_LIST_AFTER_CHANGE="filter-list:after-change",t.EVENT_FILTER_LIST_SUBMIT="filter-list:submit",t.FILTER_LIST_SUBMIT_TYPE_CHANGE="change",t.FILTER_LIST_SUBMIT_TYPE_BUTTON="button",t.SELECTOR_FILTER_LIST_CONTAINER='[data-role="filters-container"]';var o='[data-role="filter-block"]',n=new Map;t.FilterList=function(t){return!1===n.has(t)&&n.set(t,new i(t)),n.get(t)}}(window,jQuery,void 0),function(t,e,a){function i(t,e){var a=Math.pow(d,parseInt(Math.log(e-t)/Math.log(d)-1))||1;return(e-parseInt(e)>0||t-parseInt(t)>0)&&(a=Math.min(.5,a),e-t<d&&(a=Math.min(.1,a))),a<=s&&a>=l&&(a=0==t%l&&0==e%l?l:0==t%s&&0==e%s?s:d),a}function o(t,e){var a=t.data("type"),i=c===a?0:1;if(""===t.val())return!1;var o,n=t.val(),d=t.siblings("input[type=text]");o=""!==d.val()&&Number(d.val());var l=t.closest(r).find(".ui-slider"),s=l.slider("option","min"),f=l.slider("option","max");if(!(n>=s&&n<=f)){var p;return p=n>f?c===a?l.slider("values",1):f:u===a?l.slider("values",0):s,l.slider("values",i,p),"change"===e&&t.val(p),!1}!1===o||c===a&&n<=o||u===a&&n>=o?l.slider("values",i,n):(l.slider("values",i,o),"change"===e&&t.val(o))}function n(e){t(e).each(function(){var e=t(this);e.find(".slider_opt").each(function(e,a){var o=t(a),n=o.data("min"),d=o.data("max"),l=o.closest(r),s=l.find("input[type=text][data-type=to]"),c=l.find("input[type=text][data-type=from]");o.slider({range:!0,step:i(n,d),min:n,max:d,textFrom:c,textTo:s,values:[o.data("value_from"),o.data("value_to")],slide:function(e,a){var i=""!==c.val()?c.val():t(e.target).slider("option","min"),o=""!==s.val()?s.val():t(e.target).slider("option","max");s.toggleClass("is-changed",a.values[1]!==o),c.toggleClass("is-changed",a.values[0]!==i),s.val(a.values[1]!==t(e.target).slider("option","max")?a.values[1]:""),c.val(a.values[0]!==t(e.target).slider("option","min")?a.values[0]:"")},stop:function(){var e=t(this).closest(r).find("input[type=text][data-type].is-changed");0!==e.length&&e.removeClass("is-changed").change()}}).draggable(),f(o),new(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)(function(e){e.forEach(function(e){"attributes"===e.type&&f(t(e.target))})}).observe(a,{attributes:!0})}),e.find(".slider_opt_no_range").each(function(e,a){var i=t(a),o=i.data("true_value_title"),n=i.data("false_value_title");i.labeledslider({min:0,max:2,tickArray:[0,1,2],tickLabels:{0:"Не важно",1:n,2:o},slide:function(e,a){var i=t(this).parent().siblings("input[type=hidden]");i.val(a.value),i.change()},value:t(this).data("value")})}),e.find(".slider_opt_txtbox").change(function(){o(t(this),"change")}).keyup(function(){o(t(this),"keydown")}).focus(function(){t(this).select()}),e.attr("data-initialized",!0)})}var r="[data-box=interval]",d=10,l=50,s=100,c="from",u="to";t.widget("ui.slider",t.ui.slider,{refresh:function(){this.options.step=i(this.options.min,this.options.max);var t=this.options.textFrom.val(),e=parseInt(this.options.textFrom.val()),a=this.options.textTo.val(),o=parseInt(this.options.textTo.val());this.options.textFrom.prop("placeholder",this.options.min),this.options.textTo.prop("placeholder",this.options.max);var n=!1;""!==t?(e<this.options.min||e>this.options.max)&&(this.options.textFrom.val(""),n=!0,this.values(0,this.options.min)):this.values(0,this.options.min),""!==a?(o<this.options.min||o>this.options.max)&&(this.options.textTo.val(""),n=!0,this.values(1,this.options.max)):this.values(1,this.options.max),!0===n&&this.options.textFrom.change()},options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,textFrom:null,textTo:null,change:null,slide:null,start:null,stop:null}}),t(function(){n(".catalog-filter"),n(".filter-list"),t(window).on(window.EVENT_CONFIGURATOR_CATALOG_IS_LOADED,function(t){n(t.target)})});var f=function(e){var a=e.data("min"),i=e.data("max"),o=i-a,n=["min","max"];for(var r in n)if(!1!==n.hasOwnProperty(r)){var d=n[r],l=e.attr("data-filtered-"+d);if(void 0!==l){var s=e.find('[data-role="filtered-range-'+d+'"]');0===s.length&&(s=t("<div />").attr("data-role","filtered-range-"+d).addClass("filtered-range"),e.append(s));var c="min"===d?(l-a)/o*100:(i-l)/o*100;s.width(c+"%")}}};t(function(t){t.datepicker.regional.ru={closeText:"Закрыть",prevText:"&#x3c;Пред",nextText:"След&#x3e;",currentText:"Сегодня",monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],dayNames:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],dayNamesShort:["вск","пнд","втр","срд","чтв","птн","сбт"],dayNamesMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],weekHeader:"Нед",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},t.datepicker.setDefaults(t.datepicker.regional.ru)})}(jQuery,document),function(t,e){function a(t){t.$forms.each(function(a,i){e.map(e(i).find("input[name]:not([disabled])").serializeArray(),function(e){t.data[e.name]=e.value})})}function i(t){a(t),e.map(t.data,function(a,i){t.$form.append(e('<input type="hidden" name="'+i+'" value="'+a+'" />'))})}function o(t){1!=t.lockHook&&(t.lockHook=!0,t.$forms.each(function(){if(t.hookFn instanceof Function)return t.hookFn.call(this,t.$forms);e(this).submit()}),t.lockHook=!1,t.$form.submit())}function n(){var t=d[e(this).data("action")];return 0==t.lockHook&&(t.$forms.each(function(){for(var a=t.propaganda[e(this).data("id")],i=0,o=a.length;i<o;++i)a[i].call(this,t.$forms)}),o.call(this,t)),!1}function r(t){var a=t.target,i=e(a),o=t.delegateTarget,n=e(o),r=n.data("action"),l=n.data("name"),s=d[r].syncs[l],c=n.data("prefix")||"",u=n.data("attr")||"name",f=(i.attr(u)||"").replace(c,"");s.not(o).each(function(){if(n.is(this))return!0;var t=e(this),o=t.data("prefix")||"",r=t.data("attr")||"name",d="["+r+'="'+o+f+'"]';t.find(d).each(function(){var t=e(this),o=i.is("input[type=checkbox]")||i.is("input[type=radio]"),n=e(t.is("input[type=checkbox]")||t.is("input[type=radio]"));o&&n?this.checked=a.checked:t.val(i.val()),t.on("change",function(t){return e(t.delegateTarget).off("change",arguments.callee),t.preventDefault(),!1}),t.change()})})}var d={},l=function(){return arguments.callee};l.attach=function(t){var a=e(t);if(!a.is("form"))return null;var o=a.attr("action"),l=a.attr("name"),s=d[o];if(!d.hasOwnProperty(o)){var c=e('<form action="'+o+'" method="'+a.attr("method")+'" />');c.hide().appendTo("BODY"),s=d[o]={$form:c,$forms:e(),lockHook:!1,hookFn:null,data:{},propaganda:{},syncs:{}},c.on("submit",function(){i(s)})}return s.$forms.index(a.get(0))>-1?o:(a.data("id","g"+s.$forms.length),a.data("action",o),a.data("name",l),s.syncs.hasOwnProperty(l)||(s.syncs[l]=e()),s.syncs[l].push(a),s.$forms.push(a.get(0)),a.on("change",r).on("submit",n),o)},l.detach=function(t){var a=e(t);if(a.is("form")){var i=a.data("action"),o=d[i],r=o.$forms.index(a);r>-1&&o.$forms.splice(r,1),delete o.propaganda[a.data("id")],a.off("submit",n)}},l.send=function(t){o.call(null,d[t])},l.setGroupHook=function(t,e){d.hasOwnProperty(t)&&e instanceof Function&&(d[t].hookFn=e)},l.addFormHook=function(t,a){var i=e(t);if(i.is("form")&&a instanceof Function){var o=d[this.attach(i)],n=i.data("id");o.propaganda.hasOwnProperty(n)||(o.propaganda[n]=[]),o.propaganda[n].push(a)}},l.killFormHook=function(t,a){var i=e(t);if(i.is("form")&&a instanceof Function){var o=d[i.data("action")];if(!o)return;var n=o.propaganda[i.data("id")];0==arguments.length&&n.splice(0,n.length);var r=n.indexOf(a);n.splice(r,1)}},l.submit=function(t,e){d.hasOwnProperty(t)&&(e instanceof Function?d[t].$form.submit(e):this.send(t))},l.off=function(t,e){d.hasOwnProperty(t)&&e instanceof Function&&d[t].$form.off("submit",e)},window.FormAggregator=l,e.fn.aggregateForm=function(t){e(this).each(function(){l.attach(this),l.addFormHook(this,t)})},e.fn.detachForm=function(){l.detach(this)},e.fn.addHook=function(t){l.addFormHook(this,t)},e.fn.killHook=function(t){l.killFormHook(t)},e.fn.getGroupName=function(){return e(this).data("action")}}(document,jQuery),function(t,e){var a=void 0,i=void 0;t.fn.filters=function(){i=t(this),a=i.data("id"),e.FilterList(a).init(),i.on("click",'[data-role="submit-filters"]',function(){e.FilterList(a).submitFilters(!1).hide(),0<t('[data-role="ajax-loader"]').length&&(t('[data-role="ajax-loader"]').removeClass("open-filters"),t('[data-role="ajax-loader-circular"]').removeClass("open-filters"),t('[data-role="ajax-loader-control"]').removeClass("open-filters"))}),i.on("click",'[data-role="reset-filters"]',function(){e.FilterList(a).resetList().hide(),0<t('[data-role="ajax-loader"]').length&&(t('[data-role="ajax-loader"]').removeClass("open-filters"),t('[data-role="ajax-loader-circular"]').removeClass("open-filters"),t('[data-role="ajax-loader-control"]').removeClass("open-filters"))}),i.on("click",'[data-role="hide-filters"]',function(){e.FilterList(a).hide(),0<t('[data-role="ajax-loader"]').length&&(t('[data-role="ajax-loader"]').removeClass("open-filters"),t('[data-role="ajax-loader-circular"]').removeClass("open-filters"),t('[data-role="ajax-loader-control"]').removeClass("open-filters"))})}}(jQuery,window),function(t,e){var a,i;t.fn.filtersToggleButton=function(){a=t(this),i=a.data("filter-list-id"),a.on("click",function(){e.FilterList(i).show(),0<t('[data-role="ajax-loader"]').length&&(t('[data-role="ajax-loader"]').removeClass("hide").addClass("open-filters"),t('[data-role="ajax-loader-circular"]').addClass("hide open-filters"),t('[data-role="ajax-loader-control"]').addClass("open-filters"))}),t(e.SELECTOR_FILTER_LIST_CONTAINER+"[data-id="+i+"]").on(e.EVENT_FILTER_LIST_AFTER_CHANGE,function(t,e){a.find('[data-role="filters-counter"]').text(e.data.length).toggleClass("hidden",0===e.data.length)})}}(jQuery,window),function(t,e){var a=void 0;t.fn.pickedFilters=function(){var i=t(this);i.data("inited")||(i.data("inited",!0),i.on("click",'[data-role="reset-filter"]',function(){var i=t(this).data("filter-id");t('[data-role="widget-picked-filters"]').each(function(){var o=t(this);void 0!==(a=o.data("filter-list-id"))&&(e.FilterList(a).resetFilter(i),t(this).closest('[data-role="picked-filter"]').remove(),0===o.find('[data-role="picked-filter"]').length&&o.remove())})}),i.on("click",'[data-role="reset-filter-list"]',function(){t('[data-role="widget-picked-filters"]').each(function(){var i=t(this);void 0!==(a=i.data("filter-list-id"))&&(i.remove(),e.FilterList(a).resetList())})}))}}(jQuery,window);var FilterBlockShopType=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return _inherits(e,t),_createClass(e,[{key:"init",value:function(t){var a=this;_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this,t),this.$block=t,this.FILTER_SHOP_ALL="all",this.ATTR_DATA_ATTR_SHOPS_BY_TYPE="data-shops-by-type",this.SELECTOR_SHOP_TYPE_CHECKBOXES=".shop-type INPUT[type=checkbox]",this.shopsByType=[];var i=this,o=this.$block.find(this.SELECTOR_SHOP_TYPE_CHECKBOXES);this.shopsByType=JSON.parse(this.$block.attr(this.ATTR_DATA_ATTR_SHOPS_BY_TYPE)),this.$block.on("change",this.SELECTOR_SHOP_TYPE_CHECKBOXES,function(t){!0===$(t.target).is(":checked")?o.filter("[value="+a.FILTER_SHOP_ALL+"]").prop("checked",!1):0===o.filter("INPUT[type=checkbox]:checked").length&&o.filter("[value="+a.FILTER_SHOP_ALL+"]").prop("checked",!0),i.$block.trigger(window.EVENT_FILTER_BLOCK_AFTER_CHANGE)}),this.$block.on(window.EVENT_FILTER_LIST_AFTER_GET_NEW_VALUES,function(t,e){0!==e.length&&(e=e.split(",")),o.each(function(t,i){var o=$(i),n=o.val(),r=o.siblings("i"),d=0;a.FILTER_SHOP_ALL===n?d=e.length:a.shopsByType[n].forEach(function(t){-1!==e.indexOf(t)&&d++}),r.text(d)})})}},{key:"getSelectedValue",value:function(){var t=this,e=new Map;this.$block.find("INPUT[type=checkbox]:checked").each(function(t,a){e.set($(a).val(),1)});var a=[];if(void 0!==e.get(this.FILTER_SHOP_ALL))for(var i in this.shopsByType)a=a.concat(this.shopsByType[i]);else e.forEach(function(e,i){a=a.concat(t.shopsByType[i])});return a.join(",")}}]),e}(window.FilterBlock),FilterBlockShopWorkTime=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return _inherits(e,t),_createClass(e,[{key:"init",value:function(t){function e(){function t(){o.selectedDay=parseInt(o.$block.find(o.SELECTOR_DAY_FILTER).val()),o.selectedTime=parseInt(o.$block.find(o.SELECTOR_TIME_FILTER).val()),a()}var e=void 0,i=void 0;if(o.selectedDay=o.$block.find(o.SELECTOR_DAY_FILTER).val(),!0===o.workTimeInfo.workTime.hasOwnProperty(o.selectedDay))for(var n in o.workTimeInfo.workTime[o.selectedDay]){var r=o.workTimeInfo.workTime[o.selectedDay][n],d=r.openTime,l=r.closeTime;e||(e=d),i||(i=l),e=Math.min(e,d),i=Math.max(i,l)}if(e||i){e=Math.ceil(e/3600),i=Math.ceil(i/3600);var s=o.$block.find(o.SELECTOR_TIME_FILTER);s.find("option").not("[data-default-state=1]").remove(),s.find("[data-default-state=1]").prop("selected",!0);for(var c=e;c<i;c++){var u=$("<option/>").attr("value",3600*c).html(c+":00");s.append(u)}t(),s.on("change",function(){t()})}}function a(){o.$block.trigger(window.EVENT_FILTER_BLOCK_AFTER_CHANGE)}function i(){e(),o.$block.find(o.SELECTOR_WORKTIME_FILTER).removeClass("disabled"),o.$block.find(o.SELECTOR_DAY_FILTER).on("change",function(){e()})}this.SELECTOR_WORK_STATUS_FILTER="[name=work-status-filter]",this.SELECTOR_WORKTIME_FILTER="[data-role=worktime-filter]",this.SELECTOR_DAY_FILTER="[data-role=day-filter]",this.SELECTOR_TIME_FILTER="[data-role=time-filter]",this.ATTR_WORK_TIME_INFO="data-work-time-info",this.$block=t,this.workTimeInfo=JSON.parse(t.attr(this.ATTR_WORK_TIME_INFO)),this.selectedTime=null,this.selectedDay=null;var o=this;t.find(this.SELECTOR_WORK_STATUS_FILTER).on("change",function(){t.find(o.SELECTOR_WORKTIME_FILTER).addClass("disabled"),"at-time"===$(this).val()&&i(),a()}),e()}},{key:"getSelectedValue",value:function(){var t=this,e=t.$block.find(t.SELECTOR_WORK_STATUS_FILTER).filter(":checked"),a=[],i=a.length;switch(e.val()){case"opened":a=t.workTimeInfo.openedShops;break;case"at-time":if(!0===t.workTimeInfo.workTime.hasOwnProperty(t.selectedDay))for(var o in t.workTimeInfo.workTime[t.selectedDay]){var n=t.workTimeInfo.workTime[t.selectedDay][o];(0===t.selectedTime||t.selectedTime>=n.openTime&&t.selectedTime<n.closeTime)&&(a=a.concat(n.shopGuids))}break;default:for(var r in t.workTimeInfo.workTime)for(var d in t.workTimeInfo.workTime[r])a=a.concat(t.workTimeInfo.workTime[r][d].shopGuids);for(i=a.length,a.sort();i--;)a[i]===a[i-1]&&a.splice(i,1)}return a.join(",")}}]),e}(window.FilterBlock),RemainsFilterBlockShopType=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return _inherits(e,t),_createClass(e,[{key:"init",value:function(t){var a=this;_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this,t),this.$block=t,this.FILTER_SHOP_ALL="all",this.SELECTOR_SELECTOR_HEADER="[data-role=selector-header]",this.ATTR_DATA_ATTR_SHOPS_BY_TYPE="data-shops-by-type",this.SELECTOR_SHOP_TYPE_CHECKBOXES=".shop-type INPUT[type=checkbox]",this.shopsByType=[];var i=this,o=this.$block.find(this.SELECTOR_SHOP_TYPE_CHECKBOXES);this.shopsByType=JSON.parse(this.$block.attr(this.ATTR_DATA_ATTR_SHOPS_BY_TYPE)),this.$block.find(this.SELECTOR_SELECTOR_HEADER).click(function(){a.$block.toggleClass("active")}),this.$block.on("click",".shop-type",function(){var t=$(this).find("INPUT[type=checkbox]");t.prop("checked",!1===t.is(":checked")),t.change()}),this.$block.on("change",this.SELECTOR_SHOP_TYPE_CHECKBOXES,function(t){var e=$(t.target);e.closest(".shop-type").toggleClass("active",e.is(":checked")),!0===e.is(":checked")?a.FILTER_SHOP_ALL===e.val()?o.filter("[value!="+a.FILTER_SHOP_ALL+"]").prop("checked",!1):o.filter("[value="+a.FILTER_SHOP_ALL+"]").prop("checked",!1):a.FILTER_SHOP_ALL===e.val()?o.filter("[value!="+a.FILTER_SHOP_ALL+"]").prop("checked",!0):0===o.filter("INPUT[type=checkbox]:checked").length&&o.filter("[value="+a.FILTER_SHOP_ALL+"]").prop("checked",!0),i.$block.trigger(window.EVENT_FILTER_BLOCK_AFTER_CHANGE)}),
this.$block.on(window.EVENT_FILTER_LIST_AFTER_GET_NEW_VALUES,function(t,e){var i=/(\d+)/;0!==e.length&&(e=e.split(",")),o.each(function(t,o){var n=$(o),r=n.val(),d=n.siblings("LABEL[for="+n.attr("id")+"]"),l=d.text(),s=0;a.FILTER_SHOP_ALL===r?s=e.length:a.shopsByType[r].forEach(function(t){-1!==e.indexOf(t)&&s++}),d.text(l.replace(i,s))})})}},{key:"getSelectedValue",value:function(){var t=this,e=new Map;this.$block.find("INPUT[type=checkbox]:checked").each(function(t,a){e.set($(a).val(),1)});var a=[];if(void 0!==e.get(this.FILTER_SHOP_ALL))for(var i in this.shopsByType)a=a.concat(this.shopsByType[i]);else e.forEach(function(e,i){a=a.concat(t.shopsByType[i])});return a.join(",")}}]),e}(window.FilterBlock);RemainsFilterBlockShopWorkTime.prototype=Object.create(window.FilterBlock.prototype),RemainsFilterBlockShopWorkTime.prototype.constructor=RemainsFilterBlockShopWorkTime,RemainsFilterBlockShopWorkTime.prototype.init=function(t){function e(){v.$block.find(d).click()}function a(){function t(t){w.find("[data-value]").removeClass("selected"),t.addClass("selected"),e(o(t))}function e(t){T.css({left:t}),r()}function a(t){t||(t=0);var e=null,a=null;return w.find("span").each(function(){var i=$(this),n=Math.abs(t-o(i));null===a&&(a=n),a>=n&&(a=n,e=i)}),e}function o(t){var e=w.get(0).getBoundingClientRect().left,a=t.get(0).getBoundingClientRect().left;return parseInt(a-e-5)}function n(){return parseInt(T.css("left"))}function r(){v.selectedDay=v.$block.find(c+" [data-value].selected").data("value"),v.selectedTime=a(n()).data("value"),i()}var d=void 0,l=void 0;if(v.selectedDay=v.$block.find(c+" [data-value].selected").data("value"),!0===v.workTimeInfo.workTime.hasOwnProperty(v.selectedDay))for(var s in v.workTimeInfo.workTime[v.selectedDay]){var h=v.workTimeInfo.workTime[v.selectedDay][s],m=h.openTime,g=h.closeTime;d||(d=m),l||(l=g),d=Math.min(d,m),l=Math.max(l,g)}if(d||l){d=Math.ceil(d/3600),l=Math.ceil(l/3600);var w=v.$block.find(u),b=w.find(f),T=w.find(p),E=l-d;b.html("");for(var y=d;y<l;y++){var k=$("<span/>").attr("data-value",3600*y).html(y+"<i></i>");E%3==2&&y===d&&k.addClass("first"),b.append(k)}t(w.find("[data-default-state=1]")),$(p).draggable({axis:"x",containment:"parent",stop:function(e,i){t(a(i.position.left))}}),e(0),w.find("[data-value] i").on("click",function(){t($(this).closest("[data-value]"))})}}function i(){var t=v.$block.find(r),e=g.find(h),a=v.$block.find(n);t.hide(),e.hide(),w.prev().removeClass("selected"),a.removeClass("selected");var i=v.$block.find(l+" [data-value].selected");v.$block.trigger(window.EVENT_FILTER_BLOCK_AFTER_CHANGE),i.data("default-state")||(t.css("display","inline-block"),e.show(),a.addClass("selected"),w.prev().addClass("selected"))}function o(){a(),v.$block.find(s).removeClass("disabled"),v.$block.find(c+" [data-value]").on("click",function(){$(this).siblings().removeClass("selected"),$(this).addClass("selected"),a()})}var n="[data-role=show-avails-filter]",r="[data-role=clear-avails-filter]",d="[data-default-state]",l="[data-role=work-status-filter]",s="[data-role=worktime-filter]",c="[data-role=day-filter]",u="[data-role=time-filter]",f="[data-role=hours-wrap]",p="[data-role=range-control] i",h=".clear-filter-outer";this.$block=t,this.workTimeInfo=JSON.parse(t.attr("data-work-time-info")),this.selectedTime=null,this.selectedDay=null;var v=this,m=t.find(".filters-wrap"),g=t.closest(".base-modal__container");t.on("click",n,function(){m.fadeIn(200)});var w=g.find(".show-filter-outer");g.on("click",".show-filter-outer",function(){var t=$(this),e=t.offset().top-$(window).scrollTop(),a=t.offset().left-$(window).scrollLeft();t.addClass("opened"),t.prev().addClass("opened"),m.css({top:e+27,left:a-100}).fadeIn(200)}),$("BODY").on("click",function(t){var e=$(t.target);e.closest(".filters-wrap").length||e.is(".filters-wrap")||e.is(n)||e.is(r)||e.is(".show-filter-outer")||(w.removeClass("opened"),w.prev().removeClass("opened"),m.hide())}),m.on("click",".close-btn",function(){m.hide()}),t.on("click",r,function(){e()}),g.on("click",h,function(){e()}),$(window).on("resize",function(){!0===w.prev().hasClass("selected")&&window.checkScreenType(window.SCREEN_MOBILE)&&e()}),t.on("click",l+" [data-value]",function(){var e=$(this);e.siblings().removeClass("selected"),e.addClass("selected"),t.find(s).addClass("disabled"),"at-time"===e.data("value")&&o(),i()}),a(),this.$block.on(window.EVENT_FILTER_LIST_AFTER_GET_NEW_VALUES,function(t,e){var a=v.$block.find(n).find("span"),i=v.getSelectedValue(),o=v.$block.find(l+" [data-value].selected");if(0!==w.length&&(a=w.find("span")),a.html(""),!o.data("default-state")){i=0!==i.length?i.split(","):[],0!==e.length&&(e=e.split(","));var r=0;i.forEach(function(t){-1!==e.indexOf(t)&&r++}),a.html("("+r+")")}})},RemainsFilterBlockShopWorkTime.prototype.getSelectedValue=function(){var t=this,e=t.$block.find("[data-role=work-status-filter] .selected"),a=[],i=a.length;switch(e.data("value")){case"opened":a=t.workTimeInfo.openedShops;break;case"at-time":if(!0===t.workTimeInfo.workTime.hasOwnProperty(t.selectedDay))for(var o in t.workTimeInfo.workTime[t.selectedDay]){var n=t.workTimeInfo.workTime[t.selectedDay][o];(0===t.selectedTime||t.selectedTime>=n.openTime&&t.selectedTime<n.closeTime)&&(a=a.concat(n.shopGuids))}break;default:for(var r in t.workTimeInfo.workTime)for(var d in t.workTimeInfo.workTime[r])a=a.concat(t.workTimeInfo.workTime[r][d].shopGuids);for(i=a.length,a.sort();i--;)a[i]===a[i-1]&&a.splice(i,1)}return a.join(",")},function(t,e,a){function i(a){var i,o=this;this.id=a,this.init=function(){i=e("#"+o.id),i.on(t.EVENT_FILTER_LIST_AFTER_ALL_CHANGE,function(a,i){i.getBlocks().forEach(function(a){var o=[];i.getSelectedFilters().data.forEach(function(t){if(a.id!==t.key)if(0===o.length)o=t.value.split(",");else{var i=[];t.value.split(",").forEach(function(t){-1!==e.inArray(t,o)&&i.push(t)}),o=i}}),a.$block.trigger(t.EVENT_FILTER_LIST_AFTER_GET_NEW_VALUES,o.join(","))})})}}t.EVENT_FILTER_LIST_AFTER_ALL_CHANGE="filter-list:after-all-change",t.EVENT_FILTER_LIST_AFTER_GET_NEW_VALUES="filter-list:after-get-new-values";var o=new Map;t.ShopFilterListHelper=function(t){return!1===o.has(t)&&o.set(t,new i(t)),o.get(t)}}(window,jQuery),function(t,e){e.EVENT_INIT_EXTENDED_FILTER_WIDGET="extendedFilterWidget:init";t.fn.extendedFilterWidget=function(){var a=t(this);if(!a.data("initiated")){a.data("initiated",!0);var i=a.data("filter-list-id"),o=function(){e.FilterList(i).toggleLockState(!0);var t=[];e.FilterList(i).getSelectedFilters().data.forEach(function(e){t.push(e.key+"="+e.value)});var o=a.data("filter-submit-url");0!==t.length&&(o+=(o.indexOf("?")<0?"?":"&")+t.join("&")),e.location.href=o};a.on("click",'[data-role="submit-filters"]',o),a.on("keyup",'input[type="text"]',function(t){KeyboardCodes.ENTER===t.keyCode&&o()})}};var a=function(){t("[data-role=extended-filter-widget]").each(function(){t(this).extendedFilterWidget()})};t(function(){a()}),t(e).on(EVENT_INIT_EXTENDED_FILTER_WIDGET,a)}(jQuery,window),function(t,e){e.EVENT_INIT_LEFT_SIDE_WIDGET="leftSideFilterWidget:init";t.fn.leftSideFilterWidget=function(){var a=t(this);if(!a.data("initiated")){a.data("initiated",!0);var i=a.data("filter-list-id"),o=function(){e.FilterList(i).submitFilters(!1)},n=function(t){t.preventDefault(),e.FilterList(i).resetList(),a.find(".apply-filters-float-btn").remove()},r=function(t){var e=[],i=a.find('[data-role="extended-filters-link"]'),o=i.attr("href");t.data.forEach(function(t){e.push(t.key+"="+t.value)}),o.indexOf("?")>0&&(o=o.split("?")[0]),0!==e.length&&(o+="?"),o+=e.join("&"),i.attr("href",o)};a.on("keyup",'input[type="text"]',function(t){e.KeyboardCodes.ENTER===t.keyCode&&(a.find(".apply-filters-float-btn").remove(),o())}),a.on("change",function(i){if(1===parseInt(a.data("show-float-apply-button"))&&!e.checkScreenType(e.SCREEN_MOBILE,e.SCREEN_TABLET)){var n=a.find('[name="'+a.data("filter-list-form-name")+'"]');n.find(".apply-filters-float-btn").remove();var r=t("<div>").html('Показать<span class="corner"></span>').addClass("apply-filters-float-btn");r.on("click",function(){o(),t(this).remove()}),n.append(r),setTimeout(function(){r.fadeOut(300,function(){t(this).remove()})},3e3);var d=t(i.target);"none"===d.css("display")&&(d=d.parent());var l=d.offset().top-a.offset().top-r.outerHeight()/2;r.css({top:l+"px"})}}),a.on("click",'[data-role="submit-filters"]',o),a.on("click",'[data-role="drop-filters-button"]',n),a.on(e.EVENT_FILTER_LIST_SUBMIT,function(t,e){a.find('[data-role="drop-filters-button"]').toggleClass("hidden",0===e.data.length),0!==a.find('[data-role="extended-filters-link"]').length&&r(e)})}};var a=function(){t("[data-role=left-side-filter]").each(function(){t(this).leftSideFilterWidget()})};t(function(){a()}),t(e).on(e.EVENT_INIT_LEFT_SIDE_WIDGET,a)}(jQuery,window),function(t){function e(){var e="",a=!1,i=function(a,i,o){""!==e&&t.post(e,{result:a,latitude:i,longitude:o})};this.setSaveResultUrl=function(t){return e=t,this},this.init=function(){t(window).on(window.EVENT_GEOLOCATION_INIT,function(){if(!a){var t=window.UserGeolocation.checkPermission(window.GEOLOCATION_PERMISSION_GRANTED)?1:-1,e=void 0,o=void 0;1===t&&(e=window.UserGeolocation.getPosition().coords.latitude,o=window.UserGeolocation.getPosition().coords.longitude,(isNaN(e)||isNaN(o))&&(e=void 0,o=void 0)),i(t,e,o),a=!0}})}}window.GettingLocationLogger=new e}(jQuery),function(document,$,undefined){function parseUploadResponse(iframe){if("about:blank"===iframe.src)return{result:!1,data:"Не удалось загрузить изображение (E0)."};if(undefined===iframe.contentDocument&&(iframe.contentDocument=frames[iframe.id].document),"complete"!==iframe.contentDocument.readyState)return{result:!1,data:"Не удалось загрузить изображение (E1)."};if(undefined===iframe.contentDocument.body)return{result:!1,data:"Не удалось загрузить изображение (E2)."};if(""===iframe.contentDocument.body.innerHTML)return{result:!1,data:"Не удалось загрузить изображение (E3)."};if("false"===iframe.contentDocument.body.innerHTML)return{result:!1,data:"Не удалось загрузить изображение (E4)."};try{var response=iframe.contentDocument.body.getElementsByTagName("pre")[0].innerHTML;return eval("("+response+")")}catch(t){}return{result:!1,data:"Не удалось загрузить изображение (E5)."}}var IMAGETYPE_GIF=1,IMAGETYPE_JPEG=2,IMAGETYPE_PNG=3,IMAGETYPE_BMP=6;$.fn.ajaxImageUpload=function(t){return this.each(function(){function e(){o.find('INPUT[type="file"]').remove(),o.append('<input type="file" />'),n=o.find('INPUT[type="file"]')}function a(){o.addClass("disabled"),undefined===r&&(r=$("<iframe></iframe>"),r.addClass("ajax-image-upload-iframe"),r.attr("id","ajax-image-upload-iframe-"+u),r.attr("src",""),r.attr("name",u),s.append(r),r=$("#ajax-image-upload-iframe-"+u),r.on("load",i)),undefined!==d&&d.remove(),d=$('<form enctype="multipart/form-data"></form>'),d.addClass("ajax-image-upload-form"),d.attr("method","POST"),d.attr("id","ajax-image-upload-form-"+u),d.attr("action",t.uploadUrl),d.attr("target",r.attr("name")),s.append(d),d=$("#ajax-image-upload-form-"+u),d.get(0).appendChild(n.get(0)),d.find('INPUT[type="file"]').attr("name","AjaxImage");var a=$('META[name="csrf-token"]');0!==a.length&&d.append('<input type="hidden" value="'+a.attr("content")+'" name="_csrf">');for(var l in t)if(!1!==t.hasOwnProperty(l))if("object"===_typeof(t[l]))for(var c in t[l])!1!==t[l].hasOwnProperty(c)&&d.append('<input type="hidden" name="options['+l+"]["+c+']" value="'+String(t[l][c]).replace(/["\\']/gim,"")+'" />');else d.append('<input type="hidden" name="options['+l+']" value="'+String(t[l]).replace(/["\\']/gim,"")+'" />');d.submit(),e()}function i(){o.removeClass("disabled");var t=parseUploadResponse(this);!0!==t.result?(undefined!==p&&(p.text(t.data),p.show()),c.val("")):(p.hide(),undefined!==l&&l.text(t.url),undefined!==f&&f.attr("src",t.preview),c.val(t.value))}var o,n,r,d,l,s=$("BODY"),c=$(this),u=c.data("ajax-image-id");undefined!==t.imageUrlContainer&&(l=$(t.imageUrlContainer),0===l.length&&(l=undefined));var f;undefined!==t.previewContainer&&(f=$(t.previewContainer),0===f.length&&(f=undefined));var p;undefined!==t.errorContainer&&(p=$(t.errorContainer),0===p.length&&(p=undefined)),undefined!==p&&p.hide(),function(){var i=[];i.push("btn"),i.push("btn-warning"),i.push("ajax-image-upload-btn"),1===t.block&&i.push("btn-block"),i=i.join(" "),c.wrap('<div class="'+i+'">Загрузить</div>'),o=c.parent(),e(),o.on("change",'INPUT[type="file"]',a)}()})}}(document,jQuery),function(t){window.EVENT_KBT_SERVICE_WIDGET="kbt-service-widget:reinit";var e=void 0,a=function(){e=t("[data-role=related-service-container]"),0!==e.length&&e.on("change","[data-role=service-checkbox]",function(){var a=t(this),i={guid:a.attr("id"),title:a.attr("data-service-title"),price:a.attr("data-service-price"),checked:a.prop("checked"),hasKbtServiceChecked:0!==e.find("[data-is-kbt-service=1]").filter(":checked").length};window.productAdditionsDispatcher.setKbtService(i)})};t(a),window.addEventListener(window.EVENT_KBT_SERVICE_WIDGET,a)}(jQuery),function(t,e){var a;e(function(){if(a=e("#print-order-notify-content"),0!==a.length){var t=a.find("#scheme"),i=t.data("bg-color"),o=t.data("min-x"),n=t.data("min-y"),r=t.data("max-x"),d=t.data("max-y");t.css({width:r-o,height:d-n,"background-color":i,margin:"auto",position:"relative"}),t.find(".clone").each(function(){var t=parseInt(e(this).css("left")),a=parseInt(e(this).css("top"));e(this).css({left:t-o,top:a-n})})}})}(document,jQuery),function(t,e){var a="[data-role=templates-group]",i="[data-role=templates-items-search]",o="[data-role=templates-item-block]",n="[data-role=overflow]",r="empty-result-block",d="clear-search-button",l=void 0,s=window.location.hash,c=new window.XMLHttpRequest;e(function(){function t(t){var a=e("#knowledge-container"),i=e("[data-role=knowledge-breadcrumbs]"),o=e(n);o.removeClass("hidden"),o.addClass("loading"),e("body,html").animate({scrollTop:0},{duration:1e3,easing:"swing"}),c.abort(),c=e.ajax({url:t,dataType:"JSON",success:function(e){o.addClass("hidden"),o.removeClass("loading"),!0===e.result&&(a.html(e.content),i.html(e.breadcrumbs),u.removeClass("shown"),window.history.pushState(null,"",t))}})}if(l=e("#knowledge-page"),0!==l.length){var u=e("#knowledge-templates");e(window).scroll(function(){if(s){var t=e(s),a=t.offset().top-65;t.addClass("flash"),e("body,html").animate({scrollTop:a},{duration:500,easing:"swing",complete:function(){t.addClass("slow-motion"),t.removeClass("flash")}}),s=""}}),l.on("click","[data-role=anchor-link]",function(t){t.preventDefault();var a=e(this).attr("href"),i=e(a).offset().top-65;e("body,html").animate({scrollTop:i},{duration:1e3,easing:"swing"})}),l.on("click","[data-role=show-knowledge-anchors]",function(){e("#knowledge-anchors").addClass("shown"),e(n).removeClass("hidden")}),l.on("click","[data-role=close-knowledge-anchors]",function(){e("#knowledge-anchors").removeClass("shown"),e(n).addClass("hidden")}),l.on("click","[data-role=show-knowledge-templates]",function(){u.addClass("shown"),e(n).removeClass("hidden").addClass("left")}),l.on("click","[data-role=close-knowledge-templates]",function(){var t=e(n);if(t.hasClass("loading"))return!1;u.removeClass("shown"),t.addClass("hidden").removeClass("left")}),l.on("click",n,function(){if(e(this).hasClass("loading"))return!1;e("#knowledge-anchors").removeClass("shown"),u.removeClass("shown"),e(n).addClass("hidden").removeClass("left")}),l.on("click",o+" a",function(){return t(e(this).attr("href")),!1}),l.on("keyup","[data-role=templates-gbl-search]",function(){function t(){n.val(""),u.find(a).removeClass("hidden"),u.find(o).removeClass("hidden"),u.find(i).show(),u.find(".collapse").collapse("hide"),u.find("[data-role="+r+"]").remove(),u.find("[data-role="+d+"]").remove(),u.find("mark").each(function(){e(this).parent().text(e(this).parent().text())})}var n=e(this),l=n.val().toLowerCase();if(0===l.length)return t(),!1;u.find("[data-role="+r+"]").remove(),u.find("[data-role="+d+"]").remove(),u.find(i).hide().val(""),u.find(o+':not(".hidden")').addClass("hidden");var s=String.getSearchStringVariants(l),c=[];for(var f in s)s.hasOwnProperty(f)&&c.push('[data-search-title*="'+s[f]+'"]');var p=e("[data-search-title]").filter(c.join(", "));p.each(function(){var t=e(this),a=t.find("a"),i=a.text().replace(new RegExp("("+s.join("|")+")","gi"),"<mark>$1</mark>");a.html(i),t.removeClass("hidden")});var h=u.find(a);h.removeClass("hidden"),h.each(function(){var t=e(this);0===t.find(o+':not(".hidden")').length&&t.addClass("hidden")}),u.find('.collapse:not(".hidden")').collapse("show");var v=u.find("[data-role="+d+"]");0===v.length&&(v=e("<a/>",{html:"Сбросить поиск",href:"#"}),v.attr("data-role",d),n.after(v),v.on("click",function(){return t(),!1}));var m=u.find("[data-role="+r+"]");0===p.length&&0===m.length&&(m=e("<div/>",{html:"К сожалению, ничего не найдено"}),m.attr("data-role",r),n.after(m))}),l.on("keyup",i,function(a){function i(){s.find("mark").each(function(){e(this).parent().text(e(this).parent().text())}),s.find(o).removeClass("hidden"),s.find("[data-role="+r+"]").remove(),s.find("[data-role="+d+"]").remove(),n.val("")}var n=e(this),l=n.val().toLowerCase(),s=n.parent(),c=s.find(o+':not(".hidden")');if(window.KeyboardCodes.ENTER===a.keyCode&&1===c.length)return t(c.find("a").attr("href")),!1;if(0===l.length)return i(),!1;var u=s.find("[data-role="+d+"]");0===u.length&&(u=e("<a/>",{html:"Сбросить поиск",href:"#"}),u.attr("data-role",d),s.append(u),u.on("click",function(){return i(),!1}));var f=String.getSearchStringVariants(l),p=[];for(var h in f)f.hasOwnProperty(h)&&p.push('[data-search-title*="'+f[h]+'"]');s.find(o).addClass("hidden");var v=s.find("[data-search-title]").filter(p.join(", ")),m=s.find("[data-role="+r+"]");if(0===v.length)return 0===m.length&&(m=e("<div/>",{html:"К сожалению, ничего не найдено"}),m.attr("data-role",r),n.after(m)),!1;m.remove(),v.each(function(){var t=e(this),a=t.find("a"),i=a.text().replace(new RegExp("("+f.join("|")+")","gi"),"<mark>$1</mark>");a.html(i),t.removeClass("hidden")})}),l.on("click","[data-role=all-photos-link]",function(){e(this).closest("div").find(".characteristic-values_with-spoiler").slideDown(700),e(this).toggleClass("hidden")})}})}(document,jQuery),function(t,e,a){function i(t,i,n){a!=t[0]&&e.ajax({url:o,type:"POST",data:{log_guid:t,target_guid:i,target_type:n}})}var o="/to-target-log/";window.AddToLogActivityTarget=i,window.LogActivityGuids=[];var n=void 0;e(function(){n=e('[data-role="search-results"]'),0!==n.length&&(n.on("click","[data-id=product] a",function(){var t=e(this).closest("[data-id=product]"),a=t.find("[data-product-guid]").data("product-guid"),i="product";"show-avails-modal"==e(this).data("role")&&(i="avails"),AddToLogActivityTarget(LogActivityGuids,a,i)}),n.on("click","[data-action=cart-button]",function(){var t=e(this).data("product-guid");AddToLogActivityTarget(LogActivityGuids,t,"order")}),n.on("click","[data-action=notify-button]",function(){var t=e(this).data("id");AddToLogActivityTarget(LogActivityGuids,t,"notify")}),n.on("click","[data-compare-role]",function(){var t=e(this).data("product-guid");AddToLogActivityTarget(LogActivityGuids,t,"compare")}),n.on("click",'[data-role="search-category"]',function(){var t=e(this).data("category-guid");AddToLogActivityTarget(LogActivityGuids,t,"category")}))})}(document,jQuery),function(t,e,a){window.EVENT_CATALOG_LIST_IS_LOADED="catalog:is-loaded";var i=void 0,o=void 0,n=void 0,r=void 0,d=void 0,l=void 0,s={onSuccess:function(t){var a=parseInt(t.data.totalCount),l=parseInt(t.data.lastPageNumber),s=parseInt(t.lastProductIndex);r.toggleClass("hidden",0===a).text(String.countPostfix(a,["товар","товара","товаров"],!1,!1,!1));var u=e(t.data.pickedFilters);if(d.each(function(){var t=u.clone();e(this).html(t),t.pickedFilters()}),0===a&&(n.empty(),o.addClass("hidden"),i.find('[data-role="null-result-container"]').removeClass("hidden")),null!==t.html){var f=e(t.html);void 0===c.offset&&n.empty(),n.append(f)}var p=i.find('[data-role="next-load-block"]');p.data("next-product-index",s),i.data("get-page-count",l),p.toggleClass("hidden",!1===t.isNextLoadAvailable),n.trigger(window.EVENT_INIT_POPOVERS),window.dispatchEvent(new CustomEvent(window.EVENT_PRODUCTS_LOADED)),window.dispatchLazyLoadUpdateEvent(),E(!1)},onFail:function(){}},c={p:void 0,i:void 0,mode:void 0,stock:void 0,order:void 0,groupBy:void 0,shops:void 0,type:void 0,offset:void 0},u=[],f=function(t,e){c.offset=void 0,u=e.data,T()},p=function(){var t=document.location.href.split("?");if(2===t.length){var e=t.pop(),a=String.parseQueryString(e);h(a)}},h=function(t){for(var e in t)!1!==t.hasOwnProperty(e)&&(!0===c.hasOwnProperty(e)?c[e]=t[e]:u.push({key:e,value:t[e]}))},v=function(t){t.preventDefault(),n.data("clear-status",!1);var a=e(this),o=i.data("last-product-index"),r=a.data("next-product-index");c.offset=o>=r?o:r,T()},m=function(t){t.preventDefault();var a=e(this),i=a.closest('[data-role="ordering-dropdown"]'),o=a.data("id"),n=a.text(),r=i.data("ordering-key"),d=i.find(".disabled");o!==c[r]&&(i.find('[data-role="order-type-selected"]').find(".title").text(n),d.each(function(){e(this).removeClass("disabled")}),a.parent().addClass("disabled"),c[r]=o,c.offset=void 0,T())},g=function(){void 0!==l&&l.abort()},w=function(){var t=[];for(var e in c)if(!1!==c.hasOwnProperty(e)&&void 0!==c[e]){var a=c[e];t.push(e+"="+a)}return u.forEach(function(e){t.push(e.key+"="+e.value)}),t},b=function(t){void 0!==window.history&&window.history.pushState({},document.title,"?"+t.join("&"))},T=function(){E(!0),g();var t=w();l=e.get(i.data("update-url")+"?"+t.join("&")),l.then(s.onSuccess,s.onFail),b(t)},E=function(t){!0===t?(e('[data-role="markdown-products-container"]').find("loading-dots").length>0&&e('[data-role="markdown-products-container"]').find("loading-dots").remove(),e('[data-role="markdown-products-container"]').toggleClass("loading-overlay",!0).append('<div class="loading-dots"><span /><span /><span /><span /></div>')):e('[data-role="markdown-products-container"]').toggleClass("loading-overlay",!1).find(".loading-dots").remove()};e(function(){i=e("#page-markdown-products"),0!==i.length&&(d=i.find('[data-role="selected-filters-panel"]'),o=i.find('[data-role="catalog-items-wrapper"]'),n=i.find('[data-role="markdown-products-container"]'),r=i.find('[data-role="markdown-filtered-products-count"]'),p(),i.on("click",['[data-role="select-group-by"]','[data-role="select-sort-by"]'].join(","),m),i.on("click",'[data-role="next-load-block"]',v),i.on(window.EVENT_FILTER_LIST_AFTER_CHANGE,f),i.on(window.EVENT_FILTER_LIST_SUBMIT,f))})}(window,jQuery),FilterBlockMarkdownProductType.prototype=Object.create(FilterBlock.prototype),FilterBlockMarkdownProductType.prototype.constructor=FilterBlockMarkdownProductType,FilterBlockMarkdownProductType.prototype.init=function(t){function e(){var t=r.$block.find(':input[type="checkbox"]:checked'),e=r.$block.find("button .title"),a=r.$block.find(':input[type="checkbox"]').length;1===parseInt(t.length)?e.text(t.closest("div").find("label")[0].innerText):0===parseInt(t.length)||a===t.length?e.text("Все"):e.text(String.countPostfix(t.length,["тип","типа","типов"],"",!1,""))}function a(){if(0<r.$block.find(':input[type="checkbox"]:checked').length)return r.$block.find('[data-role="clear-selected-shops"]').removeClass("hidden"),void r.$block.find("button").addClass(o);r.$block.find('[data-role="clear-selected-shops"]').addClass("hidden"),r.$block.closest("div").find("button").removeClass(o)}FilterBlock.prototype.init.apply(this,[t]);var i=window.SELECTOR_FILTER_LIST_CONTAINER+'[data-id="markdown-filter"][data-side="top"][data-submit-type="button"]',o="types-select",n=document.querySelector(i);if(null!==n&&"true"!==n.getAttribute("type")){n.setAttribute("type",!0);var r=this,d=n.querySelector('[data-role="clear-selected-type"]'),l=n.querySelector("[role=menu]"),s=n.querySelectorAll('[data-toggle="dropdown"]'),c=document.getElementsByTagName("body");r.$block.on("change",'input:not([data-role="filter-items-search"]), select',function(){e(),a()});var u=!0,f=!1,p=void 0;try{for(var h,v=s[Symbol.iterator]();!(u=(h=v.next()).done);u=!0){h.value.addEventListener("click",function(){r.$block.hasClass("open")?c[0].classList.add("lock"):c[0].classList.remove("lock")})}}catch(t){f=!0,p=t}finally{try{!u&&v.return&&v.return()}finally{if(f)throw p}}r.$block.on(window.EVENT_FILTER_BLOCK_REESET,function(){a(),e()}),l.addEventListener("click",function(t){t.stopPropagation()}),d.addEventListener("click",function(){r.reset(),r.$block.trigger(window.EVENT_FILTER_BLOCK_AFTER_CHANGE),r.$block.change(),r.$block.closest("div").find("button").removeClass(o),a(),e()})}},FilterBlockMarkdownProductType.prototype.getSelectedValue=function(){var t=[];return this.$block.find(':input[type="checkbox"]:checked').each(function(){t.push($(this).data("id"))}),0!==t.length?t.join(","):void 0},FilterBlockMarkdownProductType.prototype.reset=function(){this.$block.find('[type="checkbox"]').prop("checked",!1),this.$block.trigger(window.EVENT_FILTER_BLOCK_REESET)},FilterBlockMarkdownShops.prototype=Object.create(FilterBlockSelectShops.prototype),FilterBlockMarkdownShops.prototype.constructor=FilterBlockMarkdownShops,FilterBlockMarkdownShops.prototype.getContainerSelector=function(){return window.SELECTOR_FILTER_LIST_CONTAINER+'[data-id="markdown-filter"][data-side="top"][data-submit-type="button"]'},function(t){var e="#item-tabs-block";t.fn.markdownProductPage=function(){function a(){i(),t(window).on(EVENT_CHANGE_SCREEN_TYPE,i)}function i(){!0===window.checkScreenType(window.SCREEN_MOBILE)?t(e).responsiveTabs("activate",0):t(e).responsiveTabs("activate",1)}a.apply(this,arguments)}}(jQuery),function(t,e,a,i){"use strict";function o(){var t=[];for(var a in K)if(K.hasOwnProperty(a)){var i=K[a];if(i.prev===i.last)continue;t.push({productId:a,count:i?i.last:0,productGroupId:i.productGroupId,productTypeId:i.productTypeId})}return e.extend([],t,!0)}var n=1,r=2;a.EVENT_REMOVE_FROM_CART="cart:remove-item",a.EVENT_UPDATE_CART_ITEM="cart:update-item",a.EVENT_ITEM_REMOVED_FROM_CART="cart:item-removed";var d=3,l="[data-role=mixed-types-products-count]",s="[data-role=mixed-types-products-list]",c="[data-role=mixed-types-benefit-info]",u="[data-role=mixed-types-text-info]",f="[data-role=show-all-mixed-type-products]",p="[data-role=discount-logistic-block]",h="[data-role=cart-tab]",v="[data-role=cart-tab-control]",m="[data-role=cart-tab-control-mobile]",g="[data-role=cart-tab-controls-mobile]",w="[data-role=restore-last-removed-product]",b='[data-role="submit-order"]',T='[data-role="submit-mixed-order"]',E='.btn-plus:not([data-force-disabled="1"])',y="[data-role=product-remains-block]",k="[data-id=checkout-group]",C="[data-id=checkout-group-item]",_=".price-total-amount",I="[data-role=total-remains-block]",S="[data-role=one-click]",O="[name=count]",N="<p><b>Максимально доступное количество товара!</b><br>К сожалению, данный товар доступен только в количестве %c %w.</p>",x="<p><b>К сожалению, данный товар недоступен!</b></p>",L="product-type-id",R="max",A="checkout-group",D="cart-id",P="cart-group-id",F="cart-product-id";a.SELECTOR_CART_PRODUCT="[data-"+F+"]",a.SELECTOR_CART_PRODUCT_ID=F;var B=3,$="[data-of=rsu-product-count]",j="[data-of=rsu-no-avails]",V="#bp-products-links-form",M=".bp-product-name",U=".bp-errors",H="add",W="remove",G=999,q=G.toString().length,K={},Q={},Y=void 0,z=void 0,J=!1;a.SELECTOR_CHECKOUT_GROUP=k,a.SELECTOR_CHECKOUT_GROUP_ITEM=C,e(function(){function X(e){var i=t.createEvent("CustomEvent");i.initCustomEvent(a.EVENT_CART_BUTTON_APPLY_MAIN_BTN_COUNT,!1,!0,e),a.dispatchEvent(i)}function Z(t){var e=t.data(R),a=Tt.find(C+"[data-"+F+"="+t.data(F)+"]"),i=a.find(".warning-block");i.html(String.countPostfix(e,["штука","штуки","штук"],x,!1,N)),i.addClass("visible")}function tt(t){Tt.find(C+"[data-"+F+"="+t.data(F)+"]").find(".warning-block").removeClass("visible")}function et(t){Z(t)}function at(t){tt(t)}function it(t){t?(Ot.prop("disabled",!t),Nt.each(function(){!t===e(this).data("disabled")&&e(this).prop("disabled",!t)}),It.prop("disabled",!1),z.prop("disabled",!1)):(St.prop("disabled",!t),It.prop("disabled",!t),z.prop("disabled",!t))}function ot(t,o){var n=t.find(_);n.applySingleSets({"prev-price-total":0,"price-total":a.numberFormat(o.groupPrice,0,"."," "),"total-bonus":" "+a.numberFormat(o.groupBonus,0,"."," "),"bonus-visible":o.groupBonus>0});var r=0!==o.groupPrice;n.find(".group-total-price-container").toggleClass("hidden",!1===r).end().find(".empty-remains-message").toggleClass("hidden",r).end().find(b).prop("disabled",!1===r),e('[data-products-count-for="'+o.groupType+'"]').each(function(){var t=e(this);t.data("value",t.data("value")+o.groupProductsCount).text("("+t.data("value")+")").toggleClass("hidden",0===t.data("value"))});for(var d in o.products)if(0===t.find(C+"[data-"+F+"="+d+"]").length)return a.location.reload();t.find(C).each(function(){var t=e(this),a=t.data(F);if(i!==o.products[a]){var n=o.products[a];0===n.count&&!0===n.isAvailable&&B!==n.type?ut(t,a,-1!==e.inArray(a,o.restorableProducts)):ct(t,n)}else ut(t,a,-1!==e.inArray(a,o.restorableProducts))}),t.find(p).html(o.discountWidget),t.find(I).html(o.remainsWidget),nt(t,o.oneClickCheckoutWidget),lt()}function nt(i,o){i.find("[data-role=one-click-checkout-container]").html(o),rt(),e(t).trigger(a.EVENT_INIT_POPOVERS)}function rt(){Tt.on("click",S,function(){var i=e(this);a.dispatchEvent(new CustomEvent(a.EVENT_ONE_CLICK_BUTTON_PUSH,{detail:{target:i}})),new Promise(function(t){var a=bt.find(V);0!==a.length||0!==e(M).not('[data-cart-product-guid=""]').length?e.ajax({type:"POST",url:a.attr("action"),dataType:"json",data:a.serializeArray(),success:function(t){e(U).empty(),!1===t.result&&e(U).text(t.errors[0])},error:function(){alert("Ошибка: ссылки на товары конкурентов не были добавлены.")},complete:function(){t()}}):t()}).then(function(){if(!0!==J&&!i.attr("disabled")){var e={cartId:i.data(D),cartGroupId:i.data(P),isInCart:!0},o=t.createElement("div");t.body.appendChild(o),J=!0,a.startOneClickOrder(e,o,function(e){t.body.removeChild(o),J=!1,!0===e&&i.parent().remove()})}})})}function dt(t){t.find(C).filter(":not(.hidden)").each(function(){ut(e(this),e(this).data(F),!0)}),t.addClass("hidden"),nt(t,""),lt()}function lt(){e(h).each(function(){var t=e(this);t.find(".tab-message").toggleClass("hidden",st(t)).end().find("[data-role=empty-tab-message]").toggleClass("hidden",!st(t))})}function st(t){var e=t.find(k);return e.length===e.filter(".hidden").length}function ct(t,i){t.removeClass("hidden"),t.closest(k).removeClass("hidden"),t.attr("data-"+L,i.type),K[t.data(F)]?(K[t.data(F)].productTypeId=i.type,K[t.data(F)].prev=i.isAvailable?i.count:0,K[t.data(F)].last=i.isAvailable?i.count:1):K[t.data(F)]={default:i.count,prev:i.count,last:i.count,productGroupId:t.closest(k).data("checkout-group"),productTypeId:i.type},lt(),e(a).trigger(a.EVENT_UPDATE_CART_ITEM,[t]),B===i.type&&(0<i.maxCount?(t.find(j).addClass("hidden"),t.find($).removeClass("hidden")):(t.find($).addClass("hidden"),t.find(j).removeClass("hidden")));var o=t.find(E);o.data(R,i.maxCount),o.data("disabled",i.maxCount<=i.count),t.applySingleSets({"prev-price-total":0,"price-total":a.numberFormat(i.price,0,"."," "),"total-bonus":" "+a.numberFormat(i.bonus,0,"."," "),"bonus-visible":i.bonus>0});var n=i.isAvailable?i.count:0,r=i.isAvailable?i.count:1;t.find(O).attr("data-count",r).val(n),t.find(y).html(i.remainsWidget)}function ut(t,i,o){if(t.addClass("hidden"),K.hasOwnProperty(i)){var n=t.closest(h).data("id");delete K[i],o&&(Q[n].push(i),t.closest(h).find(w).removeClass("hidden"))}e(a).trigger(a.EVENT_ITEM_REMOVED_FROM_CART,t.attr("data-"+a.SELECTOR_CART_PRODUCT_ID))}function ft(t){var i=o();if(i.length)return it(!1),e.ajax({type:"POST",url:Et,dataType:"json",data:{updates:i},success:function(e){pt(t,e)},error:function(){return a.location.reload()}})}function pt(t,o){var n=t.closest(C);if(!0===o.result){X(o.data),
e("[data-products-count-for]").data("value",0).addClass("hidden");for(var r in o.data.groups)if(0===bt.find(k+"[data-"+A+"="+r+"]").length)return a.location.reload();if(e(k).each(function(){var t=e(this),a=t.data(A);i!==o.data.groups&&o.data.groups.hasOwnProperty(a)&&!1===o.data.groups[a].isEmptyGroup?ot(t,o.data.groups[a]):dt(t)}),it(!0),i!==o.data.isOverLimit){var d=n.find(E);(parseInt(n.find(O).val())||0)>=d.data(R)&&(et(d),setTimeout(function(){at(d)},3e3))}}else alert(o.message)}function ht(t,e){var a=t.closest(C).data(F),i=+e||+t.val(),o=K[a];return o.last===i||(o.prev=o.last,o.last=i,o.last!==o.default)}function vt(t,e){var i=e>0?H:W;t.closest(C).trigger(a.EVENT_UPDATE_CART,i)}function mt(t){a.toggleLoaderVisibility(!0),e.ajax({type:"POST",url:t,dataType:"json",success:function(t){if(!0===t.result){var i=t.data;if(!0===i.isAvailable)return void(a.location.href=i.checkoutUrl);a.toggleLoaderVisibility(!1),_t.modal("show");var o=_t.find(l),p=_t.find(u),h=_t.find(c),v=_t.find(s),m=Object.keys(i.unavailableProducts);!0===i.isInternetPriceAvailable?(n===i.benefitType?(h.html("Доп. скидка "+i.benefitAmount+' <b><i class="dns-icon_rub"></i></b>'),h.removeClass("hidden")):r===i.benefitType?(h.html("Доп. бонусы "+i.benefitAmount),h.removeClass("hidden")):h.addClass("hidden"),o.text("В корзине "+m.length+" "+String.countPostfix(m.length,["товар","товара","товаров"])+", при заказе которых недоступно получение дополнительной скидки (дополнительных бонусов):"),p.text("Вы можете оформить отдельный заказ на эти товары или оформить все товары в одном заказе, но без получения дополнительной скидки или бонусов.")):(h.removeClass("hidden"),o.text("В корзине "+m.length+" "+String.countPostfix(m.length,["товар","товара","товаров"])+", при заказе которых недоступно получение со склада (в нераспакованном виде):"),p.text("Вы можете оформить отдельный заказ на эти товары или оформить все товары в одном заказе, но без получения со склада (в нераспакованном виде)."),h.text("Со склада")),v.empty(),m.forEach(function(t){var a=e("<li />");a.html(i.unavailableProducts[t].title+" - <b>"+i.unavailableProducts[t].price+'</b> <i class="dns-icon_rub"></i> ('+i.unavailableProducts[t].count+" шт.)"),v.append(a)}),d<i.unavailableProducts.length&&(_t.find(f).removeClass("hide"),_t.on("click",f,function(){_t.find("li").removeClass("hide"),_t.find(f).addClass("hide")})),_t.on("click","[data-role=hide-modal]",function(){_t.find(".modal-dialog").removeClass("shown"),setTimeout(function(){_t.modal("hide")},200)}),_t.find(T).on("click",function(){a.location.href=e(this).attr("data-order-url")})}else a.toggleLoaderVisibility(!1),alert(t.errors[0])},error:function(){a.toggleLoaderVisibility(!1),alert("Ошибка: сервис временно недоступен")}})}function gt(o){var n=xt.find("[data-id="+o+"]");e(m,xt).toggleClass("disabled",!1),n.closest(m).toggleClass("disabled",!0),e("[data-role=toggle-button] [data-role=title]",xt).html(n.html());var r=e(v+"[data-id="+o+"]");r.siblings().removeClass("active"),r.addClass("active");var d=e(h);d.removeClass("active");var l=d.filter("[data-id="+o+"]");l.addClass("active");for(var s in Q)Q.hasOwnProperty(s)&&(Q[s]=[],l.find(w).addClass("hidden"));var c=d.length;d.each(function(){var t=e(this),a=t.data("id");st(t)&&(bt.find(v+"[data-id="+a+"]").remove(),bt.find(g+"[data-id="+a+"]").remove(),t.remove(),--c)});var u=e(".carts-count",bt);if(1>=c)u.parent().addClass("hidden");else if(1<c){var f=c+" "+String.countPostfix(c,["корзина","корзины","корзин"]);u.text(f),u.parent().removeClass("hidden")}i!==a.history&&a.history.pushState({},t.title,"?activeTabId="+o)}var wt=this,bt=e("[data-role=cart-page]"),Tt=e(k),Et=bt.data("url-update"),yt=bt.data("url-refresh"),kt=bt.data("url-restore"),Ct=e(S),_t=e('[data-role="order-mixed-type-modal"]');if(0!==bt.length){e(C,bt).each(function(){var t=e(this),a=t.data(F),i=+t.find(O).attr("data-count"),o=t.closest(k).data(A),n=t.data(L);K[a]={default:i,prev:i,last:i,productGroupId:o,productTypeId:n},Q[t.closest(h).data("id")]=[]});var It=Tt.find("[data-id=remove-from-cart]"),St=Tt.find("[data-quantity]"),Ot=Tt.find('.btn-minus:not([data-force-disabled="1"])'),Nt=Tt.find(E);e(t).on(a.EVENT_UPDATE_CART,a.SELECTOR_CART_BUTTON,function(){"go_to_cart"===e(this).getState()&&a.location.reload()}),e(E).parent().mouseover(function(){!0===e(this).find(E).data("disabled")&&et(e(this).find(E))}),e(E).parent().mouseout(function(){at(e(this).find(E))}),It.on("click",function(){var t=e(this);t.attr("disabled")||(ht(t),t.trigger(a.EVENT_REMOVE_FROM_CART),ft(t))}),St.on("click",function(){var t=e(this),a=parseInt(t.closest(C).find(O).val())||0,i=parseInt(t.data("quantity"))||0;ht(t,a+i),a+i<=0&&vt(t,i);var o=ft(t);o&&o.done(vt(t,i))}),e(w,bt).on("click",function(){if(!e(this).attr("disabled")){var t=e(this).closest(h),i=t.find(w);i.attr("disabled","disabled");var o=t.data("id");if(Q[o].length){var n=Q[o].pop();it(!1);var r=Tt.find(C).filter("[data-"+F+'="'+n+'"]').find("[data-id=remove-from-cart]");e.ajax({type:"POST",url:kt,dataType:"json",data:{productId:n,tabId:o},success:function(t){pt(r,t)},error:function(){return a.location.reload()}}).then(function(){Q[o].length||i.addClass("hidden"),i.removeAttr("disabled")})}}}),e("[data-role=remove-optional]",bt).on("click",function(){var t=e(this);if(!t.attr("disabled")){t.attr("disabled","disabled"),it(!1);var i=t.closest(C).find("[data-id=remove-from-cart]");e.ajax({type:"POST",url:t.data("url"),dataType:"json",success:function(t){if(!0!==t.result)return a.location.reload();pt(i,t)},error:function(){return a.location.reload()}}).then(function(){t.closest("[data-role=optional-product]").remove()})}}),Tt.find(O).on("keydown",function(t){var a=e(this),i=t.keyCode,o=a.val(),n=+o,r=i>=96&&i<=105,d=i>=48&&i<=57||r,l=r?i-96:i-48,s=t.ctrlKey||t.shiftKey,c=null;if(d&&(c=10*n+l,this.selectionStart!==this.selectionEnd)){c=+(o.substr(0,Math.min(this.selectionStart,this.selectionEnd))+l+o.substr(Math.max(this.selectionStart,this.selectionEnd)))}if(!(d&&!isNaN(c)&&c.toString().length<=q&&c<=G||/\W/.test(String.fromCharCode(i))||s))return t.preventDefault(),!1;a.data("prev-val",o)}).on("keyup blur",function(t){var i=e(this);if(!i.attr("readonly")){var o=i.val(),n=i.data("prev-val"),r=o?+o:null,d=null;if(isNaN(r)&&(d=n),(r<0||r>G||o.length>q)&&(r=r<0?1:G),d&&(i.val(d),o=d,r=+o),0===r||13===t.keyCode){clearTimeout(Y),ht(i,r);var l=ft(i);return void(l&&l.done(function(){e(a).trigger(a.EVENT_REMOVE_FROM_CART)}))}var s=0===r&&(46===t.keyCode||8===t.keyCode);if(!(isNaN(r)||!o.length||s||o===n&&null===d)){if(!1===ht(i))return!1;var c=[];for(var u in K)K.hasOwnProperty(u)&&K[u].default!==K[u].last&&c.push({productId:u,type:K[u].last>K[u].default?H:W});clearTimeout(Y),Y=setTimeout(function(){clearTimeout(Y);var t=ft(i);t&&t.done(function(){for(var t=0,e=c.length;t<e;++t){var i=c[t];Tt.find(C+"[data-"+F+'="'+i.productId+'"]').trigger(a.EVENT_UPDATE_CART,Tt.closest(h).data("id"))}})},1e3)}}}),e(b).on("click",function(){var t=e(this),a=t.closest(k),i=a.find(".product.disabled").not(".hidden"),o=parseInt(t.attr("data-kiosk-mode")),n=a.find(".product").not(".hidden").filter(function(){return 0<e(this).find("[data-role=soft-avails-label]").length});if(0===i.length&&(1!==o||0===n.length)){var r=bt.find(V);return 0===r.length||0===e(M).not('[data-cart-product-guid=""]').length?(mt(t.attr("data-order-url")),!1):(e.ajax({type:"POST",url:r.attr("action"),dataType:"json",data:r.serializeArray(),success:function(t){if(e(U).empty(),!1===t.result)return e(U).text(t.errors[0]),!1},error:function(){alert("Ошибка: ссылки на товары конкурентов не были добавлены.")},complete:function(){mt(t.attr("data-order-url"))}}),!1)}var l=a.find('[data-role="order-partition-message-modal"]'),s=a.find('[data-role="order-soft-avails-products-modal"]'),c=l.find(".modal-body").html(""),u=void 0;if(i.each(function(){var t=e(this),a=t.find(".item-name > a").attr("href"),i=t.find(".image img").clone();u=e("<a />").attr("href",a).addClass("no-available-product").append(e("<div />").addClass("image").append(i)).append(e("<div />").addClass("description").append(e("<span />").text(t.find(".item-name > a").text())).append(e("<span />").text(t.find(".item-id").text()))).append(e("<hr/>")),c.append(u)}),0===i.length){var f=s.find("[data-role=soft-avails-products-count]"),p=s.find("[data-role=soft-avails-products-list]"),h=s.find("[data-role=max-soft-avails-date]"),v=0,m=1;return f.text(n.length+" "+String.countPostfix(n.length,["товар","товара","товаров"])),p.empty(),n.each(function(){var t=e(this),a=t.find(".item-name > a").text(),i=t.find("[data-role=soft-avails-label] > a").text(),o=t.find("[data-role=soft-avails-label]").attr("data-avails-date");u=e("<li />"),d<m&&u.addClass("hide"),u.html(a+" — <b>"+i+"</b>"),0===v&&(v=o,h.text(i)),Date.parse(v)<Date.parse(o)&&(v=o,h.text(i)),p.append(u),m++}),0===parseInt(v)&&h.text("в другом магазине"),s.modal("show"),s.on("click","[data-role=hide-modal]",function(){s.find(".modal-dialog").removeClass("shown"),setTimeout(function(){s.modal("hide")},200)}),void(d<n.length&&(s.find("[data-role=show-all-soft-products]").removeClass("hide"),s.on("click","[data-role=show-all-soft-products]",function(){p.find("li").removeClass("hide"),s.find("[data-role=show-all-soft-products]").addClass("hide")})))}l.modal("show"),l.on("click","[data-role=hide-modal]",function(){l.find(".modal-dialog").removeClass("shown"),setTimeout(function(){l.modal("hide")},200)})}),e('[data-role="product-change"]').on("click",function(){var t=e(this);t.attr("disabled")||(ht(t),t.trigger(a.EVENT_REMOVE_FROM_CART),ft(t).done(function(){a.location.href=t.attr("data-category-url")}))}),bt.on("click",function(){bt.find(".count-changed-message").fadeOut(700)});var xt=e(g+" [data-role=dropdown-list]",bt);e(v,bt).on("click",function(){if(!e(this).is(".active"))return gt(e(this).data("id")),!1}),e(m,xt).on("click",function(){if(!e(this).is(".disabled"))return e("[data-role=toggle-button]",xt).dropdown("toggle"),gt(e(this).data("id")),!1}),z=e("INPUT[type=radio][data-role=additional-warranty]",bt),z.change(function(t){it(!1),z.prop("disabled",!0);var i=t.target.value,o=e(t.target),n=o.closest(a.SELECTOR_CART_PRODUCT),r=n.closest(k).data("checkout-group"),d=n.data(F);e.ajax({type:"POST",url:bt.attr("data-url-change-additional-warranty-period"),dataType:"json",data:{productId:d,productGroupId:r,years:i},success:function(t){!0===t.result?pt(e(wt),t):alert(t.errors[0]);var a=n.find("INPUT[type=radio][data-role=additional-warranty]");a.prop("checked",!1),a.filter(function(){return i===e(this).val()}).prop("checked",!0)},error:function(){alert("Ошибка обработки данных")},complete:function(){z.prop("disabled",!1),it(!0)}})}),bt.on("change","[data-role=service-checkbox]",function(){it(!1);var t=e(this),i=t.closest(a.SELECTOR_CART_PRODUCT),o=i.closest(k).data("checkout-group"),n=i.data(F),r=t.attr("data-service-id");e.ajax({type:"POST",url:bt.attr("data-url-change-related-services"),dataType:"json",data:{productId:n,productGroupId:o,serviceId:r,serviceNeedAdd:t.prop("checked")?1:0},success:function(e){!0===e.result?(pt(t,e),i.find("[data-role=toggle-select][data-service-guid="+r+"]").toggleClass("selected"),bt.find("[data-param=kbt-service-checkbox]").filter(":checked").length?Ct.hide():Ct.show()):alert(e.errors[0])},error:function(){alert("Ошибка обработки данных")},complete:function(){it(!0)}})}),bt.on("click",".kbt-show-more",function(){var t=e(this);t.toggleClass("opened"),t.parent().find(".spoiler-in").toggleClass("hidden")}),bt.on("click",".kbt-link",function(){e(this).next().addClass("shown")}),bt.on("click",".kbt-hide-block",function(){e(this).parent().removeClass("shown")}),bt.on("click","[data-role=toggle-select]",function(){var t=e(this),a=t.data("service-guid");t.closest(".related-services-checkout-widget").find("[data-role=service-checkbox][data-service-id="+a+"]").click()}),rt(),bt.find("[data-param=kbt-service-checkbox]").filter(":checked").length&&Ct.hide(),a.refreshCheckout=function(){return e.ajax({type:"POST",url:yt,dataType:"json",success:function(t){e("[data-products-count-for]").data("value",0).addClass("hidden");for(var o in t.data.groups)if(0===bt.find(k+"[data-"+A+"="+o+"]").length)return a.location.reload();e(k).each(function(){var a=e(this),o=a.data(A);i!==t.data.groups&&t.data.groups.hasOwnProperty(o)&&!1===t.data.groups[o].isEmptyGroup?ot(a,t.data.groups[o]):dt(a)})},error:function(){return a.location.reload()}})}}})}(document,jQuery,window),function(t,e){function a(t){function a(){var t=!0;return 0!==d.length&&d.prop("checked")&&(n.find('[data-role="birth-day"]').val()&&n.find('[data-role="birth-month"]').val()&&n.find('[data-role="birth-year"]').val()?n.find('[data-role="sex-id"]').val()||(OrderCheckout.showErrors(["Необходимо заполнить «Пол»."],o),t=!1):(OrderCheckout.showErrors(["Дата рождения указана неверно."],o),t=!1)),t}o=e(t),n=o.closest("FORM");var d=o.find("#is-prozapass-agree");d.change(function(){i(d.prop("checked"));var t=o.find('[data-role="prozapass-registration"]');t.toggleClass("block-inactive",!1===d.prop("checked")),t.find("INPUT, SELECT").prop("disabled",!1===d.prop("checked"))}),CheckoutContractor.onSelectContractorType(CheckoutContractor.getContractorTypeId(o),function(){r=!1,CheckoutContractor.enableButtonNext(),0===d.length?i(!0):(d.prop("checked",!0),d.change())}),n.submit(function(){return CheckoutContractor.getCurrentContractorTypeId()!==CheckoutContractor.getContractorTypeId(o)||(!1===a()?(OrderCheckout.stopLoading(),!1):!0===r||(e.ajax({type:"POST",url:"/order/ajax/?step="+OrderCheckout.getStepNumber(),dataType:"json",data:n.serializeArray(),success:function(t){if(0!==t.errors.length)return OrderCheckout.showErrors(t.errors,o),void OrderCheckout.stopLoading();if(!0===t.data)return r=!0,void n.submit();OrderCheckout.stopLoading();var a=e("#contractor-phone-confirm-modal");0!==a.length&&a.remove(),e("BODY").append(t.html),a=e("#contractor-phone-confirm-modal"),a.modal(),a.SmsConfirm({callback:function(t){a.modal("hide"),!0===t&&(r=!0,OrderCheckout.startLoading(),n.submit())}})},error:function(){OrderCheckout.stopLoading(),OrderCheckout.showErrors(["Сервис временно недоступен. Повторите попытку позже или обратитесь в техническую поддержку."],o)}}),!1))})}function i(t){!0===t?e(".total-info-widget").trigger("order.total_info_widget.showBonus"):e(".total-info-widget").trigger("order.total_info_widget.hideBonus")}var o,n,r=!1;e(function(){CheckoutContractor.initIndividualEntity=a})}(document,jQuery),function(t,e){function a(t){console.log(t),i=e(t),o=i.closest("FORM"),CheckoutContractor.onSelectContractorType(CheckoutContractor.getContractorTypeId(i),function(){l=!1,0===e(n).length&&CheckoutContractor.disableButtonNext()}),i.on("change",n,function(){var t=e(n+":checked");o.find('[data-role="contractor_appeal"]').val(t.data("legal-appeal")),o.find('[data-role="contractor_phone"]').val(t.data("legal-phone")),o.find('[data-role="contractor_email"]').val(t.data("legal-email")),e(r).show()}),o.submit(function(){return CheckoutContractor.getCurrentContractorTypeId()!==CheckoutContractor.getContractorTypeId(i)||(!0===l||(e.ajax({type:"POST",url:"/order/ajax/?step="+OrderCheckout.getStepNumber(),dataType:"json",data:o.serializeArray(),success:function(t){if(0!==t.errors.length)return OrderCheckout.showErrors(t.errors,i),void OrderCheckout.stopLoading();!0===t.data&&(l=!0,o.submit()),OrderCheckout.stopLoading();var a=e(d);0!==a.length&&a.remove(),e("BODY").append(t.html),a=e(d),a.modal(),a.SmsConfirm({callback:function(t){a.modal("hide"),!0===t&&(l=!0,OrderCheckout.startLoading(),o.submit())}})},error:function(){OrderCheckout.stopLoading(),OrderCheckout.showErrors(["Сервис временно недоступен. Повторите попытку позже или обратитесь в техническую поддержку."],i)}}),!1))})}var i,o,n='[data-role="change-legal-contractor"]',r="[data-role=legal-contractor-contact]",d="#contractor-phone-confirm-modal",l=!1;e(function(){CheckoutContractor.initLegalEntity=a})}(document,jQuery),function(t,e,a){function i(t){s=e(t),c=s.closest("FORM"),f=e(p),s.change(function(){var t=e(this);u=t.val(),c.find('[data-contractor-section-id]:not([data-contractor-section-id="'+u+'"])').hide(),c.find('[data-contractor-section-id="'+u+'"]').show(),e(".total-info-widget").trigger("order.total_info_widget.hideBonus"),OrderCheckout.clearErrors(),a!==h[u]&&h[u]()}),setTimeout(function(){s.filter(":checked").change()},500),c.find("[data-contractor-section-id]").hide()}function o(t){return t.closest("[data-contractor-section-id]").data("contractor-section-id")}function n(t,e){h[t]=e}function r(){return u}function d(){f.prop("disabled",!1)}function l(){f.prop("disabled",!0)}var s,c,u,f,p='[data-role="button-next"]',h={};window.CheckoutContractor={init:i,onSelectContractorType:n,getContractorTypeId:o,getCurrentContractorTypeId:r,enableButtonNext:d,disableButtonNext:l}}(document,jQuery),function(t){var e,a,i,o,n,r,d,l,s,c,u,f,p,h,v,m,g,w,b="[data-id=city_guid]",T="[data-id=region_city_fias_guid]",E="[data-id=order_city_select]",y=".extended-field-city",k="[data-id=street]",C="[data-id=order_house_number]",_="[data-id=order_flat]",I="[data-id=order_is_rise_on_floor]",S="[data-id=order_floor]",O="[data-id=order_is_have_lift]",N="[data-id=street_fias_guid]",x='[data-role="calculate"]',L="[data-role=elaboration-box]",R="[data-role=elaboration-streets-list]",A="[data-role=under-street-message]",D="empty",P="load-dates-url",F=!1,B=[],$=0;t.fn.OrderCheckoutDeliveryCourier=function(){function j(){e=t(this),a=e.closest("form"),i=t(b,e),o=t(T,e),n=t(E,e),r=t(y,e),d=t(k,e),s=t(N,e),v=t(x,e),c=t(C,e),u=t(_,e),f=t(I,e),p=t(S,e),h=t(O,e),m=t(L,e),w=e.data(P),d.keyup(function(){s.val(""),window.CheckoutDelivery.Dateline.clear()}),l=d.autocomplete({source:function(t,e){V(t.term,function(t){F=0===t.length;var a=[];t.forEach(function(t){var e={id:t.guid,label:J(t),parent_guid:t.parent_guid};a.push(e)}),!1===g&&a.push({id:D,label:d.val(),parent_guid:""}),e(a)})},select:function(t,e){if(D===e.item.id)return d.val(""),s.val(""),window.CheckoutDelivery.Dateline.clear(),M(!0),!1;var a=e.item;o.val(a.parent_guid),s.val(a.id)}}),l.autocomplete("widget").addClass("order-delivery-street-autocomplete"),l.on("blur",function(){if(""===d.val())return void H();""===s.val()?(window.CheckoutDelivery.Dateline.clear(),V(t(this).val(),function(e){var a=null;if(e.length>0)if(1===e.length){var i=e[0];o.val(i.parent_guid),s.val(i.guid),d.val(J(i)),H(),Y(),W()}else Q(e);else if(Y(),!1===g)if(window.OrderCheckout.isTerminal())a=t('<div/>"',{class:"alert alert-danger"}).text("К сожалению, с таким названием улиц не найдено. Проверьте правильность написания улицы. Если улица введена верно, то обратитесь к консультанту или управляющему."),U(a);else{var n=t("<a/>",{href:"javascript:;",text:"заполните расширенную форму"});n.click(function(){return d.val(""),M(!0),H(),Y(),!1}),a=t('<div/>"',{class:"alert alert-danger"}).text("К сожалению, с таким названием улиц не найдено. Проверьте правильность написания улицы. Если улица введена верно, то ").append(n),U(a)}else K(window.OrderCheckout.isTerminal()?["Для уточнения возможности и стоимости доставки, пожалуйста, обратитесь к консультанту или управляющему"]:["Для уточнения возможности и стоимости доставки с вами свяжется оператор"])})):(H(),Y(),W())}).on("focus",function(){""===s.val()&&t(this).autocomplete("search",t(this).val())});var R=t('<small><a href="javascript:;" class="text-info bg-warning">Нет вашей улицы - заполните расширенную форму</a></small>');l.data("ui-autocomplete")._renderItem=function(e,a){return D!==a.id?t("<li></li>").data("item.autocomplete",a).append("<a>"+a.label+"</a>").appendTo(e):t("<li></li>").data("item.autocomplete",a).append(R).appendTo(e)},c.on("change",W),u.on("change",W),f.on("change",W),p.on("change",W),h.on("change",W),v.click(function(){var t=z();0===t.length?G():q(t)}),window.CheckoutDelivery.onSelectMethod(window.CheckoutDelivery.getMethodId(e),function(){window.CheckoutDelivery.Dateline.setTitle("Желаемая дата доставки:"),window.CheckoutDelivery.Dateline.setItems([]),0===z().length&&W()}),n.change(function(){s.val(""),d.val(""),o.val(t(this).val())}),a.submit(function(){if(CheckoutDelivery.isMethodSelected(e)){var t=z();if(0!==t.length)return OrderCheckout.stopLoading(),OrderCheckout.showErrors(t,e),!1}return!0});var A=function(){t(this).prop("checked")?(p.prop("disabled",!1),h.prop("disabled",!1)):(p.prop("disabled",!0),p.val(""),h.prop("disabled",!0),h.prop("checked",!1))};f.change(A),A.apply(f),M(""!==d.val()&&""===s.val()?!0:!1)}function V(e,a){if(void 0!==B[e])return void a(B[e]);var n={query:e,cityGuid:i.val()};!0===g&&(n.filterCityFiasGuid=o.val()),OrderCheckout.startLoading(),t.ajax({url:d.data("url"),method:"get",data:n,dataType:"json",success:function(t){if(!1===t.result)t.errors.length>0&&(OrderCheckout.addErrors(t.errors),OrderCheckout.scrollTop());else{var i=t.data.streets;B[e]=i,a(i)}},error:function(){alert("Ошибка при получении данных. Попробуйте позже.")},complete:function(){OrderCheckout.stopLoading()}})}function M(t){g!==t&&(!0===t?(r.show(),H(),Y()):r.hide(),g=t,B=[])}function U(a,i){void 0===i&&(i=!0),!0===i&&H(),t(A,e).removeClass("hidden").append(a)}function H(){t(A,e).addClass("hidden").empty()}function W(){0===z().length&&G()}function G(){window.OrderCheckout.clearMessages(),window.CheckoutDelivery.Dateline.clear(),t(".loading-dots",e).remove(),e.append('<div class="loading-dots"><span></span><span></span><span></span><span></span></div>');var i=a.serializeArray();window.CheckoutDelivery.setSelectorLockStatus(!0);var o=++$;t.post(w+"?step="+OrderCheckout.getStepNumber(),i).done(function(t){if(!(t instanceof Object))return void(o===$&&(q(["Сервис временно недоступен. Повторите попытку позже или обратитесь в техническую поддержку."]),window.CheckoutDelivery.Dateline.setItems([])));if(o==$){window.OrderCheckout.clearErrors(),window.OrderCheckout.clearMessages();var e=[];if(0!==t.errors.length)q(t.errors);else if(0!==t.message.length)K(t.message),OrderCheckout.setNextButtonLockStatus(!t.canMoveToNextStep);else for(var a=0;a<t.data.length;a++){var i=t.data[a],n=window.CheckoutDelivery.Dateline.initItem();n.showZeroPrice=!0,n.stamp=i.stamp,n.price=i.price,n.includeAmountToOrder=i.includeAmountToOrder,e.push(n)}window.CheckoutDelivery.Dateline.setItems(e)}}).fail(function(){o==$&&(q(["Сервис временно недоступен. Повторите попытку позже или обратитесь в техническую поддержку."]),window.CheckoutDelivery.Dateline.setItems([]))}).always(function(){o==$&&t(".loading-dots",e).remove(),o===$&&window.CheckoutDelivery.setSelectorLockStatus(!1)})}function q(t){OrderCheckout.showErrors(t,e),CheckoutDelivery.Dateline.setItems([])}function K(t){OrderCheckout.showMessages(t,e),CheckoutDelivery.Dateline.setItems([])}function Q(e){m.removeClass("hidden"),H();var a=t(R,m);if(a.empty(),0!==e.count){var i=e.slice(0,7);if(i.length<e.length){var n=t('<div/>"',{class:"alert alert-info"}).text("Некоторые варианты не отображены: введите более точный адрес");U(n)}if(i.forEach(function(e){var i="elaboration-item-"+e.guid,n=t("<div/>",{class:"radio"}),r=t("<input/>",{id:i,type:"radio",value:e.guid,name:"elaboration-street","data-city-guid":e.parent_guid}),l=t("<label/>",{for:i,text:J(e)});r.change(function(){o.val(t(this).data("city-guid")),s.val(t(this).val()),d.val(t(this).siblings("label").text()),H(),Y(),W()}),n.append(r).append(l),a.append(n)}),!1===g){var r=t("<a/>",{href:"javascript:;",text:"заполните расширенную форму"});r.click(function(){return d.val(""),M(!0),H(),Y(),!1});var n=t('<div/>"',{class:"alert alert-warning"}).text("Нет вашей улицы - ").append(r);U(n,!1)}}}function Y(){m.addClass("hidden")}function z(){window.OrderCheckout.clearErrors();var t=[];return!1===g&&""===s.val()&&t.push("Необходимо заполнить поле «Улица»."),""===d.val().trim()&&t.push("Необходимо заполнить поле «Улица»."),""===c.val().trim()&&t.push("Необходимо заполнить поле «Дом»."),!0===f.prop("checked")&&""===p.val().trim()&&t.push("Необходимо заполнить поле «Этаж»."),t}function J(t){return r.is(":visible")?t.type_name_short+". "+t.name_official:t.type_name_short+". "+t.name_official+" ("+t.owner_type_name_short+". "+t.owner_name+")"}j.apply(this)}}(jQuery),function(t,e,a){function i(t,a){c=e(t),f=c.closest('[data-role="widget-container"]'),p=a,u=c.val(),f.on("click",'[data-role="'+v+'"]',function(){n(e(this))})}function o(t){e('[data-role="dateline-label"]',f).html(t)}function n(t){h.removeClass("active"),c.val("");var e=0;0!==t.length&&(u=t.attr("data-stamp"),t.addClass("active"),c.val(u),e=parseFloat(t.data("price"))),CheckoutTotalInfo.setTotalDeliveryPriceParams(e,!0,1)}function r(t){h.remove(),0===t.length?f.hide():(t.forEach(function(t){var e=t.stamp+60*p*60+60*(new Date).getTimezoneOffset(),i=new Date(1e3*e),o=0;a!==t.price&&(o=parseFloat(t.price));var n=!0;!1===t.includeAmountToOrder&&(n=!1),f.append(['<div data-role="'+v+'" class="date-block" data-stamp="'+t.stamp+'" data-price="'+o+'" data-include-amount-to-order="'+n+'">','<div class="date">',i.strftime("%a","rus"),"<br />",i.strftime("%d.%m"),"</div>",'<div class="price">',o||t.showZeroPrice?o+" &#8381;":"","</div>"].join(""))}),h=f.find('[data-role="'+v+'"]'),f.show()),c.val(""),n(h.filter('[data-stamp="'+u+'"]'))}function d(){return{}}function l(){return""!==c.val().trim()}function s(){r([]),c.val("")}var c,u,f,p,h=e(),v="dateline-block";e(function(){CheckoutDelivery.Dateline={init:i,setTitle:o,setItems:r,isSelected:l,initItem:d,clear:s}})}(document,jQuery),function(t){t.fn.checkoutDeliveryMap=function(e){var a,i,o,n,r,d,l,s="[data-role=select-item]",c=".radio",u={init:function(){function e(t,e){void 0!==e&&null!==e||(e=!0);var a=t.closest(c),i=Math.round(r.scrollTop()+a.position().top-r.outerHeight()/2+a.outerHeight());!0===e?r.scrollTo(i):r.scrollTop(i)}i=t(this),o=t(s,i),n=o.closest('[data-role="widget-container"]'),r=n.find("[data-role=items-list]"),d=n.find("[data-role=sort-by-distance]"),a=o.closest("form");var u=i.data("map-container-id");t("[title]",r).tooltip({container:"body"});var f=[],p="islands#darkOrangeIcon";loadYandexMaps(function(){function a(){t(s,i).each(function(){var a=t(this);if(f.hasOwnProperty(a.val())){var i=f[a.val()];i.events.add("click",function(){e(a,!0),n(),i.options.set("preset",p),a.prop("checked",!0)}),a.on("change",function(){a.is(":checked")&&(n(),i.options.set("preset",p),i.options.set("zIndex",2),l.setZoom(14),l.panTo([a.data("location-latitude"),a.data("location-longitude")],{flying:!0}))})}})}function n(){l.geoObjects.each(function(t){t.options.set("zIndex",1),t.options.set("preset",t.options.get("defaultPreset"))})}l=new ymaps.Map(u,{zoom:12,controls:["zoomControl","fullscreenControl","trafficControl"],behaviors:["default","scrollZoom"],center:[55.2627,87.363281]}),o.each(function(){var e=t(this),a=e.data("location-longitude");if(void 0!==a&&0!==a){var i=e.data("location-latitude");if(void 0!==i&&0!==i){var o="islands#blueIcon",n="islands#blueIcon";e.is(":checked")&&(o="islands#darkOrangeIcon"),e.is(":disabled")&&(o="islands#grayIcon",n="islands#grayIcon");var r=new ymaps.Placemark([i,a],{balloonContent:e.data("balloon")},{preset:o,defaultPreset:n});!1===e.is(":disabled")&&(f[e.val()]=r),l.geoObjects.add(r)}}}),a();var h;d.prop("disabled",!1),d.on("change",function(){function e(e,i){function o(t){return t<500?"до 500 метров":t<1e3?"500 - 1000 метров":t<2e3?"1000 - 2000 метров":t<3e3?"2000 - 3000 метров":"более 3000 метров"}u.each(function(){var a=t(this),o=getDistanceFromLatLonInKm(a.find(s).data("location-latitude"),a.find(s).data("location-longitude"),e,i);a.data("distance",1e3*o)}),u.sort(function(e,a){return t(e).data("distance")-t(a).data("distance")});var n,d=t("<div />");u.each(function(){var e=t(this),a=o(e.data("distance"));a!==n&&d.append('<div class="group-name">Дистанция: '+a+"</div>"),d.append(e),n=a}),r.html(d.html()),a()}function i(){u.sort(function(e,a){return parseInt(t(e).data("sort-order"))-parseInt(t(a).data("sort-order"))}),r.html(u),a()}function o(){return d.prop("checked",!1),i(),!1}function n(t){var a=t.coords.latitude,i=t.coords.longitude;h=new ymaps.Placemark([a,i],{balloonContent:"Вы находитесь здесь."},{balloonAutoPan:!1,preset:"islands#orangeDotIcon",defaultPreset:"islands#orangeDotIcon"}),l.geoObjects.add(h),h.balloon.open(),e(a,i)}if(!1=="geolocation"in navigator)return o();var d=t(this),u=r.find(c);l.geoObjects.remove(h),d.prop("checked")?navigator.geolocation.getCurrentPosition(n,o):i()})}),CheckoutDelivery.onSelectMethod(CheckoutDelivery.getMethodId(n),function(){CheckoutDelivery.Dateline.setTitle("Желаемая дата получения:"),CheckoutDelivery.Dateline.setItems([]),loadYandexMaps(function(){var t=o.filter(":checked");0===t.length?l.setBounds(l.geoObjects.getBounds(),{checkZoomRange:!0}):(e(t,!1),t.change())})}),a.submit(function(){return!CheckoutDelivery.isMethodSelected(n)||0!==o.filter(":checked").length||(OrderCheckout.stopLoading(),OrderCheckout.showErrors(["Выберите точку получения."]),!1)})}};return u[e]?u[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==(void 0===e?"undefined":_typeof(e))&&e?void 0:u.init.apply(this,arguments)}}(jQuery),function(t){t.fn.OrderCheckoutDeliveryPostamat=function(){function e(){window.OrderCheckout.clearErrors();var t=[];return 0===r.filter(":checked").length&&t.push("Укажите постамат, на котором желаете получить ваш заказ."),t}var a,i,o,n,r,d="load-url",l="step-number",s="price",c="include-price",u=2,f="[data-role=select-item]",p=this;!function(){a=t(p),i=a.closest("form"),o=a.data(d),n=i.data(l),r=t(f,a),r.change(function(){CheckoutTotalInfo.setTotalDeliveryPriceParams(t(this).data(s),t(this).data(c),u)}),i.submit(function(){if(CheckoutDelivery.isMethodSelected(a)){var t=e();if(0!==t.length)return OrderCheckout.stopLoading(),OrderCheckout.showErrors(t,a),!1}return!0}),window.CheckoutDelivery.onSelectMethod(window.CheckoutDelivery.getMethodId(a),function(){var t=r.filter(":checked");0!==t.length&&(CheckoutTotalInfo.isRemoveDeliveryBlock=!1,CheckoutTotalInfo.setTotalDeliveryPriceParams(t.data(s),t.data(c),u))})}()}}(jQuery),function(t,e,a){function i(t){function i(){var t=e(this),a=t.attr("name"),i=c.find('[name="'+a+'"]');i.length>1&&i.val(t.val())}s=e(t),c=s.closest("FORM"),c.find("["+f+"]").keyup(i),c.find("["+f+"]").change(i),s.change(function(){var t=e(this),i=t.data("method-id");c.find('[data-method-section-id]:not([data-method-section-id="'+i+'"])').hide(),c.find('[data-method-section-id="'+i+'"]').show();var o=c.find('[data-role="consult-block"].static:visible');if(0!==o.length){var n=o.clone(),r=o.closest(".row");r.prev("hr").hide(),r.hide(),o.remove(),n.removeClass("static").css({"padding-left":"20px"}).attr("data-method-section-id",i),c.find('[data-role="order-buttons"]').after(n)}OrderCheckout.clearErrors(),OrderCheckout.setNextButtonLockStatus(!1),a!==p[i]&&p[i].forEach(function(t){t(i)}),h.forEach(function(t){t(i)})}),c.submit(function(){return!(s.length>1&&0===s.filter(":checked").length)||(OrderCheckout.stopLoading(),OrderCheckout.showErrors(["Выберите способ получения."]),!1)}),setTimeout(function(){s.filter(":checked").change()},500),c.find("[data-method-section-id]").hide(),c.find("["+f+'="master"]').change()}function o(t,e){a===p[t]&&(p[t]=[]),p[t].push(e)}function n(t){h.push(t)}function r(t){return t.closest("[data-method-section-id]").data("method-section-id")}function d(t){return r(t)===s.filter(":checked").data("method-id")}function l(t){!0===t?e(u).show():e(u).hide()}var s,c,u=".radio-form .radio-cover",f="data-field-sync-role",p={},h=[];window.CheckoutDelivery={init:i,onSelectMethod:o,onSelectAnyMethod:n,getMethodId:r,isMethodSelected:d,setSelectorLockStatus:l}}(document,jQuery),function(t,e,a){function i(){v.find(".order-buttons .btn").trigger("order.stopLoading")}function o(){v.find('.order-buttons .btn[type="submit"]').trigger("order.startLoading")}function n(){return parseInt(v.attr("data-step-number"))}function r(t,a){if(l(a),0!==t.length){var i=[];e.each(t,function(t,e){
i.push("<li>"+e+"</li>")}),i=i.join("");var o=c(a);o.find("UL").html(i),o.show()}}function d(t,a){if(s(a),0!==t.length){var i=[];e.each(t,function(t,e){i.push("<li>"+e+"</li>")}),i=i.join("");var o=u(a);o.find("UL").html(i),o.show()}}function l(t){c(t).hide()}function s(t){u(t).hide()}function c(t){return a!==t?t.find('[data-role="errors-list"]'):v.find('[data-role="errors-list"]')}function u(t){return a!==t?t.find('[data-role="message-list"]'):v.find('[data-role="message-list"]')}function f(){m.on("keypress",function(t){if(13===(t.keyCode||t.which))return t.preventDefault(),!1}),m.find("input[type=checkbox], input[type=radio]").on("focus",function(){e(this).closest("."+e(this).attr("type")).addClass("focus")}),m.find("input[type=checkbox], input[type=radio]").on("blur",function(){e(this).closest("."+e(this).attr("type")).removeClass("focus")}),m.find("[tabindex]").on("keyup",function(t){var i=e(this);if(13===(t.keyCode||t.which)){if("submit"==i.attr("type"))return m.submit(),!0;t.preventDefault();var o=[];return e(this).parents("form").eq(0).find("[tabindex]:visible:enabled").each(function(){o[e(this).attr("tabindex")]=this}),e.each(o,function(t,e){if(a!==e&&i.attr("tabindex")<t)return e.focus(),!1}),!0}})}function p(t){a!==g&&g.prop("disabled",t)}function h(){return v.data("is-terminal")}var v,m,g;e(function(){if(v=e(".order-page"),0===v.length)return void(v=a);l(),s(),m=v.find("FORM"),0!==m.length&&(g=e("[data-role=button-next]",m),f())}),window.OrderCheckout={stopLoading:i,startLoading:o,getStepNumber:n,showErrors:r,clearErrors:l,showMessages:d,clearMessages:s,setNextButtonLockStatus:p,isTerminal:h}}(document,jQuery),$(document).ready(function(){var t=$("#branches-with-avails");if(0===t.length)return!1;t.on("click",function(){var e="modal-branches-with-avails",a=$("#"+e);if(0===a.length){a=$("<div/>",{id:e,class:"modal fade"});var i=$("<div/>",{class:"modal-dialog"}),o=$("<div/>",{class:"modal-content"}),n=$("<div/>",{class:"modal-body"});n.html("Идет загрузка..."),o.append(n),i.append(o),a.append(i),$("body").append(a),a=$("#"+e),a.modal({keyboard:!1}),a.on("show.bs.modal",function(){var e=t.prop("href"),i=$(".modal-body",a);i.on("load",e,function(t,e){if("error"===e)return alert("Извините, сервис временно недоступен. Повторите попытку позже."),void a.modal("hide");var o=$('input[type="radio"]',i);o.length>0&&o.on("click",function(){var t=$("div",i).data("action-url");$.ajax({url:t+"&branch_guid="+$(this).val(),type:"get",cache:!1,dataType:"json",success:function(t){!0===t.result&&window.location.reload(),i.html($("<h4>").html(t.message))},error:function(){i.html($("<h4>").html("Произошла ошибка при получении ответа от сервера."))}})})})}),a.on("hidden.bs.modal",function(){n.html("")})}return a.modal("show"),!1})}),$(document).ready(function(){function t(){$(a).hide(),$.ajax({url:o.attr("action"),type:o.attr("method"),dataType:"JSON",data:o.serialize(),success:function(t){t.result?($(e).show(),$(i).hide()):$(a).show()},error:function(){$(a).show()}})}var e=".need-callback-link-div > .alert-warning",a=".need-callback-div > .alert-danger",i=".show-comment",o=$(".need-callback-div").find("form"),n=$(".need-callback-div").find(".repeat-need-callback");o.on("keyup","textarea",function(){$(this).attr("data-min-length")<=$(this).val().length?o.find("button").removeClass("lock"):o.find("button").addClass("lock")}),o.on("submit",function(){return!0===o.yiiActiveForm("data").validated&&(t(),o.hide()),!1}),n.click(t)}),function(t){t.fn.onlineCreditForm=function(){var e=t(this);t(".cancel-button",e).on("click",function(){e.on("beforeValidate",function(){t(this).data().attributes.attr("willValidate",!1)})})}}(jQuery),function(t){var e,a={isRemoveDeliveryBlock:!0,init:function(i){return t(this).on("order.total_info_widget.resetValue",function(){a.resetValue(t(this))}),1==t(this).find(".pzpBonusShow").val()&&(t(this).on("order.total_info_widget.hideBonus",function(){a.hideBonus(t(this))}),t(this).on("order.total_info_widget.showBonus",function(){a.showBonus(t(this))})),e=t(this),t(this).on("order.total_info_widget.decreaseValue",function(e,i){a.decreaseValue(t(this),i)}),t(this).on("order.total_info_widget.setDeliveryPrice",function(t,e,i){a.setDeliveryPrice(e,i)}),CheckoutDelivery.onSelectAnyMethod(function(){!0===CheckoutTotalInfo.isRemoveDeliveryBlock&&a.setDeliveryPrice(0),CheckoutTotalInfo.isRemoveDeliveryBlock=!0}),e},resetValue:function(t){var e=t.find(".total-price-value"),a=e.find("span:first-child"),i=parseInt(a.attr("data-value"));a.html(new Intl.NumberFormat("ru-RU").format(i)),e.find(".bonus-part").remove(),a.removeClass("line-through")},decreaseValue:function(t,e){t.trigger("order.total_info_widget.resetValue");var a=t.find(".total-price-value"),i=a.find("span:first-child"),o=parseInt(i.attr("data-value"))-e;i.addClass("line-through"),a.append('<div class="bonus-part">'+new Intl.NumberFormat("ru-RU").format(o)+' <i class="rub-icon"></i></div>')},showBonus:function(e){var a=e.find(".total-bonus-value");if(0!==a.length){a.show();var i=t(document).find(".pzp-block");void 0!==i&&(i.find(".bonus-info-msg").remove(),i.append('<div class="bonus-info-msg"><b>'+a.text()+"</b>будет начислено на Бонусную карту после оплаты данного заказа</div>"))}},hideBonus:function(e){var a=e.find(".total-bonus-value");if(0!==a.length){a.hide();var i=t(document).find(".pzp-block");void 0!==i&&i.find(".bonus-info-msg").remove()}},setDeliveryPrice:function(i,o,n){void 0===o&&(o=!0);var r=t(".delivery",e);if(0===i)0<r.length&&r.remove();else{if(0===r.length){switch(n){case 1:t(".products-price-amount",e).after('<div class="delivery">Доставка: <span class="price-value"></span> <i class="rub-icon"></i></div>').find(".delivery");break;case 2:t(".products-price-amount",e).after('<div class="delivery">Постамат: <span class="price-value"></span> <i class="rub-icon"></i><br><span class="hint">(доставка и хранение)</span></div>').find(".delivery")}r=t(".delivery",e)}t(".price-value",r).text(new Intl.NumberFormat("ru-RU").format(i)).data("value",i)}a.recalcTotalPrice(o)},recalcTotalPrice:function(){var a=parseFloat(t(".delivery .price-value",e).data("value")),i=parseFloat(t(".products-price-amount .price-value",e).data("value")),o=t(".total-price-value .price-value",e),n=i;a>0&&(n+=a),o.html(new Intl.NumberFormat("ru-RU").format(n)),o.data("value",n)}};t.fn.totalInfoWidget=function(t){return a[t]?a[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==(void 0===t?"undefined":_typeof(t))&&t?void 0:a.init.apply(this,arguments)},window.CheckoutTotalInfo={setTotalDeliveryPriceParams:a.setDeliveryPrice,isRemoveDeliveryBlock:a.isRemoveDeliveryBlock}}(jQuery),$(function(){if($('.order-group .order-group-control [type="radio"]:checked').trigger("change"),"#phoneFocus"===window.location.hash){var t=function(){$("input[type=tel]").focus()};setTimeout(t,2e3)}var e=$(".order-page"),a=e.find(".order-buttons .btn");a.on("click",function(t){var e=$(this);e.attr("data-loading")?t.preventDefault():"submit"!==e.attr("type")&&e.trigger("order.startLoading")}),a.on("order.stopLoading",function(){var t=$(this);t.find("SPAN.glyphicon-refresh-animate").remove(),t.removeAttr("data-loading")}),a.on("order.startLoading",function(){var t=$(this);t.attr("data-loading")||(t.prepend('<span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>'),t.attr("data-loading",1))}),$("#order-form").submit(function(){$(this).find('[type="submit"]').trigger("order.startLoading")})}),function(t,e,a){function i(){var e=r.val(),i=l[e];if(a!==i){t(o).hide();for(var n in i)if(!1!==i.hasOwnProperty(n)){var d=i[n];t(o+'[data-payment-guid="'+d+'"]').show()}}}var o='[data-role="payment-method"]',n=void 0,r=void 0,d=void 0,l=void 0;t(function(){if(n=t('[data-role="preorder-container"]'),r=n.find('[data-role="branch-list"]'),d=n.find('[data-form-name="preorder-form"]'),0!==n.length&&0!==r.length){l=JSON.parse(e.PREORDER_PAYMENT_METHODS_GROUPED_BY_BRANCH_GUID),i(),r.on("change",i);var o=!1,s=d.find('[type="submit"]');s.on("click",function(){return s.prop("disabled",!0),!0===o||(t.post(d.attr("action"),d.serialize(),function(i){if(!0===i.result)return o=!0,void d.submit();var r="",l=n.find(".alert-danger");t.each(i.errors,function(t,e){r=r+e+"<br>"}),0!==r.length?(a!==e.grecaptcha&&e.grecaptcha.reset(),l.html("").append(r).show()):l.hide();var s=t("#contractor-phone-confirm-modal");0!==s.length&&s.remove(),t("body").append(i.html),s=t("#contractor-phone-confirm-modal"),s.modal(),s.SmsConfirm({callback:function(t){s.modal("hide"),!0===t&&(o=!0,d.submit())}})}).always(function(){s.prop("disabled",!1)}),!1)}),t("body").on("click",'[data-role="preorder-select-branch"]',function(e){e.preventDefault();var a=t(this),i=a.closest('[data-id="modal-for-avails"]'),o=i.find(".avails-item.selected");0!==o.length&&(r.val(o.data("id")),i.modal("hide"))})}})}(jQuery,window,void 0),function(t,e){var a=void 0,i=void 0,o=void 0,n=void 0,r=void 0,d=void 0,l=!1,s=void 0,c=void 0,u=void 0,f=void 0,p=void 0,h=void 0;e(function(){function t(t){var e=t.value.split("."),a=t.getAttribute("data-min-date").split("."),i=t.getAttribute("data-max-date").split(".");e=new Date(e[2],e[1]-1,e[0]),a=new Date(a[2],a[1]-1,a[0]),i=new Date(i[2],i[1]-1,i[0]),a<=e&&e<=i?(p.attr("disabled",!1),f.addClass("has-success"),f.removeClass("has-error"),h.addClass("hide")):(p.attr("disabled",!0),f.addClass("has-error"),f.removeClass("has-success"),h.removeClass("hide"))}function v(t,a){e.ajax({url:i.attr("data-url"),method:"get",dataType:"json",data:{query:t},success:function(t){if(!0===t.result){var e=t.data.streets;a(e)}},error:function(){alert("Ошибка при получении данных. Попробуйте позже.")}})}function m(t){return t.type_name_short+". "+t.name_official+" ("+t.owner_type_name_short+". "+t.owner_name+")"}a=e("#service-checkout"),0!==a.length&&(i=e("[data-role=street-input]",a),o=e("[data-role=street_fias_guid]",a),n=e("[data-role=payment_method_guid]",a),d=a.find("form#service-checkout-form"),s=a.find("[data-role=operator-mode]"),c=d.find("[data-role=date-input]"),f=d.find(".field-servicekbtcheckoutform-date"),p=d.find("button"),h=d.find('[data-role="error-message"]'),c.keyup(function(){var e=this;void 0!==u&&clearTimeout(u),u=setTimeout(function(){t(e)},1e3)}),c.blur(function(){var e=this;u=setTimeout(function(){t(e)},1e3)}),0!==s.length&&(s.on("change",function(){var t=e("[data-role=payment-method]",a).first();!0===s.prop("checked")?(e("[data-role=description]",a).find(".description").collapse("hide"),t.prop("checked",!0),a.find("[data-is-offline=no]").hide(),t.trigger("click")):(e("[data-role=description]",a).find(".description").collapse("show"),a.find("[data-is-offline=no]").show())}),s.trigger("change")),r=i.autocomplete({appendTo:i.parent(),source:function(t,e){v(t.term,function(t){var a=[];t.forEach(function(t){var e={id:t.guid,label:m(t),parent_guid:t.parent_guid};a.push(e)}),e(a)})},select:function(t,e){o.val(e.item.id)}}),i.keyup(function(t){13!==t.keyCode&&o.val("")}),r.on("blur",function(){""!==i.val()&&""===o.val()&&v(e(this).val(),function(t){if(1===t.length){var e=t[0];o.val(e.guid),i.val(m(e))}else i.val("")})}),a.on("click touchstart","[data-role=date-input-button]",function(){e(this).parent().find("input").trigger("focus")}),a.on("change","[data-role=phone-input]",function(){l=!1}),d.on("beforeSubmit",function(){if(!0===l){var t=d.find("button");return!0!==t.prop("disabled")&&(t.prop("disabled",!0),!0)}return e.ajax({type:"POST",url:d.attr("data-url-confirm-phone"),dataType:"json",data:{phoneNumber:d.find("[data-role=phone-input]").val()},success:function(t){if(!0!==t.result)return void(0!==t.errors.length&&alert(t.errors[0]));if(!1===t.data.needConfirm||0!==s.length&&s.prop("checked"))return l=!0,void d.submit();var a=e("#contractor-phone-confirm-modal");0!==a.length&&a.remove(),e("BODY").append(t.html),a=e("#contractor-phone-confirm-modal"),a.modal(),a.SmsConfirm({callback:function(t){a.modal("hide"),!0===t&&(l=!0,d.submit())}})},error:function(){alert("Сервис временно недоступен. Повторите попытку позже или обратитесь в техническую поддержку.")}}),!1}),d.on("click","[data-role=pay-selector]",function(){var t=e(this).find("[data-role=payment-method]"),a=e("[data-role=info-offer]");t.prop("checked",!0),n.val(t.val()),"yes"===e(this).attr("data-is-offline")?(a.find("span:nth-child(1)").hide(),a.find("span:nth-child(2)").show()):(a.find("span:nth-child(1)").show(),a.find("span:nth-child(2)").hide())}),e("[data-role=accordion]").accordion({icons:null,heightStyle:"content",animate:!1}))})}(document,jQuery),function(t,e){e(function(){e(t).on("click","[data-role=service-order-btn]",function(){var t=e(this);return t.prop("disabled",!0),e.ajax({url:t.attr("data-url"),type:"POST",data:{productGuid:t.attr("data-product-id")},success:function(t){window.location.href=t},error:function(){alert("Сервис временно недоступен. Повторите попытку позже или обратитесь в техническую поддержку."),t.prop("disabled",!1)}}),!1})})}(document,jQuery),function(t,e,a){var i=".bp-product-link",o=".bp-product-name",n=".bp-product-select",r=".bp-input-link",d=".bp-remove",l=".bp-add-link",s=".bp-cancel-add";e(function(){function t(t){1!==e(i).length&&t.find(s).css("display","block"),t.find(n).val("").css("display","block"),t.find(o).text(" ").attr("data-cart-product-guid",""),t.find(d).hide(),t.find(r).prop("readonly",!1).val("").hide(),t.find(l).hide()}var c=e("[data-role=cart-page]").find(".best-price-action");0!==c.length&&(c.on("click",".bp-toggle-form-link",function(){var t=e(".bp-products-links");e(this).toggleClass("opened"),e(this).hasClass("opened")?t.removeClass("hidden"):t.addClass("hidden")}),c.on("change",n,function(){var t=e(this).closest(i),a=e(":selected",this);""!==a.val()&&(e(this).hide(),t.find(s).hide(),t.find(o).text(a.text()).attr("data-cart-product-guid",a.val()).css("display","block"),t.find(r).css("display","block"),t.find(".bp-change-product").css("display","block"))}),c.on("click",".bp-change-product",function(){var a=e(this).closest(i);e(this).hide(),a.find(d).hide(),t(a)}),c.on("keyup blur",r,function(){var t=e(this).closest(i);!0!==e(this).prop("readonly")&&(""!==e(this).val()?(t.find(d).css("display","block"),t.find(".bp-change-product").hide(),t.find(l).css("display","block")):(t.find(d).hide(),t.find(l).hide(),t.find(".bp-change-product").css("display","block")))}),c.on("click",l,function(){e(this).hide();var t=e(this).closest(i),a=t.clone();a.find(n).val("").css("display","block"),a.find(s).css("display","block"),a.find(o).text(" ").attr("data-cart-product-guid",""),a.find(r).prop("readonly",!1).val("").hide(),a.find(d).hide(),a.appendTo("#bp-products-links-form"),t.find(r).prop("readonly",!0)}),c.on("click",d,function(){var a=e(this).closest(i);1===e(i).length?t(a):(a.remove(),0===e(s).filter(":visible").length&&0===e(".bp-change-product").filter(":visible").length&&e(i).filter(":last-child").find(l).css("display","block"),1===e(i).length&&e(s).hide())}),c.on("click",s,function(){e(this).closest(i).remove(),e(i).filter(":last-child").find(l).css("display","block")}),c.on("submit","#bp-products-links-form",function(){return!1}),e(a).on(a.EVENT_ITEM_REMOVED_FROM_CART,function(a,r){c.find(i).each(function(){e(this).find(n).find("[value="+r+"]").hide(),r===e(this).find(o).attr("data-cart-product-guid")&&(1===e(i).length?t(e(this)):(e(this).remove(),0===e(s).filter(":visible").length&&0===e(".bp-change-product").filter(":visible").length&&e(i).filter(":last-child").find(l).css("display","block"),1===e(i).length&&e(s).hide()))})}),e(a).on(a.EVENT_UPDATE_CART_ITEM,function(t,a){c.find(i).each(function(){e(this).find(n).find("[value="+a.attr("data-cart-product-id")+"]").css("display","block")})}))})}(document,jQuery,window),function(t,e){e.fn.cartCatalogProductRelatedWidget=function(){var t=e(this),a="[data-role=cart-related-tab-control]",i=t.find(".mobile-controls [data-role=dropdown-list]"),o=function(o){e(a,t).removeClass("active").filter("[data-id="+o+"]").addClass("active");var n=e("[data-role=cart-related-tab]",t),r=n.filter("[data-id="+o+"]");n.removeClass("active"),r.addClass("active");var d=i.find("[data-id="+o+"]");(e("[data-role=list-item]",i).toggleClass("disabled",!1),d.closest("[data-role=list-item]").toggleClass("disabled",!0),e("[data-role=toggle-button] [data-role=title]",i).html(d.html()),!1===r.is("[data-content-url]")||"1"===r.attr("data-is-loaded")||r.data("loading"))||(r.data("loading",!0),e.get(r.data("content-url")).done(function(t){if(!1===t.result)return void r.html('<div class="alert alert-info">Не удалось получить список аксессуаров.</div>');r.html(t.html),r.relatedProductsByCategoriesWidget(),window.dispatchEvent(new CustomEvent(window.EVENT_PRODUCTS_LOADED)),window.dispatchLazyLoadUpdateEvent()}).fail(function(){r.html('<div class="alert alert-info">Не удалось получить список аксессуаров.</div>')}).always(function(){r.attr("data-is-loaded",1),r.data("loading",!1)}))};e("[data-role=list-item]",i).on("click",function(){return e("[data-role=toggle-button]",i).dropdown("toggle"),o(e(this).data("id")),!1}),e(a,t).on("click",function(){return o(e(this).data("id")),!1}),e(a,t).each(function(){var t=e(this).data("id");e("[data-show-related-for="+t+"]").removeClass("hidden")}),e("[data-show-related-for]").on("click",function(){var i=e(this).data("show-related-for");e(a+"[data-id="+i+"]",t).click();var o=30;window.checkScreenType(window.SCREEN_DESKTOP,window.SCREEN_WIDE)&&(o=65),e("body").scrollTo(t.offset().top-o)}),e(window).on(window.EVENT_ITEM_REMOVED_FROM_CART,function(i,o){var n=e("[data-"+window.SELECTOR_CART_PRODUCT_ID+'="'+o+'"]');if(0!==n.length){var r=n.find("[data-show-related-for]"),d=r.data("show-related-for"),l=e(a,t).filter("[data-id="+d+"]");if(l){var s=n.parent().find('[data-show-related-for="'+d+'"]'),c=!1;s.each(function(){e(this).closest(window.SELECTOR_CART_PRODUCT).attr("data-"+window.SELECTOR_CART_PRODUCT_ID)!==o&&(c=!0)}),c||(l.is(".active")&&l.siblings().first().click(),l.addClass("hidden"),1==t.find(a).length-t.find(a).filter(".hidden").length&&t.addClass("hidden"))}}}),e(window).on(window.EVENT_UPDATE_CART_ITEM,function(i,o){var n=o.find("[data-show-related-for]");if(0!==n.length){var r=n.data("show-related-for"),d=e(a,t).filter("[data-id="+r+"]");d.length&&(t.removeClass("hidden"),d.removeClass("hidden"))}})},e(function(){e("[data-role=cart-catalog-product-related-widget]").each(function(){e(this).cartCatalogProductRelatedWidget()})})}(document,jQuery),$(function(t,e){var a;e(function(){if(a=e('[data-role="order-payment-methods"]'),0===a.length)return!1;a.find('a[data-toggle="tab"]').on("shown.bs.tab",function(t){var i=e(t.target),o=e(t.relatedTarget),n=e("#"+o.attr("aria-controls")),r=n.find('[name="payment_method_selector"]:checked').val();void 0!==r&&o.data("default-payment-method",r),a.find('[name="payment_method_selector"]').removeAttr("checked").end().find('[value="'+i.data("default-payment-method")+'"]').click()})})}(window,jQuery)),function(t,e){var a=void 0,i=void 0,o=!1;e.SELECTOR_ONE_CLICK_BUTTON='[data-role="one-click-buy-button"]',t(function(){['[data-role="catalog-items-wrapper"]',"#product-page",'[data-role="product-list"]','[data-role="products-container"]'].forEach(function(e){var a=t(e);if(0!==a.length)return i=a,!1}),void 0!==i&&0!==i.length&&(i.on("click",'[data-role="one-click-buy-button"]',function(i){if(!0!==o){var n=document.createElement("div");document.body.appendChild(n),o=!0,a=t(this);var r=[],d=a.attr("data-direct-services-guids");void 0!==d&&""!==d.trim()&&(r=JSON.parse(d)),e.dispatchEvent(new CustomEvent(e.EVENT_ONE_CLICK_BUTTON_PUSH,{detail:{target:i.target}}));var l={productId:a.attr("data-product-id"),optionalProductGuid:a.attr("data-optional-guid"),additionalWarrantyPeriod:a.attr("data-additional-warranty-period"),additionalWarrantyType:a.attr("data-additional-warranty-type"),relatedServicesGuids:r,isInProductCard:!0,addCartUrl:a.attr("data-add-cart-url")};e.startOneClickOrder(l,n,function(){document.body.removeChild(n),o=!1})}}),t(e).on(e.EVENT_OS_VARIANT_CHANGED,function(e,a){var i=t('[data-role="one-click-buy-button"][data-product-id="'+a.baseProductGuid+'"]');0!==i.length&&i.attr("data-optional-guid",a.guid)}),e.productAdditionsDispatcher.addAdditionalWarrantyListener(function(e,a){var i=t('[data-role="one-click-buy-button"][data-product-id="'+e+'"]');0!==i.length&&(null!==a?(i.attr("data-additional-warranty-period",a.period),i.attr("data-additional-warranty-type",a.type)):i.removeAttr("data-additional-warranty-period"))}))}),e.productAdditionsDispatcher.addKbtServiceListener(function(e){var a=e.relatedKbtService,i=t('[data-role="one-click-buy-button"][data-product-id="'+e.baseProductGuid+'"]');a.hasKbtServiceChecked?i.hide():i.show();var o=i.attr("data-direct-services-guids");if(o=void 0===o?[]:JSON.parse(o),a.checked)o.push(a.guid);else{var n=o.indexOf(a.guid);o.splice(n,1)}i.attr("data-direct-services-guids",JSON.stringify(o))})}(jQuery,window),function(t,e){e.EVENT_OS_VARIANT_CHANGED="os-variant:changed",e.EVENT_OS_VARIANT_REINIT="os-variant:reinit";var a=void 0,i=void 0,o=void 0,n=void 0,r=void 0,d=function(a){var i=a.data("variant"),o="00000000-0000-0000-0000-000000000000"===i.guid;s(i.guid),l(i),t('[data-role="os-change-notify"]').toggleClass("hidden",o),a.trigger(e.EVENT_OS_VARIANT_CHANGED,[i]),e.productAdditionsDispatcher.setOptionalProduct(i)},l=function(t){0!==t.currentPrice?(o.html(t.title),i.addClass("sup-text")):(o.text(""),i.removeClass("sup-text"))},s=function(t){n.filter(function(e){n.eq(e).val()===t&&n.eq(e).prop("checked",!0)}),r.filter(function(e){r.eq(e).val()===t&&r.eq(e).prop("selected",!0)})},c=function(){a=t('[data-role="os-selection-widget"]'),0!==a.length&&(i=a.find("[data-role=os-title]"),o=a.find("[data-role=os-selected-label]"),n=a.find("input[name=osVariantSelected]"),r=a.find('option[data-role="change-optional-os"]'),a.on("change",'[data-role="change-optional-os"]',function(){d(t(this))}),a.on("change",'select[name="osVariantSelected"]',function(){d(t('select[name="osVariantSelected"] option:selected'))}),t(e).on(e.EVENT_UPDATE_CART,function(e,i){var o=a.find('[data-role="change-optional-os"]');if(0!==o.length){for(var n in i){(function(e){if(!1===i.hasOwnProperty(e))return"continue";var a=i[e];o.each(function(){var e=t(this),i=e.data("variant");i.baseProductGuid===a.guid&&(i.overlimitMessage="",(-1!==t.inArray(e.val(),a.optionalProducts)||0===a.optionalProducts.length&&"00000000-0000-0000-0000-000000000000"===e.val())&&(i.isOsInCart=!0,e.data("variant",i)))})})(n)}o.each(function(){var e=t(this),a=e.data("variant");if(!a.isOsInCart)for(var o in i)if(!1!==i.hasOwnProperty(o)){var n=i[o];a.baseProductGuid===n.guid&&(a.overlimitMessage=n.overlimitMessage,a.isOsInCart=""!==a.overlimitMessage,e.data("variant",a))}})}}))};t(c),e.addEventListener(e.EVENT_OS_VARIANT_REINIT,c),t(e).on("load",function(){if(a=t('[data-role="os-selection-widget"]'),0!==a.length){var e=a.find('[data-role="change-optional-os"]:checked');d(e)}})}(jQuery,window),function(t){var e="form#price-item-alert";t.fn.priceItemAlert=function(){var a={priceItemId:null,modal:null},i=void 0,o=this,n={init:function(){t(o).on("click",".btn-price-item-alert",function(){return i=t(this).data("id"),i&&n.showPopup(i),!1}),t("body").on("click",".price-item-alert .change-city",function(){return t(".price-item-alert .select-city").toggle(),t(".price-item-alert .current-city").toggle(),!1}).on("click",".price-item-alert .return-city",function(){return t(".price-item-alert .select-city").hide(),t(".price-item-alert .current-city").show(),!1}).on("click",".price-item-alert .actions .select_all",function(){return t(".price-item-alert .shops input[type=checkbox]").prop("checked","checked"),!1}).on("click",".price-item-alert .actions .unselect_all",function(){return t(".price-item-alert .shops input[type=checkbox]").prop("checked",!1),!1}).on("change","#price_item_alert_region_group_id",function(){var e=t("#price_item_alert_region_id"),a=t("#price_item_alert_city_id");e.empty().prop("disabled",!0),a.empty().prop("disabled",!0),t.ajax({type:"POST",url:"/ajax/get-regions/",data:{id:t(this).val()},success:function(a){if(1===a.result){e.append(t("<option/>"));for(var i in a.data)e.append(t("<option/>",{value:a.data[i].id,text:a.data[i].title}));e.prop("disabled",!1)}},dataType:"json"})}).on("change","#price_item_alert_region_id",function(){var e=t("#price_item_alert_city_id");e.empty().prop("disabled",!0),t.ajax({type:"POST",url:"/ajax/get-cities/",data:{id:t(this).val()},success:function(a){if(1===a.result){e.append(t("<option/>"));for(var i in a.data)e.append(t("<option/>",{value:a.data[i].id,text:a.data[i].title}));e.prop("disabled",!1)}},dataType:"json"})}).on("change","#price_item_alert_city_id",function(){t(".price-item-alert [type='submit']").prop("disabled",!0);var e=t("#price_item_alert_shop_id");e.empty(),t(".price-item-alert .change-city").text(t(":selected",this).text()),t.ajax({type:"POST",url:"/ajax/get-shops/",data:{id:t(this).val()},success:function(a){if(1===a.result){t(".price-item-alert [type='submit']").prop("disabled",!1);for(var i in a.data)e.append(t("<li/>").append(t('<div class="checkbox">').append(t("<input/>",{type:"checkbox",name:"shop_id[]",value:a.data[i].id,id:"alert-shop-id-"+a.data[i].id}).prop("checked",!0)).append(t("<label/>",{for:"alert-shop-id-"+a.data[i].id}).append(a.data[i].title))));t(".price-item-alert .select-city").hide(),t(".price-item-alert .current-city").show()}},dataType:"json"})}).on("submit",e,function(){return!1}).on("click",".btn.close-btn",function(){a.modal&&a.modal.modal("hide")}).on("click",".buttons .create-btn",function(){var a=t(this).data("action-url");n.postForm(t(e),a)}).on("click",".buttons .remove-btn",function(){var a=t(this).data("action-url");n.postForm(t(e),a)})},showPopup:function(e){var i=n.showModal('<div class="loading-dots"><span></span><span></span><span></span><span></span></div>');a.priceItemId=e,a.modal=i,n.loadPopup(e,function(e,a){e?t(".modal-content",i).empty().append(a):i.modal("hide")})},showModal:function(e){var a=t("#myPopup");return a.is(".modal")&&a.remove(),e='<div class="modal notification-modal" id="myPopup" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content">'+e+"</div></div></div>",t(e).modal()},loadPopup:function(e,a){t.ajax({url:"/productNotify/ajax/get-modal/",type:"GET",dataType:"JSON",data:{productGuid:e},success:function(t){t.result?"function"==typeof a&&a(!0,t.html):(alert("Сервис временно недоступен, повторите попытку позже."),a(!1))},error:function(){alert("Сервис временно недоступен, повторите попытку позже."),a(!1)}})},postForm:function(e,o){var n=t(".buttons .create-btn",e),r=a.modal;null!==r&&r.toggleClass("loading",!0);var d=[];t("input[name^=shop_id]:checked",e).each(function(){d.push(t(this).val())});var l=[];t("input[name^=subscribe]:checked",e).each(function(){l.push(t(this).val())}),t.ajax({type:"POST",url:o,dataType:"json",data:e.serialize(),success:function(e){!0===e.result?(t(".btn-price-item-alert[data-id="+i+"]").toggleClass("created",null===e.data),t(".product-notification-container").empty().append(e.html),null!==r&&r.find(".modal-header h1").empty().append(e.message)):(n.show(),alert(e.error))},error:function(){alert("Сервис временно недоступен, повторите попытку позже.")}}).always(function(){null!==r&&r.toggleClass("loading",!1)}),a.priceItemId=null},updateModalButton:function(){a.modal&&(0===a.modal.find(":checkbox:checked").length&&0===t(e).data("notification-exists")?a.modal.find(".buttons .create-btn").toggleClass("disabled",!0):a.modal.find(".buttons .create-btn").toggleClass("disabled",!1))}};n.init()},t(function(){t("body").priceItemAlert()})}(jQuery),function(t){t(function(){var e=t("<div/>",{class:"popover bottom",id:"cheaper-popover"}),a=t('<a href="javascript:;" id="cheaper-popover-link" target="_blank" rel="nofollow">Узнать больше</a>'),i=t("<div/>",{style:"position:fixed;left:0;top:0;right:0;bottom:0;z-index:9999;"});e.append(t("<div/>",{class:"arrow"})).append(t("<div/>",{class:"popover-content"}).append(t("<div/>",{id:"cheaper-popover-title-image"}),t('<p id="cheaper-popover-main-info">Копите бонусы и оплачивайте ими до 100% стоимости покупок!</p>'),t('<p id="cheaper-popover-second-info">1 бонус = 1 рубль скидки</p>'),t("<div/>",{class:"text-right"}).append(a))),t("body").on("click",".buy-cheaper",function(o){o.preventDefault();var n=t(this);i.appendTo("body"),e.appendTo("body"),a.attr("href",n.closest("a").attr("href")||"/prozapass"),e.show();var r=n.get(0).getBoundingClientRect(),d=e.get(0).getBoundingClientRect().width,l=r.left+(r.width/2-d/2),s=r.bottom+t(window).scrollTop(),c=document.documentElement.clientWidth;return l+d>c&&(l=c/2-d/2),e.attr("style","left:"+l+"px !important;top:"+s+"px;z-index:10000;display: block"),!1}),i.click(function(){var t=i.get(0);if(t.remove instanceof Function)t.remove();else{var a=t.parentElement||t.parentNode;a instanceof Object&&a.removeChild instanceof Function&&t.removeChild(t)}e.remove()}),t(window).on("scroll resize",function(){i.trigger("click")})})}(jQuery),function(t){var e=t("[data-role=birth-date-input]");if(0!==e.length){var a="";e.keypress(function(){var e=t(this),i=e.val(),o=i.length<a.length;2===i.length&&!1===o&&e.val(i+="."),5===i.length&&!1===o&&e.val(i+="."),a=i}),e.change(function(){function e(){o.addClass("has-error"),o.find("p").text("Значение поля «Дата рождения» не должно превышать "+r+"."+d+"."+l+".")}var a=t(this),i=a.val().split("."),o=t(a.closest("div")),n=new Date,r=n.getDate(),d=n.getMonth()+1,l=n.getFullYear()-18;setTimeout(function(){if(3===i.length&&parseInt(i[2])>l&&e(),parseInt(i[2])===l){var t=n.getMonth()+1;(t<parseInt(i[1])||n.getDate()<parseInt(i[0])&&t===parseInt(i[1]))&&e()}},400)})}t.fn.Prozapass=function(e){var a={callback:null},i=t.extend({},a,e),o={},n=void 0,r=void 0,d=void 0,l=this,s={init:function(){o[t('META[name="csrf-param"]').attr("content")]=t('META[name="csrf-token"]').attr("content"),n=t(l),r=t("#register-btn",n),d=t("#prozapass-ajax-anim",n),r.on("click",function(){return s.register(),!1})},register:function(){d.show(),t.ajax({url:r.data("url"),type:"post",data:o,cache:!1,dataType:"json",success:function(e){d.hide(),!0===e.result?t("#prozapass-register-status").html(e.message[0]):"function"==typeof i.callback?i.callback(e):(t("#prozapass-register-status").html("Произошла ошибка."),t.each(e.message,function(e,a){t("#prozapass-register-status").append("<p>"+a+"</p>")}))},error:function(){alert("Произошла неизвестная ошибка. Пожалуйста, обратитесь в техническую поддержку.")}})}};s.init()}}(jQuery),function(t,e){e.fn.relatedProductsByCategoriesWidget=function(){window.EVENT_RELATED_PRODUCTS_CATEGORY_SHOWED="related-for-product-card:category-showed";var t=e(this),a=t.find(".mobile-controls [data-role=dropdown-list]"),i=function(i){var o=a.find("[data-id="+i+"]");e("[data-role=list-item]",a).toggleClass("disabled",!1),o.closest("[data-role=list-item]").toggleClass("disabled",!0),e("[data-role=toggle-button] [data-role=title]",a).html(o.html()),e("[data-role=related-category-link]",t).attr("data-is-active",0).filter("[data-id="+i+"]").attr("data-is-active",1),e("[data-role=related-products-category]",t).attr("data-is-active",0).filter("[data-id="+i+"]").attr("data-is-active",1),e(window).trigger(window.EVENT_RELATED_PRODUCTS_CATEGORY_SHOWED)};e("[data-role=related-category-link]",t).on("click",function(){return i(e(this).data("id")),!1}),e("[data-role=list-item]",a).on("click",function(){return e("[data-role=toggle-button]",a).dropdown("toggle"),i(e(this).data("id")),!1}),e("[data-role=go-back-button]",t).on("click",function(){var a=e(this).parents("[data-role=related-products-category]").attr("data-id");e(this).parents("[data-role=related-products-category]").attr("data-is-active",0),t.find("[data-role=related-category-link]").filter("[data-id="+a+"]").attr("data-is-active",0)}),
e(window).on(window.EVENT_UPDATE_CART,function(a){var i=e(this);this==window&&(i=e(a.target));var o=i.closest("[data-role=related-products-category]");if(0!==o.length){var n=e("[data-role=related-category-link]",t).filter("[data-id="+o.data("id")+"]"),r=1;n.data("buyedProductsCount")&&(r+=n.data("buyedProductsCount")),n.find("span").remove(),n.data("buyedProductsCount",r),n.append(" <span>("+r+")</span>")}}),e(window).trigger(window.EVENT_INIT_PRODUCTS_SLIDER)}}(document,jQuery),function(t,e){e(function(){var t=e("[data-role=related-products-categories-page]");if(0!==t.length){var a=t.find("[data-role=related-products-category]");if(0!==a.length){var i=!1,o=function(){i||window.checkScreenType(window.SCREEN_MOBILE)||(i=!0,e.get().done(function(t){if(!1===t.result)return void n();a.each(function(){var a=e(this),i=a.data("id");t.data.hasOwnProperty(i)?(a.find(".loading-dots").replaceWith(t.data[i]),window.dispatchLazyLoadUpdateEvent()):n(i)}),e(window).trigger(window.EVENT_INIT_PRODUCTS_SLIDER),window.dispatchEvent(new CustomEvent(window.EVENT_PRODUCTS_LOADED))}).fail(n))},n=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;a.each(function(){var a=e(this);void 0!==t&&a.data("id")!==t||a.find(".loading-dots").replaceWith("Не удалось получить список аксессуаров.")})};o(),e(window).on(window.EVENT_CHANGE_SCREEN_TYPE,o)}}})}(document,jQuery),function(t,e){var a=this;window.EVENT_RELATED_FOR_PRODUCT_CARD_WIDGET_INIT="related-for-product-card:init",window.EVENT_RELATED_FOR_PRODUCT_CARD_WIDGET_SHOWED="related-for-product-card:showed",window.EVENT_RELATED_PRODUCTS_CATEGORY_SHOWED="related-for-product-card:category-showed";var i=!1,o=!1,n=function(){var n=e("[data-role=related-products-card-widget]");if(0!==n.length){var r=function(){if(!i){i=!0;var t=n.find(".loading-dots");e.get(n.data("url")).done(function(e){if(!1===e.result)return void t.replaceWith('<div class="alert alert-info">Не удалось получить список аксессуаров.</div>');t.replaceWith(e.html),n.relatedProductsByCategoriesWidget(),window.dispatchEvent(new CustomEvent(window.EVENT_PRODUCTS_LOADED)),window.dispatchLazyLoadUpdateEvent()}).fail(function(){t.replaceWith('<div class="alert alert-info">Не удалось получить список аксессуаров.</div>')})}};e(window).on(window.EVENT_CHANGE_SCREEN_TYPE,r);var d=function(t){var a=e("[data-role=toggle-related-products-widget]");if(!t&&parseInt(a.attr("data-showed"))||l(!parseInt(a.attr("data-showed"))),!t){var i=e("[data-role=related-products-card-widget-wrap]").parent(),o=window.checkScreenType(window.SCREEN_WIDE,window.SCREEN_DESKTOP)?parseInt(e(window.SELECTOR_HEADER_SEARCH).height()):parseInt(e(window.SELECTOR_MOBILE_HEADER).height());e("HTML, BODY").animate({scrollTop:parseInt(i.offset().top)-o},1e3)}return!1};r(),!1===o&&(e(t).on("click","[data-role=toggle-related-products-widget]",d.bind(a,!0)),e(t).on("click","[data-role=link-to-related-products-widget]",d.bind(a,!1)),o=!0),e(window).on(window.EVENT_ANALOGS_FOR_PRODUCT_CARD_WIDGET_SHOWED,function(){l(!1)});var l=function(t){!0===t?(e("[data-role=toggle-related-products-widget]").attr("data-showed",1),e("[data-role=related-products-card-widget-wrap]").addClass("showed"),n.removeClass("hidden"),e(window).trigger(window.EVENT_RELATED_FOR_PRODUCT_CARD_WIDGET_SHOWED)):(e("[data-role=toggle-related-products-widget]").attr("data-showed",0),e("[data-role=related-products-card-widget-wrap]").removeClass("showed"),n.addClass("hidden"))};e(window).on(window.EVENT_UPDATE_CART,function(t){var a=e(this);window===this&&(a=e(t.target)),a.data("product-guid")===n.data("main-product-guid")&&(l(!0),window.checkScreenType(window.SCREEN_TABLET)&&e("html, body").animate({scrollTop:a.offset().top-40},300))})}};e(n),window.addEventListener(window.EVENT_RELATED_FOR_PRODUCT_CARD_WIDGET_INIT,n)}(document,jQuery),$(document).ready(function(){$(".marks-filter-chechbox .mark-item").click(function(){$(this).parents(".marks-filter-chechbox").find('a[data-toggle="dropdown"]').empty().append($(this).clone()).append('<span class="caret"></span>')}),$(".add-review-btn").click(function(){return $(".add-review-form").toggle(),!1}),$(".add-review-form .mark-selector .star-item").click(function(){var t=$(this).closest(".mark-line").find(".star-item");t.removeClass("active");for(var e=$(this).data("val"),a=0;a<=e-1;a++)t.eq(a).addClass("active");$(this).siblings().find("input[type=hidden].rating-val").val(e)})}),function(t,e,a){function i(){function t(){u=f.find(d),u.click(function(){c.prop("disabled",!1).show(),f.empty().hide()})}s=e(n),0!==s.length&&(c=s.find(r),f=s.find(l),h=parseInt(s.data("limit")),p=s.data("count"),p=""===p?null:parseInt(p),c.click(function(){c.prop("disabled",!0),e.ajax({url:c.data("form-url"),type:"GET",dataType:"JSON",success:function(e){!0===e.result&&(f.html(e.content).show(),c.hide(),t())},error:function(t){alert(t.responseText)}})}),f.on("submit","FORM",function(){var i=e(this),o=i.serializeArray();return window.dispatchEvent(new CustomEvent(window.EVENT_SUBMIT_REVIEW_WIDGET,{detail:{params:o}})),e.ajax({url:i.attr("action"),type:"POST",dataType:"JSON",data:o,success:function(e){f.find("form").html(e.content),t(),!0===e.result&&a!==e.review&&c.prop("disabled",!1).show()},error:function(t){alert(t.responseText)}}),!1}),0!==p&&o())}function o(){var t={};t.limit=h,e.ajax({url:s.data("request-url"),type:"GET",data:t,dataType:"JSON",success:function(t){!0===t.result&&s.find("[data-role=clubexp-reviews]").prepend(t.content)},error:function(t){alert(t.responseText)}})}window.EVENT_SUBMIT_REVIEW_WIDGET="reviewWidget:submit";var n="#w-review-widget",r="[data-role=add]",d="[data-role=cancel]",l="[data-role=review-form]",s=void 0,c=void 0,u=void 0,f=void 0,p=void 0,h=void 0;e(function(){i(),window.addEventListener(window.EVENT_INIT_REVIEWS_WIDGETS,i)})}(document,jQuery),function(t){var e=void 0,a=void 0,i=void 0;t(function(){e=t("#configuration-card"),0!==e.length&&(a=e.find('[data-role="configuration-save"]'),i=a.find('[data-role="configuration-save-btn"]'),i.on("click",function(){var e=t(this);e.prop("disabled")||(e.prop("disabled",!0),t.ajax({url:e.data("url"),type:"GET",dataType:"JSON",success:function(t){if(!1===t.result)return void alert("Не удалось применить изменения");e.removeClass("btn-save").html("Сохранено")}}))}))})}(jQuery),function(t){var e=void 0,a=void 0,i=void 0,o=void 0,n=void 0,r=void 0,d=void 0,l=void 0,s=void 0,c=void 0,u=void 0,f=void 0,p=void 0,h=void 0,v=void 0;t(function(){if(e=t("#configuration-preview-page"),0!==e.length){a=e.find('[data-role="save-configuration"]'),o=a.find('[data-role="save-configuration-btn"]'),i=a.find('[data-role="save-alert"]'),n=i.find('[data-role="apply-configuration"]'),r=i.find('[name="configuration-title"]'),d=i.find('[name="show-in-profile"]'),v=e.find(".products-list-header");var l=r.val(),s=d.is(":checked");o.on("click",function(e){e.preventDefault(),t.getJSON(a.data("save-url"),function(t){!1!==t.result&&(n.data("guid",t.rsuStatusData.configurationGuid),o.addClass("hidden"),i.removeClass("hidden"))})}),i.on("change keyup","input",function(){var t=!1;l!==r.val()&&(t=!0),s!==d.is(":checked")&&(t=!0),t?(n.prop("disabled",!1),n.text("Применить")):n.prop("disabled",!0)}),n.on("click",function(){var e=t(this);if(!e.prop("disabled")){e.prop("disabled",!0);var a=r.val(),i=d.is(":checked")?1:0;t.ajax({url:e.data("url"),type:"POST",data:{guid:e.data("guid"),title:a,showInProfile:i},dataType:"JSON",success:function(o){if(!1===o.result)return void alert("Не удалось применить изменения");e.text("Применено"),l=a,s=!!i,v.find("h2").fadeOut(300,function(){t(this).text(a).fadeIn(300)}),r.trigger("change")}}).then(function(){r.trigger("change")})}})}}),t(function(){l=t("#rsu-vendor-controls"),0!==l.length&&(c=l.find('[data-role="apply-vendor"]'),s=l.find("#vendor-controls-checkbox"),s.on("change",function(){s.is(":checked")?l.find(".controls-element").addClass("active"):l.find(".controls-element").removeClass("active")}),c.on("click",function(){var e={name:l.find('[name="configuration-name"]').val(),pageGuid:l.find('[name="vendor-page"]').val(),isVendor:s.is(":checked")?1:0,configurationGuid:c.data("guid")},a=l.find("input, button");a.prop("disabled",!0),t.post(c.data("save-url"),e,function(t){!1!==t.result&&a.prop("disabled",!1)},"json")}))}),t(function(){u=t("#rsu-author-controls"),0!==u.length&&(p=u.find('[data-role="apply-author"]'),f=u.find("#author-controls-checkbox"),f.on("change",function(){f.is(":checked")?u.find(".controls-element").addClass("active"):u.find(".controls-element").removeClass("active")}),h=u.find("#configuration-author-nickname"),p.on("click",function(){var e={nickname:h.val(),isAuthor:f.is(":checked")?1:0,configurationGuid:p.data("guid")},a=u.find("input, button"),i=u.find(".error-text");a.prop("disabled",!0),h.parent().removeClass("has-success").removeClass("has-error"),i.removeClass("active"),t.post(p.data("save-url"),e,function(t){if(!1===t.result)return h.parent().addClass("has-error"),i.html(t.error).addClass("active"),void a.prop("disabled",!1);u.html("Ваши данные сохранены. Чтобы стать автором, Вы должны выкупить конфигурацию.")},"json")}))})}(jQuery),function(t){var e=void 0;t(function(){function a(){return parseInt(e.attr("data-current-step"))}function i(t){e.attr("data-current-step",t),r.filter(":not(.always-shown)").addClass("hidden"),n.addClass("hidden"),o.addClass("hidden"),d.addClass("hidden"),d.find("span").html(t),0===t?n.removeClass("hidden"):l===t?(r.removeClass("hidden"),o.removeClass("hidden"),d.removeClass("hidden")):(o.removeClass("hidden"),n.removeClass("hidden"),d.removeClass("hidden"))}if(e=t("#configurator-tutorial"),0!==e.length){var o=e.find("[data-role=go-prev-step]"),n=e.find("[data-role=go-next-step]"),r=e.find("[data-role=finish-tutorial]"),d=e.find("[data-role=step-info]"),l=parseInt(e.attr("data-steps-count"));n.on("click",function(){i(a()+1)}),o.on("click",function(){i(a()-1)}),r.on("click",function(){t.ajax(e.data("finish-url")),e.addClass("hidden")}),e.find(".close-link").on("click",function(){e.addClass("hidden")}),t(document).find("[data-role=show-tutorial]").on("click",function(){i(0),e.removeClass("hidden")})}})}(jQuery),function(t){var e=void 0,a=void 0,i=void 0,o=void 0;t(function(t){e=t("#top-vendors-configurations-slider"),0!==e.length&&(a=t("ul",e).owlCarousel({items:1,itemsMobile:[479,1],itemsTablet:[window.SCREEN_TABLET_MAX_WIDTH,1],itemsDesktopSmall:[window.SCREEN_DESKTOP_MAX_WIDTH,1],itemsDesktop:[window.SCREEN_DESKTOP_MAX_WIDTH,1],pagination:!0,rewindNav:!0,stopOnHover:!0,slideSpeed:500,paginationSpeed:500,rewindSpeed:500}),t(".next",e).click(function(){a.trigger("owl.next")}),t(".prev",e).click(function(){a.trigger("owl.prev")}))}),t(function(t){i=t("#top-users-configurations-slider"),0!==i.length&&(o=i.children("ul").owlCarousel({items:1,itemsMobile:[479,1],itemsTablet:[window.SCREEN_TABLET_MAX_WIDTH,1],itemsDesktopSmall:[window.SCREEN_DESKTOP_MAX_WIDTH,1],itemsDesktop:[window.SCREEN_DESKTOP_MAX_WIDTH,1],pagination:!0,rewindNav:!0,stopOnHover:!0,slideSpeed:500,paginationSpeed:500,rewindSpeed:500}),t(".next",i).click(function(){o.trigger("owl.next")}),t(".prev",i).click(function(){o.trigger("owl.prev")}))})}(jQuery),function(t){window.EVENT_CONFIGURATOR_CATALOG_IS_LOADED="configurator-catalog:is-loaded";t(function(){var e=['[data-role="add-item-to-configuration"]','[data-role="add-item-to-configuration-link"]'].join(",");0!==t(e).length&&t(document).on("click",e,function(e){e.preventDefault();var a=t(this);a.data("in-configuration")||(a.prop("disabled",!0),t.post(a.data("url"),{productGuid:a.data("product-guid")},function(t){if(t.result){if("add-item-to-configuration"===a.data("role"))return window.location.href=a.data("redirect-url");if("add-item-to-configuration-link"===a.data("role"))return window.open(a.attr("href"),"_blank")}},"JSON").then(function(){a.prop("disabled",!1)}))})})}(jQuery),function(t){var e=void 0,a=void 0,i=void 0;t(function(){if(e=t("#configuration-image-slider"),0!==e.length&&(a=e.find(".image-slider-wrap"),i=e.find(".thumbs-slider-wrap"),a.find(".img").length)){var o=function(e,a){var i=t(".image-slider",e).owlCarousel(a),o=i.data("owlCarousel");return t(".button.right",e).click(function(){return o.next(),!1}).show(),t(".button.left",e).click(function(){return o.prev(),!1}).show(),o},n=o(i,{items:4,itemsMobile:[479,4],itemsTablet:[window.SCREEN_TABLET_MAX_WIDTH,5],itemsDesktopSmall:[window.SCREEN_DESKTOP_MAX_WIDTH,5],itemsDesktop:[window.SCREEN_DESKTOP_MAX_WIDTH,4],dots:!1,afterAction:!1}),r=o(a,{items:1,itemsMobile:[479,1],itemsTablet:[window.SCREEN_TABLET_MAX_WIDTH,1],itemsDesktopSmall:[window.SCREEN_DESKTOP_MAX_WIDTH,1],itemsDesktop:[window.SCREEN_DESKTOP_MAX_WIDTH,1],dots:!1,afterAction:function(){"object"===(void 0===n?"undefined":_typeof(n))&&(i.find(".owl-item .thumb").removeClass("active").eq(this.owl.currentItem).addClass("active"),n.visibleItems[n.visibleItems.length-1]<this.owl.currentItem?n.goTo(this.owl.currentItem):n.visibleItems[0]>this.owl.currentItem&&n.goTo(this.owl.currentItem))},afterInit:function(){a.find(".img").removeClass("transparent")}});i.find(".owl-item .thumb").hover(function(){r.goTo(t(this).parent().index())})}})}(jQuery),function(t){t(function(){t("body").on("click",'[data-role="configuration-buy-widget"] .tab-controls a',function(e){e.preventDefault();var a=t(this);if(a.is(".disabled"))return!1;a.siblings().each(function(){t(this).removeClass("active"),t("#"+t(this).data("target")).addClass("hidden")}),a.addClass("active"),t("#"+a.data("target")).removeClass("hidden")})})}(jQuery),function(t){function e(e){!0===e?O.attr("data-is-default-state","1"):(O.attr("data-is-default-state","0"),O.data("hide-default-initial-message",1),O.find(".default-state-block .initial-message").addClass("hidden"),t(".default-state-message").remove()),t(window).trigger(window.EVENT_RSU_CONFIGURATOR_DEFAULT_STATE_CHANGED)}function a(){function e(){if(t(".add-item-to-configurator-arrow").remove(),"1"===O.attr("data-is-default-state")&&!O.data("hide-default-initial-message")&&!window.checkScreenType(window.SCREEN_MOBILE)){var e=r.offset(),a=d.offset(),l=e.left+r.outerWidth()+10,s=e.top+r.outerHeight()/2,c=a.left+d.outerWidth()/2,u=a.top-10,f=getMiddlePointCoordinates(l,s,c,u,100,1);t(document.body).curvedArrow({x0:l,y0:s,x1:f.x,y1:f.y,x2:c,y2:u,arrowSize:o,lineWidth:n,arrowColor:i,objectCssClass:"add-item-to-configurator-arrow"})}}function a(){if(t(".required-category-info-arrow").remove(),t(".required-category-info-text").remove(),"1"===O.attr("data-is-default-state")&&!O.data("hide-default-initial-message")&&!window.checkScreenType(window.SCREEN_MOBILE)){var e=t(".configurator-groups .configurator-category:first-of-type .required-marker"),a=e.offset(),r=a.left+e.outerWidth()+100,d=a.top-30-36,l=a.left+e.outerWidth()+5,s=a.top+10,c=t("<div />").addClass("required-category-info-text").html("Обязательные комплектующие<br />отмечены звездочкой").css({position:"absolute",height:"36px",top:d+"px",left:r+"px"});t(document.body).append(c),d+=41;var u=getMiddlePointCoordinates(r,d,l,s,25,-1);t(document.body).curvedArrow({x0:r,y0:d,x1:u.x,y1:u.y,x2:l,y2:s,arrowSize:o,lineWidth:n,arrowColor:i,objectCssClass:"required-category-info-arrow"})}}var i="#888",o=7,n=1,r=O.find("#default-state-category-link"),d=t('.configurator-groups .group-categories:first > .configurator-category:first-of-type [data-role="show-catalog"]');r.on("click",function(t){t.preventDefault(),d.click()}),e(),a(),t('[data-role="hide-city-no-assembly-message"]').on("click",function(i){i.preventDefault(),t(this).closest(".default-state-message").remove(),a(),e()}),t(".alert").on("closed.bs.alert",function(){a(),e()}),t(window).on(["resize",window.EVENT_RSU_CONFIGURATOR_DEFAULT_STATE_CHANGED].join(" "),function(){a(),e()})}function i(a){N.css({width:a.requiredSelectedPercent+"%"}),O.find(s).text(a.requiredSelected),O.find(o).text(a.productsCount),O.find(n).text(a.assemblyMessage),O.find(d).text(a.orderPrice),O.find(l).text(a.availableDate),O.find(I).replaceWith(a.creditInfoHtml);var i=O.find(n).parent(),B=O.find(r);i.removeClass("trouble"),B.removeClass("active"),!1===a.isAvailableAssembly?(i.show(),t(c).addClass("inactive")):(O.find(u).text(a.assemblyPrice),O.find(f).text(a.assemblyDate),t(c).removeClass("inactive"),i.hide()),0!==a.productsCount?(A.parent().removeClass("inactive"),e(!1)):(A.parent().addClass("inactive"),e(!0)),!1===a.isAvailableOrder?(O.find(".order-info").addClass("inactive"),R.attr("disabled","disabled")):(O.find(".order-info").removeClass("inactive"),R.removeAttr("disabled")),t(h).parent().removeAttr("data-troubled"),x.removeClass("error").html("");for(var $ in a.incompatibleProducts){(function(e){if(!1===a.incompatibleProducts.hasOwnProperty(e))return"continue";t(p+'[data-product-guid="'+e+'"]').each(function(){var i=t(this),o=i.find('[data-role="compatibility-status-icon"]'),n=i.find(".category-name"),r=n.find(".configuration-message"),d=i.find(".compatibility-message-mobile"),l=a.incompatibleProducts[e],s=a.incompatibleCounters[e],c=0;if(i.find(m).addClass("hidden"),0===s.length&&""===l.countMessage)c=1,r.text("Совместимо"),d.text("Совместимо"),n.removeClass("error");else{if(r.text(""),d.text(""),n.addClass("error"),""!==l.countMessage){c=0;var u=t("<a>").addClass("pseudo-link").attr("data-content",l.comment).attr("data-toggle","popover").attr("data-trigger","hover").attr("data-html",!0).text("c "+l.countMessage),f=u.clone();f.attr("data-role","show-counter-tab").attr("data-counter-tab","compatibility");var p=u.clone();p.attr("data-placement","top"),r.text("Несовместимо ").append(f),d.text("Несовместимо ").append(p)}if(0!==s.length){var h=void 0,g=void 0;for(var w in s)!1!==s.hasOwnProperty(w)&&(h=t("<a>").addClass("pseudo-link").attr("data-role","show-counter-tab").attr("data-counter-tab",w).text("Подробнее"),g=t("<span />").addClass("counter-troubles").html(s[w]+" ").append(h),r.append(g),d.append(g.clone()),i.find(m).removeClass("hidden").find(v).attr("data-counter-tab",w))}}o.attr("data-compatibility-status",c),n.append(r)})})($)}a.duplicateCategories.forEach(function(e){var a=t(p+'[data-rsu-category-guid="'+e+'"]'),i=0;t.each(a,function(){t(this).data("product-guid")&&++i}),a.length===i&&a.find("[data-role=duplicate-category]").first().click()}),t(k+y+'[data-limited-one][data-limited-one!=""]').each(function(){-1===a.limitedOneCategories.indexOf(t(this).data("limited-one"))&&t(this).removeData("limited-one").removeProp("disabled")}),a.limitedOneCategories.forEach(function(e){t("["+E+'="'+e+'"]').find(k+y).prop("disabled",!0).data("limited-one",e)}),t(p).find('[data-role="required-marker"]').remove();a.requiredCategories.forEach(function(e){t(p+'[data-rsu-category-guid="'+e+'"]').eq(0).find('[data-role="category-name"]').parent().append('<span class="required-marker" data-role="required-marker">*</span>')}),!1===a.isAvailableAssembly?L.attr("disabled","disabled"):(L.removeAttr("disabled"),void 0!==window.ga&&window.ga("send","event","button","click",S),void 0!==window.yaCounterReachGoal&&window.yaCounterReachGoal(S)),t(document).trigger(window.EVENT_INIT_POPOVERS).trigger(window.EVENT_INIT_TOOLTIPS);var j=t('[data-role="logistic-troubles"]');if(0!==a.logisticTroubles.length){j.html("");for(var V in a.logisticTroubles)if(!1!==a.logisticTroubles.hasOwnProperty(V)){var M=t("<p>").html(a.logisticTroubles[V]);j.append(M)}j.removeClass("hidden")}else j.addClass("hidden");t(g).addClass("hidden");for(var U in a.optionalCategoriesData)if(!1!==a.optionalCategoriesData.hasOwnProperty(U)){var H=a.optionalCategoriesData[U],W=t(g+'[data-component-group="'+U+'"]'),G=H.count+" "+String.countPostfix(H.count,["дополнительный товар","дополнительных товара","дополнительных товаров"]),q=H.price+" "+String.countPostfix(H.price,["рубль","рубля","рублей"]),K=W.find('[data-role="optional-add-text"]');1===H.count?K.addClass("hidden"):K.removeClass("hidden"),W.removeClass("hidden").find(w).text(G).end().find(b).text(q)}for(var Q in a.eventNotifications)if(!1!==a.eventNotifications.hasOwnProperty(Q)){var Y=P.find(T+".event-notification-template").clone();Y.removeClass("event-notification-template").addClass("event-notification").find("p").text(a.eventNotifications[Q]),P.append(Y).removeClass("hidden")}if(R.attr("href",a.buyWithoutAssemblyLink),L.attr("href",a.buyWithAssemblyLink),null!==a.sameConfigurationLink&&(F.html(t(C).html()),F.find('[data-role="same-configuration-link"]').attr("href",a.sameConfigurationLink)),!0===a.canSaveConfiguration&&F.html(t(_).html()),null!==a.tabCompatibilities){x.text(t(h).eq(0).data("compatible-message")),D.html("");for(var z in a.tabCompatibilities)if(!1!==a.tabCompatibilities.hasOwnProperty(z)){var J=a.tabMessages[z];D.append(t(J));var X=t('[data-trouble-icon="'+z+'"]');if(X.parent().attr("data-troubled",!a.tabCompatibilities[z]),!0!==a.tabCompatibilities[z]){var Z=X.data("trouble-message"),tt=t("<a>").addClass("rsu-switcher-btn").attr("data-role","show-trouble-tab").attr("data-tab-name",z).text(Z);x.addClass("error").html(tt).append(t("<i>")),i.addClass("trouble"),B.addClass("active")}}}}window.EVENT_RSU_CONFIGURATOR_DEFAULT_STATE_CHANGED="rsu-configurator:default_state_changed",window.RSU_STATUS_WIDGET={updateData:i};var o='[data-role="configurator-items-counter"]',n='[data-role="assembly-message"]',r='[data-role="error-icon"]',d='[data-role="order-price"]',l='[data-role="available-date"]',s='[data-role="required-selected"]',c=".assembly-data",u='[data-role="assembly-price"]',f='[data-role="assembly-date"]',p='[data-role="category-block"]',h="[data-trouble-icon]",v='[data-role="show-counter-tab"]',m='[data-role="alert-counters"]',g='[data-role="optional-category-hint"]',w='[data-role="optional-count"]',b='[data-role="optional-price"]',T='[data-role="event-notification"]',E="data-rsu-category-guid",y=".product-count-plus",k='[data-role="change-product-count"]',C='[data-role="modal-template-has-same-configuration"]',_='[data-role="modal-template-can-save-configuration"]',I='[data-role="credit-info"]',S="configurator_button_buy_with_assembly_active",O=void 0,N=void 0,x=void 0,L=void 0,R=void 0,A=void 0,D=void 0,P=void 0,F=void 0;t(function(){if(O=t('[data-role="configurator-status-widget"]'),0!==O.length){var e=t("body");R=t('[data-role="buy-simple"]'),L=t('[data-role="buy-assembly"]'),x=t('[data-role="compatibility-troubles-message"]'),D=t('[data-role="compatibility-tabs"]'),P=t('[data-role="event-notifications"]'),N=t('[data-role="required-progress-bar"]'),A=t('[data-role="show-save-configuration-modal"]'),F=t('[data-role="modal-for-save-configuration-content"]'),i(window.RSU_INITIAL_DATA),e.on("click",function(e){var a=['[data-role="compatibility-tab"]','[data-role="show-trouble-tab"]',v,h,r],i=t(a.join(","));!1===i.is(e.target)&&0===i.has(e.target).length&&i.removeClass("open opened").parent().removeClass("mobile-show")}),O.on("click",'[data-role="clear-configuration"]',function(){var e=t(this);if(void 0!==e.attr("data-in-process"))return!1;e.attr("data-in-process",!0)}),O.on("click",'[data-role="pair-product-change"], [data-role="pair-product-remove"]',function(e){e.preventDefault();var a=t(this),i=a.closest('[data-role="pair-product"]'),o=i.data("product-guid"),n=t(p+'[data-product-guid="'+o+'"]');if(0!==n.length){var r=void 0;a.closest('[data-role="compatibility-tab"]').removeClass("open"),t('[data-role="show-trouble-tab"]').removeClass("opened"),t('[data-role="compatibility-tabs"]').removeClass("mobile-show"),"pair-product-change"===a.attr("data-role")?(r=n.find('[data-role="configurator-controls"] .btn-change'),t(window).scrollTop(n.offset().top)):"pair-product-remove"===a.attr("data-role")&&(r=n.find('[data-role="configurator-controls"] .btn-remove')),r.click()}}),O.on("click",'[data-role="change-power-item"]',function(e){e.preventDefault();var a=t(this),i=a.data("product-guid"),o=t(p+'[data-product-guid="'+i+'"]');0!==o.length&&(a.closest('[data-role="compatibility-tab"]').removeClass("open"),t('[data-role="show-trouble-tab"]').removeClass("opened"),t('[data-role="compatibility-tabs"]').removeClass("mobile-show"),t(window).scrollTop(o.offset().top),o.find('[data-role="configurator-controls"] .btn-change').click())}),O.on("click",".rsu-switcher-btn",function(e){e.preventDefault(),t(this).toggleClass("opened")}),O.on("click",'[data-role="show-trouble-tab"]',function(){var e=t(this),a=e.data("tab-name");e.hasClass("opened")?D.find('[data-tab-category="'+a+'"]').addClass("open"):D.find('[data-tab-category="'+a+'"]').removeClass("open")}),O.on("click",'[data-role="close-tab"]',function(e){e.preventDefault(),t(this).closest('[data-role="compatibility-tab"]').removeClass("open").parent().removeClass("mobile-show"),x.find(".rsu-switcher-btn").removeClass("opened")}),O.on("click",'[data-role="show-consumers"]',function(){var e=t(this),a=O.find('[data-role="consumer-list"]');e.hasClass("opened")?a.addClass("opened"):a.removeClass("opened")}),O.on("click",'[data-role="show-slot-groups"]',function(){var e=t(this),a=e.closest('[data-role="compatibility-tab"]').find(".counter-groups");e.hasClass("opened")?a.addClass("opened"):a.removeClass("opened")}),O.on("click",h,function(){t('[data-role="compatibility-tab"]').removeClass("open");var e=t(this),a=e.parent().attr("data-troubled");if(void 0!==a){var i=x.find('[data-role="show-trouble-tab"]');if(0!==i.length&&i.data("tab-name")===e.data("trouble-icon"))return i.click(),!1;a="true"===a;var o=a?e.data("trouble-message"):e.data("compatible-message");if(a?(x.addClass("error"),O.find(n).text("Проблема! "+o+". Сборка невозможна.")):x.removeClass("error"),"compatibility"===e.data("trouble-icon")&&!1===a)x.removeClass("error").text(o);else{var r=t("<a>").addClass("rsu-switcher-btn").attr("data-role","show-trouble-tab").attr("data-tab-name",e.data("trouble-icon")).text(o);x.html(r).append(t("<i>")),r.click()}}}),O.on("click",'[data-role="deficit-item"]',function(e){e.preventDefault();var a=t(this),i=a.data("product-guid"),o=t(p+'[data-product-guid="'+i+'"]');a.closest('[data-role="compatibility-tab"]').removeClass("open"),t('[data-role="show-trouble-tab"]').removeClass("opened"),t('[data-role="compatibility-tabs"]').removeClass("mobile-show"),o.find('[data-role="show-product-card"]').eq(0).click(),t(window).scrollTop(o.offset().top)}),O.on("click",r,function(){!1!==t(this).hasClass("active")&&D.toggleClass("mobile-show")}),O.on("click",'[data-role="share-btn"]',function(){if(""===t('[data-role="configuration-link"]').val()){var e=t(this),a=e.data("url");e.toggleClass("disabled"),t.getJSON(a,function(a){!1!==a.result&&(t('[data-role="configuration-link"]').val(a.shareUrl),t('[data-role="shared-link"]').toggleClass("hidden"),e.toggleClass("disabled"))})}else t('[data-role="shared-link"]').toggleClass("hidden")}),O.on("click",'[data-role="save-configuration"]',function(e){e.preventDefault();var a=t(this),i=a.data("save-url");a.prop("disabled",!0),t.getJSON(i,function(t){!1!==t.result&&(window.location.href=t.previewUrl)})}),O.on("click",'[data-role="close-event-notification"]',function(e){e.preventDefault(),t(this).closest(T).remove(),0===P.find(".event-notification").length&&P.addClass("hidden")}),e.on("click",v,function(e){e.preventDefault();var a=t(this),i=a.data("counter-tab");t('[data-trouble-icon="'+i+'"]').click(),t(window).scrollTop(t('[data-role="configurator-status-widget"]').offset().top)}),a()}})}(jQuery),function(t,e){var a=void 0,i=void 0,o=void 0;e(function(){a=e(".category-items-phone").find(".menu-rsu"),0!==a.length&&(i=e(".menu-content",a),o=e('[data-role="rsu-menu-switcher"]',a),o.on("click",function(){return i.toggleClass("shown"),i.hasClass("shown")&&(i.get(0).scrollTop=0),!1}))})}(document,jQuery),function(t){function e(){var e=n.find([a,i].join(","));0===t(o+":checked").length?e.attr("disabled",!0):e.removeAttr("disabled")}var a='[data-role="cancel"]',i='[data-role="remove-selected"]',o='[name="profile-configuration-action"]',n=void 0,r=void 0,d=void 0,l=void 0;t(function(){if(n=t('[data-role="rsu-user-configurations-control"]'),0!==n.length){r=n.find('[data-role="select-all"]'),d=n.find(a),l=n.find(i),r.on("click",function(){t(o).prop("checked",!0),e()}),d.on("click",function(){t(o).prop("checked",!1),e()});var s=void 0;l.on("click",function(){var e=t(o+":checked");if(0!==e.length){var a=[];t(".rsu-user-configuration").removeAttr("data-mark-deleted"),e.each(function(){t(this).closest(".rsu-user-configuration").attr("data-mark-deleted",!0),a.push(t(this).data("configuration-guid"))}),void 0!==s&&s.abort(),s=t.post(n.data("remove-url"),{rsuGuids:a},function(e){!1===e.result&&t(".rsu-user-configuration").removeAttr("data-mark-deleted"),t(".rsu-user-configuration[data-mark-deleted]").remove()},"json")}}),t(".dropdown-link-mobile").on("click",function(e){e.preventDefault(),t(this).toggleClass("expanded")}),t(o).on("change",e)}})}(jQuery),function(t,e,a){e.EVENT_RSU_CATALOG_AJAX_REQUEST_PARAMS_CHANGE="rsu-user-catalog:ajax-params-change";var i=void 0,o=void 0,n=void 0,r=void 0,d=void 0,l={groupBy:0,sortBy:0,mode:0,page:1},s=[],c=void 0,u={onSuccess:function(a){var i=parseInt(a.data.totalCount);if(1===parseInt(l.page)){r.toggleClass("hidden",0===i).text("("+i+" шт)");var n=t(a.data.pickedFilters);d.html(n),n.pickedFilters()}if(0===i)return void o.html("<h4>Конфигурации не найдены</h4>");var s=t(a.html);s.find('[data-role="configurations-group"]').each(function(){var e=t(this),a=e.data("group-key"),i=o.find('[data-role="configurations-group"][data-group-key='+a+"]");if(0!==i.length){var n=e.find('[data-role="group-configuration"]');i.append(n)}else o.append(e)});var c=s.find('[data-role="category-more"]');0!==c.length&&o.append(c),o.trigger(e.EVENT_INIT_POPOVERS),e.dispatchLazyLoadUpdateEvent()},onFail:function(){}},f=function(){a!==c&&c.abort(),1===l.page&&o.html("");var n=[];for(var r in l)if(!1!==l.hasOwnProperty(r)){var d=l[r];0!==d&&n.push(r+"="+d)}s.forEach(function(t){n.push(t.key+"="+t.value)});var f=t("<div><span /><span /><span /><span /></div>").addClass("loading-dots");o.find('[data-role="show-more"]').remove().end().append(f);var p=function(){f.remove(),c=a};c=t.get(i.data("get-catalog-configurations-url")+"?"+n.join("&"),p),c.then(u.onSuccess,u.onFail),a!==e.history&&e.history.pushState({},document.title,"?"+n.join("&"))},p=function(e){e.preventDefault();var a=t(this),i=a.closest('[data-role="ordering-dropdown"]'),o=parseInt(a.data("order-value")),n=a.text(),r=i.data("ordering-key");o!==l[r]&&(i.find('[data-role="order-type-selected"]').text(n),l.page=1,l[r]=o,f())},h=function(t,a){e.checkScreenType(e.SCREEN_DESKTOP,e.SCREEN_WIDE)&&e.FilterList(a.filterListId).submitFilters(!0)},v=function(t,e){l.page=1,s=e.data,f()},m=function(e){e.preventDefault();var a=t(this);l.page=1,l.mode=a.val(),f()},g=function(){var e=t(this);l.page=parseInt(e.data("page")),f()};t(function(){if(i=t('[data-role="rsu-user-catalog-container"]'),0!==i.length){d=i.find('[data-role="rsu-picked-filters"]'),o=i.find('[data-role="catalog-configurations"]'),r=i.find('[data-role="configurations-counter"]'),n=t(document).find('[name="filter-list-user-catalog"]');var a=document.location.href.split("?");if(2===a.length){var c=a.pop(),u=String.parseQueryString(c);for(var f in u)!1!==u.hasOwnProperty(f)&&(!0===l.hasOwnProperty(f)?l[f]=parseInt(u[f]):s.push({key:f,value:u[f]}))}i.on("click",['[data-role="select-group-by"]','[data-role="select-sort-by"]'].join(","),p),i.on("click",'[data-role="show-more"]',g),i.on("change",'[data-role="mode-switcher"]',m),n.each(function(){var a=t(this),i=a.closest(e.SELECTOR_FILTER_LIST_CONTAINER);i.on(e.EVENT_FILTER_LIST_SUBMIT,v),i.on(e.EVENT_FILTER_LIST_AFTER_CHANGE,h)}),n.on(e.EVENT_FILTER_LIST_SUBMIT,v)}})}(jQuery,window,void 0),function(t,e,a){function i(){h=e(l),v=e(d),0!==h.length&&(e(window).on(window.EVENT_SHOP_FILTERS_CHANGE,r),n(),e(u).on("click","a",function(){e(u).find("li").removeClass("active"),e(this).parent().addClass("active");var t=e(this).attr("aria-controls")
;e("[data-tab-content]").removeClass(f).not('[data-tab-content="'+t+'"]').addClass(f),"shops-map"===t&&(g.container.fitToViewport(),m?o():g.setBounds(w.getBounds(),{checkZoomRange:!0}))}),e(p).on("click",function(){if(m=e(this).closest(c),!1===e(u).is(":hidden")){var t=e('[aria-controls="shops-map"]'),a=e("html, body");t.click(),a.scrollTop()>t.offset().top&&a.animate({scrollTop:t.offset().top-100},500)}else o()}))}function o(){window.loadYandexMaps(function(){m&&g.setCenter([m.attr("data-latitude"),m.attr("data-longitude")],16,{checkZoomRange:!0}),m=a})}function n(){if(a===window.ymaps||a===window.PieChartClusterer)return void window.loadYandexMaps(function(){setTimeout(n)});var t=v.data("center");t===a&&(t="0,0"),g=new window.ymaps.Map(v.attr("id"),{center:t.split(","),zoom:17}),w=new window.PieChartClusterer,v.find(".map-item").each(function(){var t=e(this),a=t.data("coordinates"),i={preset:"islands#orangeCircleDotIcon",iconColor:t.data("sales-channel-color")};t.data("selected")&&(i={preset:"islands#redCircleDotIcon",zIndex:1e3}),0!==a.length&&(a=a.split(","),w.add(new window.ymaps.Placemark(a,{balloonContent:t.html(),clusterCaption:t.find("[data-role=shop-title]").text()},i))),b[t.attr("data-id")]=t.data("sales-channel-color"),t.remove()}),g.geoObjects.add(w),"0,0"===t&&g.setBounds(w.getBounds()),g.events.add("sizechange",function(){a===m&&g.setBounds(w.getBounds(),{checkZoomRange:!0})}),g.events.add("boundschange",function(t){t.get("newZoom")<=10&&T.load()}),0!==e(s).length&&r()}function r(){var t=e(c).not(".hidden");a!==g&&(g.geoObjects.removeAll(),0!==t.length&&(w.removeAll(),t.each(function(){var t=e(this),a=b[t.attr("data-id")],i=new window.ymaps.Placemark([t.data("latitude"),t.data("longitude")],{balloonContent:t.clone().prop("outerHTML")},{preset:"islands#orangeCircleDotIcon",iconColor:a});w.add(i)}),g.geoObjects.add(w),g.setBounds(w.getBounds(),{checkZoomRange:!0}),g.geoObjects.events.add("balloonopen",function(){window.dispatchEvent(new CustomEvent(window.EVENT_SHOP_BALLOON_OPEN))}),null!==T.clusterer&&g.geoObjects.add(T.clusterer)))}window.EVENT_SHOP_FILTERS_CHANGE="shop-filters:change",window.EVENT_MAP_INIT="shops-info-init",window.EVENT_SHOP_BALLOON_OPEN="map-balloon-open";var d='[data-role="ya-map-container"]',l='[data-role="shop-map"]',s='[data-role="shop-group"]',c=".shop-list-item",u='[data-role="mobile-tabs"]',f="mobile-hidden",p='[data-role="address"]',h=void 0,v=void 0,m=void 0,g=void 0,w=void 0,b={};e(window).on(window.EVENT_MAP_INIT,i);var T=function(){function t(){if(!i){i=!0;var t=e("[data-other-cities-shops-url]");if(0!==t.length){var o=t.attr("data-other-cities-shops-url"),n=t.attr("data-city-id");e.getJSON(o).done(function(t){a=new window.PieChartClusterer,t.sites.forEach(function(t){t.cities.forEach(function(e){e.id!==n&&e.shops.forEach(function(e){var i=['<div class="map-balloon-content ">','<div class="shop-list-item__title">'+e.name+"</div>",'<div class="shop-list-item__worktime shop-list-item__text_gray shop-list-item__text_small">'+e.worktime+"</div>","</div>"].join("");a.add(new window.ymaps.Placemark([e.latitude,e.longitude],{balloonContent:i,clusterCaption:e.name},{preset:"islands#orangeCircleDotIcon",iconColor:t.color}))})})}),g.geoObjects.add(a)})}}}var a=null,i=!1;return{load:t,clusterer:a}}()}(document,jQuery),function(t,e){e(function(){var t=e("[data-role=shop-cities-page]");0!==t.length&&t.on("click",".letter",{container:t},a)});var a=function(t){var a=e(this);if(!a.parent().hasClass("active")){var i=t.data.container,o=i.find(".cities"),n=i.find(".city-list li"),r=a.data("letter"),d=i.find(".cities-letters li");o.filter(".hide").removeClass("hide"),d.filter(".active").removeClass("active"),a.parent().addClass("active"),n.removeClass("hide"),0!==r.length&&(n.not('[data-city-letter="'+r+'"]').addClass("hide"),o.each(function(){var t=e(this);0===t.find(".city-list li:not(.hide)").length&&t.addClass("hide")}))}}}(document,jQuery),function(t){t.fn.SmsConfirm=function(e){var a={callback:null,cancelCallback:null};e=t.extend({},a,e);var i=void 0,o=void 0,n=void 0,r=void 0,d=this,l=0,s={init:function(){var e=t(d);i=t("#sms-confirm-send-btn",e),o=t("#sms-confirm-send-repeat-btn",e),n=t("a#sms-not-delivered",e),r=t("#sms-confirm-code",e),i.on("click",function(){return s.check(),!1}),r.on("keypress",function(t){13===t.which&&s.check()}),o.click(function(){return s.resend(),!1}),n.click(function(){return i.hide(),o.show(),t(this).hide(),!1})},check:function(){i.attr("disabled","disabled"),window.toggleLoaderVisibility(!0),t.ajax({url:"/sms-confirm/check/",type:"GET",dataType:"json",data:{session_guid:i.data("sms-confirm-session"),code:r.val()},success:function(a){i.removeAttr("disabled"),window.toggleLoaderVisibility(!1),a.result?(alert("Ваш номер телефона подтвержден."),"function"==typeof e.callback&&e.callback(a.result),t("#sms-confirm-block").hide()):(l++,alert(a.message)),l>=2&&s.initCancel()}})},resend:function(){window.toggleLoaderVisibility(!0),o.hide(),n.remove(),t.ajax({url:"/sms-confirm/resend/",type:"GET",dataType:"json",data:{session_guid:i.data("sms-confirm-session")},success:function(t){window.toggleLoaderVisibility(!1),i.show(),0===t.data.limitLeft&&s.initCancel(),!0===t.result?alert("Повторный код успешно отправлен."):""!==t.message?alert(t.message):alert("Произошла ошибка при отправке кода. Пожалуйста, повторите попытку позднее.")}})},initCancel:function(){"function"==typeof e.cancelCallback&&t("#buttons-block .cancel-confirm",t(d)).show().find("a").click(function(){return e.cancelCallback(),!1})}};s.init()}}(jQuery),function(t,e){e(function(){function t(){i.val().length?o.parent().show():o.parent().hide()}var a=e("#b-service-center-search");if(0!==a.length){var i=a.find('[name*="[manufacturerId]"]'),o=a.find('[name*="[specId]"]'),n=a.find("form");i.on("change",function(){var a=e(this);t(),e.ajax({url:n.data("url"),type:"GET",dataType:"json",data:{manufacturerId:a.val()},success:function(t){o.html(t.content).show(),e("#select2-servicecentersearchform-specid-container").removeAttr("title").empty(),e("<span/>",{class:"select2-selection__placeholder",text:"Все изделия"}).appendTo("#select2-servicecentersearchform-specid-container")}})}),t()}})}(document,jQuery),$(document).ready(function(){var t=[],e=[];$(document).on("click",'[data-role="get-profile-hint"]',function(a){a.preventDefault();var i=$(this),o=i.parent().siblings(".profile-hint-modal");if($(".profile-hint-modal").hide(),0!==o.length)return void o.toggle();if(void 0!==e[i.attr("data-uid")])return void i.parent().after(e[i.attr("data-uid")]);if(void 0!==window.getProfileHintUrl&&1!==t[i.attr("data-uid")]){var n=window.getProfileHintUrl+i.attr("data-uid");t[i.attr("data-uid")]=1,$.ajax({url:n,cache:!1,dataType:"JSON",success:function(t){i.parent().after(t.html),e[i.attr("data-uid")]=t.html},error:function(){alert("Не удалось получить данные профиля. Попробуйте позже"),t[i.attr("data-uid")]=0}})}}),$(document).on("click",function(t){$(t.target).closest(".profile-hint-modal").length||$(t.target).closest('[data-role="get-profile-hint"]').length||$(".profile-hint-modal").hide()})}),$(document).ready(function(){var t=!1;0!==$('[data-role="show-notifications"]').length&&($('[data-role="show-notifications"]').on("click",function(){var e=$(this),a=$(this).closest(".dropdown");a.hasClass("open")?($('[role="tooltip"]').hide(),$('[role="tooltip"]').removeClass("hidden"),a.toggleClass("open"),$(".notifications-block").toggleClass("open")):!0!==t?$.ajax({url:e.attr("data-url"),method:"get",cache:!1,dataType:"JSON",success:function(e){!0===e.result&&($('[data-role="notifications-block-content"]').html(e.html),t=!0,$('[role="tooltip"]').addClass("hidden"),a.toggleClass("open"),$(".notifications-block").toggleClass("open"))},error:function(){$('[data-role="notifications-block-content"]').html("При получении уведомлений произошла ошибка.")}}):($('[role="tooltip"]').addClass("hidden"),a.toggleClass("open"),$(".notifications-block").toggleClass("open"))}),$(document).on("click",function(t){$(t.target).closest('[data-role="show-notifications"]').length||$(t.target).closest(".notifications-block").length||($('[data-role="show-notifications"]').closest(".dropdown").removeClass("open"),$(".notifications-block").removeClass("open"))}),$('[data-role="notifications-menu-close"]').on("click",function(){$(".notifications-block").removeClass("open"),$('[data-role="show-notifications"]').closest(".dropdown").removeClass("open")}))}),$(document).ready(function(){$('[data-check-input="check-latin-symbols-entry"]').keyup(function(t){var e=$(this),a=/[a-zA-Z]/;e.siblings(".check-latin-symbols-entry-message").remove(),e.val().match(a)&&e.after("<p class='help-block check-latin-symbols-entry-message help-block-warning'>Мы работаем только с резидентами РФ</p>")})}),function(t){t.fn.profileTicketsLoad=function(){t(document).on("click",".load-more-tickets",function(e){e.preventDefault();var a=t(this),i=a.data("url"),o=t(".load-more-tickets-btn-wrap");return a.siblings(".alert").remove(),a.hide(),o.prepend('<div class="loading-dots"><span></span><span></span><span></span><span></span></div>'),t.ajax({url:i,cache:!1,dataType:"JSON",success:function(t){o.replaceWith(t.html)},error:function(){o.prepend('<div class="alert alert-danger">Не удалось загрузить сообщения. Повторите попытку позже.</div>'),t(".loading-dots",o).remove(),a.show()}}),!1})}}(jQuery),function(t){t.fn.profileOrdersBlock=function(){function e(e){var a=void 0,i=void 0;switch(e){case l:a='Коммерческое предложение <span data-role="order-number"></span> удалено',i="Вернуть удалённое коммерческое предложение";break;case r:case d:default:a='Заказ <span data-role="order-number"></span> удалён',i="Вернуть удалённый заказ"}var o=t("<div />").addClass("deleted-order alert alert-warning col-xs-12 row"),n=t("<div />").addClass("col-sm-7 order-number").html(a),s=t("<a />").attr("data-role","restore-button").html("<i></i><span>"+i+"</span>"),c=t("<div />").addClass("col-sm-5 restore-wrapper").append(s);return o.append(n,c),o}function a(){t(n).find(".modal-title").text("Отмена заказа"),t(n).find(".modal-text").text("Для отмены заказа вам необходимо авторизоваться в личном кабинете или зарегистрироваться на сайте."),t(n).modal("show")}function i(){t(n).find(".modal-title").text("Удаление заказа"),t(n).find(".modal-text").text("Для удаления заказа вам необходимо авторизоваться в личном кабинете или зарегистрироваться на сайте."),t(n).modal("show")}var o=this,n="[data-role=authorization-request-modal]",r=1,d=2,l=3,s=!1,c=!1;t(document).on("click",function(e){!1===t("[data-role=edit-call-request-popover-template]").is(e.target)&&0===t("[data-role=edit-call-request-popover-template]").has(e.target).length&&!1===t("[data-role=edit-call-request-button]").is(e.target)&&0===t("[data-role=edit-call-request-button]").has(e.target).length&&(t("[data-role=edit-call-request-button]").popover("destroy"),t("[data-role=edit-call-request-popover-template]").filter(".in").remove())}),t(document).on("click touchstart",".order-type-link",function(){var e=t(".status-filter",".user-orders-filter-form");t(".order-type-link").removeClass("active"),t(this).addClass("active"),e.val(t(this).data("status")),t(".user-orders-filter-form").trigger("submit")}),t(document).on("click touchstart",".order-search-input-button",function(){t(".user-orders-filter-form").trigger("submit")}),t(document).on("click touchstart",".order-date-input-button",function(){t("input[name="+t(this).data("input-name")+"]").trigger("focus")});var u=function(){var e=t(".user-orders-filter-form").data("url"),a=t(o).find(".user-orders-filter-form").serialize(),i=t(".overflow-orders","[data-role=order-list]"),n=t("[data-role=order-list]");i.removeClass("hide"),t.ajax({url:e+"?"+a,cache:!1,dataType:"JSON",success:function(e){var a=t(e.html);a.find('[data-toggle="tooltip"]').tooltip({container:"body",placement:"bottom"}),n.empty().append(a),t(".order-item").each(function(){var e=t(this).find(".order-info").outerHeight();t(this).find(".indent").css("min-height",e)}),t(document).trigger(window.EVENT_INIT_POPOVERS)},error:function(){n.prepend('<div class="col-xs-12 row"><div class="alert alert-danger">Не удалось загрузить заказы. Повторите попытку позже.</div></div>')},complete:function(){i.addClass("hide")}})};t(document).on("change submit",".user-orders-filter-form",function(t){return t.preventDefault(),u(),!1}),t(document).on("click",".load-more-orders",function(e){e.preventDefault();var a=t(this),i=a.data("url"),o=t(".load-more-orders-btn-wrap");return a.siblings(".alert").remove(),a.hide(),o.prepend('<div class="loading-dots"><span></span><span></span><span></span><span></span></div>'),t.ajax({url:i,cache:!1,dataType:"JSON",success:function(e){var a=t(e.html);a.find('[data-toggle="tooltip"]').tooltip({container:"body",placement:"bottom"}),o.replaceWith(a),t(document).trigger(window.EVENT_INIT_POPOVERS)},error:function(){o.prepend('<div class="col-xs-12 row"><div class="alert alert-danger">Не удалось загрузить заказы. Повторите попытку позже.</div></div>'),t(".loading-dots",o).remove(),a.show()}}),!1}),t(document).on("click",".cancel-order-button-confirm",function(){var e=t(".overflow-orders","[data-role=order-list]"),i=t("[data-role=order-list]"),o=t(this).attr("href"),n=t(".user-orders-filter-form");return e.removeClass("hide"),t.ajax({url:o+"&"+n.serialize(),cache:!1,dataType:"JSON",success:function(e){if(!0===e.result){var a=t(e.html);a.find('[data-toggle="tooltip"]').tooltip({container:"body",placement:"bottom"}),i.empty().append(a),t(document).trigger(window.EVENT_INIT_POPOVERS)}else i.prepend('<div class="col-xs-12 row"><div class="alert alert-danger">'+(e.message?e.message:"Не удалось отменить заказ. Повторите попытку позже.")+"</div></div>")},error:function(t){403===t.status?a():i.prepend('<div class="col-xs-12 row"><div class="alert alert-danger">Не удалось отменить заказ. Повторите попытку позже.</div></div>')},complete:function(){e.addClass("hide")}}),!1}),t(document).on("click",'[data-role="delete-button-confirm"]',function(){var a=t("[data-role=order-list]"),o=t(this).attr("href"),n=t(this).closest(".order-item");return n.addClass("removing"),t.ajax({url:o,method:"post",cache:!1,dataType:"JSON",success:function(i){if(!0===i.result){var o=t(document).find("#deleted-order-"+i.data.id);0===o.length&&(o=e(i.data.type_id),o.attr("id","deleted-order-"+i.data.id).find('[data-role="restore-button"]').attr("href",n.data("restore-url")).end().find('[data-role="order-number"]').html(i.data.number).end().find('[data-role="restore-button"]').data("id",i.data.id).data("type_id",i.data.type_id),n.after(o)),o.removeClass("hidden"),n.addClass("hidden"),t(document).trigger(window.EVENT_INIT_POPOVERS)}else a.prepend('<div class="col-xs-12 row"><div class="alert alert-danger">'+(i.message?i.message:"Не удалось удалить заказ. Повторите попытку позже.")+"</div></div>")},error:function(t){403===t.status?i():a.prepend('<div class="col-xs-12 row"><div class="alert alert-danger">Не удалось удалить заказ. Повторите попытку позже.</div></div>')},complete:function(){n.removeClass("removing")}}),!1}),t(document).on("click",'[data-role="restore-button"]',function(){var e=t(".overflow-orders","[data-role=order-list]"),a=t("[data-role=order-list]"),i=t(this).attr("href");return e.removeClass("hide"),t.ajax({url:i,data:{order_guid:t(this).data("id"),type_id:t(this).data("type_id")},cache:!1,method:"post",dataType:"JSON",success:function(e){!0===e.result?(1===t(document).find("#order-"+e.data.id).length&&(t(document).find("#order-"+e.data.id).removeClass("hidden"),t(document).find("#deleted-order-"+e.data.id).addClass("hidden")),t(document).trigger(window.EVENT_INIT_POPOVERS)):a.prepend('<div class="col-xs-12 row"><div class="alert alert-danger">'+(e.message?e.message:"Не удалось восстановить заказ. Повторите попытку позже.")+"</div></div>")},error:function(){a.prepend('<div class="col-xs-12 row"><div class="alert alert-danger">Не удалось восстановить заказ. Повторите попытку позже.</div></div>')},complete:function(){e.addClass("hide")}}),!1}),t(document).on("click","[data-role=show-postamat-modal]",function(){var e=t("#postamat-info-modal"),a=t(this),i="postamat-map-"+t.now();e.find(".map").remove(),e.find(".modal-title").html(a.data("postamat-name"));var o=e.find(".modal-body > .info"),n={place:a.data("postamat-placement"),metro:a.data("postamat-metro"),payment:a.data("postamat-payment"),address:a.data("postamat-address"),landmark:a.data("postamat-landmark"),worktime:a.data("postamat-worktime")+" ("+(1===a.data("postamat-opened")?"открыто":"закрыто")+" / "+a.data("postamat-waiting")+")"},r=t('<div class="row"></div>');""!==n.metro&&r.append('<div class="col-md-5"><p><b>Ближайшее метро:</b> '+n.metro+"</p></div>"),""!==n.address&&r.append('<div class="col-md-7"><p><b>Адрес:</b> '+n.address+"</p></div>"),""!==n.payment&&r.append('<div class="col-md-5"><p><b>Способ оплаты:</b> '+n.payment+"</p></div>"),""!==n.worktime&&r.append('<div class="col-md-7"><p><b>Время работы:</b> '+n.worktime+"</p></div>"),""!==n.place&&r.append('<div class="col-md-12"><p><b>Расположение:</b> '+n.place+"</p></div>"),""!==n.landmark&&r.append('<div class="col-md-12"><p><b>Как добраться:</b> '+n.landmark+"</p></div>"),o.html(r),o.after('<div id="'+i+'" class="map"></div>'),e.on("shown.bs.modal",function(){e.find(".modal-dialog").addClass("shown")}),e.find("[data-role=hide-modal]").on("click",function(){e.find(".modal-dialog").removeClass("shown"),setTimeout(function(){e.modal("hide")},200)}),e.modal("show"),window.loadYandexMaps(function(){var t=a.data("postamat-latitude"),o=a.data("postamat-longitude"),n=new window.ymaps.Map(i,{zoom:17,controls:["zoomControl","fullscreenControl","trafficControl"],behaviors:["default","scrollZoom"],center:[t,o]}),r=e.find('[class*="site-color-"]').css("color"),d=new window.ymaps.Placemark([t,o],{},{preset:"islands#icon",iconColor:r});n.geoObjects.add(d)})}),t("[data-role=order-list]").on("blur",'a[data-toggle="tooltip"]',function(){t('a[data-toggle="tooltip"]').tooltip("hide")}),t(document).on("click","[data-role=authorization-request-button]",function(){"cancel"===t(this).data("type")?a():"delete"===t(this).data("type")&&i()}),t(document).on("click","[data-role=open-call-request-modal-button]",function(e){e.preventDefault(),t("[data-role=edit-call-request-button]").popover("destroy");var a=t(this),i=t("#call-request-modal"),o=i.find("#create-call-request-form"),n=o.find("[data-role=create-call-request-order-guid-input]"),r=o.find("[data-role=create-call-request-text-input]");o.find("[data-role=create-call-request-form-error]").text("").addClass("hidden"),i.data("open-call-request-modal-button",a),n.val(a.data("order-id")),r.val("")}),t(document).on("click","[data-role=create-call-request-button]",function(){var e=t("#call-request-modal"),a=e.find("#create-call-request-form"),i=t("#call-request-accepted-modal");a.find("[data-role=create-call-request-form-error]").text("").addClass("hidden"),t.ajax({url:a.data("create-call-request-url"),data:a.serialize(),cache:!1,method:"POST",dataType:"JSON",success:function(o){if(o.html){e.data("open-call-request-modal-button").closest(".order-item").find("[data-role=open-call-request-modal-button]").each(function(){var e=t(this),a=t(o.html);a.addClass(e.data("visible")),a.attr("visible",e.data("visible")),e.replaceWith(a)}),e.modal("hide"),i.modal("show")}else o.errors&&a.find("[data-role=create-call-request-form-error]").text(o.errors).removeClass("hidden")}})}),t(document).on("click","[data-role=delete-call-request-button]",function(){var e=t(this),a=e.closest("[data-role=edit-call-request-form]"),i=t("[data-role=edit-call-request-button]").filter("[aria-describedby]");a.find("[data-role=edit-call-request-form-error]").text("").addClass("hidden"),t.ajax({url:a.data("delete-call-request-url"),data:a.serialize(),cache:!1,method:"POST",dataType:"JSON",success:function(e){if(e.result){i.popover("destroy");i.closest(".order-item").find("[data-role=edit-call-request-button]").each(function(){var a=t(this),i=t(e.html);i.addClass(a.data("visible")),i.attr("data-visible",a.data("visible")),a.replaceWith(i)})}else e.errors&&a.find("[data-role=edit-call-request-form-error]").text(e.errors).removeClass("hidden")}})}),t(document).on("click","[data-role=update-call-request-button]",function(){var e=t(this),a=e.closest("[data-role=edit-call-request-form]"),i=t("[data-role=edit-call-request-button]").filter("[aria-describedby]");a.find("[data-role=edit-call-request-form-error]").text("").addClass("hidden"),t.ajax({url:a.data("update-call-request-url"),data:a.serialize(),cache:!1,method:"POST",dataType:"JSON",success:function(e){if(e.result){var o=a.find("[data-role=edit-call-request-text-input]"),n=i.closest(".order-item"),r=n.find("[data-role=edit-call-request-button]"),d=o.val();o.text(d),a.find("[data-role=cancel-edit-call-request-button]").click(),r.each(function(){t(this).data("comment",d),t(this).attr("data-comment",d)})}else e.errors&&a.find("[data-role=edit-call-request-form-error]").text(e.errors).removeClass("hidden")}})}),t(document).on("click","[data-role=change-call-request-button]",function(){var e=t(this),a=e.closest("[data-role=edit-call-request-form]"),i=a.find("[data-role=delete-call-request-button]"),o=a.find("[data-role=cancel-edit-call-request-button]"),n=a.find("[data-role=update-call-request-button]"),r=a.find("[data-role=edit-call-request-text-input]");e.addClass("hidden"),i.addClass("hidden"),o.removeClass("hidden"),n.removeClass("hidden"),r.prop("disabled",!1).focus().text(r.text())}),t(document).on("click","[data-role=cancel-edit-call-request-button]",function(){var e=t(this),a=e.closest("[data-role=edit-call-request-form]"),i=a.find("[data-role=edit-call-request-text-input]"),o=a.find("[data-role=delete-call-request-button]"),n=a.find("[data-role=change-call-request-button]"),r=a.find("[data-role=update-call-request-button]");e.addClass("hidden"),r.addClass("hidden"),n.removeClass("hidden"),o.removeClass("hidden"),i.val(i.text()),i.prop("disabled",!0)}),t(document).on("click","[data-role=edit-call-request-button]",function(){var e=t(this),a=t("[data-role=edit-call-request-popover-template]"),i=t("[data-role=edit-call-request-popover-content]");if(t("[data-role=edit-call-request-button]").not(this).popover("destroy"),e.is("[aria-describedby]"))return void e.popover("destroy");var o=a.clone(),n=i.clone();n.find("[data-role=edit-call-request-form]").find("[data-role=edit-call-request-order-guid-input]").val(e.data("order-id")),n.find("[data-role=edit-call-request-form]").find("[data-role=edit-call-request-text-input]").text(e.data("comment")),e.popover({placement:"bottom",html:!0,template:o[0].outerHTML,content:n[0].outerHTML,container:".profile-order-page",trigger:"manual"}),e.popover("show")}),t(document).on("click",".show-more",function(){t(this).closest(".products").toggleClass("expanded")});t(document).on("show.bs.modal","[data-role=reserve-extend-modal]",function(){var e=t(this),a=e.find(".modal-body"),i=e.data("url");a.html("<b>Загрузка...</b>"),t.ajax({url:i,method:"GET",success:function(t){a.html(t)},error:function(){alert("Возниклка ошибка при загрузке данных")}})}),t(document).on("click",".reserve-extend-form [type=submit]",function(){var e=t(this),a=e.closest("form"),i=e.find(".modal-body");return i.html("<b>Выполнение...</b>"),t.ajax({type:"POST",url:a.prop("action"),data:a.serialize(),dataType:"JSON",cache:!1,success:function(t){!0===t.result?(i.html("<p>Резерв продлён.</p>"),window.location.reload()):""!==t.message&&i.html("<p>К сожалению, продлить резерв по заказу не удалось.</p><br><p>Пожалуйста, попробуйте позже.</p>")},error:function(){i.html("<p>Не удалось выполнить операцию, повторите попытку позже.</p>")}}),!1}),t(document).on("click","[data-role=button-kp-replace-product]",function(t){t.preventDefault();var e={orderId:this.dataset.orderId,productId:this.dataset.productId,productLineId:this.dataset.productLineId},a=document.createElement("div");document.body.appendChild(a),s=!0,window.commercialOfferReplaceProduct(e,a,function(){!0===(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&u(),document.body.removeChild(a),s=!1})}),t(document).on("click","[data-role=button-kp-delete-product-confirm]",function(){var e=t(".overflow-orders","[data-role=order-list]");return e.removeClass("hide"),t.ajax({url:t(this).attr("href"),cache:!1,method:"post",dataType:"JSON",success:function(t){e.addClass("hide"),t.result?u():alert(t.errors[0])},error:function(){e.addClass("hide"),alert("Не удалось выпонить операцию")}}),!1}),t(document).on("click","[data-role=button-kp-replace-product]",function(){if(!0!==s){var t={productGuid:this.dataset.productId},e=document.createElement("div");document.body.appendChild(e),s=!0,window.commercialOfferReplaceProduct(t,e,function(){document.body.removeChild(e),s=!1})}}),t(document).on("click","[data-role=send-order-email]",function(){if(!0!==c){var t={orderId:this.dataset.orderId},e=document.createElement("div");document.body.appendChild(e),c=!0,window.sendDocumentByEmailDialog(t,e,function(){document.body.removeChild(e),c=!1})}}),t(document).on("click","[data-role=change-city]",function(e){e.preventDefault();var a=t(this).data("city-id");window.sendChangeCityRequest(a,function(){window.location.reload()})}),t(document).on("change",'[data-role="contractor-checkbox"] input',function(e){var a=t(e.target),i=[];"all"===a.val()?t('[data-role="contractor-checkbox"] input').each(function(){"all"!==t(this).val()&&t(this).prop("checked",!1)}):t('[data-role="contractor-checkbox"] input').each(function(){"all"===t(this).val()?t(this).prop("checked",!1):t(this).is(":checked")&&i.push(t(this))}),0===i.length?t(".orders-filter-selected span").text("Все"):1===i.length?t(".orders-filter-selected span").text(i[0].closest("label").text()):t(".orders-filter-selected span").text(i.length+" знач.");var o=[];i.forEach(function(t){o.push(t.val())});var n=t(".user-orders-filter-form");n.find('[data-role="contractor-input"]').val(o.join(",")),n.submit()})}}(jQuery),function(t,e){var a="#profile-subscriptions";e(function(){a=e(a),0!==a.length&&a.find('[data-role="profile-subscription-toggle"]').on("click",function(){var t=e(this);return e.ajax({url:t.attr("href"),type:"POST",dataType:"JSON",success:function(e){!0===e.active?t.text("выкл"):t.text("включить")},error:function(t){alert(t.responseText)}}),!1})})}(document,jQuery),function(t){t.fn.profileUpdateForm=function(){function e(t,e){return'<div class="result-message '+(!0===t?"success":"error")+'">'+e+"</div>"}function a(a){t.ajax({type:"POST",url:f,cache:!1,dataType:"json",data:{phone:a},success:function(t){!0===t.result&&(l.data(o,a),l.data(n,1),s.addClass(i),c.addClass(r),c.after(e(!0,"Номер телефона успешно обновлен.")))},error:function(){c.after(e(!1,"Не удалось обновить информацию о вашем телефоне. Повторите попытку позже или обратитесь в техническую поддержку."))},always:function(){}})}var i="hidden",o="initial-value",n="approved",r="approved",d=t(this),l=t("#about-me-form-phonenumber",d),s=t(".phone-confirm-btn",d),c=l.siblings(".status-icon"),u=s.data("url"),f=s.data("update-phone-url"),p=t("#about-me-form-email",d),h=t(".email-confirm-btn",d),v=p.siblings(".status-icon"),m=h.data("url");d.on("submit",function(){var t=p.val().trim().toLowerCase(),e=p.data(o),a=p.data(n);return""===t||t===e||!a||confirm("Изменение e-mail адреса вступит в силу только после его подтверждения.")}),l.on("keyup",function(){return t(this).siblings(".result-message").remove(),11!=t(this).val().replace(/[^\d]/g,"").length?(s.addClass(i),c.removeClass(r),!1):t(this).val().replace(/[^\d]/g,"")!=t(this).data(o)?(s.removeClass(i),c.removeClass(r),!1):t(this).data(n)?(s.addClass(i),c.addClass(r),!1):void 0}),p.on("keyup",function(){t(this).siblings(".result-message").remove();var e=/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;return""!=t(this).val()&&e.test(t(this).val())?t(this).val()!=t(this).data(o)?(h.removeClass(i),v.removeClass(r),!1):t(this).data(n)?(h.addClass(i),v.addClass(r),!1):void 0:(h.addClass(i),v.removeClass(r),!1)}),h.on("click",function(a){a.preventDefault();var i=p.val().trim().toLowerCase();return p.siblings(".result-message").remove(),(i!=p.data(o)||!p.data(n))&&(!p.prop("readOnly")&&(p.prop("readOnly",!0),t.ajax({type:"POST",url:m,cache:!1,dataType:"json",data:{email:i},success:function(t){!0===t.result?v.after(e(!0,t.message)):""!==t.message&&v.after(e(!1,t.message))},error:function(){v.after(e(!1,"Сервис временно недоступен. Повторите попытку позже или обратитесь в техническую поддержку."))},always:function(){p.prop("readOnly",!1)}}),!1))}),s.on("click",function(i){i.preventDefault();var r=l.val().replace(/[^\d]/g,"");return l.siblings(".result-message").remove(),(r!=l.data(o)||!l.data(n))&&(t.ajax({type:"POST",url:u,cache:!1,dataType:"json",data:{phone:r},success:function(i){if(!0===i.result)if(i.data.phone_already_confirmed)c.after(e(!0,"Телефон уже подтвержден."));else{var o=t(i.html).modal();o.modal().SmsConfirm({callback:function(t){o.modal("hide"),t&&a(r)}})}else""!==i.message&&c.after(e(!1,i.message))},error:function(){c.after(e(!1,"Сервис временно недоступен. Повторите попытку позже или обратитесь в техническую поддержку."))}}),!1)})},t(function(){var e={placement:"right"};window.checkScreenType(window.SCREEN_MOBILE)&&(e.placement="top"),t("#about-me-form").find('[data-toggle="tooltip"]').tooltip(e)})}(jQuery),$(document).ready(function(){$("[data-role=birth-date-input]").change(function(){var t=$(this),e=t.val().split("."),a=$(t.closest("div")),i=new Date,o=i.getDate(),n=i.getMonth()+1,r=i.getFullYear()-18;setTimeout(function(){3===e.length&&parseInt(e[2])>r&&(a.addClass("has-error"),a.find("p").text("Значение «Дата рождения» не должно превышать "+o+"."+n+"."+r+"."))},400)}),$(".menu-profile li.active").parents("li").addClass("active").find(".list-group-item:first").click();var t={};t[$('META[name="csrf-param"]').attr("content")]=$('META[name="csrf-token"]').attr("content"),$(".btn-subscription").click(function(){var e=$(this);return $.ajax({type:"POST",cache:!1,data:t,url:e.data("subscription-url"),success:function(){e.closest("[data-role=switched]").setNextState()}}),!1})}),$(document).ready(function(){$(".vacancy-direct-link").click(function(){return window.prompt("",$(this).data("link")),!1})}),$(function(){!function(){function t(t){setTimeout(function(){t.val("")},500)}function e(t){var e=void 0;void 0===t?l.find(o).is(":checked")||(e=l.find(n),e=e.filter(function(t){return 0===t||!1===a($(this))})):e=l.find(n+"["+d+'="'+t+'"]'),void 0!==e&&0!==e.length&&(e.removeClass(r),e.last().find(i).removeClass(r))}function a(t){var e=0;return t.find("INPUT, TEXTAREA").map(function(){""!==$(this).val().trim()&&e++}),0===e}var i=".btn-add-job-experience",o='[data-role="collapse-job-experience"]',n=".job-experience-block",r="hidden",d="data-number",l=$("#p-vacancy-resume-page");if(0!==l.length){var s=l.find(n),c=l.find("#resume-send-success-modal");0!==c.length&&c.modal("show");var u=$("[data-role=city-dropdown]"),f=$('[data-role="vacancy-dropdown"]');l.on("change","#resumeexperienceform_0-startdate",function(){var e=new RegExp("\\d{2}-\\d{4}"),a=l.find("#resumeexperienceform_0-startdate"),i=a.val();if(!e.test(i)&&""!==i)return void alert("Дата приема имеет неверный формат.");var o=new Date,n=l.find("#resumeexperienceform_0-enddate").val();if(i=i.split("-"),parseInt(o.getFullYear())<parseInt(i[1])||parseInt(o.getFullYear())===parseInt(i[1])&&parseInt(o.getMonth())<parseInt(i[0]))return alert("Дата приема на работу ещё не наступила."),void t(a);e.test(n)&&(n=n.split("-"),(parseInt(i[1])>parseInt(n[1])||parseInt(i[1])===parseInt(n[1])&&parseInt(i[0])>parseInt(n[0]))&&(alert("Дата увольнения старше даты приема на работу."),t(a)))}),l.on("change","#resumeexperienceform_0-enddate",function(){
var e=new RegExp("\\d{2}-\\d{4}"),a=l.find("#resumeexperienceform_0-enddate"),i=l.find("#resumeexperienceform_0-startdate").val(),o=a.val();if(!e.test(o)&&""!==o)return void alert("Дата увольнения имеет не верный формат.");e.test(i)&&(i=i.split("-"),o=o.split("-"),(parseInt(i[1])>parseInt(o[1])||parseInt(i[1])===parseInt(o[1])&&parseInt(i[0])>parseInt(o[0]))&&(alert("Дата увольнения старше даты приема на работу."),t(a)))}),l.on("change","[data-role=city-dropdown]",function(){var t=u.val();f.html(""),f.attr("disabled","disabled"),$.ajax({url:f.data("get-vacancies-url"),dataType:"JSON",type:"GET",data:{city:t},success:function(t){var e=[];$.each(t,function(t,a){e.push({id:t,text:a}),f.append($("<option>",{value:"",text:"Выберите вакансию"})),f.append($("<option>",{value:t,text:a}))})}}),f.removeAttr("disabled")}),l.find(o).click(function(){$(this).is(":checked")?(s.addClass(r),s.find(i).addClass(r)):e()}),l.find(i).click(function(){var t=$(this);return t.addClass(r),e(parseInt(t.closest("["+d+"]").attr(d))+1),!1}),e()}}(),function(){var t=$(".job-next-button"),e=$(".job-block"),a=$(".job-block.sm"),i=$(".job-block-additional");t.click(function(){$(".nav-tabs > .active").next("LI").find("A").trigger("click")}),e.click(function(){e.removeClass("active"),a.removeClass("active"),i.hide();var t=$(this),o=t.data("job-guid");t.addClass("active"),$('*[data-job-guid="'+o+'"]').show()}),e.first().trigger("click"),a.first().addClass("active")}()}),function(t){t.fn.WishfulProduct=function(e){var a={callback:null};e=t.extend({},a,e);var i=void 0,o=void 0,n=void 0,r=void 0,d=void 0,l=this,s={init:function(){i=t(l),r=t("#get-form-btn",i),r.on("click",function(){return s.getForm(),!1})},initform:function(){d=t("#wishful-ajax-anim",i),o=t("#wishful-product-form",i),n=t("#submit-form-btn",i),n.on("click",function(){return s.submitForm(),!1})},submitForm:function(){d.show(),n.attr("disabled","disabled");var a=t("form",o);t.ajax({url:n.data("url"),type:"post",data:a.serialize(),cache:!1,dataType:"json",success:function(a){n.removeAttr("disabled"),d.hide(),!0===a.result?(o.remove(),r.removeAttr("disabled"),"function"==typeof e.callback&&e.callback(a)):(o.remove(),t(i).append(a.data.form),s.initform())},error:function(){alert("Произошла неизвестная ошибка. Пожалуйста, обратитесь в техническую поддержку.")}})},getForm:function(){r.attr("disabled","disabled"),t.ajax({url:r.data("action"),type:"get",cache:!1,success:function(e){t(i).append(e),s.initform()},error:function(){alert("Произошла неизвестная ошибка. Пожалуйста, обратитесь в техническую поддержку.")}})}};s.init()}}(jQuery),function(t,e,a){function i(t,i){a!==u&&u.abort();var o={};o[e('META[name="csrf-param"]').attr("content")]=e('META[name="csrf-token"]').attr("content");var n=function(t){i instanceof Function&&i(t),u=a};u=e.post(t,o,n),u.then(f.onSuccess,f.onFail)}window.EVENT_WISHLIST_LOGIN_MODAL_SHOW="wish-list-login-modal:show",window.EVENT_WISHLIST_LOGIN_MODAL_HIDDEN="wish-list-login-modal:hidden",window.EVENT_WISHLIST_END_ADD_BUTTON_CLICK="wish-list-btn:end-click",window.setAddWishlistButtonTargetWishlist=function(t,e){d===t.data(n)&&t.data(o,[e])},window.setDisableUpdateCurrentWishlist=function(t,e){t.data(r,e)};var o="wishlistIds",n="state",r="disable-wishlist-update",d="add",l=void 0,s=void 0,c=e('<div id="wishlist-login-modal" class="modal wishlist-login-modal fade" tabindex="-1" role="dialog" data-can-show="true"><div class="modal-dialog" role="document"><div class="arrow"></div> <div class="modal-content"><p><b>Товар добавлен в Избранное</b></p><p>Войдите в профиль, чтобы сохранить список. Несохраненный список будет очищен через 7 дней.</p><div class="row"><div class="btn modal-button btn-wishlist-modal-close pull-left" data-role="modal-button">Понятно, закрыть</div><div class="btn modal-button btn-wishlist-modal-login pull-right" data-role="modal-button" data-type="login-button">Войти</div></div></div> </div></div>'),u=void 0,f={onSuccess:function(t){!0===t.result&&(s.applySets(t.data.count>0?"active":"default",{totalCount:t.data.count}),e(window).trigger(window.EVENT_UPDATE_WISHLIST,t),e(window).trigger(window.EVENT_MOBILE_UPDATE_NOTIFIER,{activity:window.NOTIFY_ACTIVITY_WISHLIST,count:t.data.count}))},onFail:function(){e(window.SELECTOR_WISHLIST_BTN).attr("disabled",!1)}};e(t.body).ready(function(){l=e(window.SELECTOR_WISHLIST_BTN),s=e(window.SELECTOR_WISHLIST_BTN_GLOBAL),0!==s.length&&(s.initSets(!1),e(t.body).on("click",window.SELECTOR_WISHLIST_BTN,function(){var t=e(this),l=t.data("wishlist-url");return a!==t.data(o)&&t.data(o).length&&(l+="&"+t.data("wishlist-ids-param")+"="+JSON.stringify(t.data(o))),t.attr("disabled",!0),i(l,function(i){var l=c.find(".modal-dialog"),s=t.offset().top-e(window).scrollTop(),u=t.offset().left,f=t.outerHeight(),p=t.outerWidth(),h=0,v=0;e(window.SELECTOR_WISHLIST_BTN).attr("disabled",!1),d===t.data(n)&&t.data("show-login-modal")&&c.data("can-show")?(t.tooltip("hide"),c.data("wishist-button",t),e("body").prepend(c),window.SCREEN_MOBILE_MAX_WIDTH<e(window).width()&&(h=s+f+11+"px",v=u-l.outerWidth()+Math.round(p/2)+29+"px"),c.find(".modal-dialog").css({top:h,left:v}),c.modal("show",t)):d===t.data(n)?(t.attr("data-original-title",i.message||"Добавлен в избранное").tooltip("fixTitle").tooltip("show").data(o,[]),setTimeout(function(){t.tooltip("hide")},2e3)):"remove"===t.data(n)&&(t.attr("data-original-title",i.message||"Товар удален из списка").tooltip("fixTitle").tooltip("show").data(o,i.data.wishlistIds||[]),setTimeout(function(){t.tooltip("hide")},2e3)),t.setNextState(),!1!==t.data(r)&&a!==t.data(r)||t.trigger(window.EVENT_UPDATE_WISHLIST,i),e(window).trigger(window.EVENT_WISHLIST_END_ADD_BUTTON_CLICK,t.attr("id"))}),!1}),e(window).on(window.EVENT_PRODUCTS_LOADED,function(){var t=e(window.SELECTOR_WISHLIST_BTN),a=t.not(l);a.length&&(a.initSets(),l=t)}),c.on("hidden.bs.modal",function(){c.detach(),e(window).trigger(window.EVENT_WISHLIST_LOGIN_MODAL_HIDDEN)}),c.on("show.bs.modal",function(){c.detach(),e(window).trigger(window.EVENT_WISHLIST_LOGIN_MODAL_SHOW)}),c.on("click","[data-role=modal-button]",function(){var t=e(this);return e.ajax({url:c.data("wishist-button").data("remember-modal-closing-url"),type:"POST",success:function(t){if(!1===t.result)return!1;c.data("can-show",!1),l.data("show-login-modal",!1)},complete:function(){c.modal("hide"),t.is("[data-type=login-button]")&&(window.location.href=c.data("wishist-button").data("login-url"))}}),!1}))})}(document,jQuery),function(t){window.EVENT_INIT_WISHLIST_CHANGE_CITY_WIDGET="wishlist:changeCity_init",window.EVENT_WISHLIST_CITY_DELETED="wishlist:changeCity_cityDeleted",window.EVENT_WISHLIST_CITY_CHANGED="wishlist:changeCity_cityChanged",window.EVENT_WISHLIST_CITY_CONFIRMED="wishlist:changeCity_cityConfirmed";var e=function(){t("[data-role=wishlist-change-city-widget]").each(function(){var e=t(this),a=e.find("[data-role=dialog]"),i=e.find("[data-role=show-dialog]"),o=e.attr("data-wishlist-id"),n=e.attr("data-city-id"),r=e.attr("data-param-list-id"),d=e.attr("data-param-city-id"),l=e.attr("data-remove-url"),s=e.attr("data-update-url");if(!e.data("inited")){e.data("inited",!0);var c=function(){e.toggleClass("show-dialog",!1).toggleClass("confirm-remove",!1)};e.find("[data-role=confirm]").on("click",function(){return t(window).trigger(EVENT_WISHLIST_CITY_CONFIRMED,[o]),c(),!1}),i.on("click",function(){return e.toggleClass("show-dialog",!0),!1}),e.find("[data-role=show-remove-dialog]").on("click",function(){return e.toggleClass("confirm-remove",!0),!1});var u=function(){toggleLoaderVisibility(!1),alert("Не удалось изменить город подписки"),window.location.reload()},f=function(e){toggleLoaderVisibility(!0);var a={};return a[r]=o,a[d]=e,t.ajax({url:s,dataType:"JSON",type:"POST",data:a,success:function(e){!0===e.result?t(window).trigger(EVENT_WISHLIST_CITY_CHANGED,[o]):u()},error:u}).always(c),!1};e.find("[data-role=select-city]").on("click",function(){return window.showSelectCityModal(f,function(){},u,n),!1}),e.find("[data-role=remove-city]").on("click",function(){toggleLoaderVisibility(!0);var e=function(){toggleLoaderVisibility(!1),alert("Не удалось удалить город подписки"),window.location.reload()},a={};return a[r]=o,t.ajax({url:l,dataType:"JSON",type:"POST",data:a,success:function(a){!0===a.result?t(window).trigger(EVENT_WISHLIST_CITY_DELETED,[o]):e()},error:e}).always(c),!1}),t(window).on(window.EVENT_CHANGE_SCREEN_TYPE,function(){!1===window.checkScreenType(window.SCREEN_MOBILE)&&(a.css({width:"",left:""}),a.find(".corner").css({left:""}))}).on("resize",function(){!0===window.checkScreenType(window.SCREEN_MOBILE)&&(a.css({width:t(window).width()-1,left:-e.offset().left}),a.find(".corner").css({left:i.find("i").offset().left-4}))}).trigger(window.EVENT_CHANGE_SCREEN_TYPE).trigger("resize")}})};t(function(){e(),t(window).on(EVENT_INIT_WISHLIST_CHANGE_CITY_WIDGET,e)})}(jQuery),function(t){var e="[data-role=wishlist-share-widget]";t(function(){t(window).on("click",function(a){var i=t(a.target);!1===i.is(e)&&0===i.closest(e).length?t(e+" [data-role=show-input]").removeClass("active"):i.is("[data-role=show-input]")&&(t(e+" [data-role=show-input]").addClass("active"),window.checkScreenType(window.SCREEN_MOBILE,window.SCREEN_TABLET)&&(t(e+" [data-role=clipboard-button]").click(),t(e+" [data-role=show-input]").removeClass("active"),alert("Ссылка скопирована")))})})}(jQuery);