!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=798)}({1:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.SCREEN_NOT_SUPPORTED=0]="SCREEN_NOT_SUPPORTED",e[e.SCREEN_WIDE=1]="SCREEN_WIDE",e[e.SCREEN_DESKTOP=2]="SCREEN_DESKTOP",e[e.SCREEN_TABLET=3]="SCREEN_TABLET",e[e.SCREEN_MOBILE=4]="SCREEN_MOBILE"}(t.ScreenTypes||(t.ScreenTypes={}))},10:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Dom_dispatchEvent=function(e,t,n){var r=document.createEvent("CustomEvent");r.initCustomEvent(e,!1,!0,n),void 0===t?window.dispatchEvent(r):t.dispatchEvent(r)}},15:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=function(){function e(){var e=this;this._waitingElements=[],this.addWaitingState=function(t){r.Dom_addClasses(t,["ajs-placeholder","ajs-placeholder_waiting"]),e._waitingElements.push(t)}}return Object.defineProperty(e.prototype,"service",{set:function(e){this._service=e},enumerable:!0,configurable:!0}),e.prototype.afterRefresh=function(e){this._waitingElements.forEach(function(e){e.classList.remove("ajs-placeholder_waiting"),setTimeout(function(){e.classList.remove("ajs-placeholder")},1e3)}),this._waitingElements=[]},e}();t.AjaxStateProcessorAbstract=i},153:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.String_countPostfix=function(e,t,n,r){if(void 0===n&&(n=!1),0===e&&void 0!==r)return r;var i=0,o=e%10,s=e%100;2<=o&&o<=4&&(i=1),(0===o||o>=5&&o<=9||s>=11&&s<=19)&&(i=2);var E=t[Math.min(i,t.length)]||"";return n?E:e+" "+E}},236:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Bem_getElementClassName=function(e,t){return e+"__"+t}},4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Dom_addClasses=function(e,t){t.forEach(function(t){e.classList.add(t)})}},798:function(e,t,n){e.exports=n(799)},799:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(800);window.AjaxStateProcessorRegistrator.register("compare-button",new r.CompareButtonProcessor)},800:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(236),E=n(801),c=n(4),a=n(10),u=n(9),_=n(153),p=n(15),d=n(802),l=n(803),T=function(e){function t(){var t=e.call(this)||this;return t.BASE_CLASS="product-buttons",t.BASE_CLASS_BLOCK_ELEMENT="btn",t.BASE_CLASS_BLOCK_ELEMENT_ICON="btn-icon",t.BASE_CLASS_COMPARE_CHECKBOX="compare-checkbox",t.screen=new u.ScreenTypeHelper,t.states=new Map,t.types=new Map,t.checkboxes=new Map,t}return i(t,e),t.prototype.build=function(e){this.render(e,!0);var t=e.data;return{action:d.CompareButtonActionEnum.ACTION_INIT,product:t.product}},t.prototype.refresh=function(e){this.render(e,!1)},t.prototype.render=function(e,t){if(!0===t){var n=e.data;this.types.set(e.id,n.type)}else{n=e.data;if(a.Dom_dispatchEvent(window.EVENT_COMPARE_BUTTON_APPLY_MAIN_BTN_COUNT,void 0,n.totalCount),0!==n.totalCount&&this.states.has(e.id)&&this.screen.check(o.ScreenTypes.SCREEN_TABLET,o.ScreenTypes.SCREEN_MOBILE)){var r=["В сравнении",_.String_countPostfix(n.totalCount,["товар","товара","товаров"]),'<a href="/catalog/product/compare/" class="compare-popup__link">Смотреть</a>'].join(" ");r='<div class="compare-popup">'+r+"</div>",window.popup.show(r)}}switch(this.types.get(e.id)){case l.CompareButtonTypeEnum.TYPE_BUTTON:this.renderButton(e,t);break;case l.CompareButtonTypeEnum.TYPE_CHECKBOX:this.renderCheckbox(e,t)}},t.prototype.renderButton=function(e,t){var n,r,i=this,u=["compare-button","special"],_=!1===this.screen.check(o.ScreenTypes.SCREEN_MOBILE,o.ScreenTypes.SCREEN_TABLET);if(!0===t){var p=e.data;(n=document.createElement("a")).id=e.id,n.dataset.commerceTarget=p.commerceTarget,r=document.createElement("i"),c.Dom_addClasses(r,E.Bem_getElementClasses(this.BASE_CLASS,this.BASE_CLASS_BLOCK_ELEMENT_ICON,u)),n.appendChild(r);var d=document.getElementById(e.id);if(null===d)return;d.parentElement.insertBefore(n,d),n.addEventListener("click",function(){i.btnClickHandler(e)}),d.remove(),a.Dom_dispatchEvent(window.EVENT_INIT_TOOLTIPS)}else{p=e.data;if(r=(n=document.getElementById(e.id)).querySelector("."+s.Bem_getElementClassName(this.BASE_CLASS,this.BASE_CLASS_BLOCK_ELEMENT_ICON)),_&&this.states.has(e.id)&&this.states.get(e.id)!==p.active){n.dataset.originalTitle=p.active?"Добавлен к сравнению":"Убран из сравнения";var l=$(n);l.tooltip("show"),setTimeout(function(){l.tooltip("hide"),l.trigger("blur")},1e3)}this.states.set(e.id,p.active),!0===p.active&&u.push("active")}n.className="",c.Dom_addClasses(n,E.Bem_getElementClasses(this.BASE_CLASS,this.BASE_CLASS_BLOCK_ELEMENT,u)),_&&(n.dataset.originalTitle=!0===this.states.get(e.id)?"Убрать из сравнения":"Добавить к сравнению"),r.className="",c.Dom_addClasses(r,E.Bem_getElementClasses(this.BASE_CLASS,this.BASE_CLASS_BLOCK_ELEMENT_ICON,u))},t.prototype.renderCheckbox=function(e,t){var n=this;if(!0===t){var r=e.data,i=document.getElementById(e.id);if(null===i)return;var o={label:"Сравнить"},s=document.createElement("div");s.classList.add(this.BASE_CLASS_COMPARE_CHECKBOX);var E=window.controlCheckbox.draw(s,o);this.checkboxes.set(e.id,E),i.parentElement.insertBefore(s,i),E.element.dataset.commerceTarget=r.commerceTarget,E.input.addEventListener("change",function(){n.btnClickHandler(e)}),i.remove()}else{r=e.data,E=this.checkboxes.get(e.id);this.states.set(e.id,r.active),E.toggle(r.active,!1)}},t.prototype.btnClickHandler=function(e){this._service.updateState(e.id,{action:!0===this.states.get(e.id)?d.CompareButtonActionEnum.ACTION_REMOVE:d.CompareButtonActionEnum.ACTION_APPEND,product:e.data.product})},t}(p.AjaxStateProcessorAbstract);t.CompareButtonProcessor=T},801:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(236);t.Bem_getElementClasses=function(e,t,n){var i=[],o=r.Bem_getElementClassName(e,t);return i.push(o),n.forEach(function(e){i.push(o+"_"+e)}),i}},802:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.ACTION_INIT="init",e.ACTION_REMOVE="remove",e.ACTION_APPEND="append"}(t.CompareButtonActionEnum||(t.CompareButtonActionEnum={}))},803:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.TYPE_BUTTON=0]="TYPE_BUTTON",e[e.TYPE_CHECKBOX=1]="TYPE_CHECKBOX"}(t.CompareButtonTypeEnum||(t.CompareButtonTypeEnum={}))},9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(){function e(){var e=this;this.SCREEN_MOBILE_MIN_WIDTH=320,this.SCREEN_MOBILE_MAX_WIDTH=767,this.SCREEN_TABLET_MAX_WIDTH=991,this.SCREEN_DESKTOP_MAX_WIDTH=1199,this.EVENT_RESIZE="resize",this.EVENT_OPTIMIZED_RESIZE="optimizedResize",this.EVENT_SCREEN_TYPE_CHANGED="screenTypeChanged",this._currentScreenType=null,this.optimizeResizeEvent=function(t){var n=!1;(t=t||window).addEventListener(e.EVENT_RESIZE,function(){n||(n=!0,requestAnimationFrame(function(){t.dispatchEvent(new CustomEvent(e.EVENT_OPTIMIZED_RESIZE));var r=e.calcCurrent();e._currentScreenType!==r&&(e._currentScreenType=r,t.dispatchEvent(new CustomEvent(e.EVENT_SCREEN_TYPE_CHANGED))),n=!1}))})}}return Object.defineProperty(e.prototype,"current",{get:function(){return null===this._currentScreenType&&(this._currentScreenType=this.calcCurrent()),this._currentScreenType},enumerable:!0,configurable:!0}),e.prototype.calcCurrent=function(){var e=window.matchMedia;if(e){if(e("(min-width: "+(this.SCREEN_DESKTOP_MAX_WIDTH+1)+"px)").matches)return r.ScreenTypes.SCREEN_WIDE;if(e("(min-width: "+(this.SCREEN_TABLET_MAX_WIDTH+1)+"px)").matches)return r.ScreenTypes.SCREEN_DESKTOP;if(e("(min-width: "+(this.SCREEN_MOBILE_MAX_WIDTH+1)+"px)").matches)return r.ScreenTypes.SCREEN_TABLET;if(e("(min-width: "+(this.SCREEN_MOBILE_MIN_WIDTH+1)+"px)").matches)return r.ScreenTypes.SCREEN_MOBILE}else{var t=window.innerWidth;if(t>this.SCREEN_DESKTOP_MAX_WIDTH)return r.ScreenTypes.SCREEN_WIDE;if(t>this.SCREEN_TABLET_MAX_WIDTH)return r.ScreenTypes.SCREEN_DESKTOP;if(t>this.SCREEN_MOBILE_MAX_WIDTH)return r.ScreenTypes.SCREEN_TABLET;if(t>=this.SCREEN_MOBILE_MIN_WIDTH)return r.ScreenTypes.SCREEN_MOBILE}return r.ScreenTypes.SCREEN_NOT_SUPPORTED},e.prototype.check=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,r=e;n<r.length;n++){if(r[n]===this.current)return!0}return!1},e.prototype.addResizeListener=function(e){this.optimizeResizeEvent(window),window.addEventListener(this.EVENT_OPTIMIZED_RESIZE,e)},e.prototype.removeResizeListener=function(e){window.removeEventListener(this.EVENT_OPTIMIZED_RESIZE,e)},e.prototype.addChangeScreenTypeListener=function(e){this.optimizeResizeEvent(window),window.addEventListener(this.EVENT_SCREEN_TYPE_CHANGED,e)},e.prototype.removeChangeScreenTypeListener=function(e){window.removeEventListener(this.EVENT_SCREEN_TYPE_CHANGED,e)},e}();t.ScreenTypeHelper=i}});