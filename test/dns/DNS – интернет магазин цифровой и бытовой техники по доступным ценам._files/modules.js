function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function FilterBlockCompatibleProduct(t){FilterBlock.apply(this,[t])}function FilterBlockCheckboxList(t){FilterBlock.apply(this,[t])}function FilterBlockCheckbox(t){FilterBlock.apply(this,[t])}function FilterBlockInterval(t){FilterBlock.apply(this,[t])}function FilterBlockRadioList(t){FilterBlock.apply(this,[t])}function FilterBlockSelectShops(t){FilterBlock.apply(this,[t])}function FilterBlock(t){window.EVENT_FILTER_BLOCK_AFTER_CHANGE="filter-block:after-change",this.id=t,this.$block=void 0,this.isInitiated=!1}function RemainsFilterBlockShopWorkTime(t){window.FilterBlock.apply(this,[t])}function FilterBlockMarkdownProductType(t){FilterBlock.apply(this,[t])}function FilterBlockMarkdownShops(t){FilterBlockSelectShops.apply(this,[t])}var _get=function t(e,a,o){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,a);if(void 0===i){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,a,o)}if("value"in i)return i.value;var r=i.get;if(void 0!==r)return r.call(o)},_createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var o=e[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,a,o){return a&&t(e.prototype,a),o&&t(e,o),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){t.fn.actionProductsPage=function(){function e(){return K[0]}function a(e){W=t.extend(W,e);var a=t(this),i=[];Y.each(function(t,e){return i.push(e.dataset.value)}),K.push(a),t("input, select",a).change(function(){var e=t(this).closest("form");(e.data(M)===V&&Q.hasClass("shown")||e.data(M)===j)&&o(!1,function(t){!0===t&&d()})}),t(P).on("click",function(){var e=t(this);e.prop("disabled")||(e.siblings().prop("disabled",!1),e.prop("disabled",!0),q.mode=e.data("value"),updateQueryStringParam("mode",q.mode),i.forEach(function(e){t(h).toggleClass("view-"+e,q.mode===e)}))}),$=W.lastProductIndex}function o(a,o){void 0===a&&(a=!1),!1===a&&(q.offset=0);var r=e(),d=r.serializeArray();for(optionKey in q){var l=q[optionKey];if(null!==l)switch(void 0===l?"undefined":_typeof(l)){case"object":l.forEach(function(t,e){d.push({name:optionKey+"["+e+"]",value:t})});break;default:d.push({name:optionKey,value:l})}}void 0!==U&&U.abort(),!1===a&&i(!0);var s=[],c=[];d.forEach(function(t){""!==t.value&&(s[t.name]=t.value,c.push(t.name+"="+t.value))}),t(I).html(B),window.history.replaceState(s,window.document.title,window.location.pathname+"?"+c.join("&")),U=t.ajax({url:W.updateUrl,data:d,type:"get",contentType:"application/json",success:function(e){if(!1===e.result)return alert("Ошибка при получении данных. Пожалуйста, попробуйте позже."),void(void 0!==o&&o(!1));!0===a?t(m).append(e.html):t(m).html(e.html),t(k).text(String.countPostfix(e.filteredProductsCount,["товар","товара","товаров"],"нет товаров",!1)),t(I).text("Показать ("+e.filteredProductsCount+")"),t(document).trigger(window.EVENT_PRODUCTS_LOADED),dispatchLazyLoadUpdateEvent(),t.each(K,function(t,a){n(a,e.filtersOptions)}),H.toggleClass("hidden",!1===e.isNextLoadAvailable),!0===e.isNextLoadAvailable?!0===e.isNextLoadFinal?t(_,H).text("Показать все"):t(_,H).text("Показать ещё"):H.toggleClass("hidden",!0),void 0!==o&&o(!0),$=e.lastProductIndex},error:function(e){void 0!==o&&o(!1),0!==e.status&&alert("Ошибка при получении данных. Пожалуйста, попробуйте позже."),t(I).text("Показать")},complete:function(){U=void 0,i(!1)}})}function i(e){!0===e?(t(m).find(b).length>0&&t(m).find(b).remove(),t(m).toggleClass(w,!0).prepend(F)):t(m).toggleClass(w,!1).find("."+b).remove()}function n(e,a){a.forEach(function(a){switch(a.controlType){case f:var o=t("input[data-id="+a.valueId+"]",e);if(0===o.length)return;o.toggleClass("disabled",!1===a.isAvailable);break;case p:var i=t("[data-filter-id="+a.filterId+"]");a.minValue>i.slider("option","min")&&i.slider("values",0,i.slider("option","min")),a.maxValue<i.slider("option","max")&&i.slider("values",1,i.slider("option","max")),i.slider("option","min",a.minValue),i.slider("option","max",a.maxValue),i.slider("refresh")}}),t.each(t(y+"[data-"+C+"=1]"),function(e,a){var o=t(a),i=t("li",o);i.sort(function(e,a){var o=t(e),i=t(a),n=t(e).find("input[type=checkbox]"),r=t(a).find("input[type=checkbox]"),d=o.find("label").text(),l=i.find("label").text();return(r.prop("checked")?10:0)-(n.prop("checked")?10:0)+(r.hasClass("disabled")?0:10)-(n.hasClass("disabled")?0:10)+(d>l?1:-1)}),i.detach().appendTo(o),o.scrollTo(0)})}function r(){t.each(t(g+" [data-role=dropdown-list]"),function(e,a){var i=t(a),n=i.data("option-name"),r=t("[data-role=toggle-button]",i);1===i.data("is-multiselect")?(t("label",i).click(function(){var e=t("#"+t(this).prop("for"));return e.prop("checked")?e.prop("checked",!1):e.prop("checked","checked"),e.change(),!1}),t("input[type=checkbox]",i).change(function(){var e=t("[data-role=title]",r),a=t("input[type=checkbox]:checked",i);if(0===a.length)e.text("Все");else if(1===a.length){var d=t("label[for="+a.eq(0).prop("id")+"]").text();e.text(d)}else e.text("Выбрано: "+a.length);return q[n]=[],t.each(a,function(e,a){q[n].push(t(a).data("id"))}),o(),!1})):t("[data-role=list-button]",i).click(function(){return r.dropdown("toggle"),t("[data-role=list-item]",i).toggleClass("disabled",!1),t(this).closest("[data-role=list-item]").toggleClass("disabled",!0),t("[data-role=title]",r).text(t(this).text()),q[n]=t(this).data("value"),o(),!1})})}function d(){t.each(t(S,e()),function(e,a){var o=t(a),i=o.data("id"),n=t(L,o).text().trim();switch(o.data(O)){case f:var r=[];t.each(t("input[type=checkbox]:checked",o),function(e,a){r.push(t(a).siblings("label").text())}),l(i,n,r);break;case p:var d=t("input[data-name=min]",o).val(),s=t("input[data-name=max]",o).val(),c=o.data(N);if(""===d&&""===s){l(i,n,void 0,null,null);break}""===d&&(d=t(v,o).data("min")),""===s&&(s=t(v,o).data("max")),l(i,n,void 0,d+" "+c,s+" "+c)}})}function l(e,a,o,i,n){var r=G.siblings(A+"[data-"+R+"=1]");if(void 0!==i&&void 0!==n||o.length>0){var d=null;if(void 0!==o?d=1===o.length?o[0]:o.length+" фильт.":null!==i&&null!==n&&(d="от "+i+" до "+n),t(A+"[data-"+D+"="+e+"]",G).remove(),t(".active-filter[data-"+D+"="+e+"]",G).remove(),null!==d){var l=r.clone().toggleClass("hidden",!1).attr("data-"+R,0).attr("data-"+D,e);t("[data-role=title]",l).text(a+": "+d),G.append(l).find("[data-"+D+"="+e+"]").click(s)}}else t("[data-"+D+"="+e+"]",G).remove();if(t(".active-filter",G).length>0&&0===t(".active-filter[data-is-total=1]",G).length){var c=r.clone().toggleClass("hidden",!1).attr("data-"+R,0).attr("data-is-total",1);t("[data-role=title]",c).html("Очистить все фильтры"),G.prepend(c).find("[data-is-total=1]").click(s)}else 0===t(".active-filter[data-is-total=0]",G).length&&t(".active-filter[data-is-total=1]",G).length>0&&t(".active-filter[data-is-total=1]",G).remove();G.toggleClass("catalog-filter-list",0!==t(".active-filter",G).length)}function s(){var e=t(this),a=1===e.data("is-total"),i=e.data(D);return!0===a?c():u(i),o(),d(),!1}function c(){t.each(t(S,e()),function(e,a){u(t(a).data("id"))})}function u(e){t.each(t(S+"[data-id="+e+"]"),function(e,a){var o=t(a);switch(o.data(O)){case f:t("input[type=checkbox]:checked",o).prop("checked",!1).trigger("change");break;case p:var i=t(v,o),n=i.slider("option","min"),r=i.slider("option","max");t(v,o).slider("option","values",[n,r]),t("input[data-name=min]",o).val(""),t("input[data-name=max]",o).val("").trigger("change")}})}var f=3,p=4,h=".catalog-products",v="[data-role=slider]",m="[data-role=products-container]",g="[data-role=view-options-panel]",w="loading-overlay",b="loading-dots",E="[data-role=next-load-block]",T="[data-role=next-load-block-button]",_="[data-role=button-title]",y="[data-role=checkbox-list]",C="is-sortable",k="[data-role=filtered-products-count]",I="[data-role=btn-mobile-close-filters]",S="[data-role=filter-block]",O="control-type",N="unit-name",L="[data-role=filter-title]",x="[data-role=selected-filters-panel]",A="[data-role=active-filter-item]",R="is-template",D="selected-filter-id",P="[data-role=view-mode-switch] button",F='<div class="loading-dots"><span /><span /><span /><span /></div>',B='<div class="loading-dots"><span /><span /><span /></div>',M="type",V="mobile",j="desktop";window.EVENT_CLOSE_MOBILE_FILTERS_MENU="filters-menu:mobile:close";var $,U,H,G,W={updateUrl:null,lastProductIndex:void 0},q={sort:null,groupBy:null,stock:null,shops:[],offset:0,mode:null},Q=t("#menu-filters-aside"),Y=(t("#desktop-characteristic-filters"),t('[data-role="view-mode-switch"] > button')),K=[],z=arguments;t.each(t(this),function(t,e){a.apply(e,z)}),function(){r(),H=t(E),G=t(x),t(T,H).click(function(){return q.offset=$,H.toggleClass("hidden",!0).siblings(".loading-dots").remove(),H.after(F),o(!0,function(t){!1!==t&&H.siblings(".loading-dots").remove()}),!1}),t(I).click(function(){t(window).trigger(EVENT_CLOSE_MOBILE_FILTERS_MENU)}),d()}()}}(jQuery),function(t){t(document).ready(function(){t("#action-marketing-code-filter").on("keyup",function(){var e=t(this).val().toUpperCase().trim(),a=t(".actions-list .action");a.removeClass("hidden"),a.filter(function(){return-1==t(this).data("code").toUpperCase().indexOf(e)}).addClass("hidden")})})}(jQuery),function(t){t(document).ready(function(){function e(){var t=a.outerHeight(),e=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,i=e/2-t/2+window.screenTop;i<0&&(i=0),o.css("padding-top",i+"px")}var a=t("#actions-slider"),o=t(".actions-on-tv");0!==a.length&&(a.owlCarousel({autoPlay:1e4,navigation:!1,pagination:!1,slideSpeed:1e3,singleItem:!0}),t("img",a).on("load",function(){e()}),t(window).resize(e))})}(jQuery),function(t,e){function a(a){function u(){n(o(p),p)}var f=e(r);e(t).on("click",function(t){e(t.target).hasClass(l)||e(s).fadeOut()});var p=a.find("FORM"),h=f.find("FORM");p.on("submit",u);var v=e();v.push.apply(v,p),v.push.apply(v,h),v.aggregateForm(function(t){t.each(function(){i(e(this))})}),v.change(u),v.on("change",function(t){var a=e(t.target).parents("[data-control-type]:first");if(a.length){var i=o(p);""!==i?a.find("label").addClass("selected"):a.find("label").removeClass("selected"),c.changeFilter(c.urlParamName,i)}}),p.find(d).on("click",function(){var t=e(this),a=t.data("action-value");t.closest('form[data-id="action-filter"]').find("input:checkbox").prop("checked",!1),c.chooseOneAction(a)})}function o(t){var e=[];return t.find("input[type=checkbox]:checked").each(function(){e.push(this.value)}),e.join("-")}function i(t){t.find('input[type=hidden][name^="'+c.urlParamName+'"]').remove()}function n(t,e){""!==t&&(i(e),e.append('<input type="hidden" name="'+c.urlParamName+'" value="'+t+'" />'))}var r="#w-catalog-action-filter-mobile-widget",d="span.one-action-submit",l="apply-filters-btn",s="."+l,c={},u={urlParamName:"action",changeFilter:function(t,e){},chooseOneAction:function(t){}};e.fn.catalogActionFilter=function(t){c=e.extend({},u,t),a(e(this))},e(function(){var t=e('[data-role="action-filter-widget"]');if(0!==t.length){var a=null;t.catalogActionFilter({urlParamName:t.data("url-param-name"),chooseOneAction:function(t){null===a&&(clearTimeout(a),a=setTimeout(function(){clearTimeout(a),setUrlParameter("action",t)},250))}})}})}(document,jQuery),$(document).ready(function(){var t=$(".partners-container").add(".landlord-container").add(".supplier-container").add(".transport-container").add(".credit-container");t.on("click",".file-input-button",function(){$(this).closest("div").find("#ajaxfileuploadform-uploadedfile").click()}),t.on("change","#ajaxfileuploadform-uploadedfile",function(){t.find(".file-input-text").text($(this).val())}),t.on("click",'[data-role="open-message-form"]',function(){t.find(".message-form-container").slideDown(500),$(this).closest("div").addClass("hidden")})}),function(t,e,a){a(e).on("click","[data-role=show-banner-popover-button]",function(){var e=a(this);if(e.tooltip("hide"),e.addClass("active"),a("[data-role=show-banner-popover-button]").not(this).popover("destroy"),a("[data-role=show-banner-popover-button]").not(this).attr("data-popover-shown","false"),"true"===e.attr("data-popover-shown"))return e.popover("destroy"),e.attr("data-popover-shown","false"),void e.removeClass("active");e.attr("data-popover-shown","true"),e.popover({placement:t.checkScreenType(t.SCREEN_DESKTOP,t.SCREEN_WIDE)?"bottom":"left",html:!0,template:t.checkScreenType(t.SCREEN_DESKTOP,t.SCREEN_WIDE)?'<div class="popover hide-banner-popover bottom" role="tooltip" data-role="hide-banner-popover"><div class="arrow"></div><div class="popover-content" data-role="hide-banner-popover-content"></div></div>':'<div class="popover hide-banner-popover left" role="tooltip" data-role="hide-banner-popover"><div class="arrow"></div><div class="popover-content" data-role="hide-banner-popover-content"></div></div>',content:'<div class="alert alert-danger hidden" data-role="error-container">Не удалось скрыть баннер, попробуйте ещё раз.</div><div class="message">Скрыть только этот баннер или все на данной странице?</div><br><div class="row controls"><div class="btn btn-default hide-all-btn pull-left" data-role="hide-all-banners-button" >Скрыть все</div><div class="btn btn-additional hide-current-btn pull-right" data-role="hide-current-banner-button" >Только этот</div></div>',trigger:"manual"}),e.popover("show")}),a(e).on("click","[data-role=hide-current-banner-button]",function(){var t=a("[data-role=show-banner-popover-button]").filter("[data-popover-shown=true]"),e=a("[data-role=hide-banner-popover]");a.ajax({url:t.data("hide-banner-url")+(t.data("type-guid")?"?typeGuid="+t.data("type-guid"):"")+(t.data("category-guid")?"&categoryGuid="+t.data("category-guid"):""),cache:!1,method:"POST",dataType:"JSON",success:function(a){if(a.result){var o=t.closest("[data-role=single-banner-container]");t.popover("destroy"),t.attr("data-popover-shown","false"),t.removeClass("active"),o.addClass("hidden")}else{var i=e.find("[data-role=error-container]");i.removeClass("hidden"),setTimeout(function(){i.addClass("hidden")},2e3)}}})}),a(e).on("click","[data-role=hide-all-banners-button]",function(){var t=a("[data-role=show-banner-popover-button]").filter("[data-popover-shown=true]"),e=a("[data-role=hide-banner-popover]");a.ajax({url:t.data("hide-banner-url")+(t.data("type-guid")?"?typeGuid="+t.data("type-guid"):""),cache:!1,method:"POST",dataType:"JSON",success:function(a){if(a.result){var o=t.closest("[data-role=single-banner-container]");t.popover("destroy"),t.attr("data-popover-shown","false"),t.removeClass("active"),o.addClass("hidden")}else{var i=e.find("[data-role=error-container]");i.removeClass("hidden"),setTimeout(function(){i.addClass("hidden")},2e3)}}})})}(window,document,jQuery),function(t,e){var a=void 0;e(function(){a=e("[data-role=blog-post-anchors]"),0!==a.length&&a.on("click","[data-role=anchor-link]",function(t){t.preventDefault();var a=e(this).attr("href"),o=e(a).offset().top-65;e("body,html").animate({scrollTop:o},{duration:1e3,easing:"swing"})})})}(document,jQuery),function(t,e,a,o){"use strict";a.EVENT_UPDATE_CART="cart:update",a.EVENT_CART_PRODUCTS_UPDATED="cart:productsUpdated",a.EVENT_LOAD_CART_DATA="cart:loadCartData",a.EVENT_ONE_CLICK_BUTTON_PUSH="cart:oneClickPush",a.SELECTOR_CART_WIDGET="[data-id=cart-widget]",a.SELECTOR_CART_BUTTON="[data-id=cart-button]";var i="add",n="go_to_cart",r="product-guid",d="add-optional-product-guid",l="group-guid",s="related-services",c="is-use-discount-logistic";a.DATA_MARKER="marker",a.SELECTOR_MARKERS="[data-"+a.DATA_MARKER+"]",e(t.body).ready(function(){function u(t){t.totalCount>0?v.applySets("active",{totalCount:a.numberFormat(t.totalCount,0,"."," "),totalPrice:a.numberFormat(t.totalPrice,0,"."," ")}):v.setState("default")}function f(t){var e={guid:t.data(r),type:t.data("product-type")};return o!==t.attr("data-"+l)&&(e.groupGuid=t.attr("data-"+l)),o!==t.attr("data-"+d)&&(e.optionalProductGuid=t.attr("data-"+d)),t.is(a.SELECTOR_MARKERS)&&(e.markers=t.data(a.DATA_MARKER).toString().match(/[A-z0-9_-]+/g)),t.data("shop-id")&&(e.shopId=t.data("shop-id")),t.data("postamat-id")&&(e.postamatId=t.data("postamat-id")),t.data("warranty-years")&&(e.warrantyYears=t.data("warranty-years")),t.data(s)&&(e.relatedServicesGuids=t.data(s)),o!==t.data(c)&&(e.isUseDiscountLogistic=t.data(c)),e}function p(){e(a.SELECTOR_CART_BUTTON+"[data-state="+n+"]").each(function(t,a){m[e(a).data(r)]=i})}function h(t){for(var o in t)t.hasOwnProperty(o)&&(m[t[o].guid]=n);for(var i in m)m.hasOwnProperty(i)&&e(a.SELECTOR_CART_BUTTON+"[data-product-guid="+i+"]").setState(m[i])}var v=e(a.SELECTOR_CART_WIDGET),m={},g=e(a.SELECTOR_CART_BUTTON);e(t.body).on("click",a.SELECTOR_CART_BUTTON,function(){var t=e(this);if(t.attr("disabled",!0),n===t.data("state"))return void(a.location.href=t.data("url"));p();var o=f(t);e.ajax({type:"POST",url:t.data("url"),dataType:"json",data:o,success:function(o){if(!0===o.result){t.attr("disabled",!1),u(o.data),h(o.data.items),t.trigger(a.EVENT_UPDATE_CART,[o.data.items]),e(a).trigger(a.EVENT_MOBILE_UPDATE_NOTIFIER,{activity:a.NOTIFY_ACTIVITY_CART,count:o.data.totalCount});var i=new CustomEvent(a.EVENT_UPDATE_CART);a.dispatchEvent(i)}else if(""!==o.html){t.attr("disabled",!1);var n=e("#cart-limit-modal");0===n.length&&(n=e(o.html)),n.modal();var r=n.find('[data-role="submit-form"]');n.on("submit","#cart-limit-captcha-form",function(){r.attr("disabled",!0);var a=e(this);return e.ajax({type:"POST",url:r.data("url"),dataType:"json",data:a.serializeArray(),success:function(a){!0===a.result?(n.modal("hide"),t.trigger("click")):e(".modal-body",n).html(a.html)}}),!1}),n.on("hidden.bs.modal",function(){n.remove()})}else{var d=o.message?o.message:"Произошла ошибка. Повторите попытку позднее.";alert(d)}}}).always(function(){t.tooltip("hide")})}),e(a).on(a.EVENT_CART_PRODUCTS_UPDATED,function(){p(),e.ajax({type:"POST",url:"/cart/get-state/",dataType:"json",success:function(t){if(!0===t.result)u(t.data),h(t.data.items);else{var e=t.message?t.message:"Произошла ошибка. Повторите попытку позднее.";alert(e)}}})}),e(a).on(a.EVENT_LOAD_CART_DATA,function(t,o){u(o),h(o.items),e(a).trigger(a.EVENT_MOBILE_UPDATE_NOTIFIER,{activity:a.NOTIFY_ACTIVITY_CART,count:o.totalCount})}),e(a).on(a.EVENT_PRODUCTS_LOADED,function(){var t=e(a.SELECTOR_CART_BUTTON),o=t.not(g);o.length&&(o.initSets(),g=t)}),e(a).on(a.EVENT_OS_VARIANT_CHANGED,function(t,e){var a=g.filter("[data-"+r+'="'+e.baseProductGuid+'"]');if(0!==a.length){var o=e.isOsInCart?n:i;a.attr("data-"+d,e.guid).setState(o)}})})}(document,jQuery,window),FilterBlockCompatibleProduct.prototype=Object.create(FilterBlock.prototype),FilterBlockCompatibleProduct.prototype.constructor=FilterBlockCompatibleProduct,FilterBlockCompatibleProduct.prototype.getSelectedValue=function(){var t="";return this.$block.find("select").each(function(){""!==$(this).val()&&(t+=(t.length?"-":"")+$(this).val())}),this.$block.find("label").first().toggleClass("selected",""!==t),""!==t?t:void 0},FilterBlockCompatibleProduct.prototype.reset=function(){this.$block.find("select").each(function(){$(this).val("")})},FilterBlockCompatibleProduct.prototype.updateFilterValues=function(t){},function(t){window.EVENT_CATALOG_SCROLL="catalog_scroll",t.fn.infiScroll=function(e){var a=t.extend({},t.fn.infiScroll.defaults,e),o=!1,i=a.page,n=a.page+1,r=a.offset,d=!1,l=parseInt(getURLParameter(location.search,"p")),s=t("#page"+l),c=t(a.btn_show_more);if(c.click(function(e){return t(this).hide(),t(document).trigger("scroll.infiScroll"),e.preventDefault(),!1}),!a.scrolling_last_child)return console.error("Error! No scrolling child!"),!1;window.addEventListener("popstate",function(e){e.state||(e.state={page:1}),s=t("#page"+e.state.page),""!=e.state.page&&s.length>0&&(d=!0,i=e.state.page,t(a.scroll_html).animate({scrollTop:s.offset().top-80},300,function(){d=!1}))}),""!=l&&s.length>0&&(d=!0,i=l,t(a.scroll_html).animate({scrollTop:s.offset().top-80},300,function(){d=!1})),t(a.scrolling_element).on("scroll.infiScroll",function(){for(var e=void 0,l=t(a.scrolling_last_child,t(this)),s=t('[id^="page"]'),u=0,f=t(),p="",h=1,v=-1e5,m=s.length;m--;)f=s.get(m),(u=t(f).offset().top-t(a.scroll_client).scrollTop())<100&&u>v&&(h=parseInt(t(f).attr("id").substr(4)),v=u);if(i!==h&&0==d&&(d=!0,i=h,p=updateURLParameter(window.location.pathname+window.location.search,"p",i),window.history.replaceState({page:i},document.title,p),d=!1),o||c.is(":visible"))return!0;if(!(l instanceof jQuery&&l.length>0))return!0;if(e=l.last(),t(a.scroll_client).scrollTop()+t(a.scroll_client).innerHeight()-e.offset().top>0){o=!0;var g="";g=a.show_page_count?"<div>Следующая страница ("+(i+1)+"-я)<br>Всего "+a.total_pages+" "+strFormatHumanNumber(a.total_pages,["страница","страницы","страниц"])+"("+a.total_items+" "+strFormatHumanNumber(a.total_items,["предложение","предложения","предложений"])+")"+a.loadingHTML+"</div>":a.loadingHTML;var w=t(g).appendTo(a.parent_block);t.ajax({url:a.ajaxUrl,type:"get",dataType:"json",data:{p:n,offset:r,last_item_cat:t("#last_item_cat").val()},success:function(e){w.remove(),"function"==typeof a.callback?a.callback(e,a):console.error("callback is not function!"),1!=e.isEnd&&(n=e.page,r=e.offset,e.offset<e.totalCount?(t(a.parent_block).append(c.parent()),t("#last_item_cat").val(e.last_item_cat)):c.parent().remove(),o=!1),t(document).trigger(window.EVENT_INFISCROLL_COMPLETE),t(document).trigger(window.EVENT_PRODUCTS_LOADED)},error:function(){w.remove(),o=!1},complete:function(){c.show()}})}})},t.fn.infiScroll.defaults={offset:0,page:1,ajaxUrl:"",callback:function(e,a){t(e.content).appendTo(a.parent_block),t(document).trigger(window.EVENT_CATALOG_SCROLL)},scrolling_element:document,scroll_html:"html",scrolling_last_child:!1,scroll_client:window,parent_block:"body",loadingHTML:'<div class="loading-dots"><span></span><span></span><span></span><span></span></div>',show_page_count:!1,total_pages:0,total_items:0,btn_show_more:".catalog-category-more a"},t.fn.infiScroll.scrollToPage=function(t,e,a){},window.EVENT_INFISCROLL_COMPLETE="infiscroll:complete"}(jQuery),function(t,e){var a=void 0,o=void 0,i=void 0,n=void 0,r=100;e(function(){function d(){i=a.offset().top}function l(){var d=e(t).scrollTop()-r;n=a.height()-o.innerHeight(),d>i&&d<n?o.css("margin-top",d+"px"):d<=i-r&&o.css("margin-top","0px")}a=e('[data-role="null-result-container"]'),0!==a.length&&(o=a.find(".null-result"),d(),l(),e(t).resize(function(){d(),l()}),e(t).scroll(function(){l()}))})}(window,jQuery),function(t,e,a,o){function i(t,a){var o=e(".image-slider",t).owlCarousel(a),i=o.data("owlCarousel");return e(".button-right",t).click(function(){return i.next(),!1}).show(),e(".button-left",t).click(function(){return i.prev(),!1}).show(),i}a.CreditCalculatorEvents="creditCalc:reInit";var n="[data-role=price-hint]",r="[data-role=price-hint-popover]",d="[data-role=price-hint-popover-content-container]",l="[data-role=price-hint-popover-content]",s=void 0,c=void 0,u=void 0,f=void 0,p=void 0,h=void 0,v=void 0,m=void 0,g=void 0,w=void 0,b=void 0,E=new Map,T=new Map,_=void 0,y=void 0,C=void 0;e(function(){function t(t,i){var n=arguments.length>2&&arguments[2]!==o?arguments[2]:0,r=arguments.length>3&&arguments[3]!==o?arguments[3]:0;if(0!==u.length){0!==i?T.set(t,{price:i,previousPrice:n,bonusPrice:r}):o!==T.get(t)&&T.delete(t);var d=parseFloat(f.attr("data-price-value")),l=parseFloat(p.attr("data-price-value")),s=parseFloat(h.attr("data-price-value")),c=void 0;if(T.forEach(function(t){d+=t.price,l+=t.previousPrice,s+=t.bonusPrice}),f.text(String.formatPrice(d)),0!==p.length&&p.text(String.formatPrice(l)),0!==h.length){h.text(String.formatPrice(s));var m=0===s;h.closest(".buy-cheaper").toggleClass("hidden",m)}if(0!==v.length){var g=parseFloat(v.attr("data-credit-percent")),w=v.attr("data-installment-month-count");c=o!==w?Math.round(d/parseInt(w)):Math.round(d*g),v.find('[data-role="credit-payment-value"]').text(c)}e(a).trigger(a.CreditCalculatorEvents,[d])}}function k(t,a,i){o!==E.get(t)&&I(t);var n=e("<li/>",{"data-id":t}),r=e("<span/>",{class:"dots"}),d=e("<span/>",{class:"name"});d.text("+ "+a),r.append(d),n.append(r);var l=e(" <span/>",{class:"value"});l.text(String.formatPrice(i)),e("<i/>",{class:"rub-icon"}).text("").appendTo(l),n.append(l),b.find("UL").append(n),0===E.size&&(m.removeClass("hidden"),u.addClass("price-changed")),E.set(t,!0)}function I(t){o!==E.get(t)&&(b.find("UL LI[data-id="+t+"]").remove(),E.delete(t),0===E.size&&(m.addClass("hidden"),u.removeClass("price-changed")))}var S=function(){function i(){g=s.find(u+" .accordion-item .selector"),g.click(function(t){e(t.target).closest(".accordion-item").toggleClass("active")}),s.find(u+" .accordion-item .content-block").click(function(t){e(t.target).find("INPUT[type=radio]").click()}),v=s.find(d),m=s.find(d).find("option"),w=s.find(l),b=g.find(p),E=g.find(h),v.change(function(t){w.prop("checked",!1);var e=parseInt(t.target.value),a=w.filter(function(t){return e===parseInt(w.eq(t).val())});a.prop("checked",!0).change();var o=r(a.val());n(e,o)}).change(),w.change(function(t){var e=parseInt(t.target.value),a=m;a.prop("selected",!1);var o=a.filter(function(t){return e===parseInt(a.eq(t).val())});o.prop("selected",!0);var i=r(o.val());n(e,i)})}function n(t,e){if(0!==t){var a=String.countPostfix(t,["год","года","лет"],"",!1)+" (+ "+String.formatPrice(e)+'<i class="rub-icon"></i>)';E.html(a),b.addClass("sup-text")}else E.text(""),b.removeClass("sup-text")}function r(i){var n=m.filter(function(t){return i===m.eq(t).val()}),r=0;return n.length>0&&o!==n.attr("data-additional-price")&&(r=parseFloat(n.attr("data-additional-price"))),null!==r&&t("additionalWarranty",r),r>0?(k(f,"Дополнительная гарантия",r),a.productAdditionsDispatcher.setAdditionalWarranty(i,r)):(I(f),a.productAdditionsDispatcher.setAdditionalWarranty(null)),e(a.SELECTOR_CART_BUTTON+'[data-product-guid="'+c+'"]').data("warranty-years",i),r}var d="[data-role=additional-warranty] SELECT",l="[data-role=additional-warranty] INPUT[type=radio]",u="[data-role=accordion]",f="additionalWarrantyPriceId",p="[data-role=title]",h="[data-role=selected-label]",v=void 0,m=void 0,g=void 0,w=void 0,b=void 0,E=void 0;return{init:function(){return i()}}}();if(s=e("#product-page"),C=e("#mainImageSliderWrap"),0!==s.length){if(c=s.data("id"),y=i(e("#thumbsSliderWrap"),{items:4,itemsMobile:[479,4],itemsTablet:[a.SCREEN_TABLET_MAX_WIDTH,4],itemsDesktopSmall:[a.SCREEN_DESKTOP_MAX_WIDTH,4],itemsDesktop:[a.SCREEN_DESKTOP_MAX_WIDTH,4],dots:!1,afterAction:!1}),e("#mainImageSliderWrap .img").length){if(e(a).width()>="992"){e(a).width()>="1900"&&e("#mainImageSliderWrap .img img").each(function(t){var a=e(this).data("original");e(this).parent().attr("href",a);var o=e(".thumb-slider-wrap .owl-item").eq(t).find("a");"iframe"!==o.data("fancybox-type")&&o.attr("href",a)});var O=e(".main-image-slider-wrap .img img[data-original]");O.length&&O.zoomer({drawIn:e('[data-role="zoom-preview"]'),viewContainer:e('[data-role="zoom-preview-wrap"]'),srcImgContainerWidth:e(".main-image-slider-wrap .image-slider").width()})}_=i(C,{items:1,itemsMobile:[479,1],itemsTablet:[a.SCREEN_TABLET_MAX_WIDTH,1],itemsDesktopSmall:[a.SCREEN_DESKTOP_MAX_WIDTH,1],itemsDesktop:[a.SCREEN_DESKTOP_MAX_WIDTH,1],dots:!1,afterAction:function(){"object"===(void 0===y?"undefined":_typeof(y))&&(e("#thumbsSliderWrap .owl-item .thumb").removeClass("active").eq(this.owl.currentItem).addClass("active"),y.visibleItems[y.visibleItems.length-1]<this.owl.currentItem?y.goTo(this.owl.currentItem):y.visibleItems[0]>this.owl.currentItem&&y.goTo(this.owl.currentItem))},afterInit:function(){C.find(".img").removeClass("transparent").removeAttr("hidden");var t=C.find('[data-fancybox-group="itemGroup"]').index(e("[data-active-img]"));-1!==t&&this.goTo(t),setTimeout(function(){e(".main-image-slider-wrap").removeClass("opacity-container")},1e3)}})}e("#thumbsSliderWrap .owl-item .thumb").hover(function(){_.goTo(e(this).parent().index())}),u=e('[data-role="item-order-price"]'),v=e('[data-role="credit-info"]'),f=u.find('[data-role="current-price-value"]'),p=u.find('[data-role="previous-price-value"]'),h=u.find('[data-role="bonus-price-value"]'),function(){var t="right";a.checkScreenType(a.SCREEN_MOBILE,a.SCREEN_TABLET)&&(t="bottom"),m=e(n),g=m.find(r),w=m.find(d),b=m.find(l),g.popover({html:!0,content:function(){return w.html()},trigger:"focus",placement:t}).click(function(){return!1}),m.on("click","[data-role=close]",function(){return g.popover("hide"),!1})}(),S.init(),a.productAdditionsDispatcher.setBaseProductGuid(c),a.productAdditionsDispatcher.addOptionalProductsListener(function(e,a){if(null!==a){t("osconstiant",a.currentPrice,a.previousPrice,a.bonus),a.currentPrice>0&&k("osVariantId","Опциональная ОС",a.currentPrice);var o=s.find('[data-role="remains-overlimit-message"]');0!==o.length&&(o.toggleClass("hidden",""===a.overlimitMessage),o.html(a.overlimitMessage))}else t("osconstiant",0),I("osVariantId")}),a.productAdditionsDispatcher.addKbtServiceListener(function(i){var n=i.relatedKbtService,r=e(a.SELECTOR_CART_BUTTON+'[data-product-guid="'+i.baseProductGuid+'"]'),d=r.attr("data-related-services");if(d=o===d?[]:JSON.parse(d),n.checked)k(n.guid,'Услуга "'+n.title+'"',n.price),t(n.guid,parseFloat(n.price)),d.push(n.guid);else{I(n.guid),t(n.guid,0);var l=d.indexOf(n.guid);d.splice(l,1)}r.attr("data-related-services",JSON.stringify(d))}),s.on("click","[data-video]",function(t){t.preventDefault(),e('[data-unpacking-video="true"]').click()}),s.on("click",'[data-id="show-reviewthree-button"]',function(t){t.preventDefault(),e('[data-role="show-reviewthree"]').click()}),s.on("click","[data-image-3d]",function(){return e('[data-3d-image="true"]').click(),!1}),s.on("click","[data-replace-with]",function(){e(this).replaceWith(e(this).data("replace-with"))})}})}(document,jQuery,window,void 0);var ProductAdditionsDispatcherClass=function(){function t(){_classCallCheck(this,t),this.optionalProduct=null,this.additionalWarranty=null,this.relatedKbtService=null,this.callbacks=[],this.baseProductGuid=null,this.EVENT_ID_OPTIONAL_PRODUCT="optionalProducts",this.EVENT_ID_ADDITIONAL_WARRANTY="additionalWarranty",this.EVENT_ID_RELATED_KBT_SERVICE="relatedKbtServices"}return _createClass(t,[{key:"setBaseProductGuid",value:function(t){this.baseProductGuid=t}},{key:"setOptionalProduct",value:function(t){null!==this.baseProductGuid&&(Constants.UUID_NILL!==t.guid?this.optionalProduct=t:this.optionalProduct=null,this.trigger(this.EVENT_ID_OPTIONAL_PRODUCT,this.baseProductGuid,this.optionalProduct))}},{key:"setAdditionalWarranty",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null!==this.baseProductGuid&&(this.additionalWarranty=null!==t?{period:t,price:e}:null,this.trigger(this.EVENT_ID_ADDITIONAL_WARRANTY,this.baseProductGuid,this.additionalWarranty))}},{key:"setKbtService",value:function(t){if(null!==this.baseProductGuid){Constants.UUID_NILL!==t.guid?this.relatedKbtService=t:this.relatedKbtService=null;var e={baseProductGuid:this.baseProductGuid,relatedKbtService:this.relatedKbtService};this.trigger(this.EVENT_ID_RELATED_KBT_SERVICE,e)}}},{
key:"trigger",value:function(t){var e=Array.from(arguments);e.shift(),void 0!==this.callbacks[t]&&this.callbacks[t].forEach(function(t){t.apply(void 0,_toConsumableArray(e))})}},{key:"addOptionalProductsListener",value:function(t){void 0===this.callbacks[this.EVENT_ID_OPTIONAL_PRODUCT]&&(this.callbacks[this.EVENT_ID_OPTIONAL_PRODUCT]=[]),this.callbacks[this.EVENT_ID_OPTIONAL_PRODUCT].push(t)}},{key:"addAdditionalWarrantyListener",value:function(t){void 0===this.callbacks[this.EVENT_ID_ADDITIONAL_WARRANTY]&&(this.callbacks[this.EVENT_ID_ADDITIONAL_WARRANTY]=[]),this.callbacks[this.EVENT_ID_ADDITIONAL_WARRANTY].push(t)}},{key:"addKbtServiceListener",value:function(t){void 0===this.callbacks[this.EVENT_ID_RELATED_KBT_SERVICE]&&(this.callbacks[this.EVENT_ID_RELATED_KBT_SERVICE]=[]),this.callbacks[this.EVENT_ID_RELATED_KBT_SERVICE].push(t)}}]),t}();window.productAdditionsDispatcher=new ProductAdditionsDispatcherClass,function(t,e,a){function o(a){a===m&&n(m),a===v&&n(v),e(t).trigger(window.EVENT_DESTROY_POPOVERS),setTimeout(function(){e(t).trigger(window.EVENT_INIT_POPOVERS)},500)}function i(i){if(a===i){i=_.find(".r-tabs-tab.active").attr("data-tab-name");var n=S.text();""!==n?S.removeClass("hidden"):S.addClass("hidden"),T[i]={metaTitle:t.title,metaDescription:e('meta[name="description"]').attr("content"),seoText:n,header:O.text(),breadcrumbs:[e(".breadcrumb li:not(.initial-breadcrumb):first").text().trim()]}}if(v===i&&(d(),r(e(b)),setTimeout(l(),300),o(i)),m===i&&o(i),p===i){var s=new CustomEvent(window.EVENT_INIT_OPINION_WIDGETS);window.dispatchEvent(s),e(window).trigger(window.EVENT_INIT_COMMENTS_WIDGET)}if(h===i&&e(window).trigger(window.EVENT_INIT_COMMENTS_WIDGET),g===i){var c=new CustomEvent(window.EVENT_INIT_FAQ_WIDGETS);window.dispatchEvent(c)}}function n(t){if(a!==window.characteristicsDescriptions){var o=e("#"+t);o.find("a[data-descr]").each(function(){var t=e(this).attr("data-descr"),o=window.characteristicsDescriptions[t];if(a!==o){e(this).addClass("icon"),e(this).attr("data-toggle","popover"),e(this).data("content-target","#popover-"+t),e(this).data("html",!0),window.SCREEN_MOBILE===window.getScreenType()?e(this).data("placement","bottom"):e(this).data("placement","right"),e(this).data("trigger","click");var i=e("<div/>",{id:"popover-"+t,class:"popover",role:"tooltip"});i.append(e("<i/>",{class:"close-btn"})),i.append(o.content),""!==o.url&&i.append(e("<a/>",{href:o.url,html:"Описания всех характеристик и значений <i/>",class:"knowledge-base-link"})),e(this).closest(".dots").after(i)}}),o.find('[data-toggle="popover"]').click(function(){return!1}),o.on("shown.bs.popover",function(){window.getVisible('[role="tooltip"]').forEach(function(t){e(t).on("click",function(t){if("close-btn"!==t.target.className&&"A"!==t.target.tagName)return!1})}),window.dispatchLazyLoadUpdateEvent()})}}function r(t){e("tbody > tr",t).removeClass("highlight"),e("tbody > tr:not(.hidden):odd",t).addClass("highlight")}function d(){a!==window.richContentProviderName&&N["init"+window.richContentProviderName]()}function l(){a!==window.richContentProviderName&&(!1===k&&(k=!0,N["get"+window.richContentProviderName]()),!0===I&&e(w).show())}function s(o){var n=_.find('[data-tab-name="'+o+'"]'),r=n.find('[data-role="real-tab-link"]').attr("href");if(window.history.pushState(null,"",r),a!==T[o])u(T[o]);else{var d=_.data(E).split("&");t.body.classList.add("loading"),e.ajax({url:d[0]+"&activeTab="+o,context:t.body,success:function(e){var a=e.data[o];T[o]={metaTitle:a.metaTitle,metaDescription:a.metaDescription,seoText:a.seoText,header:a.header,breadcrumbs:a.breadcrumbs},c(o,a.content),u(T[o]),i(o),t.body.classList.remove("loading")}})}}function c(t,a){var o=e("#"+t);0!==o.length&&o.html(a)}function u(o){O.text(o.header),t.title=o.metaTitle,e('meta[name="description"]').attr("content",o.metaDescription),a!==o.seoText&&(0!==o.seoText.length?(S.removeClass("hidden"),S.text(o.seoText)):S.addClass("hidden")),f(o.breadcrumbs)}function f(e){Array.from(t.querySelectorAll(".breadcrumb")).forEach(function(a){Array.from(a.querySelectorAll("li:not(.initial-breadcrumb)")).forEach(function(t){t.parentNode.removeChild(t)}),e.forEach(function(e){var o="object"===(void 0===e?"undefined":_typeof(e)),i=t.createElement("span");if(i.textContent=o?e.label:e,!0===o){var n=t.createElement("a");n.href=e.url,n.appendChild(i),i=n}var r=t.createElement("li");r.appendChild(i),a.appendChild(r)})})}window.EVENT_PRODUCT_CARD_TAB_RENDER="product-card-tabs:render",window.EVENT_CARD_TABS_PROCESSED="product-card-tabs:processed";var p="opinion",h="comment",v="description",m="characteristics",g="faq",w="#vendor-price-item-description",b="#description .table-params",E="get-tabs-url",T={},_=void 0,y=void 0,C=0,k=!1,I=!1,S=void 0,O=void 0;e(function(){_=e("#item-tabs-block"),S=e('[data-role="product-view-seo-text"]'),O=e('h1[data-product-param="name"]');var t=_.is("[data-product-tabs]"),o=!1,n=_.data("active-tab"),c=_.find('[aria-controls="'+n+'"]');if(0!==c.length&&(C=_.find("li").index(c.parent())),0!==_.length){var u={stateDefault:"r-tabs-state-default",stateActive:"active",stateDisabled:"r-tabs-state-disabled",stateExcluded:"r-tabs-state-excluded",tab:"r-tabs-tab",anchor:"r-tabs-anchor",panel:"r-tabs-panel",accordionTitle:"r-tabs-accordion-title"},f=function(i,n){var r=e(n.selector),d=_.find('[href="'+n.selector+'"]').attr("aria-controls");if(!0===o&&!0===t&&s(d),a===r.data("is-default")){var l=0,c=0,u=void 0;window.checkScreenType(window.SCREEN_MOBILE,window.SCREEN_TABLET)?(u=e(".mobile-top-header"),l=e(n.accordionTab).offset().top-u.height()):(u=e("#header-search"),!1===u.hasClass("navbar-fixed-top")&&(u.addClass("navbar-fixed-top"),c=u.height()),l=_.offset().top),e("body").scrollTo(l+c)}else y=e(".all-characteristics-btn",_),e(window).scroll(function(){if(!0===I){e(b).position().top+e(b).height()<e(this).scrollTop()&&e(w).show()}}),y.on("click",function(){e("a[aria-controls=characteristics]").trigger("click")});e(n.selector).trigger("tabSelected")},p=function(){o=!0};_.responsiveTabs({active:C,setHash:!1===t,collapsible:"accordion",classes:u,activate:f,load:p})}d(),r(e(b)),setTimeout(l(),300),_.on("click","#description .options-primary-switch",function(){var t=parseInt(e(this).data("state"));return e(".price-item #description .table-params > tbody >tr").removeClass("hidden").filter(function(){return parseInt(e(this).data("state"))>t}).addClass("hidden"),r(e(".price-item #description .table-params")),t=3-t,e(this).data("state",t),1===t?e(this).text("Краткое описание"):e(this).text("Подробное описание"),!1}),_.on("click","#description .options-group .info-tabs-control a",function(){e(this).siblings().each(function(){e(this).removeClass("active"),e("#"+e(this).data("target")).addClass("hidden")}),e(this).addClass("active"),e("#"+e(this).data("target")).removeClass("hidden")}),_.on("click","#review .show-all-reviews",function(){return e(this).closest(".block-group").find(".objects").removeClass("cutted"),e(this).hide(),!1}),i()});var N={initFlix:function(){var t=e('[data-role="flix-setup"]');0!==t.length&&t.data("is-requested",!1)},initWebcollage:function(){var t=this,o=e("#wc-power-page");0!==o.length&&a===o.attr("data-is-requested")&&window.loadScript(o.attr("data-src")).then(function(){o.data("is-requested",!1),t.getWebcollage()})},getFlix:function(){var t=e('[data-role="flix-setup"]');if(0!==t.length&&!0!==t.data("is-requested")){t.data("is-requested",!0);var a={};a.flixInpage=t.attr("id"),a.flixDistributor=t.data("flix-distributor"),a.flixLanguage=t.data("flix-language"),a.flixBrand=t.data("flix-brand"),a.flixMpn=t.data("flix-mpn"),a.flixEan=t.data("flix-ean"),a.flixSku=t.data("flix-sku"),a.flixButton=t.data("flix-button"),a.flixButtonImage=t.data("flix-button-image"),a.flixPrice=t.data("flix-price"),window.loadScript(t.data("flix-src"),a).then(function(){"object"===_typeof(window.flixJsCallbacks)&&window.flixJsCallbacks.setLoadCallback(function(){I=!0,e(w).show()},"inpage")})}},getWebcollage:function(){var t=e("#wc-power-page");0!==t.length&&!0!==t.data("is-requested")&&setTimeout(function(){a!==window.Webcollage&&!0!==t.attr("data-is-requested")&&(window.Webcollage.loadProductContent(t.attr("data-site-id"),t.attr("data-code"),{"power-page":{autoPlayAndStop:!0,hasPowerPageContentCallback:function(){I=!0,e(w).show()}}}),t.attr("data-is-requested",!0))},1e3)}}}(document,jQuery),function(t){var e=void 0,a=void 0,o=void 0,i=void 0,n=function(t){t.preventDefault();var e=document.location.href.split("?");if(2===e.length){var a=e.pop();return window.location.href=this.href+"?"+a,!1}return window.location.href=this.href,!1};t(function(){a=t('[data-role="compare-page"]'),e=t("#product-page"),0===a.length&&0===e.length||(window.checkScreenType(window.SCREEN_DESKTOP,window.SCREEN_WIDE)?t(".breadcrumb").length>0&&(o=t('[itemprop="name"]').parent("A")):t(".category-up").length>0&&(o=t(".category-up").find("A")),i=t('[data-role="compare-link-with-filters"]'),a.on("click",['[data-role="compare-link-with-filters"]','[itemprop="name"]'].join(","),n),void 0!==o&&o.length>0&&o.on("click",n))})}(jQuery),function(t){function e(e,v){var m=e.find(s),g=t(v.mobileFilterSelector),w=t(v.desktopFilterSelector),b=t(r);m.on("submit",function(){var e=[];t(this).find("[data-control-type]").each(function(){var n,r=t(this);switch(parseInt(r.data("control-type"))){case u:n=a(r);break;case f:case p:n=o(r);break;case h:n=i(r)}if(void 0!==n){var d=r.data("id");e.push('<input type=hidden name="'+v.urlParamName+"["+d+']" value="'+n+'" />')}}),t(this).append(e.join(""))});var E=null;if(w.on("change",function(e){var a=t(this),o=t(e.target),i=0,n=o.parents("[data-control-type]:first");if(a.find(l).hide(0,function(){t(this).remove()}),!0==(1===t(this).data(c)||void 0===t(this).data(c))&&n.length){var r=t('<div class="'+d+'">Показать</div>');switch(n.append(r),n.data("control-type")){case f:case p:var s=o.parents(".checkbox:first");i+=s.get(0).getBoundingClientRect().top+s.outerHeight()/2;break;default:i+=o.get(0).getBoundingClientRect().top+o.outerHeight()/2}i-=n.get(0).getBoundingClientRect().top,i-=r.outerHeight()/2,r.css({top:i}),r.on("click",function(){v.applyFilters(r)}),clearTimeout(E),E=setTimeout(function(){clearTimeout(E),r.fadeIn(300)},250)}}),m.on("change",function(e){var n=t(e.target).parents("[data-control-type]:first");if(n.length){var r;switch(parseInt(n.data("control-type"))){case u:r=a(n);break;case f:case p:r=o(n);break;case h:r=i(n)}void 0!==r?n.find("label").addClass("selected"):n.find("label").removeClass("selected"),v.changeFilter(n.data("id"),r)}}),t("html, body").on("click",function(e){t(e.target).hasClass(d)||t("."+d).fadeOut()}),g.length){var T=function(){C=!0,g.addClass("shown"),g.get(0).scrollTop=0,t(window).trigger(window.EVENT_OPENED_MOBILE_FILTERS_MENU)},_=function(){C=!1,g.removeClass("shown"),t(window).trigger(window.EVENT_CLOSED_MOBILE_FILTERS_MENU)},y=t(n),C=y.is(".shown");t(window).on(window.EVENT_OPEN_MOBILE_FILTERS_MENU,T),t(window).on(window.EVENT_CLOSE_MOBILE_FILTERS_MENU,_),y.on("click",function(){t(window).trigger(C?window.EVENT_CLOSE_MOBILE_FILTERS_MENU:window.EVENT_OPEN_MOBILE_FILTERS_MENU)}),g.aggregateForm(function(e){e.each(function(){t(this).find('input[type=hidden][name^="'+v.urlParamName+'"]').remove()})}),t("[data-role=submit-mobile-filters]").on("click",function(){v.applyFilters(g.find("[type=submit]:first"))});var k=t(".filters-content");if(!k.length)return;t(document).on("click",".hide-filter",function(){var e=t(this).closest(".filter"),a=e.get(0).getBoundingClientRect(),o=a.top-filtersContainerBBox.top;o>0||(k.get(0).scrollTop=k.get(0).scrollTop+o)})}v.afterInit(m,w);var I={};m.filter("[name]").each(function(){var e=this.name;I.hasOwnProperty(e)||(I[e]=t()),I[e].push(this)});for(var S in I)I.hasOwnProperty(S)&&I[S].change(function(t){var e="value";/^input$/i.test(t.target.tagName)&&/^(radio)|(checkbox)$/i.test(t.target.type)&&(e="checked"),I[S].not(this).find('[data-id="'+t.target.dataset.id+'"]').each(function(){this[e]=t.target[e]})});if(b.length){var O=w.find(".apply-filters-box:not(.sticky)");t(window).on("scroll resize",function(){if(0!==O.length){if(O.get(0).getBoundingClientRect().top+O.outerHeight()/2<t(window).height())return void w.find(".apply-filters-box.sticky").fadeOut(300,function(){t(this).remove()});var e=w.find(".apply-filters-box.sticky");e.length||(e=O.clone(),e.addClass("sticky"),w.find("form").append(e));var a=t(window).height()-e.outerHeight(),o=b.get(0).getBoundingClientRect().left,i=b.outerWidth();e.css("cssText","top: "+a+"px !important; left: "+o+"px !important; width: "+i+"px !important;"),e.show()}})}}function a(t){var e=t.find("SELECT");if(""!==e.val())return e.val()}function o(e){var a=[];if(e.find('INPUT[type="checkbox"]').each(function(){var e=t(this);e.is(":checked")&&a.push(e.data("id"))}),0!==a.length)return a.join("-")}function i(t){var e=t.find('[data-name="min"]'),a=t.find('[data-name="max"]'),o=e.val().trim(),i=a.val().trim();if(""===o&&(o=e.attr("placeholder")),""===i&&(i=a.attr("placeholder")),o!==e.attr("placeholder")||i!==a.attr("placeholder"))return o+"-"+i}window.EVENT_OPEN_MOBILE_FILTERS_MENU="filters-menu:mobile:open",window.EVENT_CLOSE_MOBILE_FILTERS_MENU="filters-menu:mobile:close",window.EVENT_OPENED_MOBILE_FILTERS_MENU="filters-menu:mobile:opened",window.EVENT_CLOSED_MOBILE_FILTERS_MENU="filters-menu:mobile:closed";var n="[data-toggle-mobile-filters]",r=".extended-filters-wrap",d="apply-filters-btn",l="."+d,s="form[name=characteristics]",c="need-display-btn-apply",u=1,f=2,p=3,h=4,v={urlParamName:"f",desktopFilterSelector:'#desktop-characteristic-filters, [data-role="desktop-characteristic-filters"]',mobileFilterSelector:'#menu-filters-aside, [data-role="menu-filters-aside"]',afterInit:function(){},applyFilters:function(t){},changeFilter:function(t,e){}};t(function(){var e=t(".catalog-filters");0!==e.length&&e.catalogCharacteristicFilters({urlParamName:e.data("url-param-name"),afterInit:function(e,a){e.each(function(){t(this).aggregateForm(function(e){e.each(function(){t(this).find('input[type=hidden][name^="'+m.urlParamName+'"]').remove()})})}),a.aggregateForm(function(e){e.each(function(){t(this).find('input[type=hidden][name^="'+m.urlParamName+'"]').remove()})})},applyFilters:function(t){t.parents("form:first").submit()}})});var m;t.fn.catalogCharacteristicFilters=function(a){var o=t(this);m=t.extend({},v,a),e(o,m)}}(jQuery),function(t,e){window.EVENT_COMPARE_BUTTON_APPLY_MAIN_BTN_COUNT="compare-button-widget:apply-main-btn-count",e(function(){var t=e(window.SELECTOR_COMPARE_BTN_GLOBAL);0!==t.length&&(t.initSets(!1),window.addEventListener(window.EVENT_COMPARE_BUTTON_APPLY_MAIN_BTN_COUNT,function(a){var o=a.detail,i=o>0?"active":"default";t.applySets(i,{totalCount:o}),e(window).trigger(window.EVENT_MOBILE_UPDATE_NOTIFIER,{activity:window.NOTIFY_ACTIVITY_COMPARE,count:o})}))})}(document,jQuery),function(t,e){window.EVENT_INIT_PRODUCTS_SLIDER="productSlider:init";e.fn.productsSliderWidget=function(){var a=e(this);if(!0!==a.data("initiated")){var o=function(t){e(".nav-btn",a).removeClass("disabled"),-1!==t.visibleItems.indexOf(0)&&e(".btn-prev",a).addClass("disabled"),-1!==t.visibleItems.indexOf(t.owlItems.length-1)&&e(".btn-next",a).addClass("disabled")},i=a.find("[data-role=products-slider]");if(0!==i.length){var n=function(){var t=a.width();return 1099<t?5:1099>t&&860<=t?4:860>t&&500<=t?3:500>t&&380<=t?2:1};if(a.width()<220)return void setTimeout(function(){a.productsSliderWidget()},1e3);if("object"!==_typeof(i.data("owlCarousel"))){var r=n();i.owlCarousel({items:r,itemsDesktop:!1,itemsDesktopSmall:!1,itemsTablet:!1,itemsTabletSmall:!1,itemsMobile:!1,navigation:!1,pagination:!1,rewindNav:!0,autoPlay:!1,scrollPerPage:!1,afterInit:function(){e(".product",a).removeClass("transparent"),o(this.owl)},afterAction:function(){if(window.checkScreenType(window.SCREEN_MOBILE)){a.toggleClass("all-items-visible",this.itemsAmount===this.visibleItems.length);var t=this.visibleItems.pop()+1;a.toggleClass("last-item-visible",this.itemsAmount===t)}o(this.owl)}}),a.data("itemsCount",r),e(window).on("resize",function(){if(0!==e(t).find(i).length){var o=n();a.data("itemsCount")!==o&&(i.data("owlCarousel").reinit({items:o}),a.data("itemsCount",o))}})}else o(i.data("owlCarousel").owl);e(".nav-btn",a).off("click"),e(".btn-next",a).click(function(){e(this).is(".disabled")||i.trigger("owl.next")}),e(".btn-prev",a).click(function(){e(this).is(".disabled")||i.trigger("owl.prev")}),a.data("initiated",!0)}}};var a=function(){e("[data-role=products-slider-wrap]").each(function(){window.checkScreenType(window.SCREEN_MOBILE)&&0!==e(this).parents("[data-role=related-products-card-widget]").length||e(this).productsSliderWidget()})};e(window).on(window.EVENT_INIT_PRODUCTS_SLIDER,a),e(window).on("resize",a),e(function(){a()})}(document,jQuery),function(t){t(function(){function e(e){!0!==e.data("ac-initialized")&&e.length&&(e.searchAutoComplete({source:e.data("url"),minLength:3,search:function(){n=e.val()},select:function(t,a){void 0!==window.ga&&window.ga("send","pageview",e.data("ga-url")+encodeURIComponent(n)),void 0!==a.item.logGuid&&window.AddToLogActivityTarget([a.item.logGuid],a.item.id,a.item.targetType),window.location.href=a.item.url},open:function(){t("body").setScrollingStateFor(!0,[window.SCREEN_MOBILE,window.SCREEN_TABLET]),t(window).on("scroll",l)},close:function(){t("body").setScrollingStateFor(!1,[window.SCREEN_MOBILE,window.SCREEN_TABLET]),t(window).off("scroll",l)}}),e.data("ac-initialized",!0))}function a(){return r.filter(":visible")}function o(){a(),e(a())}function i(){var t=d.get(0).getBoundingClientRect(),e=0<=t.top&&t.top<=window.innerHeight,a=0<=t.bottom&&t.bottom<=window.innerHeight;return e&&a}var n="",r=t("[data-role=search-input]"),d=t("#header-search"),l=function(){var t=a();0!==t.length&&!1===i()&&t.searchAutoComplete("close")};t(window).on([window.EVENT_CHANGE_SCREEN_TYPE,window.EVENT_OPEN_SEARCH].join(" "),o),r.each(function(){var a=t(this);a.is(":visible")&&e(a)}),t(window).on(window.EVENT_CHANGE_HEADER_FIXED_STATE,function(t,e){if(!window.checkScreenType(window.SCREEN_MOBILE,window.SCREEN_TABLET)){var o=a();if(o.length){var i=o.data("custom-searchAutoComplete");if(void 0!==i){var n=i.menu.element,r=o.get(0).getBoundingClientRect(),d=r.bottom;n.toggleClass("fixed",e),!1===e&&(d+=window.pageYOffset),n.css({top:d,left:r.left,minWidth:r.width})}}}}),t(window).trigger(window.EVENT_HARD_CHECK_HEADER_FIXED_STATE)})}(jQuery),$.widget("custom.searchAutoComplete",$.ui.autocomplete,{_renderMenu:function(t,e){var a=this,o="";t.addClass("b-search-autocomplete");var i=this.term;a.searchVariants=[];var n=i.split(" ");for(var r in n)if(n.hasOwnProperty(r)){var d=n[r];if(d.length<2&&!0===isNaN(parseInt(d)))continue;a.searchVariants.push(String.escapeRegExp(d)),a.searchVariants.push(String.escapeRegExp(String.eToYoTransition(d))),a.searchVariants.push(String.escapeRegExp(String.YoToETransition(d))),a.searchVariants.push(String.escapeRegExp(String.switchKeyboard("lat",d))),a.searchVariants.push(String.escapeRegExp(String.escapeRegExp(String.switchKeyboard("rus",d))))}$.each(e,function(e,i){if(i.group!==o){var n=$("<li>").html(i.group);n.data("ui-autocomplete-item",i),n.addClass("ui-autocomplete-group-title"),i.isCategory&&n.addClass("ui-autocomplete-category"),i.isProduct&&n.addClass("ui-autocomplete-product"),t.append(n),o=i.group}var r=a._renderItemData(t,i);i.group&&r.attr("aria-label",i.group+" : "+i.label)})},_renderItem:function(t,e){var a=$("<li>"),o=$("<a/>"),i=new RegExp("("+this.searchVariants.join("|")+")","gi"),n=e.label.replace(i,"<mark>$1</mark>");return a.attr("data-value",e.value),o.html(n),e.isCategory&&a.addClass("category-el"),e.isProduct&&a.addClass("product-el"),a.append(o).appendTo(t),a}}),function(t,e){e(function(){var t=e("#f-check-invoice-payment");0!==t.length&&t.on("submit",function(){return t.find('INPUT[type="text"]').val().trim().length<10?(alert("Номер счёта введён неправильно."),!1):"ajax"===t.data("method")?(e.post(t.attr("action"),t.serialize(),function(t){e("#b-check-invoice-payment-result").html(t)}),!1):void 0})})}(document,jQuery),function(){var t="show-3d-image",e=-1,a=function(){function a(o){var i=this;_classCallCheck(this,a),this.container=document.getElementById(o),null!==this.container&&(this.shots=[],this.currentShotIndex=0,this.rotationTimeoutId=void 0,this.image3D=void 0,this.preloader=void 0,this.directions=new Map,this.shotUrlKey=void 0,this.autoPlayDirection=e,this.currentPanDirection=void 0,this.panStartX=void 0,this.shotsDelta=0,this.panHandler=function(t){if(i.stopRotation(),!1!==i.directions.has(t.direction)){var e=i.directions.get(t.direction);e!==i.currentPanDirection&&(i.panStartX=t.center.x,i.currentPanDirection=e);for(var a=Math.min(i.container.getBoundingClientRect().width),o=Math.min(Math.abs(i.panStartX-t.center.x),a),n=Math.round(a/2/i.shots.length),r=Math.round(o/n),d=0;d<r-i.shotsDelta;d++)i.rotate(e);i.shotsDelta=r}},document.addEventListener("click",function(e){void 0!==e.target&&t===e.target.dataset.role&&i.init()},!0))}return _createClass(a,[{key:"init",value:function(){var t=this;if(void 0===this.image3D){this.preloader=this.container.querySelector('[data-role="ajax-loader-circular"]'),this.preloader.classList.remove("hidden");var a=document.createElement("div"),o=0,i=void 0,n=function(){t.container.removeChild(a);var o=t.container.querySelector('[data-role="image-container"]');if(null!==o){var i=o.querySelector("img");null===i&&(i=document.createElement("img"),o.appendChild(i)),t.image3D=i,0===t.directions.size&&(t.directions.set(Hammer.DIRECTION_RIGHT,1),t.directions.set(Hammer.DIRECTION_LEFT,e));var n=new Hammer(t.image3D);n.on("panleft panright press",t.panHandler),n.on("tap",function(){void 0===t.rotationTimeoutId?t.startRotation():t.stopRotation()}),n.on("panend",function(){t.stopRotation(),t.currentPanDirection=void 0,t.panStartX=void 0}),n.on("panstart",function(e){t.panStartX=e.center.x,t.currentPanDirection=e.direction,t.shotsDelta=0}),t.preloader.classList.add("hidden"),t.rotate(0),t.startRotation()}};this.setupShotUrl(),this._disableNativeEvents(),a.style.display="none",a.addEventListener("event:shots-loaded",n),this.shots.forEach(function(e){i=document.createElement("img"),i.src=e[t.shotUrlKey],i.onload=function(){++o===t.shots.length&&a.dispatchEvent(new CustomEvent("event:shots-loaded"))},a.appendChild(i)}),this.container.appendChild(a),window.onresize=function(){t.setupShotUrl()}}}},{key:"setupShotUrl",value:function(){this.shotUrlKey="desktopUrl",window.checkScreenType(window.SCREEN_TABLET)?this.shotUrlKey="tabletUrl":window.checkScreenType(window.SCREEN_MOBILE)&&(this.shotUrlKey="mobileUrl")}},{key:"startRotation",value:function(){var t=this,a=e===this.autoPlayDirection&&0===this.currentShotIndex,o=1===this.autoPlayDirection&&this.shots.length===this.currentShotIndex+1,i=a||o?700:150;this.rotationTimeoutId=setTimeout(function(){o?t.autoPlayDirection=e:a&&(t.autoPlayDirection=1),t.rotate(t.autoPlayDirection),t.startRotation()},i)}},{key:"stopRotation",value:function(){clearTimeout(this.rotationTimeoutId),this.rotationTimeoutId=void 0}},{key:"rotate",value:function(t){this.currentShotIndex+=t,this.currentShotIndex>=this.shots.length?this.currentShotIndex=this.shots.length-1:this.currentShotIndex<0&&(this.currentShotIndex=0),this.image3D.src=this.shots[this.currentShotIndex][this.shotUrlKey]}},{key:"_disableNativeEvents",value:function(){this.container.onselectstart=function(){return!1},this.container.ondblclick=function(){return!1}}}]),a}(),o=new Map;window.slider3DImage=function(t){return!1===o.has(t)&&o.set(t,new a(t)),o.get(t)}}(),function(t,e,a){window.EVENT_INIT_COMMENTS_WIDGET="commentsWidget:init",window.EVENT_SUBMIT_COMMENTS_WIDGET="commentsWidget:submit";var o="[data-role=comments-widget]";e.fn.commentsWidget=function(){function i(){C.closest("opinion-item")?(C.closest(".opinion-item").find(".comments-form").removeClass("visible"),k.prop("disabled",!1)):k.prop("disabled",!1).show(),I.hide()}function n(t,a){if(a=void 0!==a?a:"00000000-0000-0000-0000-000000000000",!(t instanceof Function))throw"Не указан обязательный параметр cb";var o=C.find(w+'[data-parent-id="'+a+'"]');return 0!==o.length?t(o):e.ajax({url:C.find(h).data("form-url"),type:"GET",data:{parentId:a},dataType:"JSON",success:function(o){!0===o.result&&(t(e(o.content)),C.find(w+'[data-parent-id="'+a+'"]').find(E).select2().next().css("display","block"))}})}function r(){return C.find("["+y+"]")}function d(t){var a=t?e(this).closest(w):r();if(0!==a.length){var o=void 0;a.is(w)?o=a.prev():(o=a,a=o.next()),a.is(w)&&a.hide(),o.removeAttr(y);o.find(m).removeClass("active")}}function l(){var a=e(this),o=a.closest(g),r=o.find(m);return r.addClass("active"),I.html().trim().length&&i(),d(),n(function(a){o.after(a);var i=a.find(b),n=(e(t).width()-e("main").width())/2,l=r.offset().left-n-i.width()-12;i.css({left:l}).show(),a.show(),a.find(window.SELECTOR_CAPTCHA_RELOAD).trigger("reload"),o.attr(y,""),a.find(v).click(d)},o.data("id")),!1}function s(t){t.find(m).click(l),t.find(".vote-widget-container[data-has-many-negative]").each(function(){e(this).closest(g).addClass("has-many-negative")})}function c(){S.show()}function u(){S.hide()}function f(){var t=arguments.length>0&&arguments[0]!==a&&arguments[0],o={};o.page=L,o.limit=N,c(),e.ajax({url:C.data("request-url"),type:"GET",data:o,dataType:"JSON",success:function(a){if(!0===a.result){u();var o=e(a.content);s(o),C.find(".comments").append(o),L++,!0===t&&p(),e(window).trigger(window.EVENT_INIT_VOTE_WIDGET),e(window).trigger(window.EVENT_INIT_CLAIM_WIDGETS)}}})}function p(){var t=e(_),a=e(T),i=void 0;0!==a.length?i=a.parent().offset().top-t.height():(a=e(o),i=a.offset().top-t.height()-30),e("html, body").animate({scrollTop:i},"slow")}var h='[data-role="add-form"]',v='[data-role="cancel"]',m=".sub-add-comment",g=".comment",w=".comment.reply",b=".border-triangle",E='[data-role="city-selector"]',T='a[href="\\#comment"]:visible',_="#header-search",y="data-opened",C=e(this);if(!C.data("initiated")){C.data("initiated",1);var k=C.find(h),I=C.find(".add-form-container"),S=C.find('[data-role="comments-loader"]'),O=C.find(".comments-container"),N=parseInt(C.data("limit")),L=parseInt(O.find('[data-role="pagination"]').data("current-page"))+1;s(O.find(g)),C.on("click","a[data-page]",function(){return L=parseInt(e(this).data("page"))+1,C.find(".comments").html(""),f(!0),!1}),C.on("click",'[data-role="show-more"]',function(){return C.find(".pagination-container").remove(),f(),!1}),C.on("click",v,i),C.on("click",h,function(){e(this).prop("disabled",!0),n(function(t){d(),C.find(".add-form-container").html(t).show()},a)}),C.on("submit","FORM",function(){var t=e(this),a=t.serializeArray();return e(window).trigger(window.EVENT_SUBMIT_COMMENTS_WIDGET,a),e.ajax({url:t.attr("action"),type:"POST",dataType:"JSON",data:a,success:function(a){if(!0===a.result){var o=t.closest(w),i=C.find(g+'[data-id="'+o.data("parent-id")+'"]');if(o.remove(),C.find(".add-form-container").html(a.content).show(),C.closest("opinion-item")?C.find(h).prop("disabled",!1):C.find(h).prop("disabled",!1).show(),a.comment&&"string"==typeof a.comment.valueOf()){var n=e(a.comment);0!==i.length?(n.attr("data-child",i.data("child")+1),i.last().after(n)):C.find(".comments-container").prepend(n),n.addClass("new"),n.on("click",m,l)}window.setTimeout(function(){C.find(".add-form-container").find(".alert-success").fadeTo(500,0).slideUp(500,function(){e(this).remove()})},4e3)}},error:function(){C.find(h).prop("disabled",!1).show()}}),!1}),C.on("click",'[data-role="open-answer"]',function(){var t=e(this),a=t.find(".open-close-answer-text"),o=t.find('[data-role="open-close-answer-icon"]'),i=t.parents(g),n=C.find('.comment-answer[data-parent-comment-guid="'+i.attr("data-id")+'"]');o.toggleClass("close"),n.hasClass("hidden")?(n.removeClass("hidden"),a.html("Свернуть ответы")):(n.addClass("hidden"),a.html("Развернуть ответы ("+n.find('[data-child="1"]').length+")"))})}};var i=function(){e(o).each(function(){e(this).commentsWidget()})};e(function(){i(),e(window).on(window.EVENT_INIT_COMMENTS_WIDGET,i)})}(document,jQuery),function(t){t(function(){var e=t("#subscription-widget"),a=e.find("[data-role=input-container]"),o=e.find("[data-role=success-message]");if(0!==e.length){var i=e.find('[data-role="message-container"]');e.on("submit","FORM",function(){var e=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;i.toggleClass("hidden",!1).toggleClass("alert-success",e).toggleClass("alert-warning",!1===e).text(t),a&&setTimeout(function(){i.addClass("hidden")},a)},n=t(this);return t.ajax({url:n.attr("action"),type:"POST",data:n.serializeArray(),dataType:"JSON",success:function(t){!0===t.result?(a.addClass("hidden"),o.removeClass("hidden")):e("Извините. Произошла ошибка.")},error:function(){e("Извините. Произошла ошибка.")}}),!1}),e.on("click","[data-role=dismiss-btn]",function(){e.addClass("hidden")})}})}(jQuery),function(t,e){function a(){function a(t){t.addClass("hidden"),t.after(k.clone())}function w(t){var e=t.next(".loading-dots");e.length&&e.detach(),t.removeClass("hidden")}function b(){a(T),e.ajax({url:T.data("request-url"),type:"GET",dataType:"JSON",success:function(t){if(!0===t.result){var a=e(t.content);T.replaceWith(a),T=a}w(T),e(window).trigger(window.EVENT_INIT_CLAIM_WIDGETS)}})}var E=e("#faq"),T=E.find("[data-role=faq-tab-content]"),_=e(".faq-controls"),y=e(".faq-best-assistants"),C=e("[data-role=question-form-container]");if(0!==T.length){var k=e("<div><span /><span /><span /><span /></div>").addClass("loading-dots");e(t).on("tabSelected","#faq",function(){T.is(":empty")&&b()}),E.on("click","[data-role=toggle-topic]",function(){return e(this).closest("[data-role=topic]").toggleClass("expand"),!1}),E.on("click","[data-role=toggle-question]",function(){return e(this).closest("[data-role=question]").find("[data-role=question-content]").toggleClass("hidden"),!1}),E.on("click","[data-role=show-question-form]",function(t){t.preventDefault();var o=e(this);0===e(g).length?(a(C),e.ajax({url:o.data("get-form-url"),type:"GET",dataType:"JSON",success:function(t){if(!0===t.result){var a=e(t.content);C.append(a),e(g).removeClass("hidden")}w(C)}})):e(g).removeClass("hidden"),y.addClass("hidden"),o.addClass("hidden"),_.addClass("hidden")}),E.on("click","[data-role=hide-question-form]",function(t){t.preventDefault(),e("[data-role=question-form]").addClass("hidden"),e("[data-role=show-question-form]").removeClass("hidden"),e(".faq-best-assistants").removeClass("hidden"),e(".faq-controls").removeClass("hidden")}),E.on("click","[data-role=submit-question-form]",function(t){t.preventDefault();var o=e(this),i=e(g).serializeArray();return e(window).trigger(window.EVENT_SUBMIT_QUESTION_WIDGET,i),a(C),e.ajax({url:o.data("submit-form-url"),type:"POST",dataType:"JSON",data:i,success:function(t){if(!0===t.result){if(C.html(t.content),t.errors.hasOwnProperty("fatal"))return C.find(".alert-danger").append(t.errors.fatal).removeClass("hidden"),void window.setTimeout(function(){C.find(".alert-danger").fadeTo(500,0).slideUp(500)},5e3);if(!0===t.hasOwnProperty("updateTab")&&!0===t.updateTab)b();else{var a=e('[data-role="topic-container"]'),o=e('[data-topic-id="'+t.topicId+'"]'),i=e(t.question),n=o.find('[data-role="count-questions"]'),r=parseInt(n.text());i.addClass("new"),a.prepend(e(t.message)),o.removeClass("hidden").addClass("expand").find(".questions").prepend(i),n.text(r+1),e("[data-role=show-question-form]").removeClass("hidden"),e(g).remove(),window.setTimeout(function(){a.find(".alert-warning").fadeTo(500,0).slideUp(500)},12e3)}}}}),w(C),!1}),E.on("click","[data-role=show-answer-form]",function(t){t.preventDefault();var o=e(this),i=e("[data-role=show-answer-form]"),n=o.closest('[data-role="question"]').find("[data-role=answer-form-container]"),r=n.find("[data-role=answer-form]");0===r.length?(a(n),e.ajax({
url:o.data("get-form-url"),type:"GET",dataType:"JSON",success:function(t){if(!0===t.result){var a=e(t.content);n.append(a),r=a,r.removeClass("hidden")}w(n)}})):(r.appendTo(n),r.removeClass("hidden")),i.removeClass("hidden"),o.addClass("active")}),E.on("click","[data-role=hide-answer-form]",function(t){t.preventDefault(),e("[data-role=answer-form]").addClass("hidden"),e("[data-role=show-answer-form]").removeClass("active")}),E.on("click","[data-role=submit-answer-form]",function(t){t.preventDefault();var o=e(this),i=o.closest("[data-role=answer-form]"),n=i.closest("[data-role=answer-form-container]");a(n);var r=i.serializeArray();return e(window).trigger(window.EVENT_SUBMIT_ANSWER_WIDGET,r),e.ajax({url:o.data("submit-form-url"),type:"POST",dataType:"JSON",data:r,success:function(t){if(!0===t.result)if(!0===t.hasOwnProperty("updateTab")&&!0===t.updateTab)b();else{w(n);var a=e(t.answer),o=e('[data-role="topic-container"]'),i=e('[data-role="show-answer-form"]');a.addClass("new"),i.removeClass("active"),n.next('[data-role="answers-container"]').prepend(a),o.prepend(e(t.message)),n.html(""),window.setTimeout(function(){o.find(".alert-warning").fadeTo(500,0).slideUp(500)},4e3)}}}),!1}),E.on("click",s,function(t){t.preventDefault();var a=e(this),o=a.closest(l),i=o.find(f),n=i.find(p),r=i.find(h),d=i.find(v);return!o.is("[data-voted]")&&(o.attr("data-voted",!0),e.ajax({url:o.data("url"),type:"POST",dataType:"JSON",data:{vote:a.data("vote-type")},success:function(t){if(!1===t.result||t.hasOwnProperty("error"))return o.removeAttr("data-voted"),!1;var e=parseInt(n.text())||0,l=parseInt(r.text())||0,s=parseInt(d.text())||0;a.is(c)?(e+=1,l+=1):a.is(u)&&(e-=1,s-=1),n.text(e),r.text(l),d.text(s),0>e?i.removeClass("positive").addClass("negative"):0<e?i.removeClass("negative").addClass("positive"):i.removeClass("negative").removeClass("positive"),a.addClass("voted")},error:function(){o.removeAttr("data-voted")}}),!1)}),E.on("click",f,function(){e(this).find(o).show()}).on("mouseleave",f,function(){0!==window.getVisible(o).length&&e(this).find(o).hide()}),E.on("click",d,function(){e("input[type=checkbox]:checked",this).length>0?(1===e("input[type=checkbox]:checked",".faq-controls .dropdown-menu").length&&e(".topic",E).addClass("hidden"),e("[data-topic-id="+e("input[type=checkbox]",this).val()+"]").removeClass("hidden")):e("[data-topic-id="+e("input[type=checkbox]",this).val()+"]").addClass("hidden"),0===e("input[type=checkbox]:checked",".faq-controls .dropdown-menu").length&&e(".topic",E).removeClass("hidden")}),E.on("click",n,function(){e(i).hasClass("open")?(e(this).removeClass("open"),e(this).find("a").text("Развернуть"),e(i).removeClass("open")):(e(this).addClass("open"),e(this).find("a").text("Свернуть"),e(i).addClass("open"))}),E.on("click",r,function(){e(this).addClass("hidden").prev(".answers").find(".answer").removeClass("hidden")}),e(m).prop("checked")||e(m).prop("disabled",!1),E.on("click",m,function(){var t="Произошла ошибка. Повторите попытку позже.",a=e(this);e.ajax({url:a.data("url"),type:"GET",dataType:"JSON",success:function(e){!0===e.result&&(t=a.prop("checked")?"Вы подписаны на уведомления о новых вопросах к данному товару,уведомления будут приходить на электронную почту. Отписаться от уведомлений,Вы сможете в карточке спустя некоторое время или в письме с уведомлением о новом вопросе.":"Вы отписались от рассылки по вопросам")}}).always(function(){a.prop("disabled",!0),e(".subscribe-alert").css("display","block"),e(".subscribe-alert > SPAN").text(t),setTimeout(function(){e(".subscribe-alert").fadeOut("slow")},1e4)})})}}window.EVENT_SUBMIT_QUESTION_WIDGET="questionWidget:submit",window.EVENT_SUBMIT_ANSWER_WIDGET="answerWidget:submit";var o=".vote-counter-expand",i=".disclaimer",n=".disclaimer .expand-btn",r=".question .show-remain-answers",d=".faq-controls .dropdown-menu .checkbox",l="[data-role=faq-vote-container]",s="[data-role=vote]",c="[data-vote-type=up]",u="[data-vote-type=down]",f="[data-role=counter-container]",p="[data-role=counter-all]",h="[data-role=counter-up]",v="[data-role=counter-down]",m="#subscribe-on-questions",g="[data-role=question-form]";e(t).ready(function(){a(),window.addEventListener(window.EVENT_INIT_FAQ_WIDGETS,a)})}(document,jQuery),function(t,e,a){var o="#b-feedback-upload-images";e(function(){o=e(o),0!==o.length&&o.find('[data-action="remove"]').click(function(){var t=e(this).closest("[data-image-index]");t.find(".image-preview IMG").removeAttr("src"),t.find("INPUT[data-ajax-image-id]").val("")})})}(document,jQuery),function(t){function e(t){s.closest(".form-group").addClass("has-error").find(".help-block-error").text(t)}function a(){s.closest(".form-group").removeClass("has-error").find(".help-block-error").empty()}function o(t){l.val(t)}var i=t("#feedback-answer-form"),n=t("[data-role=show-answer-create-form-btn]"),r=t("[data-role=hide-answer-create-form-btn]"),d=t("[data-role=ticket-charter-input]"),l=t("[data-role=ticket-theme-input]"),s=t("[data-role=themes-container]"),c=t("[data-role=mute-block]"),u=t("[data-role=btn-submit]"),f=t("[data-role=comment]"),p=t("[data-role=message-toggle]"),h=t("#email-confirm-modal"),v=t("#ticket-create-form"),m=t("#ticketcreateform-useremail"),g=t("#email-modal-submit"),w=t("#feedback-my-tickets-tabs-block");0!==w.length&&w.responsiveTabs({active:0,setHash:!0,collapsible:"accordion",classes:{stateDefault:"r-tabs-state-default",stateActive:"active",stateDisabled:"r-tabs-state-disabled",stateExcluded:"r-tabs-state-excluded",tab:"r-tabs-tab",anchor:"r-tabs-anchor",panel:"r-tabs-panel",accordionTitle:"r-tabs-accordion-title"}}),0!==s.find(".selected").length&&c.addClass("hidden"),n.on("click",function(){n.addClass("hidden"),i.removeClass("hidden")}),r.on("click",function(){i.addClass("hidden"),n.removeClass("hidden")}),p.on("click",function(){t(this).closest("[data-role=message-block]").toggleClass("opened")}),d.on("change",function(){t.ajax({url:d.data("url"),type:"GET",dataType:"JSON",data:{charterGuid:d.val()},success:function(t){t?(a(),s.html(t),c.removeClass("hidden"),o(null)):e("В выбранном разделе отсутствуют темы")},error:function(){e("Ошибка. Повторите попытку позже.")}})}),s.on("click","[data-role=theme]",function(){var e=t(this);t("[data-role=theme]").removeClass("selected"),e.addClass("selected"),a(),c.addClass("hidden"),o(e.attr("data-theme-id"))}),f.on("input",function(){u.prop("disabled",t(this).attr("data-min-length")>t(this).val().trim().length)}),v.on("submit",function(){if(!1===m.hasClass("send-empty")){var e=m.val();if(""===t.trim(e))return h.modal("show"),!1}}),g.on("click",function(){m.addClass("send-empty"),v.submit()})}(jQuery),function(t,e,a){function o(){if(!1!==r()){var o="";if(window.getSelection?o=window.getSelection().toString():t.selection&&"Control"!==t.selection.type&&(o=t.selection.createRange().text),o=o.trim(),o=o.replace(/[ ]{2,}/gim," "),o=o.replace(/\r/gim,""),o=o.replace(/\n{2,}/gim,"\n"),""!==(o=o.replace(/^[ ]+([^ ])/gim,"$1")))return a===i&&(i=e("#b-feedback-fast-dialog"),n=i.find('[data-role="create-ticket-form-text-input"]'),i.find('[data-action="confirm"]').click(function(){e(this).prop("disabled",!0),e("#b-feedback-fast-form").submit()})),n.val(o+"\n- - -\n\n"),i.modal("show"),n.focus(),n.get(0).selectionStart=n.val().length,!1}}var i=void 0,n=void 0;e(function(){e("#feedback-fast-dialog-show").on("click",o),e(t).keydown(function(t){KeyboardCodes.ENTER===t.keyCode&&!0===t.ctrlKey&&o()})});var r=function(){return null!==t.querySelector('[data-role="feedback-modal-fast-dialog"]')}}(document,jQuery),function(t,e){t(function(){t(e).on("submit","[data-role=inform-about-product-availability-form]",function(){var e=t(this);if(e.data("disabled"))return!1;e.data("disabled",!0);var a=e.find("button");return a.toggleClass("disabled",!0),e.find(".alert").remove(),t.ajax({url:e.attr("action"),dataType:"JSON",type:"POST",data:e.serialize(),success:function(t){!0===t.result?(setTimeout(function(){e.closest(".modal").modal("hide")},3e3),e.replaceWith('<div class="alert alert-success">Спасибо за ваше обращение. Специалисты его рассмотрят и свяжутся с вами в ближайшее время.</div>')):0!==t.errors.length?e.prepend('<div class="alert alert-danger">Исправьте следующие ошибки:<ul><li>'+t.errors.join("</li><li>")+"</li></ul></div>"):e.prepend('<div class="alert alert-danger">Не удалось выполнить запрос</div>')},error:function(){e.prepend('<div class="alert alert-danger">Не удалось выполнить запрос</div>')}}).always(function(){e.data("disabled",!1),a.toggleClass("disabled",!1)}),!1})})}(jQuery,document),FilterBlockCheckboxList.prototype=Object.create(FilterBlock.prototype),FilterBlockCheckboxList.prototype.constructor=FilterBlockCheckboxList,FilterBlockCheckboxList.prototype.init=function(t){var e=this,a='[data-role="filter-block-item"]',o="empty-result";if(FilterBlock.prototype.init.apply(this,[t]),window.checkScreenType(window.SCREEN_MOBILE,window.SCREEN_TABLET)){if(1===parseInt(this.$block.data("variants-count")))return;this.$block.find('[data-toggle="collapse"]').attr("aria-expanded","false").addClass("collapsed").end().find(".filter-block-items").removeClass("in")}var i=this,n=i.$block.find('[data-role="'+o+'"]'),r=i.$block.find('[data-role="clear-search-container"]'),d=i.$block.find('[data-role="clear-search-button"]');i.$block.on("keyup",'input[data-role="filter-items-search"]',function(t){function e(){i.$block.find('[data-role="'+o+'"]').addClass("hidden"),i.$block.find("mark").each(function(){$(this).parent().text($(this).parent().text())}),r.addClass("hidden"),i.$block.find(a).removeClass("hidden")}var l=$(this),s=i.$block.find(a+':not(".hidden")');KeyboardCodes.ENTER===t.keyCode&&1===s.length&&!1===s.find('[type="checkbox"]').prop("checked")&&(s.find('[type="checkbox"]').prop("checked",!0),i.$block.trigger(window.EVENT_FILTER_BLOCK_AFTER_CHANGE),$(window).trigger(window.EVENT_DESTROY_TOOLTIPS));var c=$(this).val().toLowerCase();if(e(),d.addClass("hidden"),0===c.length)l.tooltip("destroy");else{0===d.length&&(d=$("<span/>"),d.attr("data-role","clear-search-button"),d.attr("class","hidden-md hidden-lg"),l.after(d),d.on("click",function(){e(),l.val(""),d.addClass("hidden")})),d.removeClass("hidden"),0===r.length&&(r=$("<div/>"),r.attr("data-role","clear-search-container"),r.append($("<a/>",{html:"Сбросить поиск",href:"#"})),i.$block.find(".filter-block-items").append(r),r.find("a").on("click",function(){return e(),l.val(""),d.addClass("hidden"),!1})),r.removeClass("hidden");var u=String.getSearchStringVariants(c),f=[];i.$block.find("label:not(.filter-block-title)").each(function(){var t=$(this);f[t.attr("for")]=t.text(),t.text(t.text().toLowerCase()),t.attr("data-found",0)});for(var p in u)u.hasOwnProperty(p)&&i.$block.find('label:not(.filter-block-title):contains("'+u[p]+'")').attr("data-found",1);var h=i.$block.find("[data-found=1]");for(var v in f)f.hasOwnProperty(v)&&i.$block.find('label[for="'+v+'"]').text(f[v]);if(0===h.length)return i.$block.find(a).addClass("hidden"),0===n.length?(n=$("<div/>",{html:"К сожалению, ничего не найдено"}),n.attr("data-role",o),l.parent().after(n)):n.removeClass("hidden"),!1;i.$block.find(a).addClass("hidden"),h.each(function(){var t=$(this),e=t.closest(a),o=t.text().replace(new RegExp("("+u.join("|")+")","gi"),"<mark>$1</mark>");t.html(o),e.removeClass("hidden")}),1!==h.length||window.checkScreenType(window.SCREEN_MOBILE,window.SCREEN_TABLET)?l.tooltip("destroy"):l.tooltip({html:!0,placement:"right",trigger:"focus",title:"Чтобы выбрать <b>"+h.text()+"</b>, нажмите Enter"}).tooltip("show")}}),i.$block.on("change",function(){var t=e.$block.find(':input[type="checkbox"]:checked').length;e.$block.find("[data-role=selected-filters-counter]").text("("+t+")").toggleClass("hidden",0===t)})},FilterBlockCheckboxList.prototype.getSelectedValue=function(){var t=[];return this.$block.find(':input[type="checkbox"]:checked').each(function(){t.push($(this).data("id"))}),this.$block.find("label").first().toggleClass("selected",0!==t.length),0!==t.length?t.join("-"):void 0},FilterBlockCheckboxList.prototype.reset=function(){this.$block.find("[data-role=selected-filters-counter]").addClass("hidden"),this.$block.find('[type="checkbox"]').prop("checked",!1)},FilterBlockCheckbox.prototype=Object.create(FilterBlock),FilterBlockCheckbox.prototype.constructor=FilterBlockCheckbox,FilterBlockCheckbox.prototype.getSelectedValue=function(){var t=this.$block.find(':input[type="checkbox"]:checked').first();return this.$block.find("label").first().toggleClass("selected",0!==t.length),0!==t.length?t.data("id"):void 0},FilterBlockCheckbox.prototype.reset=function(){this.$block.find('[type="checkbox"]').prop("checked",!1)};var SELECTOR_INTERVAL_SLIDER='[data-role="interval-slider"]',SELECTOR_FILTER_INTERVAL_TO='[data-type="to"]',SELECTOR_FILTER_INTERVAL_FROM='[data-type="from"]';FilterBlockInterval.prototype=Object.create(FilterBlock.prototype),FilterBlockInterval.prototype.constructor=FilterBlockInterval,FilterBlockInterval.prototype.init=function(t){FilterBlock.prototype.init.apply(this,[t]);var e=this,a=this.$block.find("[data-role=presets-block]");0!==a&&(a.on("change","[type=radio]",function(){var t=$(this);if(t.is("[data-role=preset-all]"))e.reset();else{var a=e.$block.find(SELECTOR_FILTER_INTERVAL_FROM).first(),o=e.$block.find(SELECTOR_FILTER_INTERVAL_TO).first();a.val(t.data("min")||a.data("default")),o.val(t.data("max")||o.data("default")),a.change(),o.change()}}),this.$block.on("change",[SELECTOR_FILTER_INTERVAL_FROM,SELECTOR_FILTER_INTERVAL_TO].join(", "),function(){var t=e.$block.find(SELECTOR_FILTER_INTERVAL_FROM).first(),o=parseFloat(t.val().trim()),i=t.data("default");o=isNaN(o)?i:o;var n=e.$block.find(SELECTOR_FILTER_INTERVAL_TO).first(),r=parseFloat(n.val().trim()),d=n.data("default");r=isNaN(r)?d:r;var l=void 0;l=o===i&&r===d?a.find("[type=radio][data-role=preset-all]"):o===i?a.find('[type=radio][data-max="'+r+'"]:not([data-min])'):r===d?a.find('[type=radio][data-min="'+o+'"]:not([data-max])'):a.find('[type=radio][data-min="'+o+'"][data-max="'+r+'"]'),0===l.length&&(l=a.find("[type=radio][data-role=preset-all]")),l.prop("checked",!0)}))},FilterBlockInterval.prototype.getSelectedValue=function(){var t=this.$block.find(SELECTOR_FILTER_INTERVAL_FROM).first(),e=this.$block.find(SELECTOR_FILTER_INTERVAL_TO).first(),a=t.val()||t.data("default"),o=e.val()||e.data("default");a=parseFloat(a),o=parseFloat(o);var i=parseFloat(t.data("default"))!==a||parseFloat(e.data("default"))!==o;return this.$block.find("label").first().toggleClass("selected",i),i?a+"-"+o:void 0},FilterBlockInterval.prototype.reset=function(){var t=[SELECTOR_FILTER_INTERVAL_FROM,SELECTOR_FILTER_INTERVAL_TO].join(",");this.$block.find(t).each(function(){var t=$(this);t.val(t.data("default")).change()})},FilterBlockInterval.prototype.updateFilterValues=function(t){var e=this.$block.attr("id");if(void 0!==e){var a=document.getElementById(e);if(null!==a){var o=a.querySelector(SELECTOR_INTERVAL_SLIDER);if(!0===t.showActual?(o.setAttribute("data-filtered-min",t.min),o.setAttribute("data-filtered-max",t.max)):(o.removeAttribute("data-filtered-min"),o.removeAttribute("data-filtered-max")),t.hasOwnProperty("presetsCounts"))for(var i in t.presetsCounts)if(t.presetsCounts.hasOwnProperty(i)){var n=t.presetsCounts[i],r=this.$block.find('[data-id="'+i+'"]');r.find("[data-filter-block-item-count]").attr("data-filter-block-item-count",n),r.toggleClass("empty",0===n)}}}},FilterBlockRadioList.prototype=Object.create(FilterBlock.prototype),FilterBlockRadioList.prototype.constructor=FilterBlockRadioList,FilterBlockRadioList.prototype.init=function(t){if(FilterBlock.prototype.init.apply(this,[t]),window.checkScreenType(window.SCREEN_MOBILE,window.SCREEN_TABLET)){if(1===parseInt(this.$block.data("variants-count")))return;this.$block.find('[data-toggle="collapse"]').attr("aria-expanded","false").addClass("collapsed").end().find(".filter-block-items").removeClass("in")}},FilterBlockRadioList.prototype.getSelectedValue=function(){var t=this.$block.find(':input[type="radio"]:checked').first();return this.$block.find("label").first().toggleClass("selected",0!==t.data("id")),0!==t.data("id")?t.data("id"):void 0},FilterBlockRadioList.prototype.reset=function(){this.$block.find('[type="radio"]:first').prop("checked",!0)},window.EVENT_FILTER_BLOCK_REESET="filter-block:block-reset",FilterBlockSelectShops.prototype=Object.create(FilterBlock.prototype),FilterBlockSelectShops.prototype.constructor=FilterBlockSelectShops,FilterBlockSelectShops.prototype.init=function(t){function e(){var t=C.$block.find(':input[type="checkbox"]:checked:not(#'+l+")"),e=C.$block.find("button .title"),a=C.$block.find(':input[type="checkbox"]:not(#'+l+")").length;1===parseInt(t.length)?e.text(t.closest("div").find("label")[0].innerText):0===parseInt(t.length)||a===t.length?e.text("Все"):e.text(String.countPostfix(t.length,["магазин","магазина","магазинов"],"",!1,""))}function a(){if(0<C.$block.find(':input[type="checkbox"]:checked:not(#'+l+")").length)return C.$block.find('[data-role="clear-selected-shops"]').removeClass("hidden"),void C.$block.find("button").addClass(u);C.$block.find('[data-role="clear-selected-shops"]').addClass("hidden"),C.$block.closest("div").find("button").removeClass(u)}function o(t){if(T=t,!(0<w.getElementsByTagName("div").length)){O.setAttribute("checked","checked"),n();for(var e=2>=E.length?E.length:3,a=0;a<e;a++)!function(t){var e=E[t].closest("div").cloneNode(!0);e.getElementsByTagName("input")[0].checked&&e.getElementsByTagName("label")[0].classList.add("selected"),e.getElementsByTagName("label")[0].setAttribute("data-id",e.getElementsByTagName("input")[0].getAttribute("data-id")),e.getElementsByTagName("label")[0].addEventListener("click",function(){e.getElementsByTagName("label")[0].classList.toggle("selected"),void 0!==_&&clearTimeout(_),_=setTimeout(function(){w.classList.add("hidden")},3e3),void 0!==w.getAttribute(f)&&void 0!==window.ga&&ga("send","event","button","click",w.getAttribute(f)),i(this.getAttribute("data-id"))}),e.getElementsByTagName("input")[0].remove(),w.appendChild(e)}(a);S.classList.remove("hidden"),w.classList.remove("hidden")}}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=new XMLHttpRequest;e.open("GET",w.getAttribute("data-request-set-cookie-url")+"?"+t),e.send(t)}function n(){var t=document.querySelector(s),e=t.getElementsByTagName("input");e=[].slice.call(e),1===e.length?!0===e[0].hasAttribute(p)&&!0===e[0].hasAttribute(h)&&e[0].setAttribute(v,getDistanceFromLatLonInKm(parseFloat(e[0].getAttribute(p)),parseFloat(e[0].getAttribute(h)),T.coords.latitude,T.coords.longitude)):!0===e[0].hasAttribute(p)&&!0===e[0].hasAttribute(h)&&e.sort(function(t,e){var a=getDistanceFromLatLonInKm(parseFloat(t.getAttribute(p)),parseFloat(t.getAttribute(h)),T.coords.latitude,T.coords.longitude),o=getDistanceFromLatLonInKm(parseFloat(e.getAttribute(p)),parseFloat(e.getAttribute(h)),T.coords.latitude,T.coords.longitude);return null===t.getAttribute(v)&&t.setAttribute(v,parseInt(1e3*a)),null===e.getAttribute(v)&&e.setAttribute(v,parseInt(1e3*o)),a-o});var a=void 0,o=void 0;E=[],E.push(e[0]),t.innerHTML="";for(var i=0;i<e.length;i++)!1!==e[i].hasAttribute(v)&&(a=parseInt(e[i].getAttribute(v)),parseInt(E[0].getAttribute(v))+c>=a&&E[0].getAttribute("id")!==e[i].getAttribute("id")&&E.push(e[i]),o=e[i].closest("div"),null===o.querySelector(".distance")&&(parseInt(a)>3e3?o.getElementsByTagName("label")[0].innerHTML+='<label class="distance"> - '+parseInt(a/1e3)+" км.</label>":o.getElementsByTagName("label")[0].innerHTML+='<label class="distance"> - '+a+" м.</label>"),t.appendChild(e[i].closest("li").cloneNode(!0)));var n=document.createElement("li"),r=document.createElement("li");n.innerHTML='<div class="group-name">Остальные магазины</div>',r.innerHTML='<div class="group-name">Ближайшие магазины</div>',n.setAttribute(m,g),r.setAttribute(m,g),e.length>E.length&&t.insertBefore(n,t.children[E.length]),t.insertBefore(r,t.firstChild),void 0!==window.ga&&ga("send","event","button","click",document.getElementById(l).getAttribute("data-analytics"))}function r(){var t=document.querySelector(s),e=t.getElementsByTagName("li");e=[].slice.call(e),e.sort(function(t,e){return parseInt(t.getAttribute(m))-parseInt(e.getAttribute(m))}),t.innerHTML="";for(var a=0;a<e.length;a++)g!==e[a].getAttribute(m)&&t.appendChild(e[a].cloneNode(!0))}function d(t){console.log(t),console.log("Неудалось получить координаты")}FilterBlock.prototype.init.apply(this,[t]);var l="sort-by-distance",s='[data-role="shops-list"]',c=1e3,u="shops-select",f="data-analytics-apply",p="data-location-latitude",h="data-location-longitude",v="distance",m="data-sort-order",g="true",w=void 0,b=void 0,E=[],T=void 0,_=void 0,y=document.querySelector(this.getContainerSelector());if(null!==y&&"true"!==y.getAttribute("init")){y.setAttribute("init",!0);var C=this,k=y.querySelector('[data-role="clear-selected-shops"]'),I=y.querySelector("[role=menu]"),S=y.querySelector(".sort-distance-container"),O=S.querySelector("#"+l),N=y.querySelectorAll('[data-toggle="dropdown"]'),L=document.getElementsByTagName("body");C.$block.on("change",'input:not([data-role="filter-items-search"]), select',function(){if(l===this.getAttribute("id"))return!1;e(),a()});var x=!0,A=!1,R=void 0;try{for(var D,P=N[Symbol.iterator]();!(x=(D=P.next()).done);x=!0){D.value.addEventListener("click",function(){C.$block.hasClass("open")?L[0].classList.add("lock"):L[0].classList.remove("lock")})}}catch(t){A=!0,R=t}finally{try{!x&&P.return&&P.return()}finally{if(A)throw R}}!1!="geolocation"in navigator&&null!==(w=y.querySelector("#near-shops-filter-container"))&&(b=w.querySelector('[data-role="close-near-shops-container"]'),b.addEventListener("click",function(){w.classList.add("hidden"),void 0!==w.getAttribute("data-analytics-close")&&void 0!==window.ga&&ga("send","event","button","click",w.getAttribute("data-analytics-close")),i()}),navigator.geolocation.getCurrentPosition(o,d)),C.$block.on(window.EVENT_FILTER_BLOCK_REESET,function(){a(),e()}),I.addEventListener("click",function(t){t.stopPropagation()}),k.addEventListener("click",function(){C.reset(),C.$block.trigger(window.EVENT_FILTER_BLOCK_AFTER_CHANGE),C.$block.change(),C.$block.closest("div").find("button").removeClass(u),a(),e()}),O.addEventListener("click",function(){if(this.checked)return void n();r()})}},FilterBlockSelectShops.prototype.getSelectedValue=function(){var t=[];return this.$block.find(':input[type="checkbox"]:checked').each(function(){t.push($(this).data("id"))}),0!==t.length?t.join(","):void 0},FilterBlockSelectShops.prototype.reset=function(){this.$block.find('[type="checkbox"]').prop("checked",!1),this.$block.trigger(window.EVENT_FILTER_BLOCK_REESET)},FilterBlockSelectShops.prototype.getContainerSelector=function(){return window.SELECTOR_FILTER_LIST_CONTAINER+'[data-id="shop-catalog"][data-side="top"][data-submit-type="change"]'},FilterBlock.prototype.init=function(t){this.$block=t;var e=this;e.$block.on("change",'input:not([data-role="filter-items-search"]), select',function(){e.$block.trigger(window.EVENT_FILTER_BLOCK_AFTER_CHANGE)}),this.isInitiated=!0},FilterBlock.prototype.getSelectedValue=function(){},FilterBlock.prototype.reset=function(){},FilterBlock.prototype.updateFilterValues=function(t){var e=this.$block.attr("id");if(void 0!==e){var a=document.getElementById(e);if(null!==a){var o=0,i=0;for(var n in t)if(!1!==t.hasOwnProperty(n)){var r=t[n],d=a.querySelector('[data-id="'+r.id+'"]');if(null!==d){d=d.parentNode;var l=!0===r.show||void 0===r.show?1:0;d.setAttribute("data-visibilty",l),0===l&&o++;var s=0===parseInt(r.count);!0===s?(i++,d.classList.add("empty")):d.classList.remove("empty");var c=d.querySelector("[data-filter-block-item-count]");null!==c&&c.setAttribute("data-filter-block-item-count",r.count)}}"action"===this.$block.attr("data-id")?this.showFilter():1<parseInt(this.$block.attr("data-variants-count"))&&1<parseInt(this.$block.attr("data-variants-count"))-o&&0<parseInt(this.$block.attr("data-variants-count"))-i?this.showFilter():!1===this.$block.hasClass("hidden")&&this.hideFilter()}}},FilterBlock.prototype.hideFilter=function(){!1===this.$block.hasClass("hidden")&&this.$block.addClass("hidden")},FilterBlock.prototype.showFilter=function(){this.$block.removeClass("hidden")},FilterBlock.prototype.setLockState=function(t){this.$block.find("input, select").prop("disabled",t)},function(t,e,a){function o(o){var n=this,r=void 0,d=new Map,l=void 0,s=void 0,c=!1;n.id=o;var u=function(e){s=p(),e.trigger(t.EVENT_FILTER_LIST_AFTER_CHANGE,s),e.trigger(t.EVENT_FILTER_LIST_AFTER_ALL_CHANGE,n),t.FILTER_LIST_SUBMIT_TYPE_CHANGE===e.data("submit-type")&&f()},f=function(){s=p(),r.first().trigger(t.EVENT_FILTER_LIST_SUBMIT,s)},p=function(){s={},s.data=[],s.filterListId=n.id;var t=void 0;return d.forEach(function(e){if(t=e.getSelectedValue(),a!==t){var o=e.id,i=o.indexOf(".");-1<i&&(o=o.substr(0,i)+"["+o.substr(i+1)+"]"),s.data.push({key:o,value:t})}}),s};this.init=function(){return c?this:(c=!0,r=e(t.SELECTOR_FILTER_LIST_CONTAINER+"[data-id="+n.id+"]"),d.forEach(function(a){var o=e(t.SELECTOR_FILTER_LIST_CONTAINER+"[data-id="+n.id+"] "+i+'[data-id="'+a.id+'"]');!1===a.isInitiated&&a.init(o)}),r.each(function(){var a=e(this);a.on(t.EVENT_FILTER_BLOCK_AFTER_CHANGE,i,function(){0!==a.find(this).length&&u(a)})}),e(document).ajaxSuccess(function(t,e){if(a!==e.responseJSON&&a!==e.responseJSON.data&&null!==e.responseJSON.data){var o=e.responseJSON.data.filterChanges,i=e.responseJSON.data.filterListId;if(a!==o&&a!==i&&0!==o.length&&n.id===i){var r=JSON.parse(o),l=void 0;for(var s in r)!1!==r.hasOwnProperty(s)&&!1!==d.has(s)&&(l=r[s],!1===l.isViewable?d.get(s).hideFilter():d.get(s).showFilter(),d.get(s).updateFilterValues(l))}}}),this)},this.addBlock=function(t){return d.has(t.id)?this:(d.set(t.id,t),this)},this.resetFilter=function(t){return d.has(t)&&d.get(t).reset(),f(),this},this.resetList=function(){return d.forEach(function(t){t.reset()}),f(),this},this.show=function(){return r.closest(t.SELECTOR_FILTER_LIST_CONTAINER).removeClass("initial-state").addClass("active"),e("body, html").addClass("blocked"),this},this.hide=function(){return r.closest(t.SELECTOR_FILTER_LIST_CONTAINER).removeClass("active"),e("body, html").removeClass("blocked"),this},this.submitFilters=function(t){var o=0;return r.each(function(){var i=e(this);o=o||(!1!==t&&a!==i.attr("data-trigger-timeout")?parseInt(i.attr("data-trigger-timeout")):0)}),a!==l&&clearTimeout(l),l=setTimeout(f,o),this},this.toggleLockState=function(t){d.forEach(function(e){e.setLockState(t)})},this.getBlocks=function(){return d},this.getSelectedFilters=function(){return s}}t.EVENT_FILTER_LIST_AFTER_CHANGE="filter-list:after-change",t.EVENT_FILTER_LIST_SUBMIT="filter-list:submit",t.FILTER_LIST_SUBMIT_TYPE_CHANGE="change",t.FILTER_LIST_SUBMIT_TYPE_BUTTON="button",t.SELECTOR_FILTER_LIST_CONTAINER='[data-role="filters-container"]';var i='[data-role="filter-block"]',n=new Map;t.FilterList=function(t){return!1===n.has(t)&&n.set(t,new o(t)),n.get(t)}}(window,jQuery,void 0),function(t,e,a){function o(t,e){var a=Math.pow(d,parseInt(Math.log(e-t)/Math.log(d)-1))||1;return(e-parseInt(e)>0||t-parseInt(t)>0)&&(a=Math.min(.5,a),e-t<d&&(a=Math.min(.1,a))),a<=s&&a>=l&&(a=0==t%l&&0==e%l?l:0==t%s&&0==e%s?s:d),a}function i(t,e){var a=t.data("type"),o=c===a?0:1;if(""===t.val())return!1;var i,n=t.val(),d=t.siblings("input[type=text]");i=""!==d.val()&&Number(d.val());var l=t.closest(r).find(".ui-slider"),s=l.slider("option","min"),f=l.slider("option","max");if(!(n>=s&&n<=f)){var p;return p=n>f?c===a?l.slider("values",1):f:u===a?l.slider("values",0):s,l.slider("values",o,p),"change"===e&&t.val(p),!1}!1===i||c===a&&n<=i||u===a&&n>=i?l.slider("values",o,n):(l.slider("values",o,i),"change"===e&&t.val(i))}function n(e){t(e).each(function(){var e=t(this);e.find(".slider_opt").each(function(e,a){var i=t(a),n=i.data("min"),d=i.data("max"),l=i.closest(r),s=l.find("input[type=text][data-type=to]"),c=l.find("input[type=text][data-type=from]");i.slider({range:!0,step:o(n,d),min:n,max:d,textFrom:c,textTo:s,values:[i.data("value_from"),i.data("value_to")],slide:function(e,a){var o=""!==c.val()?c.val():t(e.target).slider("option","min"),i=""!==s.val()?s.val():t(e.target).slider("option","max");s.toggleClass("is-changed",a.values[1]!==i),c.toggleClass("is-changed",a.values[0]!==o),s.val(a.values[1]!==t(e.target).slider("option","max")?a.values[1]:""),c.val(a.values[0]!==t(e.target).slider("option","min")?a.values[0]:"")},stop:function(){var e=t(this).closest(r).find("input[type=text][data-type].is-changed");0!==e.length&&e.removeClass("is-changed").change()}}).draggable(),f(i),new(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)(function(e){e.forEach(function(e){"attributes"===e.type&&f(t(e.target))})}).observe(a,{attributes:!0})}),e.find(".slider_opt_no_range").each(function(e,a){var o=t(a),i=o.data("true_value_title"),n=o.data("false_value_title");o.labeledslider({min:0,max:2,tickArray:[0,1,2],tickLabels:{0:"Не важно",1:n,2:i},slide:function(e,a){var o=t(this).parent().siblings("input[type=hidden]");o.val(a.value),o.change()},value:t(this).data("value")})}),e.find(".slider_opt_txtbox").change(function(){i(t(this),"change")}).keyup(function(){i(t(this),"keydown")}).focus(function(){t(this).select()}),e.attr("data-initialized",!0)})}var r="[data-box=interval]",d=10,l=50,s=100,c="from",u="to";t.widget("ui.slider",t.ui.slider,{refresh:function(){this.options.step=o(this.options.min,this.options.max);var t=this.options.textFrom.val(),e=parseInt(this.options.textFrom.val()),a=this.options.textTo.val(),i=parseInt(this.options.textTo.val());this.options.textFrom.prop("placeholder",this.options.min),this.options.textTo.prop("placeholder",this.options.max);var n=!1;""!==t?(e<this.options.min||e>this.options.max)&&(this.options.textFrom.val(""),n=!0,this.values(0,this.options.min)):this.values(0,this.options.min),""!==a?(i<this.options.min||i>this.options.max)&&(this.options.textTo.val(""),n=!0,this.values(1,this.options.max)):this.values(1,this.options.max),!0===n&&this.options.textFrom.change()},options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,textFrom:null,textTo:null,change:null,slide:null,start:null,stop:null}}),t(function(){n(".catalog-filter"),n(".filter-list"),t(window).on(window.EVENT_CONFIGURATOR_CATALOG_IS_LOADED,function(t){n(t.target)})});var f=function(e){var a=e.data("min"),o=e.data("max"),i=o-a,n=["min","max"];for(var r in n)if(!1!==n.hasOwnProperty(r)){var d=n[r],l=e.attr("data-filtered-"+d);if(void 0!==l){var s=e.find('[data-role="filtered-range-'+d+'"]');0===s.length&&(s=t("<div />").attr("data-role","filtered-range-"+d).addClass("filtered-range"),e.append(s));var c="min"===d?(l-a)/i*100:(o-l)/i*100;s.width(c+"%")}}};t(function(t){t.datepicker.regional.ru={closeText:"Закрыть",prevText:"&#x3c;Пред",nextText:"След&#x3e;",currentText:"Сегодня",monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],dayNames:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],dayNamesShort:["вск","пнд","втр","срд","чтв","птн","сбт"],dayNamesMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],weekHeader:"Нед",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},t.datepicker.setDefaults(t.datepicker.regional.ru)})}(jQuery,document),function(t,e){function a(t){t.$forms.each(function(a,o){e.map(e(o).find("input[name]:not([disabled])").serializeArray(),function(e){t.data[e.name]=e.value})})}function o(t){a(t),e.map(t.data,function(a,o){t.$form.append(e('<input type="hidden" name="'+o+'" value="'+a+'" />'))})}function i(t){1!=t.lockHook&&(t.lockHook=!0,t.$forms.each(function(){if(t.hookFn instanceof Function)return t.hookFn.call(this,t.$forms);e(this).submit()}),
t.lockHook=!1,t.$form.submit())}function n(){var t=d[e(this).data("action")];return 0==t.lockHook&&(t.$forms.each(function(){for(var a=t.propaganda[e(this).data("id")],o=0,i=a.length;o<i;++o)a[o].call(this,t.$forms)}),i.call(this,t)),!1}function r(t){var a=t.target,o=e(a),i=t.delegateTarget,n=e(i),r=n.data("action"),l=n.data("name"),s=d[r].syncs[l],c=n.data("prefix")||"",u=n.data("attr")||"name",f=(o.attr(u)||"").replace(c,"");s.not(i).each(function(){if(n.is(this))return!0;var t=e(this),i=t.data("prefix")||"",r=t.data("attr")||"name",d="["+r+'="'+i+f+'"]';t.find(d).each(function(){var t=e(this),i=o.is("input[type=checkbox]")||o.is("input[type=radio]"),n=e(t.is("input[type=checkbox]")||t.is("input[type=radio]"));i&&n?this.checked=a.checked:t.val(o.val()),t.on("change",function(t){return e(t.delegateTarget).off("change",arguments.callee),t.preventDefault(),!1}),t.change()})})}var d={},l=function(){return arguments.callee};l.attach=function(t){var a=e(t);if(!a.is("form"))return null;var i=a.attr("action"),l=a.attr("name"),s=d[i];if(!d.hasOwnProperty(i)){var c=e('<form action="'+i+'" method="'+a.attr("method")+'" />');c.hide().appendTo("BODY"),s=d[i]={$form:c,$forms:e(),lockHook:!1,hookFn:null,data:{},propaganda:{},syncs:{}},c.on("submit",function(){o(s)})}return s.$forms.index(a.get(0))>-1?i:(a.data("id","g"+s.$forms.length),a.data("action",i),a.data("name",l),s.syncs.hasOwnProperty(l)||(s.syncs[l]=e()),s.syncs[l].push(a),s.$forms.push(a.get(0)),a.on("change",r).on("submit",n),i)},l.detach=function(t){var a=e(t);if(a.is("form")){var o=a.data("action"),i=d[o],r=i.$forms.index(a);r>-1&&i.$forms.splice(r,1),delete i.propaganda[a.data("id")],a.off("submit",n)}},l.send=function(t){i.call(null,d[t])},l.setGroupHook=function(t,e){d.hasOwnProperty(t)&&e instanceof Function&&(d[t].hookFn=e)},l.addFormHook=function(t,a){var o=e(t);if(o.is("form")&&a instanceof Function){var i=d[this.attach(o)],n=o.data("id");i.propaganda.hasOwnProperty(n)||(i.propaganda[n]=[]),i.propaganda[n].push(a)}},l.killFormHook=function(t,a){var o=e(t);if(o.is("form")&&a instanceof Function){var i=d[o.data("action")];if(!i)return;var n=i.propaganda[o.data("id")];0==arguments.length&&n.splice(0,n.length);var r=n.indexOf(a);n.splice(r,1)}},l.submit=function(t,e){d.hasOwnProperty(t)&&(e instanceof Function?d[t].$form.submit(e):this.send(t))},l.off=function(t,e){d.hasOwnProperty(t)&&e instanceof Function&&d[t].$form.off("submit",e)},window.FormAggregator=l,e.fn.aggregateForm=function(t){e(this).each(function(){l.attach(this),l.addFormHook(this,t)})},e.fn.detachForm=function(){l.detach(this)},e.fn.addHook=function(t){l.addFormHook(this,t)},e.fn.killHook=function(t){l.killFormHook(t)},e.fn.getGroupName=function(){return e(this).data("action")}}(document,jQuery),function(t,e){var a=void 0,o=void 0;t.fn.filters=function(){o=t(this),a=o.data("id"),e.FilterList(a).init(),o.on("click",'[data-role="submit-filters"]',function(){e.FilterList(a).submitFilters(!1).hide(),0<t('[data-role="ajax-loader"]').length&&(t('[data-role="ajax-loader"]').removeClass("open-filters"),t('[data-role="ajax-loader-circular"]').removeClass("open-filters"),t('[data-role="ajax-loader-control"]').removeClass("open-filters"))}),o.on("click",'[data-role="reset-filters"]',function(){e.FilterList(a).resetList().hide(),0<t('[data-role="ajax-loader"]').length&&(t('[data-role="ajax-loader"]').removeClass("open-filters"),t('[data-role="ajax-loader-circular"]').removeClass("open-filters"),t('[data-role="ajax-loader-control"]').removeClass("open-filters"))}),o.on("click",'[data-role="hide-filters"]',function(){e.FilterList(a).hide(),0<t('[data-role="ajax-loader"]').length&&(t('[data-role="ajax-loader"]').removeClass("open-filters"),t('[data-role="ajax-loader-circular"]').removeClass("open-filters"),t('[data-role="ajax-loader-control"]').removeClass("open-filters"))})}}(jQuery,window),function(t,e){var a,o;t.fn.filtersToggleButton=function(){a=t(this),o=a.data("filter-list-id"),a.on("click",function(){e.FilterList(o).show(),0<t('[data-role="ajax-loader"]').length&&(t('[data-role="ajax-loader"]').removeClass("hide").addClass("open-filters"),t('[data-role="ajax-loader-circular"]').addClass("hide open-filters"),t('[data-role="ajax-loader-control"]').addClass("open-filters"))}),t(e.SELECTOR_FILTER_LIST_CONTAINER+"[data-id="+o+"]").on(e.EVENT_FILTER_LIST_AFTER_CHANGE,function(t,e){a.find('[data-role="filters-counter"]').text(e.data.length).toggleClass("hidden",0===e.data.length)})}}(jQuery,window),function(t,e){var a,o;t.fn.pickedFilters=function(){var i=t(this);i.data("inited")||(i.data("inited",!0),i.on("click",'[data-role="reset-filter"]',function(){o=t(this).closest('[data-role="widget-picked-filters"]'),a=o.data("filter-list-id");var i=t(this).data("filter-id");void 0!==a&&(e.FilterList(a).resetFilter(i),t(this).closest('[data-role="picked-filter"]').remove(),0===o.find('[data-role="picked-filter"]').length&&o.remove())}),i.on("click",'[data-role="reset-filter-list"]',function(){o=t(this).closest('[data-role="widget-picked-filters"]'),void 0!==(a=o.data("filter-list-id"))&&(o.remove(),e.FilterList(a).resetList())}))}}(jQuery,window);var FilterBlockShopType=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return _inherits(e,t),_createClass(e,[{key:"init",value:function(t){var a=this;_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this,t),this.$block=t,this.FILTER_SHOP_ALL="all",this.ATTR_DATA_ATTR_SHOPS_BY_TYPE="data-shops-by-type",this.SELECTOR_SHOP_TYPE_CHECKBOXES=".shop-type INPUT[type=checkbox]",this.shopsByType=[];var o=this,i=this.$block.find(this.SELECTOR_SHOP_TYPE_CHECKBOXES);this.shopsByType=JSON.parse(this.$block.attr(this.ATTR_DATA_ATTR_SHOPS_BY_TYPE)),this.$block.on("change",this.SELECTOR_SHOP_TYPE_CHECKBOXES,function(t){!0===$(t.target).is(":checked")?i.filter("[value="+a.FILTER_SHOP_ALL+"]").prop("checked",!1):0===i.filter("INPUT[type=checkbox]:checked").length&&i.filter("[value="+a.FILTER_SHOP_ALL+"]").prop("checked",!0),o.$block.trigger(window.EVENT_FILTER_BLOCK_AFTER_CHANGE)}),this.$block.on(window.EVENT_FILTER_LIST_AFTER_GET_NEW_VALUES,function(t,e){0!==e.length&&(e=e.split(",")),i.each(function(t,o){var i=$(o),n=i.val(),r=i.siblings("i"),d=0;a.FILTER_SHOP_ALL===n?d=e.length:a.shopsByType[n].forEach(function(t){-1!==e.indexOf(t)&&d++}),r.text(d)})})}},{key:"getSelectedValue",value:function(){var t=this,e=new Map;this.$block.find("INPUT[type=checkbox]:checked").each(function(t,a){e.set($(a).val(),1)});var a=[];if(void 0!==e.get(this.FILTER_SHOP_ALL))for(var o in this.shopsByType)a=a.concat(this.shopsByType[o]);else e.forEach(function(e,o){a=a.concat(t.shopsByType[o])});return a.join(",")}}]),e}(window.FilterBlock),FilterBlockShopWorkTime=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return _inherits(e,t),_createClass(e,[{key:"init",value:function(t){function e(){function t(){i.selectedDay=parseInt(i.$block.find(i.SELECTOR_DAY_FILTER).val()),i.selectedTime=parseInt(i.$block.find(i.SELECTOR_TIME_FILTER).val()),a()}var e=void 0,o=void 0;if(i.selectedDay=i.$block.find(i.SELECTOR_DAY_FILTER).val(),!0===i.workTimeInfo.workTime.hasOwnProperty(i.selectedDay))for(var n in i.workTimeInfo.workTime[i.selectedDay]){var r=i.workTimeInfo.workTime[i.selectedDay][n],d=r.openTime,l=r.closeTime;e||(e=d),o||(o=l),e=Math.min(e,d),o=Math.max(o,l)}if(e||o){e=Math.ceil(e/3600),o=Math.ceil(o/3600);var s=i.$block.find(i.SELECTOR_TIME_FILTER);s.find("option").not("[data-default-state=1]").remove(),s.find("[data-default-state=1]").prop("selected",!0);for(var c=e;c<o;c++){var u=$("<option/>").attr("value",3600*c).html(c+":00");s.append(u)}t(),s.on("change",function(){t()})}}function a(){i.$block.trigger(window.EVENT_FILTER_BLOCK_AFTER_CHANGE)}function o(){e(),i.$block.find(i.SELECTOR_WORKTIME_FILTER).removeClass("disabled"),i.$block.find(i.SELECTOR_DAY_FILTER).on("change",function(){e()})}this.SELECTOR_WORK_STATUS_FILTER="[name=work-status-filter]",this.SELECTOR_WORKTIME_FILTER="[data-role=worktime-filter]",this.SELECTOR_DAY_FILTER="[data-role=day-filter]",this.SELECTOR_TIME_FILTER="[data-role=time-filter]",this.ATTR_WORK_TIME_INFO="data-work-time-info",this.$block=t,this.workTimeInfo=JSON.parse(t.attr(this.ATTR_WORK_TIME_INFO)),this.selectedTime=null,this.selectedDay=null;var i=this;t.find(this.SELECTOR_WORK_STATUS_FILTER).on("change",function(){t.find(i.SELECTOR_WORKTIME_FILTER).addClass("disabled"),"at-time"===$(this).val()&&o(),a()}),e()}},{key:"getSelectedValue",value:function(){var t=this,e=t.$block.find(t.SELECTOR_WORK_STATUS_FILTER).filter(":checked"),a=[],o=a.length;switch(e.val()){case"opened":a=t.workTimeInfo.openedShops;break;case"at-time":if(!0===t.workTimeInfo.workTime.hasOwnProperty(t.selectedDay))for(var i in t.workTimeInfo.workTime[t.selectedDay]){var n=t.workTimeInfo.workTime[t.selectedDay][i];(0===t.selectedTime||t.selectedTime>=n.openTime&&t.selectedTime<n.closeTime)&&(a=a.concat(n.shopGuids))}break;default:for(var r in t.workTimeInfo.workTime)for(var d in t.workTimeInfo.workTime[r])a=a.concat(t.workTimeInfo.workTime[r][d].shopGuids);for(o=a.length,a.sort();o--;)a[o]===a[o-1]&&a.splice(o,1)}return a.join(",")}}]),e}(window.FilterBlock),RemainsFilterBlockShopType=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return _inherits(e,t),_createClass(e,[{key:"init",value:function(t){var a=this;_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this,t),this.$block=t,this.FILTER_SHOP_ALL="all",this.SELECTOR_SELECTOR_HEADER="[data-role=selector-header]",this.ATTR_DATA_ATTR_SHOPS_BY_TYPE="data-shops-by-type",this.SELECTOR_SHOP_TYPE_CHECKBOXES=".shop-type INPUT[type=checkbox]",this.shopsByType=[];var o=this,i=this.$block.find(this.SELECTOR_SHOP_TYPE_CHECKBOXES);this.shopsByType=JSON.parse(this.$block.attr(this.ATTR_DATA_ATTR_SHOPS_BY_TYPE)),this.$block.find(this.SELECTOR_SELECTOR_HEADER).click(function(){a.$block.toggleClass("active")}),this.$block.on("click",".shop-type",function(t){var e=$(t.target).find("INPUT[type=checkbox]");e.prop("checked",!1===e.is(":checked")),e.change()}),this.$block.on("change",this.SELECTOR_SHOP_TYPE_CHECKBOXES,function(t){var e=$(t.target);e.closest(".shop-type").toggleClass("active",e.is(":checked")),!0===e.is(":checked")?a.FILTER_SHOP_ALL===e.val()?i.filter("[value!="+a.FILTER_SHOP_ALL+"]").prop("checked",!1):i.filter("[value="+a.FILTER_SHOP_ALL+"]").prop("checked",!1):a.FILTER_SHOP_ALL===e.val()?i.filter("[value!="+a.FILTER_SHOP_ALL+"]").prop("checked",!0):0===i.filter("INPUT[type=checkbox]:checked").length&&i.filter("[value="+a.FILTER_SHOP_ALL+"]").prop("checked",!0),o.$block.trigger(window.EVENT_FILTER_BLOCK_AFTER_CHANGE)}),this.$block.on(window.EVENT_FILTER_LIST_AFTER_GET_NEW_VALUES,function(t,e){var o=/(\d+)/;0!==e.length&&(e=e.split(",")),i.each(function(t,i){var n=$(i),r=n.val(),d=n.siblings("LABEL[for="+n.attr("id")+"]"),l=d.text(),s=0;a.FILTER_SHOP_ALL===r?s=e.length:a.shopsByType[r].forEach(function(t){-1!==e.indexOf(t)&&s++}),d.text(l.replace(o,s))})})}},{key:"getSelectedValue",value:function(){var t=this,e=new Map;this.$block.find("INPUT[type=checkbox]:checked").each(function(t,a){e.set($(a).val(),1)});var a=[];if(void 0!==e.get(this.FILTER_SHOP_ALL))for(var o in this.shopsByType)a=a.concat(this.shopsByType[o]);else e.forEach(function(e,o){a=a.concat(t.shopsByType[o])});return a.join(",")}}]),e}(window.FilterBlock);RemainsFilterBlockShopWorkTime.prototype=Object.create(window.FilterBlock.prototype),RemainsFilterBlockShopWorkTime.prototype.constructor=RemainsFilterBlockShopWorkTime,RemainsFilterBlockShopWorkTime.prototype.init=function(t){function e(){v.$block.find(d).click()}function a(){function t(t){w.find("[data-value]").removeClass("selected"),t.addClass("selected"),e(i(t))}function e(t){E.css({left:t}),r()}function a(t){t||(t=0);var e=null,a=null;return w.find("span").each(function(){var o=$(this),n=Math.abs(t-i(o));null===a&&(a=n),a>=n&&(a=n,e=o)}),e}function i(t){var e=w.get(0).getBoundingClientRect().left,a=t.get(0).getBoundingClientRect().left;return parseInt(a-e-5)}function n(){return parseInt(E.css("left"))}function r(){v.selectedDay=v.$block.find(c+" [data-value].selected").data("value"),v.selectedTime=a(n()).data("value"),o()}var d=void 0,l=void 0;if(v.selectedDay=v.$block.find(c+" [data-value].selected").data("value"),!0===v.workTimeInfo.workTime.hasOwnProperty(v.selectedDay))for(var s in v.workTimeInfo.workTime[v.selectedDay]){var h=v.workTimeInfo.workTime[v.selectedDay][s],m=h.openTime,g=h.closeTime;d||(d=m),l||(l=g),d=Math.min(d,m),l=Math.max(l,g)}if(d||l){d=Math.ceil(d/3600),l=Math.ceil(l/3600);var w=v.$block.find(u),b=w.find(f),E=w.find(p),T=l-d;b.html("");for(var _=d;_<l;_++){var y=$("<span/>").attr("data-value",3600*_).html(_+"<i></i>");T%3==2&&_===d&&y.addClass("first"),b.append(y)}t(w.find("[data-default-state=1]")),$(p).draggable({axis:"x",containment:"parent",stop:function(e,o){t(a(o.position.left))}}),e(0),w.find("[data-value] i").on("click",function(){t($(this).closest("[data-value]"))})}}function o(){var t=v.$block.find(r),e=g.find(h),a=v.$block.find(n);t.hide(),e.hide(),w.prev().removeClass("selected"),a.removeClass("selected");var o=v.$block.find(l+" [data-value].selected");v.$block.trigger(window.EVENT_FILTER_BLOCK_AFTER_CHANGE),o.data("default-state")||(t.css("display","inline-block"),e.show(),a.addClass("selected"),w.prev().addClass("selected"))}function i(){a(),v.$block.find(s).removeClass("disabled"),v.$block.find(c+" [data-value]").on("click",function(){$(this).siblings().removeClass("selected"),$(this).addClass("selected"),a()})}var n="[data-role=show-avails-filter]",r="[data-role=clear-avails-filter]",d="[data-default-state]",l="[data-role=work-status-filter]",s="[data-role=worktime-filter]",c="[data-role=day-filter]",u="[data-role=time-filter]",f="[data-role=hours-wrap]",p="[data-role=range-control] i",h=".clear-filter-outer";this.$block=t,this.workTimeInfo=JSON.parse(t.attr("data-work-time-info")),this.selectedTime=null,this.selectedDay=null;var v=this,m=t.find(".filters-wrap"),g=t.closest(".modal-dialog");t.on("click",n,function(){m.fadeIn(200)});var w=g.find(".show-filter-outer");g.on("click",".show-filter-outer",function(){var t=$(this),e=t.offset().top,a=t.offset().left,o=g.offset().top,i=g.offset().left;t.addClass("opened"),t.prev().addClass("opened"),m.css({top:e-o+27,left:a-i-100}),m.fadeIn(200)}),$("BODY").on("click",function(t){var e=$(t.target);e.closest(".filters-wrap").length||e.is(".filters-wrap")||e.is(n)||e.is(r)||e.is(".show-filter-outer")||(w.removeClass("opened"),w.prev().removeClass("opened"),m.hide())}),m.on("click",".close-btn",function(){m.hide()}),t.on("click",r,function(){e()}),g.on("click",h,function(){e()}),$(window).on("resize",function(){!0===w.prev().hasClass("selected")&&window.checkScreenType(window.SCREEN_MOBILE)&&e()}),t.on("click",l+" [data-value]",function(){var e=$(this);e.siblings().removeClass("selected"),e.addClass("selected"),t.find(s).addClass("disabled"),"at-time"===e.data("value")&&i(),o()}),a(),this.$block.on(window.EVENT_FILTER_LIST_AFTER_GET_NEW_VALUES,function(t,e){var a=v.$block.find(n).find("span"),o=v.getSelectedValue(),i=v.$block.find(l+" [data-value].selected");if(0!==w.length&&(a=w.find("span")),a.html(""),!i.data("default-state")){0!==o.length&&(o=o.split(",")),0!==e.length&&(e=e.split(","));var r=0;o.forEach(function(t){-1!==e.indexOf(t)&&r++}),a.html("("+r+")")}})},RemainsFilterBlockShopWorkTime.prototype.getSelectedValue=function(){var t=this,e=t.$block.find("[data-role=work-status-filter] .selected"),a=[],o=a.length;switch(e.data("value")){case"opened":a=t.workTimeInfo.openedShops;break;case"at-time":if(!0===t.workTimeInfo.workTime.hasOwnProperty(t.selectedDay))for(var i in t.workTimeInfo.workTime[t.selectedDay]){var n=t.workTimeInfo.workTime[t.selectedDay][i];(0===t.selectedTime||t.selectedTime>=n.openTime&&t.selectedTime<n.closeTime)&&(a=a.concat(n.shopGuids))}break;default:for(var r in t.workTimeInfo.workTime)for(var d in t.workTimeInfo.workTime[r])a=a.concat(t.workTimeInfo.workTime[r][d].shopGuids);for(o=a.length,a.sort();o--;)a[o]===a[o-1]&&a.splice(o,1)}return a.join(",")},function(t,e,a){function o(a){var o,i=this;this.id=a,this.init=function(){o=e("#"+i.id),o.on(t.EVENT_FILTER_LIST_AFTER_ALL_CHANGE,function(a,o){o.getBlocks().forEach(function(a){var i=[];o.getSelectedFilters().data.forEach(function(t){if(a.id!==t.key)if(0===i.length)i=t.value.split(",");else{var o=[];t.value.split(",").forEach(function(t){-1!==e.inArray(t,i)&&o.push(t)}),i=o}}),a.$block.trigger(t.EVENT_FILTER_LIST_AFTER_GET_NEW_VALUES,i.join(","))})})}}t.EVENT_FILTER_LIST_AFTER_ALL_CHANGE="filter-list:after-all-change",t.EVENT_FILTER_LIST_AFTER_GET_NEW_VALUES="filter-list:after-get-new-values";var i=new Map;t.ShopFilterListHelper=function(t){return!1===i.has(t)&&i.set(t,new o(t)),i.get(t)}}(window,jQuery),function(t,e){e.EVENT_INIT_EXTENDED_FILTER_WIDGET="extendedFilterWidget:init";t.fn.extendedFilterWidget=function(){var a=t(this);if(!a.data("initiated")){a.data("initiated",!0);var o=a.data("filter-list-id"),i=function(){e.FilterList(o).toggleLockState(!0);var t=[];e.FilterList(o).getSelectedFilters().data.forEach(function(e){t.push(e.key+"="+e.value)});var i=a.data("filter-submit-url");0!==t.length&&(i+=(i.indexOf("?")<0?"?":"&")+t.join("&")),e.location.href=i};a.on("click",'[data-role="submit-filters"]',i),a.on("keyup",'input[type="text"]',function(t){KeyboardCodes.ENTER===t.keyCode&&i()})}};var a=function(){t("[data-role=extended-filter-widget]").each(function(){t(this).extendedFilterWidget()})};t(function(){a()}),t(e).on(EVENT_INIT_EXTENDED_FILTER_WIDGET,a)}(jQuery,window),function(t,e){e.EVENT_INIT_LEFT_SIDE_WIDGET="leftSideFilterWidget:init";t.fn.leftSideFilterWidget=function(){var a=t(this);if(!a.data("initiated")){a.data("initiated",!0);var o=a.data("filter-list-id"),i=function(){e.FilterList(o).submitFilters(!1)},n=function(t){var e=[],o=a.find('[data-role="extended-filters-link"]'),i=o.attr("href");t.data.forEach(function(t){e.push(t.key+"="+t.value)}),i.indexOf("?")>0&&(i=i.split("?")[0]),0!==e.length&&(i+="?"),i+=e.join("&"),o.attr("href",i)};a.on("keyup",'input[type="text"]',function(t){e.KeyboardCodes.ENTER===t.keyCode&&(a.find(".apply-filters-float-btn").remove(),i())}),a.on("change",function(o){if(1===parseInt(a.data("show-float-apply-button"))&&!e.checkScreenType(e.SCREEN_MOBILE,e.SCREEN_TABLET)){var n=a.find('[name="'+a.data("filter-list-form-name")+'"]');n.find(".apply-filters-float-btn").remove();var r=t("<div>").html('Показать<span class="corner"></span>').addClass("apply-filters-float-btn");r.on("click",function(){i(),t(this).remove()}),n.append(r),setTimeout(function(){r.fadeOut(300,function(){t(this).remove()})},3e3);var d=t(o.target);"none"===d.css("display")&&(d=d.parent());var l=d.offset().top-a.offset().top-r.outerHeight()/2;r.css({top:l+"px"})}}),a.on("click",'[data-role="submit-filters"]',i),a.on(e.EVENT_FILTER_LIST_SUBMIT,function(t,e){a.find('[data-role="drop-filters-button"]').toggleClass("hidden",0===e.data.length),0!==a.find('[data-role="extended-filters-link"]').length&&n(e)})}};var a=function(){t("[data-role=left-side-filter]").each(function(){t(this).leftSideFilterWidget()})};t(function(){a()}),t(e).on(e.EVENT_INIT_LEFT_SIDE_WIDGET,a)}(jQuery,window),function(t){function e(){var e="",a=!1,o=function(a,o,i){""!==e&&t.post(e,{result:a,latitude:o,longitude:i})};this.setSaveResultUrl=function(t){return e=t,this},this.init=function(){t(window).on(window.EVENT_GEOLOCATION_INIT,function(){if(!a){var t=window.UserGeolocation.checkPermission(window.GEOLOCATION_PERMISSION_GRANTED)?1:-1,e=void 0,i=void 0;1===t&&(e=window.UserGeolocation.getPosition().coords.latitude,i=window.UserGeolocation.getPosition().coords.longitude,(isNaN(e)||isNaN(i))&&(e=void 0,i=void 0)),o(t,e,i),a=!0}})}}window.GettingLocationLogger=new e}(jQuery),function(document,$,undefined){function parseUploadResponse(iframe){if("about:blank"===iframe.src)return{result:!1,data:"Не удалось загрузить изображение (E0)."};if(undefined===iframe.contentDocument&&(iframe.contentDocument=frames[iframe.id].document),"complete"!==iframe.contentDocument.readyState)return{result:!1,data:"Не удалось загрузить изображение (E1)."};if(undefined===iframe.contentDocument.body)return{result:!1,data:"Не удалось загрузить изображение (E2)."};if(""===iframe.contentDocument.body.innerHTML)return{result:!1,data:"Не удалось загрузить изображение (E3)."};if("false"===iframe.contentDocument.body.innerHTML)return{result:!1,data:"Не удалось загрузить изображение (E4)."};try{var response=iframe.contentDocument.body.getElementsByTagName("pre")[0].innerHTML;return eval("("+response+")")}catch(t){}return{result:!1,data:"Не удалось загрузить изображение (E5)."}}var IMAGETYPE_GIF=1,IMAGETYPE_JPEG=2,IMAGETYPE_PNG=3,IMAGETYPE_BMP=6;$.fn.ajaxImageUpload=function(t){return this.each(function(){function e(){i.find('INPUT[type="file"]').remove(),i.append('<input type="file" />'),n=i.find('INPUT[type="file"]')}function a(){i.addClass("disabled"),undefined===r&&(r=$("<iframe></iframe>"),r.addClass("ajax-image-upload-iframe"),r.attr("id","ajax-image-upload-iframe-"+u),r.attr("src",""),r.attr("name",u),s.append(r),r=$("#ajax-image-upload-iframe-"+u),r.on("load",o)),undefined!==d&&d.remove(),d=$('<form enctype="multipart/form-data"></form>'),d.addClass("ajax-image-upload-form"),d.attr("method","POST"),d.attr("id","ajax-image-upload-form-"+u),d.attr("action",t.uploadUrl),d.attr("target",r.attr("name")),s.append(d),d=$("#ajax-image-upload-form-"+u),d.get(0).appendChild(n.get(0)),d.find('INPUT[type="file"]').attr("name","AjaxImage");var a=$('META[name="csrf-token"]');0!==a.length&&d.append('<input type="hidden" value="'+a.attr("content")+'" name="_csrf">');for(var l in t)if(!1!==t.hasOwnProperty(l))if("object"===_typeof(t[l]))for(var c in t[l])!1!==t[l].hasOwnProperty(c)&&d.append('<input type="hidden" name="options['+l+"]["+c+']" value="'+String(t[l][c]).replace(/["\\']/gim,"")+'" />');else d.append('<input type="hidden" name="options['+l+']" value="'+String(t[l]).replace(/["\\']/gim,"")+'" />');d.submit(),e()}function o(){i.removeClass("disabled");var t=parseUploadResponse(this);!0!==t.result?(undefined!==p&&(p.text(t.data),p.show()),c.val("")):(p.hide(),undefined!==l&&l.text(t.url),undefined!==f&&f.attr("src",t.preview),c.val(t.value))}var i,n,r,d,l,s=$("BODY"),c=$(this),u=c.data("ajax-image-id");undefined!==t.imageUrlContainer&&(l=$(t.imageUrlContainer),0===l.length&&(l=undefined));var f;undefined!==t.previewContainer&&(f=$(t.previewContainer),0===f.length&&(f=undefined));var p;undefined!==t.errorContainer&&(p=$(t.errorContainer),0===p.length&&(p=undefined)),undefined!==p&&p.hide(),function(){var o=[];o.push("btn"),o.push("btn-warning"),o.push("ajax-image-upload-btn"),1===t.block&&o.push("btn-block"),o=o.join(" "),c.wrap('<div class="'+o+'">Загрузить</div>'),i=c.parent(),e(),i.on("change",'INPUT[type="file"]',a)}()})}}(document,jQuery),function(t){var e=void 0;t(function(){if(e=t("[data-role=related-service-container]"),0===e.length)return!1;e.on("change","[data-role=service-checkbox]",function(){var a=t(this),o={guid:a.attr("id"),title:a.attr("data-service-title"),price:a.attr("data-service-price"),checked:a.prop("checked"),hasKbtServiceChecked:0!==e.find("[data-is-kbt-service=1]").filter(":checked").length};window.productAdditionsDispatcher.setKbtService(o)})})}(jQuery),function(t,e){var a;e(function(){if(a=e("#print-order-notify-content"),0!==a.length){var t=a.find("#scheme"),o=t.data("bg-color"),i=t.data("min-x"),n=t.data("min-y"),r=t.data("max-x"),d=t.data("max-y");t.css({width:r-i,height:d-n,"background-color":o,margin:"auto",position:"relative"}),t.find(".clone").each(function(){var t=parseInt(e(this).css("left")),a=parseInt(e(this).css("top"));e(this).css({left:t-i,top:a-n})})}})}(document,jQuery),function(t,e){var a="[data-role=templates-group]",o="[data-role=templates-items-search]",i="[data-role=templates-item-block]",n="[data-role=overflow]",r="empty-result-block",d="clear-search-button",l=void 0,s=window.location.hash,c=new window.XMLHttpRequest;e(function(){function t(t){var a=e("#knowledge-container"),o=e("[data-role=knowledge-breadcrumbs]"),i=e(n);i.removeClass("hidden"),i.addClass("loading"),e("body,html").animate({scrollTop:0},{duration:1e3,easing:"swing"}),c.abort(),c=e.ajax({url:t,dataType:"JSON",success:function(e){i.addClass("hidden"),i.removeClass("loading"),!0===e.result&&(a.html(e.content),o.html(e.breadcrumbs),u.removeClass("shown"),window.history.pushState(null,"",t))}})}if(l=e("#knowledge-page"),0!==l.length){var u=e("#knowledge-templates");e(window).scroll(function(){if(s){var t=e(s),a=t.offset().top-65;t.addClass("flash"),e("body,html").animate({scrollTop:a},{duration:500,easing:"swing",complete:function(){t.addClass("slow-motion"),t.removeClass("flash")}}),s=""}}),l.on("click","[data-role=anchor-link]",function(t){t.preventDefault();var a=e(this).attr("href"),o=e(a).offset().top-65;e("body,html").animate({scrollTop:o},{duration:1e3,easing:"swing"})}),l.on("click","[data-role=show-knowledge-anchors]",function(){e("#knowledge-anchors").addClass("shown"),e(n).removeClass("hidden")}),l.on("click","[data-role=close-knowledge-anchors]",function(){e("#knowledge-anchors").removeClass("shown"),e(n).addClass("hidden")}),l.on("click","[data-role=show-knowledge-templates]",function(){u.addClass("shown"),e(n).removeClass("hidden").addClass("left")}),l.on("click","[data-role=close-knowledge-templates]",function(){var t=e(n);if(t.hasClass("loading"))return!1;u.removeClass("shown"),t.addClass("hidden").removeClass("left")}),l.on("click",n,function(){if(e(this).hasClass("loading"))return!1;e("#knowledge-anchors").removeClass("shown"),u.removeClass("shown"),e(n).addClass("hidden").removeClass("left")}),l.on("click",i+" a",function(){return t(e(this).attr("href")),!1}),l.on("keyup","[data-role=templates-gbl-search]",function(){function t(){n.val(""),u.find(a).removeClass("hidden"),u.find(i).removeClass("hidden"),u.find(o).show(),u.find(".collapse").collapse("hide"),u.find("[data-role="+r+"]").remove(),u.find("[data-role="+d+"]").remove(),u.find("mark").each(function(){e(this).parent().text(e(this).parent().text())})}var n=e(this),l=n.val().toLowerCase();if(0===l.length)return t(),!1;u.find("[data-role="+r+"]").remove(),u.find("[data-role="+d+"]").remove(),u.find(o).hide().val(""),u.find(i+':not(".hidden")').addClass("hidden");var s=String.getSearchStringVariants(l),c=[];for(var f in s)s.hasOwnProperty(f)&&c.push('[data-search-title*="'+s[f]+'"]');var p=e("[data-search-title]").filter(c.join(", "));p.each(function(){var t=e(this),a=t.find("a"),o=a.text().replace(new RegExp("("+s.join("|")+")","gi"),"<mark>$1</mark>");a.html(o),t.removeClass("hidden")});var h=u.find(a);h.removeClass("hidden"),h.each(function(){var t=e(this);0===t.find(i+':not(".hidden")').length&&t.addClass("hidden")}),u.find('.collapse:not(".hidden")').collapse("show");var v=u.find("[data-role="+d+"]");0===v.length&&(v=e("<a/>",{html:"Сбросить поиск",href:"#"}),v.attr("data-role",d),n.after(v),v.on("click",function(){return t(),!1}));var m=u.find("[data-role="+r+"]");0===p.length&&0===m.length&&(m=e("<div/>",{html:"К сожалению, ничего не найдено"}),m.attr("data-role",r),n.after(m))}),l.on("keyup",o,function(a){function o(){s.find("mark").each(function(){e(this).parent().text(e(this).parent().text())}),s.find(i).removeClass("hidden"),s.find("[data-role="+r+"]").remove(),s.find("[data-role="+d+"]").remove(),n.val("")}var n=e(this),l=n.val().toLowerCase(),s=n.parent(),c=s.find(i+':not(".hidden")');if(window.KeyboardCodes.ENTER===a.keyCode&&1===c.length)return t(c.find("a").attr("href")),!1;if(0===l.length)return o(),!1;var u=s.find("[data-role="+d+"]");0===u.length&&(u=e("<a/>",{html:"Сбросить поиск",href:"#"}),u.attr("data-role",d),s.append(u),u.on("click",function(){return o(),!1}));var f=String.getSearchStringVariants(l),p=[];for(var h in f)f.hasOwnProperty(h)&&p.push('[data-search-title*="'+f[h]+'"]');s.find(i).addClass("hidden");var v=s.find("[data-search-title]").filter(p.join(", ")),m=s.find("[data-role="+r+"]");if(0===v.length)return 0===m.length&&(m=e("<div/>",{html:"К сожалению, ничего не найдено"}),m.attr("data-role",r),n.after(m)),!1;m.remove(),v.each(function(){var t=e(this),a=t.find("a"),o=a.text().replace(new RegExp("("+f.join("|")+")","gi"),"<mark>$1</mark>");a.html(o),t.removeClass("hidden")})}),l.on("click","[data-role=all-photos-link]",function(){e(this).closest("div").find(".characteristic-values_with-spoiler").slideDown(700),e(this).toggleClass("hidden")})}})}(document,jQuery),function(t,e,a){function o(t,o,n){a!=t[0]&&e.ajax({url:i,type:"POST",data:{log_guid:t,target_guid:o,target_type:n}})}var i="/to-target-log/";window.AddToLogActivityTarget=o,window.LogActivityGuids=[];var n=void 0;e(function(){n=e('[data-role="search-results"]'),0!==n.length&&(n.on("click","[data-id=product] a",function(){var t=e(this).closest("[data-id=product]"),a=t.find("[data-product-guid]").data("product-guid"),o="product";"show-avails-modal"==e(this).data("role")&&(o="avails"),AddToLogActivityTarget(LogActivityGuids,a,o)}),n.on("click","[data-action=cart-button]",function(){var t=e(this).data("product-guid");AddToLogActivityTarget(LogActivityGuids,t,"order")}),n.on("click","[data-action=notify-button]",function(){var t=e(this).data("id");AddToLogActivityTarget(LogActivityGuids,t,"notify")}),n.on("click","[data-compare-role]",function(){var t=e(this).data("product-guid");AddToLogActivityTarget(LogActivityGuids,t,"compare")}),n.on("click",'[data-role="search-category"]',function(){var t=e(this).data("category-guid");AddToLogActivityTarget(LogActivityGuids,t,"category")}))})}(document,jQuery),function(t,e,a){window.EVENT_CATALOG_LIST_IS_LOADED="catalog:is-loaded";var o=void 0,i=void 0,n=void 0,r=void 0,d=void 0,l=void 0,s=void 0,c=void 0,u={onSuccess:function(t){var a=parseInt(t.data.totalCount),r=parseInt(t.data.lastPageNumber),l=parseInt(t.lastProductIndex);d.toggleClass("hidden",0===a).text(String.countPostfix(a,["товар","товара","товаров"],!1,!1,!1));var c=e(t.data.pickedFilters);if(s.each(function(){var t=c.clone();e(this).html(t),t.pickedFilters()}),0===a&&(n.empty(),i.addClass("hidden"),o.find('[data-role="null-result-container"]').removeClass("hidden")),null!==t.html){var u=e(t.html);void 0===f.offset&&n.empty(),n.append(u)}var p=o.find('[data-role="next-load-block"]');p.data("next-product-index",l),o.data("get-page-count",r),p.toggleClass("hidden",!1===t.isNextLoadAvailable),n.trigger(window.EVENT_INIT_POPOVERS),e(document).trigger(window.EVENT_PRODUCTS_LOADED),dispatchLazyLoadUpdateEvent(),y(!1)},onFail:function(){}},f={p:void 0,i:void 0,mode:void 0,stock:void 0,order:void 0,groupBy:void 0,shops:void 0,type:void 0,offset:void 0},p=[],h=function(t,e){f.offset=void 0,p=e.data,_()},v=function(){var t=document.location.href.split("?");if(2===t.length){var e=t.pop(),a=String.parseQueryString(e);m(a)}},m=function(t){for(var e in t)!1!==t.hasOwnProperty(e)&&(!0===f.hasOwnProperty(e)?f[e]=t[e]:p.push({key:e,value:t[e]}))},g=function(t){t.preventDefault(),n.data("clear-status",!1);var a=e(this),i=o.data("last-product-index"),r=a.data("next-product-index");f.offset=i>=r?i:r,_()},w=function(t){t.preventDefault();var a=e(this),o=a.closest('[data-role="ordering-dropdown"]'),i=a.data("id"),n=a.text(),r=o.data("ordering-key"),d=o.find(".disabled");i!==f[r]&&(o.find('[data-role="order-type-selected"]').find(".title").text(n),d.each(function(){e(this).removeClass("disabled")}),a.parent().addClass("disabled"),f[r]=i,f.offset=void 0,_())},b=function(){void 0!==c&&c.abort()},E=function(){var t=[];for(var e in f)if(!1!==f.hasOwnProperty(e)&&void 0!==f[e]){var a=f[e];t.push(e+"="+a)}
return p.forEach(function(e){t.push(e.key+"="+e.value)}),t},T=function(t){void 0!==window.history&&window.history.pushState({},document.title,"?"+t.join("&"))},_=function(){y(!0),b();var t=E();c=e.get(o.data("update-url")+"?"+t.join("&")),c.then(u.onSuccess,u.onFail),T(t)},y=function(t){!0===t?(e('[data-role="markdown-products-container"]').find("loading-dots").length>0&&e('[data-role="markdown-products-container"]').find("loading-dots").remove(),e('[data-role="markdown-products-container"]').toggleClass("loading-overlay",!0).append('<div class="loading-dots"><span /><span /><span /><span /></div>')):e('[data-role="markdown-products-container"]').toggleClass("loading-overlay",!1).find(".loading-dots").remove()};e(function(){o=e("#page-markdown-products"),0!==o.length&&(s=o.find('[data-role="selected-filters-panel"]'),i=o.find('[data-role="catalog-items-wrapper"]'),n=o.find('[data-role="markdown-products-container"]'),d=o.find('[data-role="markdown-filtered-products-count"]'),l=o.find('[data-role="catalog-view-mode-form"]'),r=e(document).find(window.SELECTOR_FILTER_LIST_CONTAINER),v(),o.on("click",['[data-role="select-group-by"]','[data-role="select-sort-by"]'].join(","),w),o.on("click",'[data-role="next-load-block"]',g),o.on(window.EVENT_FILTER_LIST_AFTER_CHANGE,h),o.on(window.EVENT_FILTER_LIST_SUBMIT,h))})}(window,jQuery),FilterBlockMarkdownProductType.prototype=Object.create(FilterBlock.prototype),FilterBlockMarkdownProductType.prototype.constructor=FilterBlockMarkdownProductType,FilterBlockMarkdownProductType.prototype.init=function(t){function e(){var t=r.$block.find(':input[type="checkbox"]:checked'),e=r.$block.find("button .title"),a=r.$block.find(':input[type="checkbox"]').length;1===parseInt(t.length)?e.text(t.closest("div").find("label")[0].innerText):0===parseInt(t.length)||a===t.length?e.text("Все"):e.text(String.countPostfix(t.length,["тип","типа","типов"],"",!1,""))}function a(){if(0<r.$block.find(':input[type="checkbox"]:checked').length)return r.$block.find('[data-role="clear-selected-shops"]').removeClass("hidden"),void r.$block.find("button").addClass(i);r.$block.find('[data-role="clear-selected-shops"]').addClass("hidden"),r.$block.closest("div").find("button").removeClass(i)}FilterBlock.prototype.init.apply(this,[t]);var o=window.SELECTOR_FILTER_LIST_CONTAINER+'[data-id="markdown-filter"][data-side="top"][data-submit-type="button"]',i="types-select",n=document.querySelector(o);if(null!==n&&"true"!==n.getAttribute("type")){n.setAttribute("type",!0);var r=this,d=n.querySelector('[data-role="clear-selected-type"]'),l=n.querySelector("[role=menu]"),s=n.querySelectorAll('[data-toggle="dropdown"]'),c=document.getElementsByTagName("body");r.$block.on("change",'input:not([data-role="filter-items-search"]), select',function(){e(),a()});var u=!0,f=!1,p=void 0;try{for(var h,v=s[Symbol.iterator]();!(u=(h=v.next()).done);u=!0){h.value.addEventListener("click",function(){r.$block.hasClass("open")?c[0].classList.add("lock"):c[0].classList.remove("lock")})}}catch(t){f=!0,p=t}finally{try{!u&&v.return&&v.return()}finally{if(f)throw p}}r.$block.on(window.EVENT_FILTER_BLOCK_REESET,function(){a(),e()}),l.addEventListener("click",function(t){t.stopPropagation()}),d.addEventListener("click",function(){r.reset(),r.$block.trigger(window.EVENT_FILTER_BLOCK_AFTER_CHANGE),r.$block.change(),r.$block.closest("div").find("button").removeClass(i),a(),e()})}},FilterBlockMarkdownProductType.prototype.getSelectedValue=function(){var t=[];return this.$block.find(':input[type="checkbox"]:checked').each(function(){t.push($(this).data("id"))}),0!==t.length?t.join(","):void 0},FilterBlockMarkdownProductType.prototype.reset=function(){this.$block.find('[type="checkbox"]').prop("checked",!1),this.$block.trigger(window.EVENT_FILTER_BLOCK_REESET)},FilterBlockMarkdownShops.prototype=Object.create(FilterBlockSelectShops.prototype),FilterBlockMarkdownShops.prototype.constructor=FilterBlockMarkdownShops,FilterBlockMarkdownShops.prototype.getContainerSelector=function(){return window.SELECTOR_FILTER_LIST_CONTAINER+'[data-id="markdown-filter"][data-side="top"][data-submit-type="button"]'},function(t){var e="#item-tabs-block";t.fn.markdownProductPage=function(){function a(){o(),t(window).on(EVENT_CHANGE_SCREEN_TYPE,o)}function o(){!0===window.checkScreenType(window.SCREEN_MOBILE)?t(e).responsiveTabs("activate",0):t(e).responsiveTabs("activate",1)}a.apply(this,arguments)}}(jQuery),function(t,e){!function(){e.EVENT_DO_SHOW_CATALOG_MOBILE_MENU="catalog-menu:mobile:show",e.EVENT_DO_HIDE_CATALOG_MOBILE_MENU="catalog-menu:mobile:hide",e.EVENT_DO_TOGGLE_CATALOG_MOBILE_MENU="catalog-menu:mobile:toggle",e.EVENT_SHOWN_CATALOG_MOBILE_MENU="catalog-menu:mobile:shown",e.EVENT_HIDDEN_CATALOG_MOBILE_MENU="catalog-menu:mobile:hidden",e.EVENT_MENU_MOBILE_SHOW="global:open",e.EVENT_MENU_MOBILE_HIDE="global:close",t(function(){function a(){n=!0,i.get(0).scrollTop=0,i.addClass("shown"),t(e).trigger(e.EVENT_SHOWN_CATALOG_MOBILE_MENU)}function o(){0!==i.length&&(n=!1,i.removeClass("shown"),t(e).trigger(e.EVENT_HIDDEN_CATALOG_MOBILE_MENU))}var i=t("#menu-catalog-aside"),n=!1;t(document).on(["click",e.EVENT_DO_TOGGLE_CATALOG_MOBILE_MENU].join(" "),'[data-role="catalog-menu-tumbler"]',function(){!0===n?o():a()});var r=t();r.push(e),i.each(function(){r.push(this)}),r.on(e.EVENT_DO_SHOW_CATALOG_MOBILE_MENU,a).on(e.EVENT_DO_HIDE_CATALOG_MOBILE_MENU,o),i.on(e.EVENT_MENU_MOBILE_SHOW,a).on(e.EVENT_MENU_MOBILE_HIDE,o),t(e).on(e.EVENT_CHANGE_SCREEN_TYPE,function(){e.checkScreenType(e.SCREEN_MOBILE,e.SCREEN_TABLET)||o()}),t(e).trigger(e.EVENT_CHANGE_SCREEN_TYPE)})}(),function(){e.EVENT_MOBILE_MENU_DO_SHOW="menu:mobile:open",e.EVENT_MOBILE_MENU_DO_HIDE="menu:mobile:close",e.EVENT_MOBILE_MENU_HAS_OPENED="menu:mobile:opened",e.EVENT_MOBILE_MENU_HAS_CLOSED="menu:mobile:closed",e.EVENT_MOBILE_UPDATE_NOTIFIER="menu:modile:update-notifier",e.NOTIFY_ACTIVITY_COMPARE="compare",e.NOTIFY_ACTIVITY_WISHLIST="wishlist",e.NOTIFY_ACTIVITY_CART="cart",e.NOTIFY_ACTIVITY_USER="user",t(function(){function a(){n.get(0).scrollTop=0,n.addClass("open"),t(e).trigger(e.EVENT_MOBILE_MENU_HAS_OPENED)}function o(){n.removeClass("open"),t(e).trigger(e.EVENT_MOBILE_MENU_HAS_CLOSED),v.addClass("collapsed"),v.attr("data-action","open")}function i(){var e=0;t.each(h,function(t,a){e+=a}),v.toggleClass("has-notifies",e>0)}var n=t("#header-menu"),r=0,d=t(e.SELECTOR_COMPARE_BTN_GLOBAL+' [data-of="totalCount"]');0!==d.length&&""!==d.text()&&(r=parseInt(d.text()));var l=0,s=t(e.SELECTOR_WISHLIST_BTN_GLOBAL+' [data-of="totalCount"]');0!==s.length&&""!==s.text()&&(l=parseInt(s.text()));var c=0,u=t(e.SELECTOR_CART_WIDGET+' [data-of="totalCount"]');0!==u.length&&""!==u.text()&&(c=parseInt(u.text()));var f=0,p=n.find('[data-role="user-notifications-count"]');0!==p.length&&""!==p.text()&&(f=parseInt(p.text()));var h={};h[e.NOTIFY_ACTIVITY_COMPARE]=r,h[e.NOTIFY_ACTIVITY_WISHLIST]=l,h[e.NOTIFY_ACTIVITY_CART]=c,h[e.NOTIFY_ACTIVITY_USER]=f;var v=t('[data-role="toggle-mobile-menu"]');t('[data-role="open-mobile-menu"]').on("click",function(){!0===t(this).hasClass("opened")?o():a()}),t('[data-role="close-mobile-menu"]').on("click",o),v.on("click",function(){var e=t(this);"open"===e.attr("data-action")?(e.removeClass("collapsed"),e.attr("data-action","close"),a()):(e.addClass("collapsed"),e.attr("data-action","open"),o())}),i(),t(e).on(e.EVENT_MOBILE_MENU_DO_SHOW,a).on(e.EVENT_MOBILE_MENU_DO_HIDE,o).on(e.EVENT_MOBILE_UPDATE_NOTIFIER,function(t,e){h[e.activity]=e.count,i()}),n.on(e.EVENT_MENU_MOBILE_SHOW,a).on(e.EVENT_MENU_MOBILE_HIDE,o)})}()}(jQuery,window),function(t,e){function a(){r.show()}function o(){r.hide()}function i(){n=e(u);var t={};t.page=l,t.limit=s,a(),e.ajax({url:n.data("request-url"),type:"GET",data:t,dataType:"JSON",success:function(t){if(!0===t.result){o();var a=e(t.content);n.find(f).last().after(a),l++,window.history.pushState(null,"",a.find("ul.pagination li.active a").attr("href")),dispatchLazyLoadUpdateEvent()}}})}var n,r,d,l,s,c,u="#news-container",f=".news-item";e(function(){n=e(u),0!==n.length&&(r=n.find("[data-role=news-loader]"),d=n.find(".news-container"),c=parseInt(n.data("count")),s=parseInt(n.data("limit")),l=parseInt(d.find('[data-role="pagination"]').data("current-page"))+1,n.on("pjax:start",function(){a()}).on("pjax:end",function(){o();var t=e(".page-title");0!==t.length&&e(window).scrollTop(t.offset().top),l=parseInt(d.find('[data-role="pagination"]').data("current-page"))+1,dispatchLazyLoadUpdateEvent()}),n.on("click","[data-role=show-more]",function(){return e(".pagination-container").remove(),i(),!1}))}),e(function(){n=e(".news-view"),0!==n.length&&n.on("pjax:end",function(){e(t).trigger(window.EVENT_PRODUCTS_LOADED),dispatchLazyLoadUpdateEvent()})})}(document,jQuery),function(t,e,a){function o(){function t(){if(et!==at){it=1;var t=K.find(Y).find(b);n(function(){i(rt),t.remove(),e(E+":first").remove()})}else i(rt)}function o(t){t.fadeIn(1e3,function(){var a=t.offset().top-t.outerHeight();t.fadeOut(8e3),e("HTML, BODY").animate({scrollTop:a},1e3)})}function ht(t){var e=t.closest(b);return{$opinionItem:e,$btnEdit:e.find(V),$formContainer:e.find($),$opinionContainer:e.find(".opinion-content")}}function vt(){window.initFancyBox();var t=K.find("[data-role=opinion-photos-slider-wrap]");e.each(t,function(){function t(t){i.toggleClass("disabled",-1!==t.visibleItems.indexOf(0)),o.toggleClass("disabled",-1!==t.visibleItems.indexOf(t.owlItems.length-1))}var a=e(this).find("[data-role=slider]");if(0!==a.length){var o=e(this).find(D),i=e(this).find(R);window.checkScreenType(window.SCREEN_MOBILE)?"object"!==_typeof(a.data("owlCarousel"))&&a.owlCarousel({itemsCustom:[[0,2],[390,3]],navigation:!1,pagination:!1,rewindNav:!0,autoPlay:!1,scrollPerPage:!0,afterInit:function(){t(this.owl)},afterAction:function(){t(this.owl)}}):"object"===_typeof(a.data("owlCarousel"))&&a.data("owlCarousel").destroy(),o.click(function(){e(this).is(".disabled")||a.trigger("owl.next")}),i.click(function(){e(this).is(".disabled")||a.trigger("owl.prev")})}})}if(K=e(c),0!==K.length){J=K.find(p),z=K.find(g),X=K.find(w),tt=K.find(T),Z=K.find(m),ct=K.find(L),ut=K.find(x),ft=K.find(k),pt=K.find(W),at=parseInt(K.data("count")),et=parseInt(K.data("limit")),it=parseInt(Z.find(_).data("current-page"))+1,nt=parseInt(K.find(y).val()),rt=0,dt=parseInt(K.find(S).val()),ot=e(window).scrollTop();var mt=K.find(C);0!==mt.length&&mt.select2({theme:"krajee",templateResult:function(t){return e("<div>",{text:t.text}).attr("class","option-with-star")},templateSelection:function(t){return e("<div>",{text:t.text}).attr("class","option-with-star")},minimumResultsForSearch:-1}).next().css("display","block"),K.on("click",O,function(){it=parseInt(e(this).data("page"))+1,ft=K.find(".active-block"),dt=parseInt(ft.find(S).val());var t=K.find(Y).find(b);return n(function(){i(rt),t.remove(),e(E+":first").remove()}),e("HTML, BODY").animate({scrollTop:ct.offset().top-50},700),!1}),K.on("click",u,function(){return K.find(E).remove(),n(),!1}),K.on("change",y,function(){e(I+" div").removeClass("active-block"),e(this).closest("div").addClass("active-block"),it=1,nt=parseInt(e(this).val());var t=K.find(Y).find(b);n(function(){i(rt),t.remove(),e(E+":first").remove()})}),K.on("change",C,function(){rt=parseInt(e(this).val()),t()}),e(N).click(function(){e("HTML, BODY").animate({scrollTop:ct.offset().top-50},500)}),K.on("change",S,function(){e(k+" div").removeClass("active-block"),e(this).closest("div").addClass("active-block"),it=1,dt=parseInt(e(this).val()),d===dt&&(e(H).prop("checked",!1),lt=0);var t=K.find(Y).find(b);K.find(E).remove(),t.remove(),n(function(){i(rt)})}),K.on("click",H,function(){if(d===dt)return e(this).prop("checked",!1),void(lt=0);lt=e(this).prop("checked")?1:0,it=1;var t=K.find(Y).find(b);K.find(E).remove(),t.remove(),n(function(){i(rt)})}),K.on("click",Q,function(){st=e(this).prop("checked")?1:0,it=1;var t=K.find(Y).find(b);K.find(E).remove(),t.remove(),n(function(){i(rt)})}),K.find("[data-grade-filter]").click(function(){return rt=e(this).data("grade-filter"),t(),!1}),J.click(function(){if(e(this).closest(f).hide(),0<ut.length&&ut.css({display:"none"}),ot=e(window).scrollTop(),z.attr("data-form-open",!0),!1===X.is(":empty"))return void X.show();e.ajax({url:J.data("form-url"),type:"GET",dataType:"JSON",success:function(t){if(!0!==t.result)return void z.attr("data-form-open",!1);var a=e(t.html);X.append(a),e(window).trigger(window.GlobalEvents.EVENT_OPINION_FORM_INIT,X)}})}),e(window).on(window.GlobalEvents.EVENT_OPINION_SUBMIT_BTN_ADD_FORM_PRESS,function(t,a){var i=e(a),n=i.closest("FORM"),r=n.serializeArray();return e(window).trigger(window.EVENT_SUBMIT_OPINION_WIDGET,r),e.ajax({url:J.data("form-url"),type:"POST",dataType:"JSON",data:r,success:function(t){if(l===t.status)return pt.fadeIn(1e3,function(){pt.fadeOut(8e3),e("HTML, BODY").animate({scrollTop:pt.offset().top-150},1e3)}),z.attr("data-form-open",!1),X.hide(),J.show(),void i.toggleClass("not-allowed",!1);if(!0===t.result){var a=e(t.content),n=X.find('[data-role="photo-dropzone-container"]');if(X.html(a),t.opinion&&"string"==typeof t.opinion.valueOf()){var r=e(t.opinion);if(r.addClass("new"),K.find(".opinions-list").find(W).after(r),s===t.status){var d=r.find(G);d.find("SPAN").html(t.message),o(d)}}var c=X.find('[data-role="photo-dropzone-container"]');c.length>0&&n.length>0&&c.replaceWith(n),e(window).scrollTop(ot),J.show(),z.attr("data-form-open",!1),i.toggleClass("not-allowed",!1),setTimeout(function(){X.find(".alert-warning").fadeOut(700)},2e3)}}}),!1}),e(window).on(window.GlobalEvents.EVENT_OPINION_CLOSE_BTN_ADD_FORM_PRESS,function(){J.closest(f).show(),z.attr("data-form-open",!1),X.hide(),e(window).scrollTop(ot)}),K.on("click",A,function(){var t=e(this),o=t.closest(b);a===t.attr("disabled")&&(o.hasClass("expanded")?(o.css({maxHeight:o.prop("scrollHeight")}),o.animate({maxHeight:"320px"},200,function(){o.removeClass("expanded")})):(o.addClass("expanded"),o.animate({maxHeight:o.prop("scrollHeight")},200,function(){o.css({"max-height":"none"})})))}),K.on("click",h,function(){var t=K.find(v);!1===e(h).prop("checked")?t.animate({maxHeight:"190px"},200):t.animate({maxHeight:t.prop("scrollHeight")},200)}),K.on("click",P,function(){K.find(U).toggleClass("close"),e(this).closest(b).find(M).hasClass("spoiler-close")?e(this).closest(b).find(M).slideDown(700):e(this).closest(b).find(M).slideUp(700),e(this).closest(b).find(M).toggleClass("spoiler-close")}),K.on("click",F,function(){var t=e(this).closest(b);0<t.find(P).length&&e(this).closest(b).find(M).addClass("spoiler-close"),e(this).closest(b).find(M).find(".comments-form").addClass("visible"),t.find(P).click(),t.find(B).click()}),K.on("click",V,function(){var t=e(this),a=e(this).closest(b),o=ht(t);e.ajax({url:t.attr("data-url"),type:"GET",dataType:"JSON",success:function(i){if(!0!==i.result){var n=o.$opinionContainer.parent().find('.modal[data-role="unable-to-edit-modal"]');return 0===n.length&&(o.$opinionContainer.after(i.html),n=o.$opinionContainer.parent().find('.modal[data-role="unable-to-edit-modal"]')),void n.modal("show")}t.attr("disabled",!0);var r=e(i.html);o.$formContainer.append(r),o.$opinionContainer.hide(),0<a.find(A).length&&a.find(A).click(),e(window).trigger(window.GlobalEvents.EVENT_OPINION_FORM_INIT,o.$opinionItem)}})}),e(window).on(window.GlobalEvents.EVENT_OPINION_CLOSE_BTN_EDIT_FORM_PRESS,function(t,a){var o=ht(e(a));o.$btnEdit.prop("disabled",!1),o.$formContainer.empty(),o.$opinionContainer.show(),e(window).scrollTop(o.$opinionItem.offset().top)}),e(window).on(window.GlobalEvents.EVENT_OPINION_SUBMIT_BTN_EDIT_FORM_PRESS,function(t,a){var i=ht(e(a)),n=i.$formContainer.find("FORM");e.ajax({url:n.attr("action"),type:"POST",dataType:"JSON",data:n.serializeArray(),success:function(t){if(l===t.status)return void pt.fadeIn(1e3,function(){pt.fadeOut(8e3),e("HTML, BODY").animate({scrollTop:pt.offset().top-pt.outerHeight()},1e3)});if(!0===t.result){var a=e(t.content),n=i.$formContainer.find('[data-role="photo-dropzone-container"]');if(i.$formContainer.html(a),!0===t.updated){var r=i.$opinionItem;t.opinion&&"string"==typeof t.opinion.valueOf()&&(r=e(t.opinion),i.$opinionItem.replaceWith(r));var d=r.find(G);d.find("SPAN").html(t.message),o(d),i.$btnEdit.prop("disabled",!1),i.$formContainer.empty(),i.$opinionContainer.show()}var s=i.$formContainer.find('[data-role="photo-dropzone-container"]');s.length>0&&n.length>0&&s.replaceWith(n),setTimeout(function(){i.$formContainer.find(".alert-warning").fadeOut(8e3)},2e3)}}})}),K.on("click",q,function(){e(this).parents(G).fadeOut(500),e(this).parents(W).fadeOut(500)}),K.on("click",j,function(){var t=e(this),a=ht(t),o=a.$opinionContainer.parent().find('[data-role="opinion-changes-modal"]');if(0===o.length)return e.ajax({url:t.attr("data-url"),type:"GET",dataType:"JSON",success:function(e){a.$opinionContainer.after(e.content),o=a.$opinionContainer.parent().find('[data-role="opinion-changes-modal"]'),t.attr("href","#"+o.attr("id")),o.modal()}}),!1}),r(),e(window).on(window.EVENT_CHANGE_SCREEN_TYPE,vt),vt()}}function i(t){a===t||0===t?K.find(".opinions-list [data-grade]").show():(K.find(".opinions-list [data-grade]").hide(),K.find('.opinions-list [data-grade="'+t+'"]').show())}function n(t){var o={};o.page=it,o.limit=et,o.sort=nt,o.source=dt||0,o.confirmPurchase=lt,o.withImage=st,rt&&(o.grade=rt),tt.show(),e.ajax({url:K.data("request-url"),type:"GET",data:o,dataType:"JSON",success:function(o){if(tt.hide(),!0===o.result){var i=e(o.content);Z.find(".opinions").append(i),it++,window.history.pushState(null,"",i.find("ul.pagination li.active a").attr("href")),r(),e(window).trigger(window.EVENT_INIT_COMMENTS_WIDGET),e(window).trigger(window.EVENT_INIT_VOTE_WIDGET),a!==t&&t(),window.initFancyBox()}}})}function r(){e(".vote-widget-container[data-has-many-negative]").each(function(){e(this).closest(b).addClass("has-many-negative")})}window.EVENT_PRODUCT_CARD_OPINIONS_LOADED="product-card-opinions:loaded";var d=2,l="failed",s="success",c="#w-opinions-widget",u='[data-role="show-more"]',f='[data-role="button-container"]',p='[data-role="add"]',h="#disclaimer-spoiler",v=".disclaimer",m=".opinion-container",g=".opinions-header",w='[data-role="add-form-container"]',b=".opinion-item",E=".pagination-container",T='[data-role="opinions-loader"]',_='[data-role="pagination"]',y='[data-role="opinions-sort-filter"]',C='[data-role="opinions-grades-filter"]',k='[data-role="sources-container"]',I='[data-role="sort-container"]',S='[data-role="opinions-sources-filter"]',O="a[data-page]",N=".opinion-ajax-grade",L=".filters-container",x=".stub-container",A=".opinion-spoiler",R=".btn-prev",D=".btn-next",P='[data-role="show-comments"]',F=".dummy-sub-add-comment",B='[data-role="add-form"]',M=".comment-container",V='[data-role="get-opinion-edit-form"]',j='[data-role="show-opinion-changes"]',$='[data-role="edit-form-container"]',U='[data-role="open-close-comment-icon"]',H='[data-role="opinion-sort-confirm-purchase"]',G='[data-role="opinion-save-alert"]',W='[data-role="opinion-reject-alert"]',q='[data-role="close-opinion-alert"]',Q='[data-role="opinion-sort-with-image"]',Y=".opinions-list",K=void 0,z=void 0,J=void 0,X=void 0,Z=void 0,tt=void 0,et=void 0,at=void 0,ot=null,it=void 0,nt=void 0,rt=void 0,dt=void 0,lt=void 0,st=void 0,ct=void 0,ut=void 0,ft=void 0,pt=void 0;e(function(){o(),window.addEventListener(window.EVENT_INIT_OPINION_WIDGETS,o)})}(document,jQuery),function(t,e,a,o){"use strict";function i(){var t=[];for(var a in Q)if(Q.hasOwnProperty(a)){var o=Q[a];if(o.prev===o.last)continue;t.push({productId:a,count:o?o.last:0,productGroupId:o.productGroupId,productTypeId:o.productTypeId})}return e.extend([],t,!0)}var n=1,r=2;a.EVENT_REMOVE_FROM_CART="cart:remove-item",a.EVENT_UPDATE_CART_ITEM="cart:update-item",a.EVENT_ITEM_REMOVED_FROM_CART="cart:item-removed";var d=3,l="[data-role=mixed-types-products-count]",s="[data-role=mixed-types-products-list]",c="[data-role=mixed-types-benefit-info]",u="[data-role=mixed-types-text-info]",f="[data-role=show-all-mixed-type-products]",p="[data-role=discount-logistic-block]",h="[data-role=cart-tab]",v="[data-role=cart-tab-control]",m="[data-role=cart-tab-control-mobile]",g="[data-role=cart-tab-controls-mobile]",w="[data-role=restore-last-removed-product]",b='[data-role="submit-order"]',E='[data-role="submit-mixed-order"]',T='.btn-plus:not([data-force-disabled="1"])',_="[data-role=product-remains-block]",y="[data-id=checkout-group]",C="[data-id=checkout-group-item]",k=".price-total-amount",I="[data-role=total-remains-block]",S="[data-role=one-click]",O="[name=count]",N="<p><b>Максимально доступное количество товара!</b><br>К сожалению, данный товар доступен только в количестве %c %w.</p>",L="<p><b>К сожалению, данный товар недоступен!</b></p>",x="product-type-id",A="max",R="checkout-group",D="cart-id",P="cart-group-id",F="cart-product-id";a.SELECTOR_CART_PRODUCT="[data-"+F+"]",a.SELECTOR_CART_PRODUCT_ID=F;var B=3,M="[data-of=rsu-product-count]",V="[data-of=rsu-no-avails]",j="#bp-products-links-form",$=".bp-product-name",U=".bp-errors",H="add",G="remove",W=999,q=W.toString().length,Q={},Y={},K=void 0,z=void 0,J=!1;a.SELECTOR_CHECKOUT_GROUP=y,a.SELECTOR_CHECKOUT_GROUP_ITEM=C,e(function(){function X(t){t.totalCount>0?Tt.applySets("active",{totalCount:a.numberFormat(t.totalCount,0,"."," "),totalPrice:a.numberFormat(t.totalPrice,0,"."," ")}):Tt.setState("default"),e(a).trigger(a.EVENT_MOBILE_UPDATE_NOTIFIER,{activity:a.NOTIFY_ACTIVITY_CART,count:t.totalCount})}function Z(t){var e=t.data(A),a=Et.find(C+"[data-"+F+"="+t.data(F)+"]"),o=a.find(".warning-block");o.html(String.countPostfix(e,["штука","штуки","штук"],L,!1,N)),o.addClass("visible")}function tt(t){Et.find(C+"[data-"+F+"="+t.data(F)+"]").find(".warning-block").removeClass("visible")}function et(t){Z(t)}function at(t){tt(t)}function ot(t){t?(Nt.prop("disabled",!t),Lt.each(function(){!t===e(this).data("disabled")&&e(this).prop("disabled",!t)}),St.prop("disabled",!1),z.prop("disabled",!1)):(Ot.prop("disabled",!t),St.prop("disabled",!t),z.prop("disabled",!t))}function it(t,i){var n=t.find(k);n.applySingleSets({"prev-price-total":0,"price-total":a.numberFormat(i.groupPrice,0,"."," "),"total-bonus":" "+a.numberFormat(i.groupBonus,0,"."," "),"bonus-visible":i.groupBonus>0});var r=0!==i.groupPrice;n.find(".group-total-price-container").toggleClass("hidden",!1===r).end().find(".empty-remains-message").toggleClass("hidden",r).end().find(b).prop("disabled",!1===r),e('[data-products-count-for="'+i.groupType+'"]').each(function(){var t=e(this);t.data("value",t.data("value")+i.groupProductsCount).text("("+t.data("value")+")").toggleClass("hidden",0===t.data("value"))});for(var d in i.products)if(0===t.find(C+"[data-"+F+"="+d+"]").length)return a.location.reload();t.find(C).each(function(){var t=e(this),a=t.data(F);if(o!==i.products[a]){var n=i.products[a];0===n.count&&!0===n.isAvailable&&B!==n.type?ut(t,a,-1!==e.inArray(a,i.restorableProducts)):ct(t,n)}else ut(t,a,-1!==e.inArray(a,i.restorableProducts))}),t.find(p).html(i.discountWidget),t.find(I).html(i.remainsWidget),nt(t,i.oneClickCheckoutWidget),lt()}function nt(o,i){o.find("[data-role=one-click-checkout-container]").html(i),rt(),e(t).trigger(a.EVENT_INIT_POPOVERS)}function rt(){Et.on("click",S,function(){var o=e(this);e(a).trigger(a.EVENT_ONE_CLICK_BUTTON_PUSH,o),new Promise(function(t){var a=bt.find(j);0!==a.length||0!==e($).not('[data-cart-product-guid=""]').length?e.ajax({type:"POST",url:a.attr("action"),dataType:"json",data:a.serializeArray(),success:function(t){e(U).empty(),!1===t.result&&e(U).text(t.errors[0])},error:function(){alert("Ошибка: ссылки на товары конкурентов не были добавлены.")},complete:function(){t()}}):t()}).then(function(){if(!0!==J&&!o.attr("disabled")){var e={cartId:o.data(D),cartGroupId:o.data(P),isInCart:!0},i=t.createElement("div");t.body.appendChild(i),J=!0,a.startOneClickOrder(e,i,function(e){t.body.removeChild(i),J=!1,!0===e&&o.parent().remove()})}})})}function dt(t){t.find(C).filter(":not(.hidden)").each(function(){ut(e(this),e(this).data(F),!0)}),t.addClass("hidden"),nt(t,""),lt()}function lt(){e(h).each(function(){var t=e(this);t.find(".tab-message").toggleClass("hidden",st(t)).end().find("[data-role=empty-tab-message]").toggleClass("hidden",!st(t))})}function st(t){var e=t.find(y);return e.length===e.filter(".hidden").length}function ct(t,o){t.removeClass("hidden"),t.closest(y).removeClass("hidden"),t.attr("data-"+x,o.type),Q[t.data(F)]?(Q[t.data(F)].productTypeId=o.type,Q[t.data(F)].prev=o.isAvailable?o.count:0,Q[t.data(F)].last=o.isAvailable?o.count:1):Q[t.data(F)]={default:o.count,prev:o.count,last:o.count,productGroupId:t.closest(y).data("checkout-group"),productTypeId:o.type},lt(),e(a).trigger(a.EVENT_UPDATE_CART_ITEM,[t]),B===o.type&&(0<o.maxCount?(t.find(V).addClass("hidden"),t.find(M).removeClass("hidden")):(t.find(M).addClass("hidden"),t.find(V).removeClass("hidden")));var i=t.find(T);i.data(A,o.maxCount),i.data("disabled",o.maxCount<=o.count),t.applySingleSets({"prev-price-total":0,"price-total":a.numberFormat(o.price,0,"."," "),"total-bonus":" "+a.numberFormat(o.bonus,0,"."," "),"bonus-visible":o.bonus>0});var n=o.isAvailable?o.count:0,r=o.isAvailable?o.count:1;t.find(O).attr("data-count",r).val(n),t.find(_).html(o.remainsWidget)}function ut(t,o,i){if(t.addClass("hidden"),Q.hasOwnProperty(o)){var n=t.closest(h).data("id");delete Q[o],i&&(Y[n].push(o),t.closest(h).find(w).removeClass("hidden"))}e(a).trigger(a.EVENT_ITEM_REMOVED_FROM_CART,t.attr("data-"+a.SELECTOR_CART_PRODUCT_ID))}function ft(t){var o=i();if(o.length)return ot(!1),e.ajax({type:"POST",url:_t,dataType:"json",data:{updates:o},success:function(e){pt(t,e)},error:function(){return a.location.reload()}})}function pt(t,i){var n=t.closest(C);if(!0===i.result){X(i.data),e("[data-products-count-for]").data("value",0).addClass("hidden");for(var r in i.data.groups)if(0===bt.find(y+"[data-"+R+"="+r+"]").length)return a.location.reload();if(e(y).each(function(){var t=e(this),a=t.data(R);o!==i.data.groups&&i.data.groups.hasOwnProperty(a)&&!1===i.data.groups[a].isEmptyGroup?it(t,i.data.groups[a]):dt(t)}),ot(!0),o!==i.data.isOverLimit){var d=n.find(T);(parseInt(n.find(O).val())||0)>=d.data(A)&&(et(d),setTimeout(function(){at(d)},3e3))}}else alert(i.message)}function ht(t,e){var a=t.closest(C).data(F),o=+e||+t.val(),i=Q[a];return i.last===o||(i.prev=i.last,i.last=o,i.last!==i.default)}function vt(t,e){var o=e>0?H:G;t.closest(C).trigger(a.EVENT_UPDATE_CART,o)}function mt(t){a.toggleLoaderVisibility(!0),e.ajax({type:"POST",url:t,dataType:"json",success:function(t){if(!0===t.result){var o=t.data;if(!0===o.isAvailable)return void(a.location.href=o.checkoutUrl);a.toggleLoaderVisibility(!1),It.modal("show");var i=It.find(l),p=It.find(u),h=It.find(c),v=It.find(s),m=Object.keys(o.unavailableProducts);!0===o.isInternetPriceAvailable?(n===o.benefitType?(h.html("Доп. скидка "+o.benefitAmount+' <b><i class="dns-icon_rub"></i></b>'),h.removeClass("hidden")):r===o.benefitType?(h.html("Доп. бонусы "+o.benefitAmount),h.removeClass("hidden")):h.addClass("hidden"),i.text("В корзине "+m.length+" "+String.countPostfix(m.length,["товар","товара","товаров"])+", при заказе которых недоступно получение дополнительной скидки (дополнительных бонусов):"),p.text("Вы можете оформить отдельный заказ на эти товары или оформить все товары в одном заказе, но без получения дополнительной скидки или бонусов.")):(h.removeClass("hidden"),i.text("В корзине "+m.length+" "+String.countPostfix(m.length,["товар","товара","товаров"])+", при заказе которых недоступно получение со склада (в нераспакованном виде):"),p.text("Вы можете оформить отдельный заказ на эти товары или оформить все товары в одном заказе, но без получения со склада (в нераспакованном виде)."),h.text("Со склада")),v.empty(),m.forEach(function(t){var a=e("<li />");a.html(o.unavailableProducts[t].title+" - <b>"+o.unavailableProducts[t].price+'</b> <i class="dns-icon_rub"></i> ('+o.unavailableProducts[t].count+" шт.)"),v.append(a)}),d<o.unavailableProducts.length&&(It.find(f).removeClass("hide"),It.on("click",f,function(){It.find("li").removeClass("hide"),It.find(f).addClass("hide")})),It.on("click","[data-role=hide-modal]",function(){It.find(".modal-dialog").removeClass("shown"),setTimeout(function(){It.modal("hide")},200)}),It.find(E).on("click",function(){a.location.href=e(this).attr("data-order-url")})}else a.toggleLoaderVisibility(!1),alert(t.errors[0])},error:function(){a.toggleLoaderVisibility(!1),alert("Ошибка: сервис временно недоступен")}})}function gt(i){var n=xt.find("[data-id="+i+"]");e(m,xt).toggleClass("disabled",!1),n.closest(m).toggleClass("disabled",!0),e("[data-role=toggle-button] [data-role=title]",xt).html(n.html());var r=e(v+"[data-id="+i+"]");r.siblings().removeClass("active"),r.addClass("active");var d=e(h);d.removeClass("active");var l=d.filter("[data-id="+i+"]");l.addClass("active");for(var s in Y)Y.hasOwnProperty(s)&&(Y[s]=[],l.find(w).addClass("hidden"));var c=d.length;d.each(function(){var t=e(this),a=t.data("id");st(t)&&(bt.find(v+"[data-id="+a+"]").remove(),bt.find(g+"[data-id="+a+"]").remove(),t.remove(),--c)});var u=e(".carts-count",bt);if(1>=c)u.parent().addClass("hidden");else if(1<c){var f=c+" "+String.countPostfix(c,["корзина","корзины","корзин"]);u.text(f),u.parent().removeClass("hidden")}o!==a.history&&a.history.pushState({},t.title,"?activeTabId="+i)}var wt=this,bt=e("[data-role=cart-page]"),Et=e(y),Tt=e(a.SELECTOR_CART_WIDGET),_t=bt.data("url-update"),yt=bt.data("url-refresh"),Ct=bt.data("url-restore"),kt=e(S),It=e('[data-role="order-mixed-type-modal"]');if(0!==bt.length){e(C,bt).each(function(){var t=e(this),a=t.data(F),o=+t.find(O).attr("data-count"),i=t.closest(y).data(R),n=t.data(x);Q[a]={default:o,prev:o,last:o,productGroupId:i,productTypeId:n},Y[t.closest(h).data("id")]=[]});var St=Et.find("[data-id=remove-from-cart]"),Ot=Et.find("[data-quantity]"),Nt=Et.find('.btn-minus:not([data-force-disabled="1"])'),Lt=Et.find(T);e(t).on(a.EVENT_UPDATE_CART,a.SELECTOR_CART_BUTTON,function(){"go_to_cart"===e(this).getState()&&a.location.reload()}),e(T).parent().mouseover(function(){!0===e(this).find(T).data("disabled")&&et(e(this).find(T))}),e(T).parent().mouseout(function(){at(e(this).find(T))}),St.on("click",function(){var t=e(this);t.attr("disabled")||(ht(t),t.trigger(a.EVENT_REMOVE_FROM_CART),ft(t))}),Ot.on("click",function(){var t=e(this),a=parseInt(t.closest(C).find(O).val())||0,o=parseInt(t.data("quantity"))||0;ht(t,a+o),a+o<=0&&vt(t,o);var i=ft(t);i&&i.done(vt(t,o))}),e(w,bt).on("click",function(){if(!e(this).attr("disabled")){var t=e(this).closest(h),o=t.find(w);o.attr("disabled","disabled");var i=t.data("id");if(Y[i].length){var n=Y[i].pop();ot(!1);var r=Et.find(C).filter("[data-"+F+'="'+n+'"]').find("[data-id=remove-from-cart]");e.ajax({type:"POST",url:Ct,dataType:"json",data:{productId:n,tabId:i},success:function(t){pt(r,t)},error:function(){return a.location.reload()}}).then(function(){Y[i].length||o.addClass("hidden"),o.removeAttr("disabled")})}}}),e("[data-role=remove-optional]",bt).on("click",function(){var t=e(this);if(!t.attr("disabled")){t.attr("disabled","disabled"),ot(!1);var o=t.closest(C).find("[data-id=remove-from-cart]");e.ajax({type:"POST",url:t.data("url"),dataType:"json",success:function(t){if(!0!==t.result)return a.location.reload();pt(o,t)},error:function(){return a.location.reload()}}).then(function(){t.closest("[data-role=optional-product]").remove()})}}),Et.find(O).on("keydown",function(t){var a=e(this),o=t.keyCode,i=a.val(),n=+i,r=o>=96&&o<=105,d=o>=48&&o<=57||r,l=r?o-96:o-48,s=t.ctrlKey||t.shiftKey,c=null;if(d&&(c=10*n+l,this.selectionStart!==this.selectionEnd)){c=+(i.substr(0,Math.min(this.selectionStart,this.selectionEnd))+l+i.substr(Math.max(this.selectionStart,this.selectionEnd)))}if(!(d&&!isNaN(c)&&c.toString().length<=q&&c<=W||/\W/.test(String.fromCharCode(o))||s))return t.preventDefault(),!1;a.data("prev-val",i)}).on("keyup blur",function(t){var o=e(this);if(!o.attr("readonly")){
var i=o.val(),n=o.data("prev-val"),r=i?+i:null,d=null;if(isNaN(r)&&(d=n),(r<0||r>W||i.length>q)&&(r=r<0?1:W),d&&(o.val(d),i=d,r=+i),0===r||13===t.keyCode){clearTimeout(K),ht(o,r);var l=ft(o);return void(l&&l.done(function(){e(a).trigger(a.EVENT_REMOVE_FROM_CART)}))}var s=0===r&&(46===t.keyCode||8===t.keyCode);if(!(isNaN(r)||!i.length||s||i===n&&null===d)){if(!1===ht(o))return!1;var c=[];for(var u in Q)Q.hasOwnProperty(u)&&Q[u].default!==Q[u].last&&c.push({productId:u,type:Q[u].last>Q[u].default?H:G});clearTimeout(K),K=setTimeout(function(){clearTimeout(K);var t=ft(o);t&&t.done(function(){for(var t=0,e=c.length;t<e;++t){var o=c[t];Et.find(C+"[data-"+F+'="'+o.productId+'"]').trigger(a.EVENT_UPDATE_CART,Et.closest(h).data("id"))}})},1e3)}}}),e(b).on("click",function(){var t=e(this),a=t.closest(y),o=a.find(".product.disabled").not(".hidden"),i=parseInt(t.attr("data-kiosk-mode")),n=a.find(".product").not(".hidden").filter(function(){return 0<e(this).find("[data-role=soft-avails-label]").length});if(0===o.length&&(1!==i||0===n.length)){var r=bt.find(j);return 0===r.length||0===e($).not('[data-cart-product-guid=""]').length?(mt(t.attr("data-order-url")),!1):(e.ajax({type:"POST",url:r.attr("action"),dataType:"json",data:r.serializeArray(),success:function(t){if(e(U).empty(),!1===t.result)return e(U).text(t.errors[0]),!1},error:function(){alert("Ошибка: ссылки на товары конкурентов не были добавлены.")},complete:function(){mt(t.attr("data-order-url"))}}),!1)}var l=a.find('[data-role="order-partition-message-modal"]'),s=a.find('[data-role="order-soft-avails-products-modal"]'),c=l.find(".modal-body").html(""),u=void 0;if(o.each(function(){var t=e(this),a=t.find(".item-name > a").attr("href"),o=t.find(".image img").clone();u=e("<a />").attr("href",a).addClass("no-available-product").append(e("<div />").addClass("image").append(o)).append(e("<div />").addClass("description").append(e("<span />").text(t.find(".item-name > a").text())).append(e("<span />").text(t.find(".item-id").text()))).append(e("<hr/>")),c.append(u)}),0===o.length){var f=s.find("[data-role=soft-avails-products-count]"),p=s.find("[data-role=soft-avails-products-list]"),h=s.find("[data-role=max-soft-avails-date]"),v=0,m=1;return f.text(n.length+" "+String.countPostfix(n.length,["товар","товара","товаров"])),p.empty(),n.each(function(){var t=e(this),a=t.find(".item-name > a").text(),o=t.find("[data-role=soft-avails-label] > a").text(),i=t.find("[data-role=soft-avails-label]").attr("data-avails-date");u=e("<li />"),d<m&&u.addClass("hide"),u.html(a+" — <b>"+o+"</b>"),0===v&&(v=i,h.text(o)),Date.parse(v)<Date.parse(i)&&(v=i,h.text(o)),p.append(u),m++}),0===parseInt(v)&&h.text("в другом магазине"),s.modal("show"),s.on("click","[data-role=hide-modal]",function(){s.find(".modal-dialog").removeClass("shown"),setTimeout(function(){s.modal("hide")},200)}),void(d<n.length&&(s.find("[data-role=show-all-soft-products]").removeClass("hide"),s.on("click","[data-role=show-all-soft-products]",function(){p.find("li").removeClass("hide"),s.find("[data-role=show-all-soft-products]").addClass("hide")})))}l.modal("show"),l.on("click","[data-role=hide-modal]",function(){l.find(".modal-dialog").removeClass("shown"),setTimeout(function(){l.modal("hide")},200)})}),e('[data-role="product-change"]').on("click",function(){var t=e(this);t.attr("disabled")||(ht(t),t.trigger(a.EVENT_REMOVE_FROM_CART),ft(t).done(function(){a.location.href=t.attr("data-category-url")}))}),bt.on("click",function(){bt.find(".count-changed-message").fadeOut(700)});var xt=e(g+" [data-role=dropdown-list]",bt);e(v,bt).on("click",function(){if(!e(this).is(".active"))return gt(e(this).data("id")),!1}),e(m,xt).on("click",function(){if(!e(this).is(".disabled"))return e("[data-role=toggle-button]",xt).dropdown("toggle"),gt(e(this).data("id")),!1}),z=e("INPUT[type=radio][data-role=additional-warranty]",bt),z.change(function(t){ot(!1),z.prop("disabled",!0);var o=t.target.value,i=e(t.target),n=i.closest(a.SELECTOR_CART_PRODUCT),r=n.closest(y).data("checkout-group"),d=n.data(F);e.ajax({type:"POST",url:bt.attr("data-url-change-additional-warranty-period"),dataType:"json",data:{productId:d,productGroupId:r,years:o},success:function(t){!0===t.result?pt(e(wt),t):alert(t.errors[0]);var a=n.find("INPUT[type=radio][data-role=additional-warranty]");a.prop("checked",!1),a.filter(function(){return o===e(this).val()}).prop("checked",!0)},error:function(){alert("Ошибка обработки данных")},complete:function(){z.prop("disabled",!1),ot(!0)}})}),bt.on("change","[data-role=service-checkbox]",function(){ot(!1);var t=e(this),o=t.closest(a.SELECTOR_CART_PRODUCT),i=o.closest(y).data("checkout-group"),n=o.data(F),r=t.attr("data-service-id");e.ajax({type:"POST",url:bt.attr("data-url-change-related-services"),dataType:"json",data:{productId:n,productGroupId:i,serviceId:r,serviceNeedAdd:t.prop("checked")?1:0},success:function(e){!0===e.result?(pt(t,e),o.find("[data-role=toggle-select][data-service-guid="+r+"]").toggleClass("selected"),bt.find("[data-param=kbt-service-checkbox]").filter(":checked").length?kt.hide():kt.show()):alert(e.errors[0])},error:function(){alert("Ошибка обработки данных")},complete:function(){ot(!0)}})}),bt.on("click",".kbt-show-more",function(){var t=e(this);t.toggleClass("opened"),t.parent().find(".spoiler-in").toggleClass("hidden")}),bt.on("click",".kbt-link",function(){e(this).next().addClass("shown")}),bt.on("click",".kbt-hide-block",function(){e(this).parent().removeClass("shown")}),bt.on("click","[data-role=toggle-select]",function(){var t=e(this),a=t.data("service-guid");t.closest(".related-services-checkout-widget").find("[data-role=service-checkbox][data-service-id="+a+"]").click()}),rt(),bt.find("[data-param=kbt-service-checkbox]").filter(":checked").length&&kt.hide(),a.refreshCheckout=function(){return e.ajax({type:"POST",url:yt,dataType:"json",success:function(t){e("[data-products-count-for]").data("value",0).addClass("hidden");for(var i in t.data.groups)if(0===bt.find(y+"[data-"+R+"="+i+"]").length)return a.location.reload();e(y).each(function(){var a=e(this),i=a.data(R);o!==t.data.groups&&t.data.groups.hasOwnProperty(i)&&!1===t.data.groups[i].isEmptyGroup?it(a,t.data.groups[i]):dt(a)})},error:function(){return a.location.reload()}})}}})}(document,jQuery,window),function(t,e){function a(t){function a(){var t=!0;return 0!==d.length&&d.prop("checked")&&(n.find('[data-role="birth-day"]').val()&&n.find('[data-role="birth-month"]').val()&&n.find('[data-role="birth-year"]').val()?n.find('[data-role="sex-id"]').val()||(OrderCheckout.showErrors(["Необходимо заполнить «Пол»."],i),t=!1):(OrderCheckout.showErrors(["Дата рождения указана неверно."],i),t=!1)),t}i=e(t),n=i.closest("FORM");var d=i.find("#is-prozapass-agree");d.change(function(){o(d.prop("checked"));var t=i.find('[data-role="prozapass-registration"]');t.toggleClass("block-inactive",!1===d.prop("checked")),t.find("INPUT, SELECT").prop("disabled",!1===d.prop("checked"))}),CheckoutContractor.onSelectContractorType(CheckoutContractor.getContractorTypeId(i),function(){r=!1,CheckoutContractor.enableButtonNext(),0===d.length?o(!0):(d.prop("checked",!0),d.change())}),n.submit(function(){return CheckoutContractor.getCurrentContractorTypeId()!==CheckoutContractor.getContractorTypeId(i)||(!1===a()?(OrderCheckout.stopLoading(),!1):!0===r||(e.ajax({type:"POST",url:"/order/ajax/?step="+OrderCheckout.getStepNumber(),dataType:"json",data:n.serializeArray(),success:function(t){if(0!==t.errors.length)return OrderCheckout.showErrors(t.errors,i),void OrderCheckout.stopLoading();if(!0===t.data)return r=!0,void n.submit();OrderCheckout.stopLoading();var a=e("#contractor-phone-confirm-modal");0!==a.length&&a.remove(),e("BODY").append(t.html),a=e("#contractor-phone-confirm-modal"),a.modal(),a.SmsConfirm({callback:function(t){a.modal("hide"),!0===t&&(r=!0,OrderCheckout.startLoading(),n.submit())}})},error:function(){OrderCheckout.stopLoading(),OrderCheckout.showErrors(["Сервис временно недоступен. Повторите попытку позже или обратитесь в техническую поддержку."],i)}}),!1))})}function o(t){!0===t?e(".total-info-widget").trigger("order.total_info_widget.showBonus"):e(".total-info-widget").trigger("order.total_info_widget.hideBonus")}var i,n,r=!1;e(function(){CheckoutContractor.initIndividualEntity=a})}(document,jQuery),function(t,e){function a(t){console.log(t),o=e(t),i=o.closest("FORM"),CheckoutContractor.onSelectContractorType(CheckoutContractor.getContractorTypeId(o),function(){l=!1,0===e(n).length&&CheckoutContractor.disableButtonNext()}),o.on("change",n,function(){var t=e(n+":checked");i.find('[data-role="contractor_appeal"]').val(t.data("legal-appeal")),i.find('[data-role="contractor_phone"]').val(t.data("legal-phone")),i.find('[data-role="contractor_email"]').val(t.data("legal-email")),e(r).show()}),i.submit(function(){return CheckoutContractor.getCurrentContractorTypeId()!==CheckoutContractor.getContractorTypeId(o)||(!0===l||(e.ajax({type:"POST",url:"/order/ajax/?step="+OrderCheckout.getStepNumber(),dataType:"json",data:i.serializeArray(),success:function(t){if(0!==t.errors.length)return OrderCheckout.showErrors(t.errors,o),void OrderCheckout.stopLoading();!0===t.data&&(l=!0,i.submit()),OrderCheckout.stopLoading();var a=e(d);0!==a.length&&a.remove(),e("BODY").append(t.html),a=e(d),a.modal(),a.SmsConfirm({callback:function(t){a.modal("hide"),!0===t&&(l=!0,OrderCheckout.startLoading(),i.submit())}})},error:function(){OrderCheckout.stopLoading(),OrderCheckout.showErrors(["Сервис временно недоступен. Повторите попытку позже или обратитесь в техническую поддержку."],o)}}),!1))})}var o,i,n='[data-role="change-legal-contractor"]',r="[data-role=legal-contractor-contact]",d="#contractor-phone-confirm-modal",l=!1;e(function(){CheckoutContractor.initLegalEntity=a})}(document,jQuery),function(t,e,a){function o(t){s=e(t),c=s.closest("FORM"),f=e(p),s.change(function(){var t=e(this);u=t.val(),c.find('[data-contractor-section-id]:not([data-contractor-section-id="'+u+'"])').hide(),c.find('[data-contractor-section-id="'+u+'"]').show(),e(".total-info-widget").trigger("order.total_info_widget.hideBonus"),OrderCheckout.clearErrors(),a!==h[u]&&h[u]()}),setTimeout(function(){s.filter(":checked").change()},500),c.find("[data-contractor-section-id]").hide()}function i(t){return t.closest("[data-contractor-section-id]").data("contractor-section-id")}function n(t,e){h[t]=e}function r(){return u}function d(){f.prop("disabled",!1)}function l(){f.prop("disabled",!0)}var s,c,u,f,p='[data-role="button-next"]',h={};window.CheckoutContractor={init:o,onSelectContractorType:n,getContractorTypeId:i,getCurrentContractorTypeId:r,enableButtonNext:d,disableButtonNext:l}}(document,jQuery),function(t){var e,a,o,i,n,r,d,l,s,c,u,f,p,h,v,m,g,w,b="[data-id=city_guid]",E="[data-id=region_city_fias_guid]",T="[data-id=order_city_select]",_=".extended-field-city",y="[data-id=street]",C="[data-id=order_house_number]",k="[data-id=order_flat]",I="[data-id=order_is_rise_on_floor]",S="[data-id=order_floor]",O="[data-id=order_is_have_lift]",N="[data-id=street_fias_guid]",L='[data-role="calculate"]',x="[data-role=elaboration-box]",A="[data-role=elaboration-streets-list]",R="[data-role=under-street-message]",D="empty",P="load-dates-url",F=!1,B=[],M=0;t.fn.OrderCheckoutDeliveryCourier=function(){function V(){e=t(this),a=e.closest("form"),o=t(b,e),i=t(E,e),n=t(T,e),r=t(_,e),d=t(y,e),s=t(N,e),v=t(L,e),c=t(C,e),u=t(k,e),f=t(I,e),p=t(S,e),h=t(O,e),m=t(x,e),w=e.data(P),d.keyup(function(){s.val(""),window.CheckoutDelivery.Dateline.clear()}),l=d.autocomplete({source:function(t,e){j(t.term,function(t){F=0===t.length;var a=[];t.forEach(function(t){var e={id:t.guid,label:J(t),parent_guid:t.parent_guid};a.push(e)}),!1===g&&a.push({id:D,label:d.val(),parent_guid:""}),e(a)})},select:function(t,e){if(D===e.item.id)return d.val(""),s.val(""),window.CheckoutDelivery.Dateline.clear(),$(!0),!1;var a=e.item;i.val(a.parent_guid),s.val(a.id)}}),l.autocomplete("widget").addClass("order-delivery-street-autocomplete"),l.on("blur",function(){if(""===d.val())return void H();""===s.val()?(window.CheckoutDelivery.Dateline.clear(),j(t(this).val(),function(e){var a=null;if(e.length>0)if(1===e.length){var o=e[0];i.val(o.parent_guid),s.val(o.guid),d.val(J(o)),H(),K(),G()}else Y(e);else if(K(),!1===g)if(window.OrderCheckout.isTerminal())a=t('<div/>"',{class:"alert alert-danger"}).text("К сожалению, с таким названием улиц не найдено. Проверьте правильность написания улицы. Если улица введена верно, то обратитесь к консультанту или управляющему."),U(a);else{var n=t("<a/>",{href:"javascript:;",text:"заполните расширенную форму"});n.click(function(){return d.val(""),$(!0),H(),K(),!1}),a=t('<div/>"',{class:"alert alert-danger"}).text("К сожалению, с таким названием улиц не найдено. Проверьте правильность написания улицы. Если улица введена верно, то ").append(n),U(a)}else Q(window.OrderCheckout.isTerminal()?["Для уточнения возможности и стоимости доставки, пожалуйста, обратитесь к консультанту или управляющему"]:["Для уточнения возможности и стоимости доставки с вами свяжется оператор"])})):(H(),K(),G())}).on("focus",function(){""===s.val()&&t(this).autocomplete("search",t(this).val())});var A=t('<small><a href="javascript:;" class="text-info bg-warning">Нет вашей улицы - заполните расширенную форму</a></small>');l.data("ui-autocomplete")._renderItem=function(e,a){return D!==a.id?t("<li></li>").data("item.autocomplete",a).append("<a>"+a.label+"</a>").appendTo(e):t("<li></li>").data("item.autocomplete",a).append(A).appendTo(e)},c.on("change",G),u.on("change",G),f.on("change",G),p.on("change",G),h.on("change",G),v.click(function(){var t=z();0===t.length?W():q(t)}),window.CheckoutDelivery.onSelectMethod(window.CheckoutDelivery.getMethodId(e),function(){window.CheckoutDelivery.Dateline.setTitle("Желаемая дата доставки:"),window.CheckoutDelivery.Dateline.setItems([]),0===z().length&&G()}),n.change(function(){s.val(""),d.val(""),i.val(t(this).val())}),a.submit(function(){if(CheckoutDelivery.isMethodSelected(e)){var t=z();if(0!==t.length)return OrderCheckout.stopLoading(),OrderCheckout.showErrors(t,e),!1}return!0});var R=function(){t(this).prop("checked")?(p.prop("disabled",!1),h.prop("disabled",!1)):(p.prop("disabled",!0),p.val(""),h.prop("disabled",!0),h.prop("checked",!1))};f.change(R),R.apply(f),$(""!==d.val()&&""===s.val()?!0:!1)}function j(e,a){if(void 0!==B[e])return void a(B[e]);var n={query:e,cityGuid:o.val()};!0===g&&(n.filterCityFiasGuid=i.val()),OrderCheckout.startLoading(),t.ajax({url:d.data("url"),method:"get",data:n,dataType:"json",success:function(t){if(!1===t.result)t.errors.length>0&&(OrderCheckout.addErrors(t.errors),OrderCheckout.scrollTop());else{var o=t.data.streets;B[e]=o,a(o)}},error:function(){alert("Ошибка при получении данных. Попробуйте позже.")},complete:function(){OrderCheckout.stopLoading()}})}function $(t){g!==t&&(!0===t?(r.show(),H(),K()):r.hide(),g=t,B=[])}function U(a,o){void 0===o&&(o=!0),!0===o&&H(),t(R,e).removeClass("hidden").append(a)}function H(){t(R,e).addClass("hidden").empty()}function G(){0===z().length&&W()}function W(){window.OrderCheckout.clearMessages(),window.CheckoutDelivery.Dateline.clear(),t(".loading-dots",e).remove(),e.append('<div class="loading-dots"><span></span><span></span><span></span><span></span></div>');var o=a.serializeArray();window.CheckoutDelivery.setSelectorLockStatus(!0);var i=++M;t.post(w+"?step="+OrderCheckout.getStepNumber(),o).done(function(t){if(!(t instanceof Object))return void(i===M&&(q(["Сервис временно недоступен. Повторите попытку позже или обратитесь в техническую поддержку."]),window.CheckoutDelivery.Dateline.setItems([])));if(i==M){window.OrderCheckout.clearErrors(),window.OrderCheckout.clearMessages();var e=[];if(0!==t.errors.length)q(t.errors);else if(0!==t.message.length)Q(t.message),OrderCheckout.setNextButtonLockStatus(!t.canMoveToNextStep);else for(var a=0;a<t.data.length;a++){var o=t.data[a],n=window.CheckoutDelivery.Dateline.initItem();n.showZeroPrice=!0,n.stamp=o.stamp,n.price=o.price,n.includeAmountToOrder=o.includeAmountToOrder,e.push(n)}window.CheckoutDelivery.Dateline.setItems(e)}}).fail(function(){i==M&&(q(["Сервис временно недоступен. Повторите попытку позже или обратитесь в техническую поддержку."]),window.CheckoutDelivery.Dateline.setItems([]))}).always(function(){i==M&&t(".loading-dots",e).remove(),i===M&&window.CheckoutDelivery.setSelectorLockStatus(!1)})}function q(t){OrderCheckout.showErrors(t,e),CheckoutDelivery.Dateline.setItems([])}function Q(t){OrderCheckout.showMessages(t,e),CheckoutDelivery.Dateline.setItems([])}function Y(e){m.removeClass("hidden"),H();var a=t(A,m);if(a.empty(),0!==e.count){var o=e.slice(0,7);if(o.length<e.length){var n=t('<div/>"',{class:"alert alert-info"}).text("Некоторые варианты не отображены: введите более точный адрес");U(n)}if(o.forEach(function(e){var o="elaboration-item-"+e.guid,n=t("<div/>",{class:"radio"}),r=t("<input/>",{id:o,type:"radio",value:e.guid,name:"elaboration-street","data-city-guid":e.parent_guid}),l=t("<label/>",{for:o,text:J(e)});r.change(function(){i.val(t(this).data("city-guid")),s.val(t(this).val()),d.val(t(this).siblings("label").text()),H(),K(),G()}),n.append(r).append(l),a.append(n)}),!1===g){var r=t("<a/>",{href:"javascript:;",text:"заполните расширенную форму"});r.click(function(){return d.val(""),$(!0),H(),K(),!1});var n=t('<div/>"',{class:"alert alert-warning"}).text("Нет вашей улицы - ").append(r);U(n,!1)}}}function K(){m.addClass("hidden")}function z(){window.OrderCheckout.clearErrors();var t=[];return!1===g&&""===s.val()&&t.push("Необходимо заполнить поле «Улица»."),""===d.val().trim()&&t.push("Необходимо заполнить поле «Улица»."),""===c.val().trim()&&t.push("Необходимо заполнить поле «Дом»."),!0===f.prop("checked")&&""===p.val().trim()&&t.push("Необходимо заполнить поле «Этаж»."),t}function J(t){return r.is(":visible")?t.type_name_short+". "+t.name_official:t.type_name_short+". "+t.name_official+" ("+t.owner_type_name_short+". "+t.owner_name+")"}V.apply(this)}}(jQuery),function(t,e,a){function o(t,a){c=e(t),f=c.closest('[data-role="widget-container"]'),p=a,u=c.val(),f.on("click",'[data-role="'+v+'"]',function(){n(e(this))})}function i(t){e('[data-role="dateline-label"]',f).html(t)}function n(t){h.removeClass("active"),c.val("");var e=0;0!==t.length&&(u=t.attr("data-stamp"),t.addClass("active"),c.val(u),e=parseFloat(t.data("price"))),CheckoutTotalInfo.setTotalDeliveryPriceParams(e,!0,1)}function r(t){h.remove(),0===t.length?f.hide():(t.forEach(function(t){var e=t.stamp+60*p*60+60*(new Date).getTimezoneOffset(),o=new Date(1e3*e),i=0;a!==t.price&&(i=parseFloat(t.price));var n=!0;!1===t.includeAmountToOrder&&(n=!1),f.append(['<div data-role="'+v+'" class="date-block" data-stamp="'+t.stamp+'" data-price="'+i+'" data-include-amount-to-order="'+n+'">','<div class="date">',o.strftime("%a","rus"),"<br />",o.strftime("%d.%m"),"</div>",'<div class="price">',i||t.showZeroPrice?i+" &#8381;":"","</div>"].join(""))}),h=f.find('[data-role="'+v+'"]'),f.show()),c.val(""),n(h.filter('[data-stamp="'+u+'"]'))}function d(){return{}}function l(){return""!==c.val().trim()}function s(){r([]),c.val("")}var c,u,f,p,h=e(),v="dateline-block";e(function(){CheckoutDelivery.Dateline={init:o,setTitle:i,setItems:r,isSelected:l,initItem:d,clear:s}})}(document,jQuery),function(t){t.fn.checkoutDeliveryMap=function(e){var a,o,i,n,r,d,l,s="[data-role=select-item]",c=".radio",u={init:function(){function e(t,e){void 0!==e&&null!==e||(e=!0);var a=t.closest(c),o=Math.round(r.scrollTop()+a.position().top-r.outerHeight()/2+a.outerHeight());!0===e?r.scrollTo(o):r.scrollTop(o)}o=t(this),i=t(s,o),n=i.closest('[data-role="widget-container"]'),r=n.find("[data-role=items-list]"),d=n.find("[data-role=sort-by-distance]"),a=i.closest("form");var u=o.data("map-container-id");t("[title]",r).tooltip({container:"body"});var f=[],p="islands#darkOrangeIcon";loadYandexMaps(function(){function a(){t(s,o).each(function(){var a=t(this);if(f.hasOwnProperty(a.val())){var o=f[a.val()];o.events.add("click",function(){e(a,!0),n(),o.options.set("preset",p),a.prop("checked",!0)}),a.on("change",function(){a.is(":checked")&&(n(),o.options.set("preset",p),o.options.set("zIndex",2),l.setZoom(14),l.panTo([a.data("location-latitude"),a.data("location-longitude")],{flying:!0}))})}})}function n(){l.geoObjects.each(function(t){t.options.set("zIndex",1),t.options.set("preset",t.options.get("defaultPreset"))})}l=new ymaps.Map(u,{zoom:12,controls:["zoomControl","fullscreenControl","trafficControl"],behaviors:["default","scrollZoom"],center:[55.2627,87.363281]}),i.each(function(){var e=t(this),a=e.data("location-longitude");if(void 0!==a&&0!==a){var o=e.data("location-latitude");if(void 0!==o&&0!==o){var i="islands#blueIcon",n="islands#blueIcon";e.is(":checked")&&(i="islands#darkOrangeIcon"),e.is(":disabled")&&(i="islands#grayIcon",n="islands#grayIcon");var r=new ymaps.Placemark([o,a],{balloonContent:e.data("balloon")},{preset:i,defaultPreset:n});!1===e.is(":disabled")&&(f[e.val()]=r),l.geoObjects.add(r)}}}),a();var h;d.prop("disabled",!1),d.on("change",function(){function e(e,o){function i(t){return t<500?"до 500 метров":t<1e3?"500 - 1000 метров":t<2e3?"1000 - 2000 метров":t<3e3?"2000 - 3000 метров":"более 3000 метров"}u.each(function(){var a=t(this),i=getDistanceFromLatLonInKm(a.find(s).data("location-latitude"),a.find(s).data("location-longitude"),e,o);a.data("distance",1e3*i)}),u.sort(function(e,a){return t(e).data("distance")-t(a).data("distance")});var n,d=t("<div />");u.each(function(){var e=t(this),a=i(e.data("distance"));a!==n&&d.append('<div class="group-name">Дистанция: '+a+"</div>"),d.append(e),n=a}),r.html(d.html()),a()}function o(){u.sort(function(e,a){return parseInt(t(e).data("sort-order"))-parseInt(t(a).data("sort-order"))}),r.html(u),a()}function i(){return d.prop("checked",!1),o(),!1}function n(t){var a=t.coords.latitude,o=t.coords.longitude;h=new ymaps.Placemark([a,o],{balloonContent:"Вы находитесь здесь."},{balloonAutoPan:!1,preset:"islands#orangeDotIcon",defaultPreset:"islands#orangeDotIcon"}),l.geoObjects.add(h),h.balloon.open(),e(a,o)}if(!1=="geolocation"in navigator)return i();var d=t(this),u=r.find(c);l.geoObjects.remove(h),d.prop("checked")?navigator.geolocation.getCurrentPosition(n,i):o()})}),CheckoutDelivery.onSelectMethod(CheckoutDelivery.getMethodId(n),function(){CheckoutDelivery.Dateline.setTitle("Желаемая дата получения:"),CheckoutDelivery.Dateline.setItems([]),loadYandexMaps(function(){var t=i.filter(":checked");0===t.length?l.setBounds(l.geoObjects.getBounds(),{checkZoomRange:!0}):(e(t,!1),t.change())})}),a.submit(function(){return!CheckoutDelivery.isMethodSelected(n)||0!==i.filter(":checked").length||(OrderCheckout.stopLoading(),OrderCheckout.showErrors(["Выберите точку получения."]),!1)})}};return u[e]?u[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==(void 0===e?"undefined":_typeof(e))&&e?void 0:u.init.apply(this,arguments)}}(jQuery),function(t){t.fn.OrderCheckoutDeliveryPostamat=function(){function e(){window.OrderCheckout.clearErrors();var t=[];return 0===r.filter(":checked").length&&t.push("Укажите постамат, на котором желаете получить ваш заказ."),t}var a,o,i,n,r,d="load-url",l="step-number",s="price",c="include-price",u=2,f="[data-role=select-item]",p=this;!function(){a=t(p),o=a.closest("form"),i=a.data(d),n=o.data(l),r=t(f,a),r.change(function(){CheckoutTotalInfo.setTotalDeliveryPriceParams(t(this).data(s),t(this).data(c),u)}),o.submit(function(){if(CheckoutDelivery.isMethodSelected(a)){var t=e();if(0!==t.length)return OrderCheckout.stopLoading(),OrderCheckout.showErrors(t,a),!1}return!0}),window.CheckoutDelivery.onSelectMethod(window.CheckoutDelivery.getMethodId(a),function(){var t=r.filter(":checked");0!==t.length&&(CheckoutTotalInfo.isRemoveDeliveryBlock=!1,CheckoutTotalInfo.setTotalDeliveryPriceParams(t.data(s),t.data(c),u))})}()}}(jQuery),function(t,e,a){function o(t){function o(){var t=e(this),a=t.attr("name"),o=c.find('[name="'+a+'"]');o.length>1&&o.val(t.val())}s=e(t),c=s.closest("FORM"),c.find("["+f+"]").keyup(o),c.find("["+f+"]").change(o),s.change(function(){var t=e(this),o=t.data("method-id");c.find('[data-method-section-id]:not([data-method-section-id="'+o+'"])').hide(),c.find('[data-method-section-id="'+o+'"]').show();var i=c.find('[data-role="consult-block"].static:visible');if(0!==i.length){var n=i.clone(),r=i.closest(".row");r.prev("hr").hide(),r.hide(),i.remove(),n.removeClass("static").css({"padding-left":"20px"}).attr("data-method-section-id",o),c.find('[data-role="order-buttons"]').after(n)}OrderCheckout.clearErrors(),OrderCheckout.setNextButtonLockStatus(!1),a!==p[o]&&p[o].forEach(function(t){t(o)}),h.forEach(function(t){t(o)})}),c.submit(function(){return!(s.length>1&&0===s.filter(":checked").length)||(OrderCheckout.stopLoading(),OrderCheckout.showErrors(["Выберите способ получения."]),!1)}),setTimeout(function(){s.filter(":checked").change()},500),c.find("[data-method-section-id]").hide(),c.find("["+f+'="master"]').change()}function i(t,e){a===p[t]&&(p[t]=[]),p[t].push(e)}function n(t){h.push(t)}function r(t){return t.closest("[data-method-section-id]").data("method-section-id")}function d(t){return r(t)===s.filter(":checked").data("method-id")}function l(t){!0===t?e(u).show():e(u).hide()}var s,c,u=".radio-form .radio-cover",f="data-field-sync-role",p={},h=[];window.CheckoutDelivery={init:o,onSelectMethod:i,onSelectAnyMethod:n,getMethodId:r,isMethodSelected:d,setSelectorLockStatus:l}}(document,jQuery),function(t,e,a){function o(){v.find(".order-buttons .btn").trigger("order.stopLoading")}function i(){v.find('.order-buttons .btn[type="submit"]').trigger("order.startLoading")}function n(){return parseInt(v.attr("data-step-number"))}function r(t,a){if(l(a),0!==t.length){var o=[];e.each(t,function(t,e){o.push("<li>"+e+"</li>")}),o=o.join("");var i=c(a);i.find("UL").html(o),i.show()}}function d(t,a){if(s(a),0!==t.length){var o=[];e.each(t,function(t,e){o.push("<li>"+e+"</li>")}),o=o.join("");var i=u(a);i.find("UL").html(o),i.show()}}function l(t){c(t).hide()}function s(t){u(t).hide()}function c(t){return a!==t?t.find('[data-role="errors-list"]'):v.find('[data-role="errors-list"]')}function u(t){return a!==t?t.find('[data-role="message-list"]'):v.find('[data-role="message-list"]')}function f(){m.on("keypress",function(t){if(13===(t.keyCode||t.which))return t.preventDefault(),!1}),m.find("input[type=checkbox], input[type=radio]").on("focus",function(){e(this).closest("."+e(this).attr("type")).addClass("focus")}),m.find("input[type=checkbox], input[type=radio]").on("blur",function(){e(this).closest("."+e(this).attr("type")).removeClass("focus")}),m.find("[tabindex]").on("keyup",function(t){var o=e(this);if(13===(t.keyCode||t.which)){if("submit"==o.attr("type"))return m.submit(),!0;t.preventDefault();var i=[];return e(this).parents("form").eq(0).find("[tabindex]:visible:enabled").each(function(){i[e(this).attr("tabindex")]=this}),e.each(i,function(t,e){if(a!==e&&o.attr("tabindex")<t)return e.focus(),!1}),!0}})}function p(t){a!==g&&g.prop("disabled",t)}function h(){return v.data("is-terminal")}var v,m,g;e(function(){if(v=e(".order-page"),0===v.length)return void(v=a);l(),s(),m=v.find("FORM"),0!==m.length&&(g=e("[data-role=button-next]",m),f())}),window.OrderCheckout={stopLoading:o,startLoading:i,getStepNumber:n,showErrors:r,clearErrors:l,showMessages:d,clearMessages:s,setNextButtonLockStatus:p,isTerminal:h}}(document,jQuery),$(document).ready(function(){var t=$("#branches-with-avails");if(0===t.length)return!1;t.on("click",function(){var e="modal-branches-with-avails",a=$("#"+e);if(0===a.length){a=$("<div/>",{id:e,class:"modal fade"});var o=$("<div/>",{class:"modal-dialog"}),i=$("<div/>",{class:"modal-content"}),n=$("<div/>",{class:"modal-body"});n.html("Идет загрузка..."),i.append(n),o.append(i),a.append(o),$("body").append(a),a=$("#"+e),a.modal({keyboard:!1}),a.on("show.bs.modal",function(){var e=t.prop("href"),o=$(".modal-body",a);o.on("load",e,function(t,e){if("error"===e)return alert("Извините, сервис временно недоступен. Повторите попытку позже."),void a.modal("hide");var i=$('input[type="radio"]',o);i.length>0&&i.on("click",function(){var t=$("div",o).data("action-url");$.ajax({url:t+"&branch_guid="+$(this).val(),type:"get",cache:!1,dataType:"json",success:function(t){!0===t.result&&window.location.reload(),o.html($("<h4>").html(t.message))},error:function(){o.html($("<h4>").html("Произошла ошибка при получении ответа от сервера."))}})})})}),a.on("hidden.bs.modal",function(){n.html("")})}return a.modal("show"),!1})}),$(document).ready(function(){function t(){$(a).hide(),$.ajax({url:i.attr("action"),type:i.attr("method"),dataType:"JSON",data:i.serialize(),success:function(t){t.result?($(e).show(),$(o).hide()):$(a).show()},error:function(){$(a).show()}})}var e=".need-callback-link-div > .alert-warning",a=".need-callback-div > .alert-danger",o=".show-comment",i=$(".need-callback-div").find("form"),n=$(".need-callback-div").find(".repeat-need-callback");i.on("keyup","textarea",function(){$(this).attr("data-min-length")<=$(this).val().length?i.find("button").removeClass("lock"):i.find("button").addClass("lock")}),i.on("submit",function(){return!0===i.yiiActiveForm("data").validated&&(t(),i.hide()),!1}),n.click(t)}),function(t){t.fn.onlineCreditForm=function(){var e=t(this);t(".cancel-button",e).on("click",function(){e.on("beforeValidate",function(){t(this).data().attributes.attr("willValidate",!1)})})}}(jQuery),function(t){var e,a={isRemoveDeliveryBlock:!0,init:function(o){return t(this).on("order.total_info_widget.resetValue",function(){a.resetValue(t(this))}),1==t(this).find(".pzpBonusShow").val()&&(t(this).on("order.total_info_widget.hideBonus",function(){a.hideBonus(t(this))}),t(this).on("order.total_info_widget.showBonus",function(){a.showBonus(t(this))})),e=t(this),t(this).on("order.total_info_widget.decreaseValue",function(e,o){a.decreaseValue(t(this),o)}),t(this).on("order.total_info_widget.setDeliveryPrice",function(t,e,o){a.setDeliveryPrice(e,o)}),CheckoutDelivery.onSelectAnyMethod(function(){!0===CheckoutTotalInfo.isRemoveDeliveryBlock&&a.setDeliveryPrice(0),CheckoutTotalInfo.isRemoveDeliveryBlock=!0}),e},resetValue:function(t){var e=t.find(".total-price-value"),a=e.find("span:first-child"),o=parseInt(a.attr("data-value"));a.html(new Intl.NumberFormat("ru-RU").format(o)),e.find(".bonus-part").remove(),a.removeClass("line-through")},decreaseValue:function(t,e){t.trigger("order.total_info_widget.resetValue");var a=t.find(".total-price-value"),o=a.find("span:first-child"),i=parseInt(o.attr("data-value"))-e;o.addClass("line-through"),a.append('<div class="bonus-part">'+new Intl.NumberFormat("ru-RU").format(i)+' <i class="rub-icon"></i></div>')},showBonus:function(e){var a=e.find(".total-bonus-value");if(0!==a.length){a.show();var o=t(document).find(".pzp-block");void 0!==o&&(o.find(".bonus-info-msg").remove(),o.append('<div class="bonus-info-msg"><b>'+a.text()+"</b>будет начислено на Бонусную карту после оплаты данного заказа</div>"))}},hideBonus:function(e){var a=e.find(".total-bonus-value");if(0!==a.length){a.hide();var o=t(document).find(".pzp-block");void 0!==o&&o.find(".bonus-info-msg").remove()}},setDeliveryPrice:function(o,i,n){void 0===i&&(i=!0);var r=t(".delivery",e);if(0===o)0<r.length&&r.remove();else{if(0===r.length){switch(n){case 1:t(".products-price-amount",e).after('<div class="delivery">Доставка: <span class="price-value"></span> <i class="rub-icon"></i></div>').find(".delivery");break;case 2:t(".products-price-amount",e).after('<div class="delivery">Постамат: <span class="price-value"></span> <i class="rub-icon"></i><br><span class="hint">(доставка и хранение)</span></div>').find(".delivery")}r=t(".delivery",e)}t(".price-value",r).text(new Intl.NumberFormat("ru-RU").format(o)).data("value",o)}a.recalcTotalPrice(i)},recalcTotalPrice:function(){
var a=parseFloat(t(".delivery .price-value",e).data("value")),o=parseFloat(t(".products-price-amount .price-value",e).data("value")),i=t(".total-price-value .price-value",e),n=o;a>0&&(n+=a),i.html(new Intl.NumberFormat("ru-RU").format(n)),i.data("value",n)}};t.fn.totalInfoWidget=function(t){return a[t]?a[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==(void 0===t?"undefined":_typeof(t))&&t?void 0:a.init.apply(this,arguments)},window.CheckoutTotalInfo={setTotalDeliveryPriceParams:a.setDeliveryPrice,isRemoveDeliveryBlock:a.isRemoveDeliveryBlock}}(jQuery),$(function(){if($('.order-group .order-group-control [type="radio"]:checked').trigger("change"),"#phoneFocus"===window.location.hash){var t=function(){$("input[type=tel]").focus()};setTimeout(t,2e3)}var e=$(".order-page"),a=e.find(".order-buttons .btn");a.on("click",function(t){var e=$(this);e.attr("data-loading")?t.preventDefault():"submit"!==e.attr("type")&&e.trigger("order.startLoading")}),a.on("order.stopLoading",function(){var t=$(this);t.find("SPAN.glyphicon-refresh-animate").remove(),t.removeAttr("data-loading")}),a.on("order.startLoading",function(){var t=$(this);t.attr("data-loading")||(t.prepend('<span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>'),t.attr("data-loading",1))}),$("#order-form").submit(function(){$(this).find('[type="submit"]').trigger("order.startLoading")})}),function(t,e,a){function o(){var e=r.val(),o=l[e];if(a!==o){t(i).hide();for(var n in o)if(!1!==o.hasOwnProperty(n)){var d=o[n];t(i+'[data-payment-guid="'+d+'"]').show()}}}var i='[data-role="payment-method"]',n=void 0,r=void 0,d=void 0,l=void 0;t(function(){if(n=t('[data-role="preorder-container"]'),r=n.find('[data-role="branch-list"]'),d=n.find('[data-form-name="preorder-form"]'),0!==n.length&&0!==r.length){l=JSON.parse(e.PREORDER_PAYMENT_METHODS_GROUPED_BY_BRANCH_GUID),o(),r.on("change",o);var i=!1,s=d.find('[type="submit"]');s.on("click",function(){return s.prop("disabled",!0),!0===i||(t.post(d.attr("action"),d.serialize(),function(o){if(!0===o.result)return i=!0,void d.submit();var r="",l=n.find(".alert-danger");t.each(o.errors,function(t,e){r=r+e+"<br>"}),0!==r.length?(a!==e.grecaptcha&&e.grecaptcha.reset(),l.html("").append(r).show()):l.hide();var s=t("#contractor-phone-confirm-modal");0!==s.length&&s.remove(),t("body").append(o.html),s=t("#contractor-phone-confirm-modal"),s.modal(),s.SmsConfirm({callback:function(t){s.modal("hide"),!0===t&&(i=!0,d.submit())}})}).always(function(){s.prop("disabled",!1)}),!1)}),t("body").on("click",'[data-role="preorder-select-branch"]',function(e){e.preventDefault();var a=t(this),o=a.closest('[data-id="modal-for-avails"]'),i=o.find(".avails-item.selected");0!==i.length&&(r.val(i.data("id")),o.modal("hide"))})}})}(jQuery,window,void 0),function(t,e){var a=void 0,o=void 0,i=void 0,n=void 0,r=void 0,d=void 0,l=!1,s=void 0,c=void 0,u=void 0,f=void 0,p=void 0,h=void 0;e(function(){function t(t){var e=t.value.split("."),a=t.getAttribute("data-min-date").split("."),o=t.getAttribute("data-max-date").split(".");e=new Date(e[2],e[1]-1,e[0]),a=new Date(a[2],a[1]-1,a[0]),o=new Date(o[2],o[1]-1,o[0]),a<=e&&e<=o?(p.attr("disabled",!1),f.addClass("has-success"),f.removeClass("has-error"),h.addClass("hide")):(p.attr("disabled",!0),f.addClass("has-error"),f.removeClass("has-success"),h.removeClass("hide"))}function v(t,a){e.ajax({url:o.attr("data-url"),method:"get",dataType:"json",data:{query:t},success:function(t){if(!0===t.result){var e=t.data.streets;a(e)}},error:function(){alert("Ошибка при получении данных. Попробуйте позже.")}})}function m(t){return t.type_name_short+". "+t.name_official+" ("+t.owner_type_name_short+". "+t.owner_name+")"}a=e("#service-checkout"),0!==a.length&&(o=e("[data-role=street-input]",a),i=e("[data-role=street_fias_guid]",a),n=e("[data-role=payment_method_guid]",a),d=a.find("form#service-checkout-form"),s=a.find("[data-role=operator-mode]"),c=d.find("[data-role=date-input]"),f=d.find(".field-servicekbtcheckoutform-date"),p=d.find("button"),h=d.find('[data-role="error-message"]'),c.keyup(function(){var e=this;void 0!==u&&clearTimeout(u),u=setTimeout(function(){t(e)},1e3)}),c.blur(function(){var e=this;u=setTimeout(function(){t(e)},1e3)}),0!==s.length&&(s.on("change",function(){var t=e("[data-role=payment-method]",a).first();!0===s.prop("checked")?(e("[data-role=description]",a).find(".description").collapse("hide"),t.prop("checked",!0),a.find("[data-is-offline=no]").hide(),t.trigger("click")):(e("[data-role=description]",a).find(".description").collapse("show"),a.find("[data-is-offline=no]").show())}),s.trigger("change")),r=o.autocomplete({appendTo:o.parent(),source:function(t,e){v(t.term,function(t){var a=[];t.forEach(function(t){var e={id:t.guid,label:m(t),parent_guid:t.parent_guid};a.push(e)}),e(a)})},select:function(t,e){i.val(e.item.id)}}),o.keyup(function(t){13!==t.keyCode&&i.val("")}),r.on("blur",function(){""!==o.val()&&""===i.val()&&v(e(this).val(),function(t){if(1===t.length){var e=t[0];i.val(e.guid),o.val(m(e))}else o.val("")})}),a.on("click touchstart","[data-role=date-input-button]",function(){e(this).parent().find("input").trigger("focus")}),a.on("change","[data-role=phone-input]",function(){l=!1}),d.on("beforeSubmit",function(){if(!0===l){var t=d.find("button");return!0!==t.prop("disabled")&&(t.prop("disabled",!0),!0)}return e.ajax({type:"POST",url:d.attr("data-url-confirm-phone"),dataType:"json",data:{phoneNumber:d.find("[data-role=phone-input]").val()},success:function(t){if(!0!==t.result)return void(0!==t.errors.length&&alert(t.errors[0]));if(!1===t.data.needConfirm||0!==s.length&&s.prop("checked"))return l=!0,void d.submit();var a=e("#contractor-phone-confirm-modal");0!==a.length&&a.remove(),e("BODY").append(t.html),a=e("#contractor-phone-confirm-modal"),a.modal(),a.SmsConfirm({callback:function(t){a.modal("hide"),!0===t&&(l=!0,d.submit())}})},error:function(){alert("Сервис временно недоступен. Повторите попытку позже или обратитесь в техническую поддержку.")}}),!1}),d.on("click","[data-role=pay-selector]",function(){var t=e(this).find("[data-role=payment-method]"),a=e("[data-role=info-offer]");t.prop("checked",!0),n.val(t.val()),"yes"===e(this).attr("data-is-offline")?(a.find("span:nth-child(1)").hide(),a.find("span:nth-child(2)").show()):(a.find("span:nth-child(1)").show(),a.find("span:nth-child(2)").hide())}),e("[data-role=accordion]").accordion({icons:null,heightStyle:"content",animate:!1}))})}(document,jQuery),function(t,e){e(function(){e(t).on("click","[data-role=service-order-btn]",function(){var t=e(this);return t.prop("disabled",!0),e.ajax({url:t.attr("data-url"),type:"POST",data:{productGuid:t.attr("data-product-id")},success:function(t){window.location.href=t},error:function(){alert("Сервис временно недоступен. Повторите попытку позже или обратитесь в техническую поддержку."),t.prop("disabled",!1)}}),!1})})}(document,jQuery),function(t,e,a){var o=".bp-product-link",i=".bp-product-name",n=".bp-product-select",r=".bp-input-link",d=".bp-remove",l=".bp-add-link",s=".bp-cancel-add";e(function(){function t(t){1!==e(o).length&&t.find(s).css("display","block"),t.find(n).val("").css("display","block"),t.find(i).text(" ").attr("data-cart-product-guid",""),t.find(d).hide(),t.find(r).prop("readonly",!1).val("").hide(),t.find(l).hide()}var c=e("[data-role=cart-page]").find(".best-price-action");0!==c.length&&(c.on("click",".bp-toggle-form-link",function(){var t=e(".bp-products-links");e(this).toggleClass("opened"),e(this).hasClass("opened")?t.removeClass("hidden"):t.addClass("hidden")}),c.on("change",n,function(){var t=e(this).closest(o),a=e(":selected",this);""!==a.val()&&(e(this).hide(),t.find(s).hide(),t.find(i).text(a.text()).attr("data-cart-product-guid",a.val()).css("display","block"),t.find(r).css("display","block"),t.find(".bp-change-product").css("display","block"))}),c.on("click",".bp-change-product",function(){var a=e(this).closest(o);e(this).hide(),a.find(d).hide(),t(a)}),c.on("keyup blur",r,function(){var t=e(this).closest(o);!0!==e(this).prop("readonly")&&(""!==e(this).val()?(t.find(d).css("display","block"),t.find(".bp-change-product").hide(),t.find(l).css("display","block")):(t.find(d).hide(),t.find(l).hide(),t.find(".bp-change-product").css("display","block")))}),c.on("click",l,function(){e(this).hide();var t=e(this).closest(o),a=t.clone();a.find(n).val("").css("display","block"),a.find(s).css("display","block"),a.find(i).text(" ").attr("data-cart-product-guid",""),a.find(r).prop("readonly",!1).val("").hide(),a.find(d).hide(),a.appendTo("#bp-products-links-form"),t.find(r).prop("readonly",!0)}),c.on("click",d,function(){var a=e(this).closest(o);1===e(o).length?t(a):(a.remove(),0===e(s).filter(":visible").length&&0===e(".bp-change-product").filter(":visible").length&&e(o).filter(":last-child").find(l).css("display","block"),1===e(o).length&&e(s).hide())}),c.on("click",s,function(){e(this).closest(o).remove(),e(o).filter(":last-child").find(l).css("display","block")}),c.on("submit","#bp-products-links-form",function(){return!1}),e(a).on(a.EVENT_ITEM_REMOVED_FROM_CART,function(a,r){c.find(o).each(function(){e(this).find(n).find("[value="+r+"]").hide(),r===e(this).find(i).attr("data-cart-product-guid")&&(1===e(o).length?t(e(this)):(e(this).remove(),0===e(s).filter(":visible").length&&0===e(".bp-change-product").filter(":visible").length&&e(o).filter(":last-child").find(l).css("display","block"),1===e(o).length&&e(s).hide()))})}),e(a).on(a.EVENT_UPDATE_CART_ITEM,function(t,a){c.find(o).each(function(){e(this).find(n).find("[value="+a.attr("data-cart-product-id")+"]").css("display","block")})}))})}(document,jQuery,window),function(t,e){e.fn.cartCatalogProductRelatedWidget=function(){var t=e(this),a="[data-role=cart-related-tab-control]",o=t.find(".mobile-controls [data-role=dropdown-list]"),i=function(i){e(a,t).removeClass("active").filter("[data-id="+i+"]").addClass("active");var n=e("[data-role=cart-related-tab]",t),r=n.filter("[data-id="+i+"]");n.removeClass("active"),r.addClass("active");var d=o.find("[data-id="+i+"]");(e("[data-role=list-item]",o).toggleClass("disabled",!1),d.closest("[data-role=list-item]").toggleClass("disabled",!0),e("[data-role=toggle-button] [data-role=title]",o).html(d.html()),!1===r.is("[data-content-url]")||"1"===r.attr("data-is-loaded")||r.data("loading"))||(r.data("loading",!0),e.get(r.data("content-url")).done(function(t){if(!1===t.result)return void r.html('<div class="alert alert-info">Не удалось получить список аксессуаров.</div>');r.html(t.html),r.relatedProductsByCategoriesWidget(),e(window).trigger(window.EVENT_PRODUCTS_LOADED),window.dispatchLazyLoadUpdateEvent()}).fail(function(){r.html('<div class="alert alert-info">Не удалось получить список аксессуаров.</div>')}).always(function(){r.attr("data-is-loaded",1),r.data("loading",!1)}))};e("[data-role=list-item]",o).on("click",function(){return e("[data-role=toggle-button]",o).dropdown("toggle"),i(e(this).data("id")),!1}),e(a,t).on("click",function(){return i(e(this).data("id")),!1}),e(a,t).each(function(){var t=e(this).data("id");e("[data-show-related-for="+t+"]").removeClass("hidden")}),e("[data-show-related-for]").on("click",function(){var o=e(this).data("show-related-for");e(a+"[data-id="+o+"]",t).click();var i=30;window.checkScreenType(window.SCREEN_DESKTOP,window.SCREEN_WIDE)&&(i=65),e("body").scrollTo(t.offset().top-i)}),e(window).on(window.EVENT_ITEM_REMOVED_FROM_CART,function(o,i){var n=e("[data-"+window.SELECTOR_CART_PRODUCT_ID+'="'+i+'"]');if(0!==n.length){var r=n.find("[data-show-related-for]"),d=r.data("show-related-for"),l=e(a,t).filter("[data-id="+d+"]");if(l){var s=n.parent().find('[data-show-related-for="'+d+'"]'),c=!1;s.each(function(){e(this).closest(window.SELECTOR_CART_PRODUCT).attr("data-"+window.SELECTOR_CART_PRODUCT_ID)!==i&&(c=!0)}),c||(l.is(".active")&&l.siblings().first().click(),l.addClass("hidden"),1==t.find(a).length-t.find(a).filter(".hidden").length&&t.addClass("hidden"))}}}),e(window).on(window.EVENT_UPDATE_CART_ITEM,function(o,i){var n=i.find("[data-show-related-for]");if(0!==n.length){var r=n.data("show-related-for"),d=e(a,t).filter("[data-id="+r+"]");d.length&&(t.removeClass("hidden"),d.removeClass("hidden"))}})},e(function(){e("[data-role=cart-catalog-product-related-widget]").each(function(){e(this).cartCatalogProductRelatedWidget()})})}(document,jQuery),$(function(t,e){var a;e(function(){if(a=e('[data-role="order-payment-methods"]'),0===a.length)return!1;a.find('a[data-toggle="tab"]').on("shown.bs.tab",function(t){var o=e(t.target),i=e(t.relatedTarget),n=e("#"+i.attr("aria-controls")),r=n.find('[name="payment_method_selector"]:checked').val();void 0!==r&&i.data("default-payment-method",r),a.find('[name="payment_method_selector"]').removeAttr("checked").end().find('[value="'+o.data("default-payment-method")+'"]').click()})})}(window,jQuery)),function(t,e){var a=void 0,o=void 0,i=!1;e.SELECTOR_ONE_CLICK_BUTTON='[data-role="one-click-buy-button"]',t(function(){['[data-role="catalog-items-wrapper"]',"#product-page",".shopwindow-products",'[data-role="product-list"]','[data-role="products-container"]'].forEach(function(e){var a=t(e);if(0!==a.length)return o=a,!1}),void 0!==o&&0!==o.length&&(o.on("click",'[data-role="one-click-buy-button"]',function(o){if(!0!==i){var n=document.createElement("div");document.body.appendChild(n),i=!0,a=t(this);var r=[],d=a.attr("data-direct-services-guids");void 0!==d&&""!==d.trim()&&(r=JSON.parse(d)),t(e).trigger(e.EVENT_ONE_CLICK_BUTTON_PUSH,o.target);var l={productId:a.attr("data-product-id"),optionalProductGuid:a.attr("data-optional-guid"),additionalWarrantyPeriod:a.attr("data-additional-warranty-period"),relatedServicesGuids:r,isInProductCard:!0,addCartUrl:a.attr("data-add-cart-url")};e.startOneClickOrder(l,n,function(){document.body.removeChild(n),i=!1})}}),t(e).on(e.EVENT_OS_VARIANT_CHANGED,function(e,a){var o=t('[data-role="one-click-buy-button"][data-product-id="'+a.baseProductGuid+'"]');0!==o.length&&o.attr("data-optional-guid",a.guid)}),e.productAdditionsDispatcher.addAdditionalWarrantyListener(function(e,a){var o=t('[data-role="one-click-buy-button"][data-product-id="'+e+'"]');0!==o.length&&(null!==a?o.attr("data-additional-warranty-period",a.period):o.removeAttr("data-additional-warranty-period"))}))}),e.productAdditionsDispatcher.addKbtServiceListener(function(e){var a=e.relatedKbtService,o=t('[data-role="one-click-buy-button"][data-product-id="'+e.baseProductGuid+'"]');a.hasKbtServiceChecked?o.hide():o.show();var i=o.attr("data-direct-services-guids");if(i=void 0===i?[]:JSON.parse(i),a.checked)i.push(a.guid);else{var n=i.indexOf(a.guid);i.splice(n,1)}o.attr("data-direct-services-guids",JSON.stringify(i))})}(jQuery,window),function(t,e){e.EVENT_OS_VARIANT_CHANGED="os-variant:changed";var a=void 0,o=void 0,i=void 0,n=void 0,r=void 0,d=function(a){var o=a.data("variant"),i="00000000-0000-0000-0000-000000000000"===o.guid;s(o.guid),l(o),t('[data-role="os-change-notify"]').toggleClass("hidden",i),a.trigger(e.EVENT_OS_VARIANT_CHANGED,[o]),e.productAdditionsDispatcher.setOptionalProduct(o)},l=function(t){0!==t.currentPrice?(i.html(t.title),o.addClass("sup-text")):(i.text(""),o.removeClass("sup-text"))},s=function(t){n.filter(function(e){n.eq(e).val()===t&&n.eq(e).prop("checked",!0)}),r.filter(function(e){r.eq(e).val()===t&&r.eq(e).prop("selected",!0)})};t(function(){a=t('[data-role="os-selection-widget"]'),0!==a.length&&(o=a.find("[data-role=os-title]"),i=a.find("[data-role=os-selected-label]"),n=a.find("input[name=osVariantSelected]"),r=a.find('option[data-role="change-optional-os"]'),a.on("change",'[data-role="change-optional-os"]',function(){d(t(this))}),a.on("change",'select[name="osVariantSelected"]',function(){d(t('select[name="osVariantSelected"] option:selected'))}),t(e).on(e.EVENT_UPDATE_CART,function(e,o){var i=a.find('[data-role="change-optional-os"]');if(0!==i.length){for(var n in o){(function(e){if(!1===o.hasOwnProperty(e))return"continue";var a=o[e];i.each(function(){var e=t(this),o=e.data("variant");o.baseProductGuid===a.guid&&(o.overlimitMessage="",(-1!==t.inArray(e.val(),a.optionalProducts)||0===a.optionalProducts.length&&"00000000-0000-0000-0000-000000000000"===e.val())&&(o.isOsInCart=!0,e.data("variant",o)))})})(n)}i.each(function(){var e=t(this),a=e.data("variant");if(!a.isOsInCart)for(var i in o)if(!1!==o.hasOwnProperty(i)){var n=o[i];a.baseProductGuid===n.guid&&(a.overlimitMessage=n.overlimitMessage,a.isOsInCart=""!==a.overlimitMessage,e.data("variant",a))}})}}))}),t(e).on("load",function(){if(a=t('[data-role="os-selection-widget"]'),0!==a.length){var e=a.find('[data-role="change-optional-os"]:checked');d(e)}})}(jQuery,window),function(t){var e=void 0;t(function(){if(e=t("#page-notification"),0===e.length)return!1;e.on("close.bs.alert",function(){var a=e.data("url");t.ajax({url:a,type:"POST",dataType:"JSON"})}),e.find("[data-spoiler-show-more]").click(function(){var e=t(this);e.toggleClass("spoiler-show-more-unshadow"),e.closest("#page-notification").toggleClass("spoiler-notification-show"),e.find("[data-spoiler-text]").text(!0===e.hasClass("spoiler-show-more-unshadow")?"Свернуть":"Подробнее")})})}(jQuery,window),function(t){var e="form#price-item-alert";t.fn.priceItemAlert=function(){var a={priceItemId:null,modal:null},o=void 0,i=this,n={init:function(){t(i).on("click",".btn-price-item-alert",function(){return o=t(this).data("id"),o&&n.showPopup(o),!1}),t("body").on("click",".price-item-alert .change-city",function(){return t(".price-item-alert .select-city").toggle(),t(".price-item-alert .current-city").toggle(),!1}).on("click",".price-item-alert .return-city",function(){return t(".price-item-alert .select-city").hide(),t(".price-item-alert .current-city").show(),!1}).on("click",".price-item-alert .actions .select_all",function(){return t(".price-item-alert .shops input[type=checkbox]").prop("checked","checked"),!1}).on("click",".price-item-alert .actions .unselect_all",function(){return t(".price-item-alert .shops input[type=checkbox]").prop("checked",!1),!1}).on("change","#price_item_alert_region_group_id",function(){var e=t("#price_item_alert_region_id"),a=t("#price_item_alert_city_id");e.empty().prop("disabled",!0),a.empty().prop("disabled",!0),t.ajax({type:"POST",url:"/ajax/get-regions/",data:{id:t(this).val()},success:function(a){if(1===a.result){e.append(t("<option/>"));for(var o in a.data)e.append(t("<option/>",{value:a.data[o].id,text:a.data[o].title}));e.prop("disabled",!1)}},dataType:"json"})}).on("change","#price_item_alert_region_id",function(){var e=t("#price_item_alert_city_id");e.empty().prop("disabled",!0),t.ajax({type:"POST",url:"/ajax/get-cities/",data:{id:t(this).val()},success:function(a){if(1===a.result){e.append(t("<option/>"));for(var o in a.data)e.append(t("<option/>",{value:a.data[o].id,text:a.data[o].title}));e.prop("disabled",!1)}},dataType:"json"})}).on("change","#price_item_alert_city_id",function(){t(".price-item-alert [type='submit']").prop("disabled",!0);var e=t("#price_item_alert_shop_id");e.empty(),t(".price-item-alert .change-city").text(t(":selected",this).text()),t.ajax({type:"POST",url:"/ajax/get-shops/",data:{id:t(this).val()},success:function(a){if(1===a.result){t(".price-item-alert [type='submit']").prop("disabled",!1);for(var o in a.data)e.append(t("<li/>").append(t('<div class="checkbox">').append(t("<input/>",{type:"checkbox",name:"shop_id[]",value:a.data[o].id,id:"alert-shop-id-"+a.data[o].id}).prop("checked",!0)).append(t("<label/>",{for:"alert-shop-id-"+a.data[o].id}).append(a.data[o].title))));t(".price-item-alert .select-city").hide(),t(".price-item-alert .current-city").show()}},dataType:"json"})}).on("submit",e,function(){return!1}).on("click",".btn.close-btn",function(){a.modal&&a.modal.modal("hide")}).on("click",".buttons .create-btn",function(){var a=t(this).data("action-url");n.postForm(t(e),a)}).on("click",".buttons .remove-btn",function(){var a=t(this).data("action-url");n.postForm(t(e),a)})},showPopup:function(e){var o=n.showModal('<div class="loading-dots"><span></span><span></span><span></span><span></span></div>');a.priceItemId=e,a.modal=o,n.loadPopup(e,function(e,a){e?t(".modal-content",o).empty().append(a):o.modal("hide")})},showModal:function(e){var a=t("#myPopup");return a.is(".modal")&&a.remove(),e='<div class="modal notification-modal" id="myPopup" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content">'+e+"</div></div></div>",t(e).modal()},loadPopup:function(e,a){t.ajax({url:"/productNotify/ajax/get-modal/",type:"GET",dataType:"JSON",data:{productGuid:e},success:function(t){t.result?"function"==typeof a&&a(!0,t.html):(alert("Сервис временно недоступен, повторите попытку позже."),a(!1))},error:function(){alert("Сервис временно недоступен, повторите попытку позже."),a(!1)}})},postForm:function(e,i){var n=t(".buttons .create-btn",e),r=a.modal;null!==r&&r.toggleClass("loading",!0);var d=[];t("input[name^=shop_id]:checked",e).each(function(){d.push(t(this).val())});var l=[];t("input[name^=subscribe]:checked",e).each(function(){l.push(t(this).val())}),t.ajax({type:"POST",url:i,dataType:"json",data:e.serialize(),success:function(e){!0===e.result?(t(".btn-price-item-alert[data-id="+o+"]").toggleClass("created",null===e.data),t(".product-notification-container").empty().append(e.html),null!==r&&r.find(".modal-header h1").empty().append(e.message)):(n.show(),alert(e.error))},error:function(){alert("Сервис временно недоступен, повторите попытку позже.")}}).always(function(){null!==r&&r.toggleClass("loading",!1)}),a.priceItemId=null},updateModalButton:function(){a.modal&&(0===a.modal.find(":checkbox:checked").length&&0===t(e).data("notification-exists")?a.modal.find(".buttons .create-btn").toggleClass("disabled",!0):a.modal.find(".buttons .create-btn").toggleClass("disabled",!1))}};n.init()},t(function(){t("body").priceItemAlert()})}(jQuery),function(t){t(function(){var e=t("<div/>",{class:"popover bottom",id:"cheaper-popover"}),a=t('<a href="javascript:;" id="cheaper-popover-link" target="_blank" rel="nofollow">Узнать больше</a>'),o=t("<div/>",{style:"position:fixed;left:0;top:0;right:0;bottom:0;z-index:9999;"});e.append(t("<div/>",{class:"arrow"})).append(t("<div/>",{class:"popover-content"}).append(t("<div/>",{id:"cheaper-popover-title-image"}),t('<p id="cheaper-popover-main-info">Копите бонусы и оплачивайте ими до 100% стоимости покупок!</p>'),t('<p id="cheaper-popover-second-info">1 бонус = 1 рубль скидки</p>'),t("<div/>",{class:"text-right"}).append(a))),t("body").on("click",".buy-cheaper",function(i){i.preventDefault();var n=t(this);o.appendTo("body"),e.appendTo("body"),a.attr("href",n.closest("a").attr("href")||"/prozapass"),e.show();var r=n.get(0).getBoundingClientRect(),d=e.get(0).getBoundingClientRect().width,l=r.left+(r.width/2-d/2),s=r.bottom+t(window).scrollTop(),c=document.documentElement.clientWidth;return l+d>c&&(l=c/2-d/2),e.attr("style","left:"+l+"px !important;top:"+s+"px;z-index:10000;display: block"),!1}),o.click(function(){var t=o.get(0);if(t.remove instanceof Function)t.remove();else{var a=t.parentElement||t.parentNode;a instanceof Object&&a.removeChild instanceof Function&&t.removeChild(t)}e.remove()}),t(window).on("scroll resize",function(){o.trigger("click")})})}(jQuery),function(t){t.fn.Prozapass=function(e){var a,o,i,n={callback:null},e=t.extend({},n,e),r={},d=this,l={init:function(){r[t('META[name="csrf-param"]').attr("content")]=t('META[name="csrf-token"]').attr("content"),a=t(d),o=t("#register-btn",a),i=t("#prozapass-ajax-anim",a),o.on("click",function(){return l.register(),!1})},register:function(){i.show(),t.ajax({url:o.data("url"),type:"post",data:r,cache:!1,dataType:"json",success:function(a){i.hide(),1==a.result?t("#prozapass-register-status").html(a.message[0]):"function"==typeof e.callback?e.callback(a):(t("#prozapass-register-status").html("Произошла ошибка."),t.each(a.message,function(e,a){t("#prozapass-register-status").append("<p>"+a+"</p>")}))},error:function(t){alert("Произошла неизвестная ошибка. Пожалуйста, обратитесь в техническую поддержку.")}})}};l.init()}}(jQuery),function(t,e){e.fn.relatedProductsByCategoriesWidget=function(){window.EVENT_RELATED_PRODUCTS_CATEGORY_SHOWED="related-for-product-card:category-showed";var t=e(this),a=t.find(".mobile-controls [data-role=dropdown-list]"),o=function(o){var i=a.find("[data-id="+o+"]");e("[data-role=list-item]",a).toggleClass("disabled",!1),i.closest("[data-role=list-item]").toggleClass("disabled",!0),e("[data-role=toggle-button] [data-role=title]",a).html(i.html()),e("[data-role=related-category-link]",t).attr("data-is-active",0).filter("[data-id="+o+"]").attr("data-is-active",1),e("[data-role=related-products-category]",t).attr("data-is-active",0).filter("[data-id="+o+"]").attr("data-is-active",1),e(window).trigger(window.EVENT_RELATED_PRODUCTS_CATEGORY_SHOWED)};e("[data-role=related-category-link]",t).on("click",function(){return o(e(this).data("id")),!1}),e("[data-role=list-item]",a).on("click",function(){return e("[data-role=toggle-button]",a).dropdown("toggle"),o(e(this).data("id")),!1}),e("[data-role=go-back-button]",t).on("click",function(){var a=e(this).parents("[data-role=related-products-category]").attr("data-id");e(this).parents("[data-role=related-products-category]").attr("data-is-active",0),t.find("[data-role=related-category-link]").filter("[data-id="+a+"]").attr("data-is-active",0)}),e(window).on(window.EVENT_UPDATE_CART,function(a){var o=e(this);this==window&&(o=e(a.target));var i=o.closest("[data-role=related-products-category]");if(0!==i.length){var n=e("[data-role=related-category-link]",t).filter("[data-id="+i.data("id")+"]"),r=1;n.data("buyedProductsCount")&&(r+=n.data("buyedProductsCount")),n.find("span").remove(),n.data("buyedProductsCount",r),n.append(" <span>("+r+")</span>")}}),e(window).trigger(window.EVENT_INIT_PRODUCTS_SLIDER)}}(document,jQuery),function(t,e){e(function(){var t=e("[data-role=related-products-categories-page]");if(0!==t.length){var a=t.find("[data-role=related-products-category]");if(0!==a.length){var o=!1,i=function(){o||window.checkScreenType(window.SCREEN_MOBILE)||(o=!0,e.get().done(function(t){if(!1===t.result)return void n();a.each(function(){var a=e(this),o=a.data("id");t.data.hasOwnProperty(o)?(a.find(".loading-dots").replaceWith(t.data[o]),dispatchLazyLoadUpdateEvent()):n(o)}),e(window).trigger(window.EVENT_INIT_PRODUCTS_SLIDER).trigger(window.EVENT_PRODUCTS_LOADED)}).fail(n))},n=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;a.each(function(){var a=e(this);void 0!==t&&a.data("id")!==t||a.find(".loading-dots").replaceWith("Не удалось получить список аксессуаров.")})};i(),e(window).on(window.EVENT_CHANGE_SCREEN_TYPE,i)}}})}(document,jQuery),function(t,e){window.EVENT_RELATED_FOR_PRODUCT_CARD_WIDGET_SHOWED="related-for-product-card:showed",window.EVENT_RELATED_PRODUCTS_CATEGORY_SHOWED="related-for-product-card:category-showed";var a=!1;e(function(){var t=e("[data-role=related-products-card-widget]");if(0!==t.length){var o=function(){if(!a){a=!0;var o=t.find(".loading-dots");e.get(t.data("url")).done(function(a){if(!1===a.result)return void o.replaceWith('<div class="alert alert-info">Не удалось получить список аксессуаров.</div>');o.replaceWith(a.html),t.relatedProductsByCategoriesWidget(),e(window).trigger(window.EVENT_PRODUCTS_LOADED),window.dispatchLazyLoadUpdateEvent()}).fail(function(){o.replaceWith('<div class="alert alert-info">Не удалось получить список аксессуаров.</div>')})}};e(window).on(window.EVENT_CHANGE_SCREEN_TYPE,o);var i=function(t){var a=e("[data-role=toggle-related-products-widget]");if(!t&&parseInt(a.attr("data-showed"))||n(!parseInt(a.attr("data-showed"))),!t){var o=e("[data-role=related-products-card-widget-wrap]").parent(),i=window.checkScreenType(window.SCREEN_WIDE,window.SCREEN_DESKTOP)?parseInt(e(window.SELECTOR_HEADER_SEARCH).height()):parseInt(e(window.SELECTOR_MOBILE_HEADER).height());e("HTML, BODY").animate({scrollTop:parseInt(o.offset().top)-i},1e3)}return!1};o(),e("[data-role=toggle-related-products-widget]").on("click",i.bind(this,!0)),e("[data-role=link-to-related-products-widget]").on("click",i.bind(this,!1)),e(window).on(window.EVENT_ANALOGS_FOR_PRODUCT_CARD_WIDGET_SHOWED,function(){n(!1)});var n=function(a){!0===a?(e("[data-role=toggle-related-products-widget]").attr("data-showed",1),e("[data-role=related-products-card-widget-wrap]").addClass("showed"),t.removeClass("hidden"),e(window).trigger(window.EVENT_RELATED_FOR_PRODUCT_CARD_WIDGET_SHOWED)):(e("[data-role=toggle-related-products-widget]").attr("data-showed",0),e("[data-role=related-products-card-widget-wrap]").removeClass("showed"),t.addClass("hidden"))};e(window).on(window.EVENT_UPDATE_CART,function(a){var o=e(this);this==window&&(o=e(a.target)),o.data("product-guid")===t.data("main-product-guid")&&(n(!0),window.checkScreenType(window.SCREEN_TABLET)&&e("html, body").animate({scrollTop:o.offset().top-40},300))})}})}(document,jQuery),function(t,e){function a(){return null!==d?d:d=t("#remains-list tbody")}function o(){return a().find("tr:not(tr.table-row-loading)").remove()}function i(){if(!r&&!n){var e=t(this);(e.is(l)||(e=e.find(l),0!==e.length))&&(o(),r=!0,t.get(e.data("url")).done(function(e){if(n=!0,0===e.length)return d.append('\t\t\t\t\t\t<tr><td colspan="2" class="text-center">Товара нет в остатках</td></tr>\t\t\t\t\t'),this;for(var a=0,o=e.length;a<o;++a)t("<tr><td>"+e[a].shop_title+"</td><td>"+e[a].avails_count+"</td></tr>").appendTo(d)}).fail(function(){a().append('\t\t\t\t\t<tr><td colspan="2">\t\t\t\t\t\tНе удалось получить информацию об остатках. Возможны проблемы с подколючением к интернету, загруженность сети или неполадки с сервером\t\t\t\t\t\t<br>\t\t\t\t\t\tПопробуйте обновить позднее.\t\t\t\t\t\t<hr>\t\t\t\t\t\t<div class="text-center">\t\t\t\t\t\t\t<button class="btn btn-primary remains-reload">Обновить</button>\t\t\t\t\t\t</div>\t\t\t\t\t</td></tr>\t\t\t\t')}).always(function(){r=!1}))}}var n=!1,r=!1,d=null,l="[data-js=remains-tab]";t(e).on("tabSelected","#remains",i).on("click",".remains-reload",i)}(jQuery,document),function(t,e,a,o){function i(t,o,i){var n=t.find(I),r=t.closest(S);return r.find(T).remove(),r.find(C).show(),a.get(o).done(function(e){if(t.data("loaded",!0),t.find(C).remove(),r.find(C).remove(),!1===e.result)return n.append(H),a(this);n.html(e.html),G[i]=t.html()}).fail(function(){t.find(C).hide(),n.append(H),r.find(C).hide()}).always(function(){a(e).trigger(e.EVENT_AVAILS_MODAL_CONTENT_LOADED)})}function n(t){t.find(g).on("click",function(){var e=a(this);r(t,e.attr("data-type")),p(t.find(w+'[data-type="'+e.attr("data-type")+'"]'))})}function r(t,e){t.find(g).removeClass("discount-logistic-tabs__tab_active"),t.find(w).each(function(){var o=a(this);e===o.attr("data-type")?(o.removeClass("hidden"),t.find(g+'[data-type="'+o.attr("data-type")+'"]').addClass("discount-logistic-tabs__tab_active")):o.addClass("hidden")})}function d(t,e,a){null!==Q&&clearTimeout(Q),Q=setTimeout(function(){l(t,e)},a||1e3)}function l(t,i){var n=i.find(N).filter(":not(.hidden)"),r=i.find(O),d=i.find(D),l=r.attr("id");if(r.hasClass("shown")){var s=null;d.hide(),W.hasOwnProperty(l)&&(s=W[l]),""===r.html()&&(s=null),e.loadYandexMaps(function(){if(null===s&&(s=new e.ymaps.Map(l,{zoom:12,controls:["zoomControl","fullscreenControl","trafficControl"],behaviors:["default","scrollZoom"],center:[55.2627,87.363281]}),W[l]=s),s.geoObjects.removeAll(),!n.length)return void d.show();var i=new e.ymaps.GeoObjectCollection,r=t.data("product-id"),c=void 0;if(r){var u=h(r);u.length&&(c=u.first().clone(),a.each(c.data(),function(t){c.removeAttr("data-"+t)}),c.attr("data-commerce-target","AVAILS_BUY"))}var f=void 0;n.each(function(){var t=a(this),n=t.data("longitude");if(o!==n&&0!==n){var d=t.data("latitude");if(o!==d&&0!==d){var l=t.find('[class*="site-color-"]').css("color"),s=t.find(L);if(r&&c){switch(c.removeAttr("data-shop-id").removeAttr("data-postamat-id"),
t.data("type")){case V:case j:c.attr("data-shop-id",t.data("id"));break;case $:c.attr("data-postamat-id",t.data("id"))}s.find(A).html(c)}var u=new e.ymaps.Placemark([d,n],{balloonContent:s.html()},{preset:"islands#icon",iconColor:l,balloonCloseButton:!1});t.hasClass("selected")&&(f=u),i.add(u)}}}),s.geoObjects.add(i),s.events.add("click",function(){s.balloon.isOpen()&&s.balloon.close()}),f?(s.setCenter(f.geometry.getCoordinates()),s.setZoom(14).then(function(){f.events.fire("click")})):(s.setBounds(i.getBounds()),1===n.length&&s.setZoom(14)),o!==q&&(s.geoObjects.add(q),q.balloon.open())})}}function s(t,l,s){var f=arguments.length>3&&arguments[3]!==o?arguments[3]:U,g=a("#"+y+t);if(0===g.length&&(g=a(_).clone(!0,!0).attr("id",y+t),s&&g.data("product-id",t),delete G[t]),g.on("show.bs.modal",function(){a(e).trigger(e.EVENT_AVAILS_MODAL_SHOW)}),g.on("shown.bs.modal",function(){a(e).trigger(e.EVENT_AVAILS_MODAL_SHOWN),g.find(".modal-dialog").addClass("shown"),g.find(w).each(function(){d(g,a(this),1)}),g.on("click",function(){g.find(".current-shop-hint").addClass("hide")})}),g.on("hide.bs.modal",function(){a(e).trigger(e.EVENT_AVAILS_MODAL_HIDE)}),g.on("hidden.bs.modal",function(){a(e).trigger(e.EVENT_AVAILS_MODAL_HIDDEN),g.find(".current-shop-hint").removeClass("hide")}),g.find("[data-role=hide-modal]").on("click",function(){g.find(".modal-dialog").removeClass("shown"),setTimeout(function(){g.modal("hide")},200)}),g.modal("show"),G.hasOwnProperty(t))return r(g,f),!0;i(g,l,t).then(function(){function i(t){t.find("."+M).show();var e=o,i=t.find(x).children().filter(":visible").length;t.find(x).children().filter(":visible").each(function(t){var n=a(this);if(o!==e&&!0===n.hasClass(M)&&!0===e.hasClass(M)&&e.hide(),t+1===i&&n.hasClass(M))return n.hide(),!1;e=n})}n(g);var l=g.find(w);l.each(function(){var n=a(this),r=m+"-"+n.attr("data-type")+"-"+t;if(n.find(b).attr("id",r).attr("data-id",r).data("id",r),0===l.find(k).length){e.FilterList(r).addBlock(new e.RemainsFilterBlockShopType("shop-type-filter")),e.FilterList(r).addBlock(new e.RemainsFilterBlockShopWorkTime("shop-work-time-filter")),e.FilterList(r).init().submitFilters(),e.ShopFilterListHelper(r).init(),g.data("product-id")&&n.on("click",".avails-map .btn-cart",function(){h(g.data("product-id")).first().data("shop-id",a(this).data("shop-id")).data("postamat-id",a(this).data("postamat-id")).removeAttr("data-commerce-target").click()}),n.find(".btn-cart").attr("data-commerce-target","AVAILS_BUY"),n.on("click",N,function(t){var e=a(this);if("avails-map"===a(t.target).data("tab-show"))return void u(g,e);c(g,e)});var s=g.find(E);if(s.length){u(g,s);var f=s.closest(x),w=Math.round(f.scrollTop()+s.position().top-f.outerHeight()/2+s.outerHeight()/2);f.scrollTo(w)}n.on("click","[data-tab-show]",function(){var t=a(this).data("tab-show");n.find(D).hide(),n.find("[data-tab-show]").removeClass("active"),n.find('[data-tab-show="'+t+'"]').addClass("active"),n.find("[data-tab-role]").removeClass("shown"),n.find('[data-tab-role="'+t+'"]').addClass("shown"),"avails-map"===t?d(g,n,1):p(n)});var T=function(t,e){n.find(N).addClass("hidden");var o=[];e.data.forEach(function(t){if(0===o.length)o=t.value.split(",");else{var e=[];t.value.split(",").forEach(function(t){-1!==a.inArray(t,o)&&e.push(t)}),o=e}}),o.forEach(function(t){n.find(N+"[data-id="+t+"]").removeClass("hidden")}),i(n),d(g,n,1)};n.on(e.EVENT_FILTER_LIST_AFTER_CHANGE,T),n.on(e.EVENT_FILTER_LIST_SUBMIT,T),g.on("click",B,function(){g.find(F).click()}),n.on("change",F,function(){function t(t,o){function n(t){return t<500?"до 500 метров":t<1e3?"500 - 1000 метров":t<2e3?"1000 - 2000 метров":t<3e3?"2000 - 3000 метров":"более 3000 метров"}h.each(function(){var i=a(this),n=e.getDistanceFromLatLonInKm(i.data("latitude"),i.data("longitude"),t,o);i.attr("data-distance",1e3*n)}),h.sort(function(t,e){return a(t).data("distance")-a(e).data("distance")});var r=a("<div />");r.append(a("<div/>",{class:M,html:"Ближайшие магазины"}));var d=void 0,s=h.first();h.each(function(){var t=a(this),o=e.getDistanceFromLatLonInKm(t.data("latitude"),t.data("longitude"),s.data("latitude"),s.data("longitude"));v>1e3*o&&(t.prop("closest-shop",!0),u(t),r.append(t))}),h.each(function(){var t=a(this);if(!0===t.prop("closest-shop"))return!0;var e=n(t.data("distance"));e!==d&&r.append(a("<div/>",{class:M,html:"Дистанция: "+e})),u(t),r.append(t),d=e}),p.html(r.html()),i(l)}function r(){h.sort(function(t,e){return parseInt(a(t).data("sort-order"))-parseInt(a(e).data("sort-order"))}),h.find(P).empty(),p.html(h)}function s(){return f.prop("checked",!1),r(),!1}function c(a){var o=a.coords.latitude,i=a.coords.longitude;e.loadYandexMaps(function(){q=new e.ymaps.Placemark([o,i],{balloonContent:"Вы находитесь здесь."},{balloonAutoPan:!1,preset:"islands#orangeDotIcon",defaultPreset:"islands#orangeDotIcon"})}),t(o,i)}function u(t){var e=t.data("distance"),a=" м";1e3<e?(e=(e/1e3).toFixed(1),a=" км"):e=Math.ceil(e),t.find(P).text("Дистанция: "+e+a)}if(0=="geolocation"in navigator)return s();var f=a(this),p=n.find(x),h=p.find(N);f.prop("checked")?navigator.geolocation.getCurrentPosition(c,s):(q=o,r()),d(g,n,1)})}}),r(g,f),p(g.find(w+'[data-type="'+f+'"]')),g.on("click",".btn-cart",function(){g.modal("hide")}),e.dispatchLazyLoadUpdateEvent()})}function c(t,e){e.hasClass("selected")?f(t):u(t,e)}function u(t,a){if(f(t),a.addClass("selected"),e.getScreenType()!==e.SCREEN_MOBILE&&t.data("product-id")){var o=h(t.data("product-id"));switch(a.data("type")){case V:case j:o.data("shop-id",a.data("id"));break;case $:o.data("postamat-id",a.data("id"))}}}function f(t){if(t.find(N).removeClass("selected"),t.data("product-id")){h(t.data("product-id")).removeAttr("data-shop-id").removeAttr("data-postamat-id")}}function p(t){var e=t.find(x),a=e.find(N),o=t.find(R),i=t.find(".avails-list .list-head");if(i.removeClass("shops-closed"),0===a.filter(":visible").length){o.html("<div>Сейчас все магазины выбранного типа закрыты.</div>"),i.addClass("shops-closed")}}function h(t){return a(e.SELECTOR_CART_BUTTON+'[data-product-guid="'+t+'"]')}e.EVENT_AVAILS_MODAL_SHOW="avails-modal:show",e.EVENT_AVAILS_MODAL_SHOWN="avails-modal:shown",e.EVENT_AVAILS_MODAL_HIDE="avails-modal:hide",e.EVENT_AVAILS_MODAL_HIDDEN="avails-modal:hidden",e.EVENT_AVAILS_MODAL_CONTENT_LOADED="avails-modal:content-loaded",e.EVENT_AVAILS_MODAL_REQUEST="avails-modal:request";var v=1e3,m="shop-filters-list",g='[data-role="discount-logistic-button"]',w='[data-role="remains-list-tab"]',b='[data-role="filters-container"]',E=".current-shop",T=".connect-error",_="#modal-for-avails-template",y="avails-modal-",C=".loading-dots",k="[data-role=no-avails-message]",I='[data-id="avails-modal-content"]',S=".order-avail-wrap",O=".avails-map",N=".avails-item",L=".balloon-content-wrap",x=".avails-items",A=".cart-btn-wrap",R="[data-role=shops-closed-message]",D="[data-role=map-is-empty-message]",P=".distance-to-user",F="[data-role=sort-by-distance]",B=".sort-shops-by-distance-label",M="shops-group-name",V=1,j=2,$=3,U="retail",H='<div class="text-center connect-error">Не удалось получить список магазинов.</div>',G={},W={},q=void 0,Q=null;a(function(){a(t).on("click",'[data-role="show-avails-modal"]',function(t){t.preventDefault();var e=a(this);s(e.data("modal-id"),e.data("url"),e.data("product-id"),U)}),a(e).on(e.EVENT_AVAILS_MODAL_REQUEST,function(t,e){s(e.modalId,e.url,e.productId,U)}),a(t).on("click",'[data-role="discount-logistic-widget"]',function(t){t.preventDefault();var e=a(this);s(e.data("modal-id"),e.data("url"),e.data("product-id"),"discount")}),"#modal_remains"===e.location.hash&&a('#product-page .order-avail-wrap:first [data-role="show-avails-modal"]').click(),a(e).on(e.EVENT_OS_VARIANT_CHANGED,function(t,e){var o=a('[data-role="show-avails-modal"][data-product-id="'+e.baseProductGuid+'"]'),i=o.closest(S).parent(),n=null!==e.availsContent;if(i.find(".dynamic-widget").remove(),o.closest(S).toggleClass("hidden",n),n){var r=a(e.availsContent);r.addClass("dynamic-widget"),i.append(r)}}),e.openAvailsModalWidget=s}),e.openAvailsModalWidget=s}(document,window,jQuery),$(document).ready(function(){$(".marks-filter-chechbox .mark-item").click(function(){$(this).parents(".marks-filter-chechbox").find('a[data-toggle="dropdown"]').empty().append($(this).clone()).append('<span class="caret"></span>')}),$(".add-review-btn").click(function(){return $(".add-review-form").toggle(),!1}),$(".add-review-form .mark-selector .star-item").click(function(){var t=$(this).closest(".mark-line").find(".star-item");t.removeClass("active");for(var e=$(this).data("val"),a=0;a<=e-1;a++)t.eq(a).addClass("active");$(this).siblings().find("input[type=hidden].rating-val").val(e)})}),function(t,e,a){function o(){function t(){u=f.find(d),u.click(function(){c.prop("disabled",!1).show(),f.empty().hide()})}s=e(n),0!==s.length&&(c=s.find(r),f=s.find(l),h=parseInt(s.data("limit")),p=s.data("count"),p=""===p?null:parseInt(p),c.click(function(){c.prop("disabled",!0),e.ajax({url:c.data("form-url"),type:"GET",dataType:"JSON",success:function(e){!0===e.result&&(f.html(e.content).show(),c.hide(),t())},error:function(t){alert(t.responseText)}})}),f.on("submit","FORM",function(){var o=e(this),i=o.serializeArray();return e(window).trigger(window.EVENT_SUBMIT_REVIEW_WIDGET,i),e.ajax({url:o.attr("action"),type:"POST",dataType:"JSON",data:i,success:function(e){f.find("form").html(e.content),t(),!0===e.result&&a!==e.review&&c.prop("disabled",!1).show()},error:function(t){alert(t.responseText)}}),!1}),0!==p&&i())}function i(){var t={};t.limit=h,e.ajax({url:s.data("request-url"),type:"GET",data:t,dataType:"JSON",success:function(t){!0===t.result&&s.find("[data-role=clubexp-reviews]").prepend(t.content)},error:function(t){alert(t.responseText)}})}window.EVENT_SUBMIT_REVIEW_WIDGET="reviewWidget:submit";var n="#w-review-widget",r="[data-role=add]",d="[data-role=cancel]",l="[data-role=review-form]",s=void 0,c=void 0,u=void 0,f=void 0,p=void 0,h=void 0;e(function(){o(),e("#item-tabs-block").on(window.EVENT_PRODUCT_CARD_TAB_RENDER,"#review",o)})}(document,jQuery),function(t){var e=void 0,a=void 0,o=void 0;t(function(){e=t("#configuration-card"),0!==e.length&&(a=e.find('[data-role="configuration-save"]'),o=a.find('[data-role="configuration-save-btn"]'),o.on("click",function(){var e=t(this);e.prop("disabled")||(e.prop("disabled",!0),t.ajax({url:e.data("url"),type:"GET",dataType:"JSON",success:function(t){if(!1===t.result)return void alert("Не удалось применить изменения");e.removeClass("btn-save").html("Сохранено")}}))}))})}(jQuery),function(t){var e=void 0,a=void 0,o=void 0,i=void 0,n=void 0,r=void 0,d=void 0,l=void 0,s=void 0,c=void 0,u=void 0,f=void 0,p=void 0,h=void 0,v=void 0;t(function(){if(e=t("#configuration-preview-page"),0!==e.length){a=e.find('[data-role="save-configuration"]'),i=a.find('[data-role="save-configuration-btn"]'),o=a.find('[data-role="save-alert"]'),n=o.find('[data-role="apply-configuration"]'),r=o.find('[name="configuration-title"]'),d=o.find('[name="show-in-profile"]'),v=e.find(".products-list-header");var l=r.val(),s=d.is(":checked");i.on("click",function(e){e.preventDefault(),t.getJSON(a.data("save-url"),function(t){!1!==t.result&&(n.data("guid",t.rsuStatusData.configurationGuid),i.addClass("hidden"),o.removeClass("hidden"))})}),o.on("change keyup","input",function(){var t=!1;l!==r.val()&&(t=!0),s!==d.is(":checked")&&(t=!0),t?(n.prop("disabled",!1),n.text("Применить")):n.prop("disabled",!0)}),n.on("click",function(){var e=t(this);if(!e.prop("disabled")){e.prop("disabled",!0);var a=r.val(),o=d.is(":checked")?1:0;t.ajax({url:e.data("url"),type:"POST",data:{guid:e.data("guid"),title:a,showInProfile:o},dataType:"JSON",success:function(i){if(!1===i.result)return void alert("Не удалось применить изменения");e.text("Применено"),l=a,s=!!o,v.find("h2").fadeOut(300,function(){t(this).text(a).fadeIn(300)}),r.trigger("change")}}).then(function(){r.trigger("change")})}})}}),t(function(){l=t("#rsu-vendor-controls"),0!==l.length&&(c=l.find('[data-role="apply-vendor"]'),s=l.find("#vendor-controls-checkbox"),s.on("change",function(){s.is(":checked")?l.find(".controls-element").addClass("active"):l.find(".controls-element").removeClass("active")}),c.on("click",function(){var e={name:l.find('[name="configuration-name"]').val(),pageGuid:l.find('[name="vendor-page"]').val(),isVendor:s.is(":checked")?1:0,configurationGuid:c.data("guid")},a=l.find("input, button");a.prop("disabled",!0),t.post(c.data("save-url"),e,function(t){!1!==t.result&&a.prop("disabled",!1)},"json")}))}),t(function(){u=t("#rsu-author-controls"),0!==u.length&&(p=u.find('[data-role="apply-author"]'),f=u.find("#author-controls-checkbox"),f.on("change",function(){f.is(":checked")?u.find(".controls-element").addClass("active"):u.find(".controls-element").removeClass("active")}),h=u.find("#configuration-author-nickname"),p.on("click",function(){var e={nickname:h.val(),isAuthor:f.is(":checked")?1:0,configurationGuid:p.data("guid")},a=u.find("input, button"),o=u.find(".error-text");a.prop("disabled",!0),h.parent().removeClass("has-success").removeClass("has-error"),o.removeClass("active"),t.post(p.data("save-url"),e,function(t){if(!1===t.result)return h.parent().addClass("has-error"),o.html(t.error).addClass("active"),void a.prop("disabled",!1);u.html("Ваши данные сохранены. Чтобы стать автором, Вы должны выкупить конфигурацию.")},"json")}))})}(jQuery),function(t){var e=void 0;t(function(){function a(){return parseInt(e.attr("data-current-step"))}function o(t){e.attr("data-current-step",t),r.filter(":not(.always-shown)").addClass("hidden"),n.addClass("hidden"),i.addClass("hidden"),d.addClass("hidden"),d.find("span").html(t),0===t?n.removeClass("hidden"):l===t?(r.removeClass("hidden"),i.removeClass("hidden"),d.removeClass("hidden")):(i.removeClass("hidden"),n.removeClass("hidden"),d.removeClass("hidden"))}if(e=t("#configurator-tutorial"),0!==e.length){var i=e.find("[data-role=go-prev-step]"),n=e.find("[data-role=go-next-step]"),r=e.find("[data-role=finish-tutorial]"),d=e.find("[data-role=step-info]"),l=parseInt(e.attr("data-steps-count"));n.on("click",function(){o(a()+1)}),i.on("click",function(){o(a()-1)}),r.on("click",function(){t.ajax(e.data("finish-url")),e.addClass("hidden")}),e.find(".close-link").on("click",function(){e.addClass("hidden")}),t(document).find("[data-role=show-tutorial]").on("click",function(){o(0),e.removeClass("hidden")})}})}(jQuery),function(t){var e=void 0,a=void 0,o=void 0,i=void 0;t(function(t){e=t("#top-vendors-configurations-slider"),0!==e.length&&(a=t("ul",e).owlCarousel({items:1,itemsMobile:[479,1],itemsTablet:[window.SCREEN_TABLET_MAX_WIDTH,1],itemsDesktopSmall:[window.SCREEN_DESKTOP_MAX_WIDTH,1],itemsDesktop:[window.SCREEN_DESKTOP_MAX_WIDTH,1],pagination:!0,rewindNav:!0,stopOnHover:!0,slideSpeed:500,paginationSpeed:500,rewindSpeed:500}),t(".next",e).click(function(){a.trigger("owl.next")}),t(".prev",e).click(function(){a.trigger("owl.prev")}))}),t(function(t){o=t("#top-users-configurations-slider"),0!==o.length&&(i=o.children("ul").owlCarousel({items:1,itemsMobile:[479,1],itemsTablet:[window.SCREEN_TABLET_MAX_WIDTH,1],itemsDesktopSmall:[window.SCREEN_DESKTOP_MAX_WIDTH,1],itemsDesktop:[window.SCREEN_DESKTOP_MAX_WIDTH,1],pagination:!0,rewindNav:!0,stopOnHover:!0,slideSpeed:500,paginationSpeed:500,rewindSpeed:500}),t(".next",o).click(function(){i.trigger("owl.next")}),t(".prev",o).click(function(){i.trigger("owl.prev")}))})}(jQuery),function(t){window.EVENT_CONFIGURATOR_CATALOG_IS_LOADED="configurator-catalog:is-loaded";t(function(){var e=['[data-role="add-item-to-configuration"]','[data-role="add-item-to-configuration-link"]'].join(",");0!==t(e).length&&t(document).on("click",e,function(e){e.preventDefault();var a=t(this);a.data("in-configuration")||(a.prop("disabled",!0),t.post(a.data("url"),{productGuid:a.data("product-guid")},function(t){if(t.result){if("add-item-to-configuration"===a.data("role"))return window.location.href=a.data("redirect-url");if("add-item-to-configuration-link"===a.data("role"))return window.open(a.attr("href"),"_blank")}},"JSON").then(function(){a.prop("disabled",!1)}))})})}(jQuery),function(t){var e=void 0,a=void 0,o=void 0;t(function(){if(e=t("#configuration-image-slider"),0!==e.length&&(a=e.find(".image-slider-wrap"),o=e.find(".thumbs-slider-wrap"),a.find(".img").length)){var i=function(e,a){var o=t(".image-slider",e).owlCarousel(a),i=o.data("owlCarousel");return t(".button.right",e).click(function(){return i.next(),!1}).show(),t(".button.left",e).click(function(){return i.prev(),!1}).show(),i},n=i(o,{items:4,itemsMobile:[479,4],itemsTablet:[window.SCREEN_TABLET_MAX_WIDTH,5],itemsDesktopSmall:[window.SCREEN_DESKTOP_MAX_WIDTH,5],itemsDesktop:[window.SCREEN_DESKTOP_MAX_WIDTH,4],dots:!1,afterAction:!1}),r=i(a,{items:1,itemsMobile:[479,1],itemsTablet:[window.SCREEN_TABLET_MAX_WIDTH,1],itemsDesktopSmall:[window.SCREEN_DESKTOP_MAX_WIDTH,1],itemsDesktop:[window.SCREEN_DESKTOP_MAX_WIDTH,1],dots:!1,afterAction:function(){"object"===(void 0===n?"undefined":_typeof(n))&&(o.find(".owl-item .thumb").removeClass("active").eq(this.owl.currentItem).addClass("active"),n.visibleItems[n.visibleItems.length-1]<this.owl.currentItem?n.goTo(this.owl.currentItem):n.visibleItems[0]>this.owl.currentItem&&n.goTo(this.owl.currentItem))},afterInit:function(){a.find(".img").removeClass("transparent")}});o.find(".owl-item .thumb").hover(function(){r.goTo(t(this).parent().index())})}})}(jQuery),function(t){t(function(){t("body").on("click",'[data-role="configuration-buy-widget"] .tab-controls a',function(e){e.preventDefault();var a=t(this);if(a.is(".disabled"))return!1;a.siblings().each(function(){t(this).removeClass("active"),t("#"+t(this).data("target")).addClass("hidden")}),a.addClass("active"),t("#"+a.data("target")).removeClass("hidden")})})}(jQuery),function(t){function e(e){!0===e?S.attr("data-is-default-state","1"):(S.attr("data-is-default-state","0"),S.data("hide-default-initial-message",1),S.find(".default-state-block .initial-message").addClass("hidden"),t(".default-state-message").remove()),t(window).trigger(window.EVENT_RSU_CONFIGURATOR_DEFAULT_STATE_CHANGED)}function a(){function e(){if(t(".add-item-to-configurator-arrow").remove(),"1"===S.attr("data-is-default-state")&&!S.data("hide-default-initial-message")&&!window.checkScreenType(window.SCREEN_MOBILE)){var e=r.offset(),a=d.offset(),l=e.left+r.outerWidth()+10,s=e.top+r.outerHeight()/2,c=a.left+d.outerWidth()/2,u=a.top-10,f=getMiddlePointCoordinates(l,s,c,u,100,1);t(document.body).curvedArrow({x0:l,y0:s,x1:f.x,y1:f.y,x2:c,y2:u,arrowSize:i,lineWidth:n,arrowColor:o,objectCssClass:"add-item-to-configurator-arrow"})}}function a(){if(t(".required-category-info-arrow").remove(),t(".required-category-info-text").remove(),"1"===S.attr("data-is-default-state")&&!S.data("hide-default-initial-message")&&!window.checkScreenType(window.SCREEN_MOBILE)){var e=t(".configurator-groups .configurator-category:first-of-type .required-marker"),a=e.offset(),r=a.left+e.outerWidth()+100,d=a.top-30-36,l=a.left+e.outerWidth()+5,s=a.top+10,c=t("<div />").addClass("required-category-info-text").html("Обязательные комплектующие<br />отмечены звездочкой").css({position:"absolute",height:"36px",top:d+"px",left:r+"px"});t(document.body).append(c),d+=41;var u=getMiddlePointCoordinates(r,d,l,s,25,-1);t(document.body).curvedArrow({x0:r,y0:d,x1:u.x,y1:u.y,x2:l,y2:s,arrowSize:i,lineWidth:n,arrowColor:o,objectCssClass:"required-category-info-arrow"})}}var o="#888",i=7,n=1,r=S.find("#default-state-category-link"),d=t('.configurator-groups .group-categories:first > .configurator-category:first-of-type [data-role="show-catalog"]');r.on("click",function(t){t.preventDefault(),d.click()}),e(),a(),t('[data-role="hide-city-no-assembly-message"]').on("click",function(o){o.preventDefault(),t(this).closest(".default-state-message").remove(),a(),e()}),t(".alert").on("closed.bs.alert",function(){a(),e()}),t(window).on(["resize",window.EVENT_RSU_CONFIGURATOR_DEFAULT_STATE_CHANGED].join(" "),function(){a(),e()})}function o(a){O.css({width:a.requiredSelectedPercent+"%"}),S.find(s).text(a.requiredSelected),S.find(i).text(a.productsCount),S.find(n).text(a.assemblyMessage),S.find(d).text(a.orderPrice),S.find(l).text(a.availableDate),S.find(I).replaceWith(a.creditInfoHtml);var o=S.find(n).parent(),F=S.find(r);o.removeClass("trouble"),F.removeClass("active"),!1===a.isAvailableAssembly?(o.show(),t(c).addClass("inactive")):(S.find(u).text(a.assemblyPrice),S.find(f).text(a.assemblyDate),t(c).removeClass("inactive"),o.hide()),0!==a.productsCount?(A.parent().removeClass("inactive"),e(!1)):(A.parent().addClass("inactive"),e(!0)),!1===a.isAvailableOrder?(S.find(".order-info").addClass("inactive"),x.attr("disabled","disabled")):(S.find(".order-info").removeClass("inactive"),x.removeAttr("disabled")),t(h).parent().removeAttr("data-troubled"),N.removeClass("error").html("");for(var B in a.incompatibleProducts){(function(e){if(!1===a.incompatibleProducts.hasOwnProperty(e))return"continue";t(p+'[data-product-guid="'+e+'"]').each(function(){var o=t(this),i=o.find('[data-role="compatibility-status-icon"]'),n=o.find(".category-name"),r=n.find(".configuration-message"),d=o.find(".compatibility-message-mobile"),l=a.incompatibleProducts[e],s=a.incompatibleCounters[e],c=0;if(o.find(m).addClass("hidden"),0===s.length&&""===l.countMessage)c=1,r.text("Совместимо"),d.text("Совместимо"),n.removeClass("error");else{if(r.text(""),d.text(""),n.addClass("error"),""!==l.countMessage){c=0;var u=t("<a>").addClass("pseudo-link").attr("data-content",l.comment).attr("data-toggle","popover").attr("data-trigger","hover").attr("data-html",!0).text("c "+l.countMessage),f=u.clone();f.attr("data-role","show-counter-tab").attr("data-counter-tab","compatibility");var p=u.clone();p.attr("data-placement","top"),r.text("Несовместимо ").append(f),d.text("Несовместимо ").append(p)}if(0!==s.length){var h=void 0,g=void 0;for(var w in s)!1!==s.hasOwnProperty(w)&&(h=t("<a>").addClass("pseudo-link").attr("data-role","show-counter-tab").attr("data-counter-tab",w).text("Подробнее"),g=t("<span />").addClass("counter-troubles").html(s[w]+" ").append(h),r.append(g),d.append(g.clone()),o.find(m).removeClass("hidden").find(v).attr("data-counter-tab",w))}}i.attr("data-compatibility-status",c),n.append(r)})})(B)}a.duplicateCategories.forEach(function(e){var a=t(p+'[data-rsu-category-guid="'+e+'"]'),o=0;t.each(a,function(){t(this).data("product-guid")&&++o}),a.length===o&&a.find("[data-role=duplicate-category]").first().click()}),t(y+_+'[data-limited-one][data-limited-one!=""]').each(function(){-1===a.limitedOneCategories.indexOf(t(this).data("limited-one"))&&t(this).removeData("limited-one").removeProp("disabled")}),a.limitedOneCategories.forEach(function(e){t("["+T+'="'+e+'"]').find(y+_).prop("disabled",!0).data("limited-one",e)}),t(p).find('[data-role="required-marker"]').remove();a.requiredCategories.forEach(function(e){t(p+'[data-rsu-category-guid="'+e+'"]').eq(0).find('[data-role="category-name"]').parent().append('<span class="required-marker" data-role="required-marker">*</span>')}),!1===a.isAvailableAssembly?L.attr("disabled","disabled"):L.removeAttr("disabled"),t(document).trigger(window.EVENT_INIT_POPOVERS).trigger(window.EVENT_INIT_TOOLTIPS);var M=t('[data-role="logistic-troubles"]');if(0!==a.logisticTroubles.length){M.html("");for(var V in a.logisticTroubles)if(!1!==a.logisticTroubles.hasOwnProperty(V)){var j=t("<p>").html(a.logisticTroubles[V]);M.append(j)}M.removeClass("hidden")}else M.addClass("hidden");t(g).addClass("hidden");for(var $ in a.optionalCategoriesData)if(!1!==a.optionalCategoriesData.hasOwnProperty($)){var U=a.optionalCategoriesData[$],H=t(g+'[data-component-group="'+$+'"]'),G=U.count+" "+String.countPostfix(U.count,["дополнительный товар","дополнительных товара","дополнительных товаров"]),W=U.price+" "+String.countPostfix(U.price,["рубль","рубля","рублей"]),q=H.find('[data-role="optional-add-text"]');1===U.count?q.addClass("hidden"):q.removeClass("hidden"),H.removeClass("hidden").find(w).text(G).end().find(b).text(W)}for(var Q in a.eventNotifications)if(!1!==a.eventNotifications.hasOwnProperty(Q)){var Y=D.find(E+".event-notification-template").clone();Y.removeClass("event-notification-template").addClass("event-notification").find("p").text(a.eventNotifications[Q]),D.append(Y).removeClass("hidden")}if(x.attr("href",a.buyWithoutAssemblyLink),L.attr("href",a.buyWithAssemblyLink),null!==a.sameConfigurationLink&&(P.html(t(C).html()),P.find('[data-role="same-configuration-link"]').attr("href",a.sameConfigurationLink)),!0===a.canSaveConfiguration&&P.html(t(k).html()),null!==a.tabCompatibilities){N.text(t(h).eq(0).data("compatible-message")),R.html("");for(var K in a.tabCompatibilities)if(!1!==a.tabCompatibilities.hasOwnProperty(K)){var z=a.tabMessages[K];R.append(t(z));var J=t('[data-trouble-icon="'+K+'"]');if(J.parent().attr("data-troubled",!a.tabCompatibilities[K]),!0!==a.tabCompatibilities[K]){var X=J.data("trouble-message"),Z=t("<a>").addClass("rsu-switcher-btn").attr("data-role","show-trouble-tab").attr("data-tab-name",K).text(X);N.addClass("error").html(Z).append(t("<i>")),o.addClass("trouble"),F.addClass("active")}}}}window.EVENT_RSU_CONFIGURATOR_DEFAULT_STATE_CHANGED="rsu-configurator:default_state_changed",window.RSU_STATUS_WIDGET={updateData:o};var i='[data-role="configurator-items-counter"]',n='[data-role="assembly-message"]',r='[data-role="error-icon"]',d='[data-role="order-price"]',l='[data-role="available-date"]',s='[data-role="required-selected"]',c=".assembly-data",u='[data-role="assembly-price"]',f='[data-role="assembly-date"]',p='[data-role="category-block"]',h="[data-trouble-icon]",v='[data-role="show-counter-tab"]',m='[data-role="alert-counters"]',g='[data-role="optional-category-hint"]',w='[data-role="optional-count"]',b='[data-role="optional-price"]',E='[data-role="event-notification"]',T="data-rsu-category-guid",_=".product-count-plus",y='[data-role="change-product-count"]',C='[data-role="modal-template-has-same-configuration"]',k='[data-role="modal-template-can-save-configuration"]',I='[data-role="credit-info"]',S=void 0,O=void 0,N=void 0,L=void 0,x=void 0,A=void 0,R=void 0,D=void 0,P=void 0;t(function(){if(S=t('[data-role="configurator-status-widget"]'),0!==S.length){var e=t("body");x=t('[data-role="buy-simple"]'),L=t('[data-role="buy-assembly"]'),N=t('[data-role="compatibility-troubles-message"]'),R=t('[data-role="compatibility-tabs"]'),D=t('[data-role="event-notifications"]'),O=t('[data-role="required-progress-bar"]'),A=t('[data-role="show-save-configuration-modal"]'),P=t('[data-role="modal-for-save-configuration-content"]'),o(window.RSU_INITIAL_DATA),e.on("click",function(e){var a=['[data-role="compatibility-tab"]','[data-role="show-trouble-tab"]',v,h,r],o=t(a.join(","));!1===o.is(e.target)&&0===o.has(e.target).length&&o.removeClass("open opened").parent().removeClass("mobile-show")}),S.on("click",'[data-role="clear-configuration"]',function(){var e=t(this);if(void 0!==e.attr("data-in-process"))return!1;e.attr("data-in-process",!0)}),S.on("click",'[data-role="pair-product-change"], [data-role="pair-product-remove"]',function(e){e.preventDefault();var a=t(this),o=a.closest('[data-role="pair-product"]'),i=o.data("product-guid"),n=t(p+'[data-product-guid="'+i+'"]');if(0!==n.length){var r=void 0;a.closest('[data-role="compatibility-tab"]').removeClass("open"),t('[data-role="show-trouble-tab"]').removeClass("opened"),t('[data-role="compatibility-tabs"]').removeClass("mobile-show"),"pair-product-change"===a.attr("data-role")?(r=n.find('[data-role="configurator-controls"] .btn-change'),t(window).scrollTop(n.offset().top)):"pair-product-remove"===a.attr("data-role")&&(r=n.find('[data-role="configurator-controls"] .btn-remove')),r.click()}}),S.on("click",'[data-role="change-power-item"]',function(e){e.preventDefault();var a=t(this),o=a.data("product-guid"),i=t(p+'[data-product-guid="'+o+'"]');0!==i.length&&(a.closest('[data-role="compatibility-tab"]').removeClass("open"),t('[data-role="show-trouble-tab"]').removeClass("opened"),t('[data-role="compatibility-tabs"]').removeClass("mobile-show"),t(window).scrollTop(i.offset().top),i.find('[data-role="configurator-controls"] .btn-change').click())}),S.on("click",".rsu-switcher-btn",function(e){e.preventDefault(),t(this).toggleClass("opened")}),S.on("click",'[data-role="show-trouble-tab"]',function(){var e=t(this),a=e.data("tab-name");e.hasClass("opened")?R.find('[data-tab-category="'+a+'"]').addClass("open"):R.find('[data-tab-category="'+a+'"]').removeClass("open")}),S.on("click",'[data-role="close-tab"]',function(e){e.preventDefault(),t(this).closest('[data-role="compatibility-tab"]').removeClass("open").parent().removeClass("mobile-show"),N.find(".rsu-switcher-btn").removeClass("opened")}),S.on("click",'[data-role="show-consumers"]',function(){var e=t(this),a=S.find('[data-role="consumer-list"]');e.hasClass("opened")?a.addClass("opened"):a.removeClass("opened")}),S.on("click",'[data-role="show-slot-groups"]',function(){var e=t(this),a=e.closest('[data-role="compatibility-tab"]').find(".counter-groups");e.hasClass("opened")?a.addClass("opened"):a.removeClass("opened")}),S.on("click",h,function(){t('[data-role="compatibility-tab"]').removeClass("open");var e=t(this),a=e.parent().attr("data-troubled");if(void 0!==a){var o=N.find('[data-role="show-trouble-tab"]');if(0!==o.length&&o.data("tab-name")===e.data("trouble-icon"))return o.click(),!1;a="true"===a;var i=a?e.data("trouble-message"):e.data("compatible-message");if(a?(N.addClass("error"),S.find(n).text("Проблема! "+i+". Сборка невозможна.")):N.removeClass("error"),"compatibility"===e.data("trouble-icon")&&!1===a)N.removeClass("error").text(i);else{var r=t("<a>").addClass("rsu-switcher-btn").attr("data-role","show-trouble-tab").attr("data-tab-name",e.data("trouble-icon")).text(i);N.html(r).append(t("<i>")),r.click()}}}),S.on("click",'[data-role="deficit-item"]',function(e){e.preventDefault();var a=t(this),o=a.data("product-guid"),i=t(p+'[data-product-guid="'+o+'"]');a.closest('[data-role="compatibility-tab"]').removeClass("open"),t('[data-role="show-trouble-tab"]').removeClass("opened"),t('[data-role="compatibility-tabs"]').removeClass("mobile-show"),i.find('[data-role="show-product-card"]').eq(0).click(),t(window).scrollTop(i.offset().top)}),S.on("click",r,function(){!1!==t(this).hasClass("active")&&R.toggleClass("mobile-show")}),S.on("click",'[data-role="share-btn"]',function(){if(""===t('[data-role="configuration-link"]').val()){var e=t(this),a=e.data("url");e.toggleClass("disabled"),t.getJSON(a,function(a){!1!==a.result&&(t('[data-role="configuration-link"]').val(a.shareUrl),t('[data-role="shared-link"]').toggleClass("hidden"),e.toggleClass("disabled"))})}else t('[data-role="shared-link"]').toggleClass("hidden")}),S.on("click",'[data-role="save-configuration"]',function(e){e.preventDefault();var a=t(this),o=a.data("save-url");a.prop("disabled",!0),t.getJSON(o,function(t){!1!==t.result&&(window.location.href=t.previewUrl)})}),S.on("click",'[data-role="close-event-notification"]',function(e){e.preventDefault(),t(this).closest(E).remove(),0===D.find(".event-notification").length&&D.addClass("hidden")}),e.on("click",v,function(e){e.preventDefault();var a=t(this),o=a.data("counter-tab");t('[data-trouble-icon="'+o+'"]').click(),t(window).scrollTop(t('[data-role="configurator-status-widget"]').offset().top)}),a()}})}(jQuery),function(t,e){var a=void 0,o=void 0,i=void 0;e(function(){a=e(".category-items-phone").find(".menu-rsu"),0!==a.length&&(o=e(".menu-content",a),i=e('[data-role="rsu-menu-switcher"]',a),i.on("click",function(){return o.toggleClass("shown"),o.hasClass("shown")&&(o.get(0).scrollTop=0),!1}))})}(document,jQuery),function(t){function e(){var e=n.find([a,o].join(","));0===t(i+":checked").length?e.attr("disabled",!0):e.removeAttr("disabled")}var a='[data-role="cancel"]',o='[data-role="remove-selected"]',i='[name="profile-configuration-action"]',n=void 0,r=void 0,d=void 0,l=void 0
;t(function(){if(n=t('[data-role="rsu-user-configurations-control"]'),0!==n.length){r=n.find('[data-role="select-all"]'),d=n.find(a),l=n.find(o),r.on("click",function(){t(i).prop("checked",!0),e()}),d.on("click",function(){t(i).prop("checked",!1),e()});var s=void 0;l.on("click",function(){var e=t(i+":checked");if(0!==e.length){var a=[];t(".rsu-user-configuration").removeAttr("data-mark-deleted"),e.each(function(){t(this).closest(".rsu-user-configuration").attr("data-mark-deleted",!0),a.push(t(this).data("configuration-guid"))}),void 0!==s&&s.abort(),s=t.post(n.data("remove-url"),{rsuGuids:a},function(e){!1===e.result&&t(".rsu-user-configuration").removeAttr("data-mark-deleted"),t(".rsu-user-configuration[data-mark-deleted]").remove()},"json")}}),t(".dropdown-link-mobile").on("click",function(e){e.preventDefault(),t(this).toggleClass("expanded")}),t(i).on("change",e)}})}(jQuery),function(t,e,a){e.EVENT_RSU_CATALOG_AJAX_REQUEST_PARAMS_CHANGE="rsu-user-catalog:ajax-params-change";var o=void 0,i=void 0,n=void 0,r=void 0,d=void 0,l={groupBy:0,sortBy:0,mode:0,page:1},s=[],c=void 0,u={onSuccess:function(a){var o=parseInt(a.data.totalCount);if(1===parseInt(l.page)){r.toggleClass("hidden",0===o).text("("+o+" шт)");var n=t(a.data.pickedFilters);d.html(n),n.pickedFilters()}if(0===o)return void i.html("<h4>Конфигурации не найдены</h4>");var s=t(a.html);s.find('[data-role="configurations-group"]').each(function(){var e=t(this),a=e.data("group-key"),o=i.find('[data-role="configurations-group"][data-group-key='+a+"]");if(0!==o.length){var n=e.find('[data-role="group-configuration"]');o.append(n)}else i.append(e)});var c=s.find('[data-role="category-more"]');0!==c.length&&i.append(c),i.trigger(e.EVENT_INIT_POPOVERS),dispatchLazyLoadUpdateEvent()},onFail:function(){var e=t("<div />").addClass("alert-danger alert fade in").html('<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button> При получении конфигураций произошла ошибка. Попробуйте обновить страницу.');i.html("").append(e)}},f=function(){a!==c&&c.abort(),1===l.page&&i.html("");var n=[];for(var r in l)if(!1!==l.hasOwnProperty(r)){var d=l[r];0!==d&&n.push(r+"="+d)}s.forEach(function(t){n.push(t.key+"="+t.value)});var f=t("<div><span /><span /><span /><span /></div>").addClass("loading-dots");i.find('[data-role="show-more"]').remove().end().append(f);var p=function(){f.remove(),c=a};c=t.get(o.data("get-catalog-configurations-url")+"?"+n.join("&"),p),c.then(u.onSuccess,u.onFail),a!==e.history&&e.history.pushState({},document.title,"?"+n.join("&"))},p=function(e){e.preventDefault();var a=t(this),o=a.closest('[data-role="ordering-dropdown"]'),i=parseInt(a.data("order-value")),n=a.text(),r=o.data("ordering-key");i!==l[r]&&(o.find('[data-role="order-type-selected"]').text(n),l.page=1,l[r]=i,f())},h=function(t,a){e.checkScreenType(e.SCREEN_DESKTOP,e.SCREEN_WIDE)&&e.FilterList(a.filterListId).submitFilters(!0)},v=function(t,e){l.page=1,s=e.data,f()},m=function(e){e.preventDefault();var a=t(this);l.page=1,l.mode=a.val(),f()},g=function(){var e=t(this);l.page=parseInt(e.data("page")),f()};t(function(){if(o=t('[data-role="rsu-user-catalog-container"]'),0!==o.length){d=o.find('[data-role="rsu-picked-filters"]'),i=o.find('[data-role="catalog-configurations"]'),r=o.find('[data-role="configurations-counter"]'),n=t(document).find('[name="filter-list-user-catalog"]');var a=document.location.href.split("?");if(2===a.length){var c=a.pop(),u=String.parseQueryString(c);for(var f in u)!1!==u.hasOwnProperty(f)&&(!0===l.hasOwnProperty(f)?l[f]=parseInt(u[f]):s.push({key:f,value:u[f]}))}o.on("click",['[data-role="select-group-by"]','[data-role="select-sort-by"]'].join(","),p),o.on("click",'[data-role="show-more"]',g),o.on("change",'[data-role="mode-switcher"]',m),n.each(function(){var a=t(this),o=a.closest(e.SELECTOR_FILTER_LIST_CONTAINER);o.on(e.EVENT_FILTER_LIST_SUBMIT,v),o.on(e.EVENT_FILTER_LIST_AFTER_CHANGE,h)}),n.on(e.EVENT_FILTER_LIST_SUBMIT,v)}})}(jQuery,window,void 0),function(t,e,a){function o(){v=e(s),m=e(l),0!==v.length&&(e(window).on(window.EVENT_SHOP_FILTERS_CHANGE,d),n(),e(f).on("click","a",function(){e(f).find("li").removeClass("active"),e(this).parent().addClass("active");var t=e(this).attr("aria-controls");e("[data-tab-content]").removeClass(p).not('[data-tab-content="'+t+'"]').addClass(p),"shops-map"===t&&(w.container.fitToViewport(),g?i():w.setBounds(b.getBounds(),{checkZoomRange:!0}))}),e(h).on("click",function(){if(g=e(this).closest(u),!1===e(f).is(":hidden")){var t=e('[aria-controls="shops-map"]'),a=e("html, body");t.click(),a.scrollTop()>t.offset().top&&a.animate({scrollTop:t.offset().top-100},500)}else i()}))}function i(){window.loadYandexMaps(function(){g&&w.setCenter([g.attr("data-latitude"),g.attr("data-longitude")],16,{checkZoomRange:!0}),g=a})}function n(){if(a===window.ymaps||a===window.PieChartClusterer)return void window.loadYandexMaps(function(){setTimeout(n)});var t=m.data("center");t===a&&(t="0,0"),w=new window.ymaps.Map(m.attr("id"),{center:t.split(","),zoom:17}),b=new window.PieChartClusterer,m.find(".map-item").each(function(){var t=e(this),a=t.data("coordinates"),o={preset:"islands#orangeCircleDotIcon",iconColor:t.data("sales-channel-color")};t.data("selected")&&(o={preset:"islands#redCircleDotIcon",zIndex:1e3}),0!==a.length&&(a=a.split(","),b.add(new window.ymaps.Placemark(a,{balloonContent:t.html(),clusterCaption:t.find("[data-role=shop-title]").text()},o))),T[t.attr("data-id")]=t.data("sales-channel-color"),t.remove()}),w.geoObjects.add(b),"0,0"===t&&w.setBounds(b.getBounds()),w.events.add("sizechange",function(){a===g&&w.setBounds(b.getBounds(),{checkZoomRange:!0})}),0!==e(c).length&&d(),r()}function r(){var t=e("[data-other-cities-shops-url]");0!==t.length&&e.get(t.data("other-cities-shops-url")).done(function(t){!1!==t.result&&(E=new window.PieChartClusterer,e.each(t.data.sites,function(o,i){e.each(t.data.siteCitiesShops[o],function(t,o){e.each(o,function(t,e){var o=e.latitude;if(a!==o&&0!==o){var n=e.longitude;if(a!==n&&0!==n){var r={preset:"islands#orangeCircleDotIcon",iconColor:i.color},d='<div class="map-balloon-content "><div class="shop-list-item__title">'+e.name+'</div><div class="shop-list-item__worktime shop-list-item__text_gray shop-list-item__text_small">'+e.worktime+"</div></div>",l=new window.ymaps.Placemark([o,n],{balloonContent:d,clusterCaption:e.name},r);E.add(l)}}})})}),w.geoObjects.add(E))})}function d(){var t=e(u).not(".hidden");a!==w&&(w.geoObjects.removeAll(),0!==t.length&&(b.removeAll(),t.each(function(){var t=e(this),a=T[t.attr("data-id")],o=new window.ymaps.Placemark([t.data("latitude"),t.data("longitude")],{balloonContent:t.clone().prop("outerHTML")},{preset:"islands#orangeCircleDotIcon",iconColor:a});b.add(o)}),w.geoObjects.add(b),w.setBounds(b.getBounds(),{checkZoomRange:!0}),w.geoObjects.events.add("balloonopen",function(){e(window).trigger(window.EVENT_SHOP_BALLOON_OPEN)}),E&&w.geoObjects.add(E)))}window.EVENT_SHOP_FILTERS_CHANGE="shop-filters:change",window.EVENT_MAP_INIT="shops-info-init",window.EVENT_SHOP_BALLOON_OPEN="map-balloon-open";var l='[data-role="ya-map-container"]',s='[data-role="shop-map"]',c='[data-role="shop-group"]',u=".shop-list-item",f='[data-role="mobile-tabs"]',p="mobile-hidden",h='[data-role="address"]',v=void 0,m=void 0,g=void 0,w=void 0,b=void 0,E=void 0,T={};e(window).on(window.EVENT_MAP_INIT,o)}(document,jQuery),function(t,e){e(function(){var t=e("[data-role=shop-cities-page]");0!==t.length&&t.on("click",".letter",{container:t},a)});var a=function(t){var a=e(this);if(!a.parent().hasClass("active")){var o=t.data.container,i=o.find(".cities"),n=o.find(".city-list li"),r=a.data("letter"),d=o.find(".cities-letters li");i.filter(".hide").removeClass("hide"),d.filter(".active").removeClass("active"),a.parent().addClass("active"),n.removeClass("hide"),0!==r.length&&(n.not('[data-city-letter="'+r+'"]').addClass("hide"),i.each(function(){var t=e(this);0===t.find(".city-list li:not(.hide)").length&&t.addClass("hide")}))}}}(document,jQuery),function(t){t.fn.SmsConfirm=function(e){var a={callback:null,cancelCallback:null};e=t.extend({},a,e);var o=void 0,i=void 0,n=void 0,r=void 0,d=this,l=0,s={init:function(){var e=t(d);o=t("#sms-confirm-send-btn",e),i=t("#sms-confirm-send-repeat-btn",e),n=t("a#sms-not-delivered",e),r=t("#sms-confirm-code",e),o.on("click",function(){return s.check(),!1}),r.on("keypress",function(t){13===t.which&&s.check()}),i.click(function(){return s.resend(),!1}),n.click(function(){return o.hide(),i.show(),t(this).hide(),!1})},check:function(){o.attr("disabled","disabled"),window.toggleLoaderVisibility(!0),t.ajax({url:"/sms-confirm/check/",type:"GET",dataType:"json",data:{session_guid:o.data("sms-confirm-session"),code:r.val()},success:function(a){o.removeAttr("disabled"),window.toggleLoaderVisibility(!1),a.result?(alert("Ваш номер телефона подтвержден."),"function"==typeof e.callback&&e.callback(a.result),t("#sms-confirm-block").hide()):(l++,alert(a.message)),l>=2&&s.initCancel()}})},resend:function(){window.toggleLoaderVisibility(!0),i.hide(),n.remove(),t.ajax({url:"/sms-confirm/resend/",type:"GET",dataType:"json",data:{session_guid:o.data("sms-confirm-session")},success:function(t){window.toggleLoaderVisibility(!1),o.show(),0===t.data.limitLeft&&s.initCancel(),!0===t.result?alert("Повторный код успешно отправлен."):""!==t.message?alert(t.message):alert("Произошла ошибка при отправке кода. Пожалуйста, повторите попытку позднее.")}})},initCancel:function(){"function"==typeof e.cancelCallback&&t("#buttons-block .cancel-confirm",t(d)).show().find("a").click(function(){return e.cancelCallback(),!1})}};s.init()}}(jQuery),function(t,e){function a(){e(i).each(function(){e(this).attr("href",e(this).attr("href").replace(r,""))})}function o(){e.ajax({url:e(n).attr("data-request-url"),type:"GET"})}var i=".ec-price-item-link",n="#search-results",r="finalize=1";e(function(){var i=e("#b-search-page-categories");if(0!==i.length){var r=t.documentElement.clientHeight,d=t.documentElement,l=t.body,s=!1;e('[data-role="show-extra"]',i).click(function(){return i.toggleClass("view-extra"),a(),!1}),e(window).scroll(function(){var t=d.scrollTop||l&&l.scrollTop||0;r+r/2<=t&&!1===s&&(a(),s=!0)}),e(n).on("click",".btn-cart",function(){!1===s&&o()}),e(n).on("click",".btn-compare",function(){!1===s&&o()}),e(n).on("click",".btn-price-item-alert",function(){!1===s&&o()}),e(n).on("click",'[data-role="show-avails-modal"]',function(){!1===s&&o()})}})}(document,jQuery),function(t,e){e(function(){function t(){o.val().length?i.parent().show():i.parent().hide()}var a=e("#b-service-center-search");if(0!==a.length){var o=a.find('[name*="[manufacturerId]"]'),i=a.find('[name*="[specId]"]'),n=a.find("form");o.on("change",function(){var a=e(this);t(),e.ajax({url:n.data("url"),type:"GET",dataType:"json",data:{manufacturerId:a.val()},success:function(t){i.html(t.content).show(),e("#select2-servicecentersearchform-specid-container").removeAttr("title").empty(),e("<span/>",{class:"select2-selection__placeholder",text:"Все изделия"}).appendTo("#select2-servicecentersearchform-specid-container")}})}),t()}})}(document,jQuery),$(document).ready(function(){var t=[],e=[];$(document).on("click",'[data-role="get-profile-hint"]',function(a){a.preventDefault();var o=$(this),i=o.parent().siblings(".profile-hint-modal");if($(".profile-hint-modal").hide(),0!==i.length)return void i.toggle();if(void 0!==e[o.attr("data-uid")])return void o.parent().after(e[o.attr("data-uid")]);if(void 0!==window.getProfileHintUrl&&1!==t[o.attr("data-uid")]){var n=window.getProfileHintUrl+o.attr("data-uid");t[o.attr("data-uid")]=1,$.ajax({url:n,cache:!1,dataType:"JSON",success:function(t){o.parent().after(t.html),e[o.attr("data-uid")]=t.html},error:function(){alert("Не удалось получить данные профиля. Попробуйте позже"),t[o.attr("data-uid")]=0}})}}),$(document).on("click",function(t){$(t.target).closest(".profile-hint-modal").length||$(t.target).closest('[data-role="get-profile-hint"]').length||$(".profile-hint-modal").hide()})}),$(document).ready(function(){var t=!1;0!==$('[data-role="show-notifications"]').length&&($('[data-role="show-notifications"]').on("click",function(){var e=$(this),a=$(this).closest(".dropdown");a.hasClass("open")?($('[role="tooltip"]').hide(),$('[role="tooltip"]').removeClass("hidden"),a.toggleClass("open"),$(".notifications-block").toggleClass("open")):!0!==t?$.ajax({url:e.attr("data-url"),method:"get",cache:!1,dataType:"JSON",success:function(e){!0===e.result&&($('[data-role="notifications-block-content"]').html(e.html),t=!0,$('[role="tooltip"]').addClass("hidden"),a.toggleClass("open"),$(".notifications-block").toggleClass("open"))},error:function(){$('[data-role="notifications-block-content"]').html("При получении уведомлений произошла ошибка.")}}):($('[role="tooltip"]').addClass("hidden"),a.toggleClass("open"),$(".notifications-block").toggleClass("open"))}),$(document).on("click",function(t){$(t.target).closest('[data-role="show-notifications"]').length||$(t.target).closest(".notifications-block").length||($('[data-role="show-notifications"]').closest(".dropdown").removeClass("open"),$(".notifications-block").removeClass("open"))}),$('[data-role="notifications-menu-close"]').on("click",function(){$(".notifications-block").removeClass("open"),$('[data-role="show-notifications"]').closest(".dropdown").removeClass("open")}))}),$(document).ready(function(){$('[data-check-input="check-latin-symbols-entry"]').keyup(function(t){var e=$(this),a=/[a-zA-Z]/;e.siblings(".check-latin-symbols-entry-message").remove(),e.val().match(a)&&e.after("<p class='help-block check-latin-symbols-entry-message help-block-warning'>Мы работаем только с резидентами РФ</p>")})}),function(t){t.fn.profileTicketsLoad=function(){t(document).on("click",".load-more-tickets",function(e){e.preventDefault();var a=t(this),o=a.data("url"),i=t(".load-more-tickets-btn-wrap");return a.siblings(".alert").remove(),a.hide(),i.prepend('<div class="loading-dots"><span></span><span></span><span></span><span></span></div>'),t.ajax({url:o,cache:!1,dataType:"JSON",success:function(t){i.replaceWith(t.html)},error:function(){i.prepend('<div class="alert alert-danger">Не удалось загрузить сообщения. Повторите попытку позже.</div>'),t(".loading-dots",i).remove(),a.show()}}),!1})}}(jQuery),function(t){t.fn.profileOrdersBlock=function(){function e(e){var a=void 0,o=void 0;switch(e){case l:a='Коммерческое предложение <span data-role="order-number"></span> удалено',o="Вернуть удалённое коммерческое предложение";break;case r:case d:default:a='Заказ <span data-role="order-number"></span> удалён',o="Вернуть удалённый заказ"}var i=t("<div />").addClass("deleted-order alert alert-warning col-xs-12 row"),n=t("<div />").addClass("col-sm-7 order-number").html(a),s=t("<a />").attr("data-role","restore-button").html("<i></i><span>"+o+"</span>"),c=t("<div />").addClass("col-sm-5 restore-wrapper").append(s);return i.append(n,c),i}function a(){t(n).find(".modal-title").text("Отмена заказа"),t(n).find(".modal-text").text("Для отмены заказа вам необходимо авторизоваться в личном кабинете или зарегистрироваться на сайте."),t(n).modal("show")}function o(){t(n).find(".modal-title").text("Удаление заказа"),t(n).find(".modal-text").text("Для удаления заказа вам необходимо авторизоваться в личном кабинете или зарегистрироваться на сайте."),t(n).modal("show")}var i=this,n="[data-role=authorization-request-modal]",r=1,d=2,l=3,s=!1,c=!1;t(document).on("click",function(e){!1===t("[data-role=edit-call-request-popover-template]").is(e.target)&&0===t("[data-role=edit-call-request-popover-template]").has(e.target).length&&!1===t("[data-role=edit-call-request-button]").is(e.target)&&0===t("[data-role=edit-call-request-button]").has(e.target).length&&(t("[data-role=edit-call-request-button]").popover("destroy"),t("[data-role=edit-call-request-popover-template]").filter(".in").remove())}),t(document).on("click touchstart",".order-type-link",function(){var e=t(".status-filter",".user-orders-filter-form");t(".order-type-link").removeClass("active"),t(this).addClass("active"),e.val(t(this).data("status")),t(".user-orders-filter-form").trigger("submit")}),t(document).on("click touchstart",".order-search-input-button",function(){t(".user-orders-filter-form").trigger("submit")}),t(document).on("click touchstart",".order-date-input-button",function(){t("input[name="+t(this).data("input-name")+"]").trigger("focus")});var u=function(){var e=t(".user-orders-filter-form").data("url"),a=t(i).find(".user-orders-filter-form").serialize(),o=t(".overflow-orders","[data-role=order-list]"),n=t("[data-role=order-list]");o.removeClass("hide"),t.ajax({url:e+"?"+a,cache:!1,dataType:"JSON",success:function(e){var a=t(e.html);a.find('[data-toggle="tooltip"]').tooltip({container:"body",placement:"bottom"}),n.empty().append(a),t(".order-item").each(function(){var e=t(this).find(".order-info").outerHeight();t(this).find(".indent").css("min-height",e)}),t(document).trigger(window.EVENT_INIT_POPOVERS)},error:function(){n.prepend('<div class="col-xs-12 row"><div class="alert alert-danger">Не удалось загрузить заказы. Повторите попытку позже.</div></div>')},complete:function(){o.addClass("hide")}})};t(document).on("change submit",".user-orders-filter-form",function(t){return t.preventDefault(),u(),!1}),t(document).on("click",".load-more-orders",function(e){e.preventDefault();var a=t(this),o=a.data("url"),i=t(".load-more-orders-btn-wrap");return a.siblings(".alert").remove(),a.hide(),i.prepend('<div class="loading-dots"><span></span><span></span><span></span><span></span></div>'),t.ajax({url:o,cache:!1,dataType:"JSON",success:function(e){var a=t(e.html);a.find('[data-toggle="tooltip"]').tooltip({container:"body",placement:"bottom"}),i.replaceWith(a),t(document).trigger(window.EVENT_INIT_POPOVERS)},error:function(){i.prepend('<div class="col-xs-12 row"><div class="alert alert-danger">Не удалось загрузить заказы. Повторите попытку позже.</div></div>'),t(".loading-dots",i).remove(),a.show()}}),!1}),t(document).on("click",".cancel-order-button-confirm",function(){var e=t(".overflow-orders","[data-role=order-list]"),o=t("[data-role=order-list]"),i=t(this).attr("href"),n=t(".user-orders-filter-form");return e.removeClass("hide"),t.ajax({url:i+"&"+n.serialize(),cache:!1,dataType:"JSON",success:function(e){if(!0===e.result){var a=t(e.html);a.find('[data-toggle="tooltip"]').tooltip({container:"body",placement:"bottom"}),o.empty().append(a),t(document).trigger(window.EVENT_INIT_POPOVERS)}else o.prepend('<div class="col-xs-12 row"><div class="alert alert-danger">'+(e.message?e.message:"Не удалось отменить заказ. Повторите попытку позже.")+"</div></div>")},error:function(t){403===t.status?a():o.prepend('<div class="col-xs-12 row"><div class="alert alert-danger">Не удалось отменить заказ. Повторите попытку позже.</div></div>')},complete:function(){e.addClass("hide")}}),!1}),t(document).on("click",'[data-role="delete-button-confirm"]',function(){var a=t("[data-role=order-list]"),i=t(this).attr("href"),n=t(this).closest(".order-item");return n.addClass("removing"),t.ajax({url:i,method:"post",cache:!1,dataType:"JSON",success:function(o){if(!0===o.result){var i=t(document).find("#deleted-order-"+o.data.id);0===i.length&&(i=e(o.data.type_id),i.attr("id","deleted-order-"+o.data.id).find('[data-role="restore-button"]').attr("href",n.data("restore-url")).end().find('[data-role="order-number"]').html(o.data.number).end().find('[data-role="restore-button"]').data("id",o.data.id).data("type_id",o.data.type_id),n.after(i)),i.removeClass("hidden"),n.addClass("hidden"),t(document).trigger(window.EVENT_INIT_POPOVERS)}else a.prepend('<div class="col-xs-12 row"><div class="alert alert-danger">'+(o.message?o.message:"Не удалось удалить заказ. Повторите попытку позже.")+"</div></div>")},error:function(t){403===t.status?o():a.prepend('<div class="col-xs-12 row"><div class="alert alert-danger">Не удалось удалить заказ. Повторите попытку позже.</div></div>')},complete:function(){n.removeClass("removing")}}),!1}),t(document).on("click",'[data-role="restore-button"]',function(){var e=t(".overflow-orders","[data-role=order-list]"),a=t("[data-role=order-list]"),o=t(this).attr("href");return e.removeClass("hide"),t.ajax({url:o,data:{order_guid:t(this).data("id"),type_id:t(this).data("type_id")},cache:!1,method:"post",dataType:"JSON",success:function(e){!0===e.result?(1===t(document).find("#order-"+e.data.id).length&&(t(document).find("#order-"+e.data.id).removeClass("hidden"),t(document).find("#deleted-order-"+e.data.id).addClass("hidden")),t(document).trigger(window.EVENT_INIT_POPOVERS)):a.prepend('<div class="col-xs-12 row"><div class="alert alert-danger">'+(e.message?e.message:"Не удалось восстановить заказ. Повторите попытку позже.")+"</div></div>")},error:function(){a.prepend('<div class="col-xs-12 row"><div class="alert alert-danger">Не удалось восстановить заказ. Повторите попытку позже.</div></div>')},complete:function(){e.addClass("hide")}}),!1}),t(document).on("click","[data-role=show-postamat-modal]",function(){var e=t("#postamat-info-modal"),a=t(this),o="postamat-map-"+t.now();e.find(".map").remove(),e.find(".modal-title").html(a.data("postamat-name"));var i=e.find(".modal-body > .info"),n={place:a.data("postamat-placement"),metro:a.data("postamat-metro"),payment:a.data("postamat-payment"),address:a.data("postamat-address"),landmark:a.data("postamat-landmark"),worktime:a.data("postamat-worktime")+" ("+(1===a.data("postamat-opened")?"открыто":"закрыто")+" / "+a.data("postamat-waiting")+")"},r=t('<div class="row"></div>');""!==n.metro&&r.append('<div class="col-md-5"><p><b>Ближайшее метро:</b> '+n.metro+"</p></div>"),""!==n.address&&r.append('<div class="col-md-7"><p><b>Адрес:</b> '+n.address+"</p></div>"),""!==n.payment&&r.append('<div class="col-md-5"><p><b>Способ оплаты:</b> '+n.payment+"</p></div>"),""!==n.worktime&&r.append('<div class="col-md-7"><p><b>Время работы:</b> '+n.worktime+"</p></div>"),""!==n.place&&r.append('<div class="col-md-12"><p><b>Расположение:</b> '+n.place+"</p></div>"),""!==n.landmark&&r.append('<div class="col-md-12"><p><b>Как добраться:</b> '+n.landmark+"</p></div>"),i.html(r),i.after('<div id="'+o+'" class="map"></div>'),e.on("shown.bs.modal",function(){e.find(".modal-dialog").addClass("shown")}),e.find("[data-role=hide-modal]").on("click",function(){e.find(".modal-dialog").removeClass("shown"),setTimeout(function(){e.modal("hide")},200)}),e.modal("show"),window.loadYandexMaps(function(){var t=a.data("postamat-latitude"),i=a.data("postamat-longitude"),n=new window.ymaps.Map(o,{zoom:17,controls:["zoomControl","fullscreenControl","trafficControl"],behaviors:["default","scrollZoom"],center:[t,i]}),r=e.find('[class*="site-color-"]').css("color"),d=new window.ymaps.Placemark([t,i],{},{preset:"islands#icon",iconColor:r});n.geoObjects.add(d)})}),t("[data-role=order-list]").on("blur",'a[data-toggle="tooltip"]',function(){t('a[data-toggle="tooltip"]').tooltip("hide")}),t(document).on("click","[data-role=authorization-request-button]",function(){"cancel"===t(this).data("type")?a():"delete"===t(this).data("type")&&o()}),t(document).on("click","[data-role=open-call-request-modal-button]",function(e){e.preventDefault(),t("[data-role=edit-call-request-button]").popover("destroy");var a=t(this),o=t("#call-request-modal"),i=o.find("#create-call-request-form"),n=i.find("[data-role=create-call-request-order-guid-input]"),r=i.find("[data-role=create-call-request-text-input]");i.find("[data-role=create-call-request-form-error]").text("").addClass("hidden"),o.data("open-call-request-modal-button",a),n.val(a.data("order-id")),r.val("")}),t(document).on("click","[data-role=create-call-request-button]",function(){var e=t("#call-request-modal"),a=e.find("#create-call-request-form"),o=t("#call-request-accepted-modal");a.find("[data-role=create-call-request-form-error]").text("").addClass("hidden"),t.ajax({url:a.data("create-call-request-url"),data:a.serialize(),cache:!1,method:"POST",dataType:"JSON",success:function(i){if(i.html){e.data("open-call-request-modal-button").closest(".order-item").find("[data-role=open-call-request-modal-button]").each(function(){var e=t(this),a=t(i.html);a.addClass(e.data("visible")),a.attr("visible",e.data("visible")),e.replaceWith(a)}),e.modal("hide"),o.modal("show")}else i.errors&&a.find("[data-role=create-call-request-form-error]").text(i.errors).removeClass("hidden")}})}),t(document).on("click","[data-role=delete-call-request-button]",function(){var e=t(this),a=e.closest("[data-role=edit-call-request-form]"),o=t("[data-role=edit-call-request-button]").filter("[aria-describedby]");a.find("[data-role=edit-call-request-form-error]").text("").addClass("hidden"),t.ajax({url:a.data("delete-call-request-url"),data:a.serialize(),cache:!1,method:"POST",dataType:"JSON",success:function(e){if(e.result){o.popover("destroy");o.closest(".order-item").find("[data-role=edit-call-request-button]").each(function(){var a=t(this),o=t(e.html);o.addClass(a.data("visible")),o.attr("data-visible",a.data("visible")),a.replaceWith(o)})}else e.errors&&a.find("[data-role=edit-call-request-form-error]").text(e.errors).removeClass("hidden")}})}),t(document).on("click","[data-role=update-call-request-button]",function(){var e=t(this),a=e.closest("[data-role=edit-call-request-form]"),o=t("[data-role=edit-call-request-button]").filter("[aria-describedby]");a.find("[data-role=edit-call-request-form-error]").text("").addClass("hidden"),t.ajax({url:a.data("update-call-request-url"),data:a.serialize(),cache:!1,method:"POST",dataType:"JSON",success:function(e){if(e.result){var i=a.find("[data-role=edit-call-request-text-input]"),n=o.closest(".order-item"),r=n.find("[data-role=edit-call-request-button]"),d=i.val();i.text(d),a.find("[data-role=cancel-edit-call-request-button]").click(),r.each(function(){t(this).data("comment",d),t(this).attr("data-comment",d)})}else e.errors&&a.find("[data-role=edit-call-request-form-error]").text(e.errors).removeClass("hidden")}})}),t(document).on("click","[data-role=change-call-request-button]",function(){var e=t(this),a=e.closest("[data-role=edit-call-request-form]"),o=a.find("[data-role=delete-call-request-button]"),i=a.find("[data-role=cancel-edit-call-request-button]"),n=a.find("[data-role=update-call-request-button]"),r=a.find("[data-role=edit-call-request-text-input]");e.addClass("hidden"),o.addClass("hidden"),i.removeClass("hidden"),n.removeClass("hidden"),r.prop("disabled",!1).focus().text(r.text())}),t(document).on("click","[data-role=cancel-edit-call-request-button]",function(){var e=t(this),a=e.closest("[data-role=edit-call-request-form]"),o=a.find("[data-role=edit-call-request-text-input]"),i=a.find("[data-role=delete-call-request-button]"),n=a.find("[data-role=change-call-request-button]"),r=a.find("[data-role=update-call-request-button]");e.addClass("hidden"),r.addClass("hidden"),n.removeClass("hidden"),i.removeClass("hidden"),o.val(o.text()),o.prop("disabled",!0)}),t(document).on("click","[data-role=edit-call-request-button]",function(){var e=t(this),a=t("[data-role=edit-call-request-popover-template]"),o=t("[data-role=edit-call-request-popover-content]");if(t("[data-role=edit-call-request-button]").not(this).popover("destroy"),e.is("[aria-describedby]"))return void e.popover("destroy");var i=a.clone(),n=o.clone();n.find("[data-role=edit-call-request-form]").find("[data-role=edit-call-request-order-guid-input]").val(e.data("order-id")),n.find("[data-role=edit-call-request-form]").find("[data-role=edit-call-request-text-input]").text(e.data("comment")),e.popover({placement:"bottom",html:!0,template:i[0].outerHTML,content:n[0].outerHTML,container:".profile-order-page",trigger:"manual"}),e.popover("show")}),t(document).on("click",".show-more",function(){t(this).closest(".products").toggleClass("expanded")});t(document).on("show.bs.modal","[data-role=reserve-extend-modal]",function(){var e=t(this),a=e.find(".modal-body"),o=e.data("url");a.html("<b>Загрузка...</b>"),t.ajax({url:o,method:"GET",success:function(t){a.html(t)},error:function(){alert("Возниклка ошибка при загрузке данных")}})}),t(document).on("click",".reserve-extend-form [type=submit]",function(){var e=t(this),a=e.closest("form"),o=e.find(".modal-body");return o.html("<b>Выполнение...</b>"),t.ajax({type:"POST",url:a.prop("action"),data:a.serialize(),dataType:"JSON",cache:!1,success:function(t){!0===t.result?(o.html("<p>Резерв продлён.</p>"),window.location.reload()):""!==t.message&&o.html("<p>К сожалению, продлить резерв по заказу не удалось.</p><br><p>Пожалуйста, попробуйте позже.</p>")},error:function(){o.html("<p>Не удалось выполнить операцию, повторите попытку позже.</p>")}}),!1}),t(document).on("click","[data-role=button-kp-replace-product]",function(t){t.preventDefault();var e={orderId:this.dataset.orderId,productId:this.dataset.productId,productLineId:this.dataset.productLineId},a=document.createElement("div");document.body.appendChild(a),s=!0,window.commercialOfferReplaceProduct(e,a,function(){!0===(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&u(),document.body.removeChild(a),s=!1})}),t(document).on("click","[data-role=button-kp-delete-product-confirm]",function(){var e=t(".overflow-orders","[data-role=order-list]");return e.removeClass("hide"),t.ajax({url:t(this).attr("href"),cache:!1,method:"post",dataType:"JSON",success:function(t){e.addClass("hide"),t.result?u():alert(t.errors[0])},error:function(){e.addClass("hide"),alert("Не удалось выпонить операцию")}}),!1}),t(document).on("click","[data-role=button-kp-replace-product]",function(){if(!0!==s){var t={productGuid:this.dataset.productId},e=document.createElement("div");document.body.appendChild(e),s=!0,window.commercialOfferReplaceProduct(t,e,function(){document.body.removeChild(e),s=!1})}}),t(document).on("click","[data-role=send-order-email]",function(){if(!0!==c){var t={orderId:this.dataset.orderId},e=document.createElement("div");document.body.appendChild(e),c=!0,window.sendDocumentByEmailDialog(t,e,function(){document.body.removeChild(e),c=!1})}}),t(document).on("click","[data-role=change-city]",function(e){e.preventDefault();var a=t(this).data("city-id");window.sendChangeCityRequest(a,function(){window.location.reload()})})}}(jQuery),function(t,e){var a="#profile-subscriptions";e(function(){a=e(a),0!==a.length&&a.find('[data-role="profile-subscription-toggle"]').on("click",function(){var t=e(this);return e.ajax({url:t.attr("href"),type:"POST",dataType:"JSON",success:function(e){!0===e.active?t.text("выкл"):t.text("включить")},error:function(t){alert(t.responseText)}}),!1})})}(document,jQuery),function(t){t.fn.profileUpdateForm=function(){function e(t,e){return'<div class="result-message '+(!0===t?"success":"error")+'">'+e+"</div>"}function a(a){t.ajax({type:"POST",url:f,cache:!1,dataType:"json",data:{phone:a},success:function(t){!0===t.result&&(l.data(i,a),l.data(n,1),s.addClass(o),c.addClass(r),c.after(e(!0,"Номер телефона успешно обновлен.")))},error:function(){c.after(e(!1,"Не удалось обновить информацию о вашем телефоне. Повторите попытку позже или обратитесь в техническую поддержку."))},always:function(){}})}var o="hidden",i="initial-value",n="approved",r="approved",d=t(this),l=t("#about-me-form-phonenumber",d),s=t(".phone-confirm-btn",d),c=l.siblings(".status-icon"),u=s.data("url"),f=s.data("update-phone-url"),p=t("#about-me-form-email",d),h=t(".email-confirm-btn",d),v=p.siblings(".status-icon"),m=h.data("url");d.on("submit",function(){var t=p.val().trim().toLowerCase(),e=p.data(i),a=p.data(n);return""===t||t===e||!a||confirm("Изменение e-mail адреса вступит в силу только после его подтверждения.")}),l.on("keyup",function(){return t(this).siblings(".result-message").remove(),11!=t(this).val().replace(/[^\d]/g,"").length?(s.addClass(o),c.removeClass(r),!1):t(this).val().replace(/[^\d]/g,"")!=t(this).data(i)?(s.removeClass(o),c.removeClass(r),!1):t(this).data(n)?(s.addClass(o),c.addClass(r),!1):void 0}),p.on("keyup",function(){
t(this).siblings(".result-message").remove();var e=/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;return""!=t(this).val()&&e.test(t(this).val())?t(this).val()!=t(this).data(i)?(h.removeClass(o),v.removeClass(r),!1):t(this).data(n)?(h.addClass(o),v.addClass(r),!1):void 0:(h.addClass(o),v.removeClass(r),!1)}),h.on("click",function(a){a.preventDefault();var o=p.val().trim().toLowerCase();return p.siblings(".result-message").remove(),(o!=p.data(i)||!p.data(n))&&(!p.prop("readOnly")&&(p.prop("readOnly",!0),t.ajax({type:"POST",url:m,cache:!1,dataType:"json",data:{email:o},success:function(t){!0===t.result?v.after(e(!0,t.message)):""!==t.message&&v.after(e(!1,t.message))},error:function(){v.after(e(!1,"Сервис временно недоступен. Повторите попытку позже или обратитесь в техническую поддержку."))},always:function(){p.prop("readOnly",!1)}}),!1))}),s.on("click",function(o){o.preventDefault();var r=l.val().replace(/[^\d]/g,"");return l.siblings(".result-message").remove(),(r!=l.data(i)||!l.data(n))&&(t.ajax({type:"POST",url:u,cache:!1,dataType:"json",data:{phone:r},success:function(o){if(!0===o.result)if(o.data.phone_already_confirmed)c.after(e(!0,"Телефон уже подтвержден."));else{var i=t(o.html).modal();i.modal().SmsConfirm({callback:function(t){i.modal("hide"),t&&a(r)}})}else""!==o.message&&c.after(e(!1,o.message))},error:function(){c.after(e(!1,"Сервис временно недоступен. Повторите попытку позже или обратитесь в техническую поддержку."))}}),!1)})},t(function(){var e={placement:"right"};window.checkScreenType(window.SCREEN_MOBILE)&&(e.placement="top"),t("#about-me-form").find('[data-toggle="tooltip"]').tooltip(e)})}(jQuery),$(document).ready(function(){$(".menu-profile li.active").parents("li").addClass("active").find(".list-group-item:first").click();var t={};t[$('META[name="csrf-param"]').attr("content")]=$('META[name="csrf-token"]').attr("content"),$(".btn-subscription").click(function(){var e=$(this);return $.ajax({type:"POST",cache:!1,data:t,url:e.data("subscription-url"),success:function(t){e.closest("[data-role=switched]").setNextState()}}),!1})}),$(document).ready(function(){$(".vacancy-direct-link").click(function(){return window.prompt("",$(this).data("link")),!1})}),$(function(){!function(){function t(t){setTimeout(function(){t.val("")},500)}function e(t){var e=void 0;void 0===t?l.find(i).is(":checked")||(e=l.find(n),e=e.filter(function(t){return 0===t||!1===a($(this))})):e=l.find(n+"["+d+'="'+t+'"]'),void 0!==e&&0!==e.length&&(e.removeClass(r),e.last().find(o).removeClass(r))}function a(t){var e=0;return t.find("INPUT, TEXTAREA").map(function(){""!==$(this).val().trim()&&e++}),0===e}var o=".btn-add-job-experience",i='[data-role="collapse-job-experience"]',n=".job-experience-block",r="hidden",d="data-number",l=$("#p-vacancy-resume-page");if(0!==l.length){var s=l.find(n),c=l.find("#resume-send-success-modal");0!==c.length&&c.modal("show");var u=$("[data-role=city-dropdown]"),f=$('[data-role="vacancy-dropdown"]');l.on("change","#resumeexperienceform_0-startdate",function(){var e=new RegExp("\\d{2}-\\d{4}"),a=l.find("#resumeexperienceform_0-startdate"),o=a.val();if(!e.test(o)&&""!==o)return void alert("Дата приема имеет неверный формат.");var i=new Date,n=l.find("#resumeexperienceform_0-enddate").val();if(o=o.split("-"),parseInt(i.getFullYear())<parseInt(o[1])||parseInt(i.getFullYear())===parseInt(o[1])&&parseInt(i.getMonth())<parseInt(o[0]))return alert("Дата приема на работу ещё не наступила."),void t(a);e.test(n)&&(n=n.split("-"),(parseInt(o[1])>parseInt(n[1])||parseInt(o[1])===parseInt(n[1])&&parseInt(o[0])>parseInt(n[0]))&&(alert("Дата увольнения старше даты приема на работу."),t(a)))}),l.on("change","#resumeexperienceform_0-enddate",function(){var e=new RegExp("\\d{2}-\\d{4}"),a=l.find("#resumeexperienceform_0-enddate"),o=l.find("#resumeexperienceform_0-startdate").val(),i=a.val();if(!e.test(i)&&""!==i)return void alert("Дата увольнения имеет не верный формат.");e.test(o)&&(o=o.split("-"),i=i.split("-"),(parseInt(o[1])>parseInt(i[1])||parseInt(o[1])===parseInt(i[1])&&parseInt(o[0])>parseInt(i[0]))&&(alert("Дата увольнения старше даты приема на работу."),t(a)))}),l.on("change","[data-role=city-dropdown]",function(){var t=u.val();f.html(""),f.attr("disabled","disabled"),$.ajax({url:f.data("get-vacancies-url"),dataType:"JSON",type:"GET",data:{city:t},success:function(t){var e=[];$.each(t,function(t,a){e.push({id:t,text:a}),f.append($("<option>",{value:"",text:"Выберите вакансию"})),f.append($("<option>",{value:t,text:a}))})}}),f.removeAttr("disabled")}),l.find(i).click(function(){$(this).is(":checked")?(s.addClass(r),s.find(o).addClass(r)):e()}),l.find(o).click(function(){var t=$(this);return t.addClass(r),e(parseInt(t.closest("["+d+"]").attr(d))+1),!1}),e()}}(),function(){var t=$(".job-next-button"),e=$(".job-block"),a=$(".job-block.sm"),o=$(".job-block-additional");t.click(function(){$(".nav-tabs > .active").next("LI").find("A").trigger("click")}),e.click(function(){e.removeClass("active"),a.removeClass("active"),o.hide();var t=$(this),i=t.data("job-guid");t.addClass("active"),$('*[data-job-guid="'+i+'"]').show()}),e.first().trigger("click"),a.first().addClass("active")}()}),function(t,e,a){var o={};t(function(){var a=function(e){t.ajax({url:e,type:"post",dataType:"JSON",success:function(t){!0===t.result?o[e]=t.html:o[e]="<h1>Не удалось получить описание.</h1>"},error:function(){o[e]="<h1>Не удалось получить описание.</h1>"}}).always(function(){i(e)})},i=function(e){if(!1===o.hasOwnProperty(e))return void a(e);var i=t("tech-vobler-modal");0===i.length&&(i=t('<div id="tech-vobler-modal" class="modal fade" role="dialog"><div class="modal-dialog"><div class="modal-content"><button type="button" class="btn btn-default modal-close-btn" data-dismiss="modal"><span>✕</span></button><div class="modal-body"></div></div></div>').appendTo("body"),i.modal()),i.find(".modal-body").html(o[e]),i.modal("show")};t(e).on("click",'[data-role="technical-vobler"]',function(){i(t(this).attr("data-url"))})})}(jQuery,document),function(t,e){function a(t,e){var a=t.data(E);return void 0===e&&(e=m),void 0===a?a=e:v.unused(a,e)&&(a=window.Enum.push(a,e)),t.data(E,a),a}function o(t,o){return e.get(o).always(function(){a(t,g)===b&&t.find(r).remove()}).then(function(a){t.find(d).html(a),e(window).trigger(window.EVENT_PRODUCTS_LOADED),window.dispatchLazyLoadUpdateEvent()})}function i(o,i){return e.get(i).always(function(){a(o,w)===b&&o.find(r).remove()}).then(function(a){o.find(c).html(a),e(t).trigger("slider-init"),o.find(s).show()})}function n(){var t=e(this),n=t.data(),r=n.target.substr(1);if(T.indexOf(r)>-1)return!0;var d=h.clone();d.find(u).text(n.actionTitle),n.actionImageUrl?d.find(p).attr("src",n.actionImageUrl):d.find(p).remove(),d.find(f).attr("href",n.actionUrl),d.attr("id",r),a(d,m),o(d,n.actionContentUrl),n.showProductsBlock?i(d,n.actionParticipantUrl):d.find(l).remove(),T.push(r),d.appendTo("body"),d.modal()}var r=".loading-dots",d=".wobbler-modal-content",l=".action-participant",s=".participant-block",c=".participant-content",u=".modal-title",f=".wobbler-modal-url",p=".wobbler-modal-image img",h=void 0,v=window.Enum.create(),m=v.default(),g=v.next(),w=v.next(),b=v.sum(),E="pendingStatus",T=[];e(function(){var a=e('[data-id="modal-for-wobbler"]');h=a.first().clone(),a.remove(),h.find(s).hide(),e(t).on("click",'[data-role="vobler-action"]',n)})}(document,jQuery),function(t){t.fn.WishfulProduct=function(e){var a,o,i,n,r,d={callback:null},e=t.extend({},d,e),l=this,s={init:function(){a=t(l),n=t("#get-form-btn",a),n.on("click",function(){return s.getForm(),!1})},initform:function(){r=t("#wishful-ajax-anim",a),o=t("#wishful-product-form",a),i=t("#submit-form-btn",a),i.on("click",function(){return s.submitForm(),!1})},submitForm:function(){r.show(),i.attr("disabled","disabled"),$form=t("form",o),t.ajax({url:i.data("url"),type:"post",data:$form.serialize(),cache:!1,dataType:"json",success:function(d){i.removeAttr("disabled"),r.hide(),!0===d.result?(o.remove(),n.removeAttr("disabled"),"function"==typeof e.callback&&e.callback(d)):(o.remove(),t(".node-block",a).append(d.data.form),s.initform())},error:function(t){alert("Произошла неизвестная ошибка. Пожалуйста, обратитесь в техническую поддержку.")}})},getForm:function(){n.attr("disabled","disabled"),t.ajax({url:n.data("action"),type:"get",cache:!1,success:function(e){t(".node-block",a).append(e),s.initform()},error:function(){alert("Произошла неизвестная ошибка. Пожалуйста, обратитесь в техническую поддержку.")}})}};s.init()}}(jQuery),function(t,e,a){function o(t,o){a!==u&&u.abort();var i={};i[e('META[name="csrf-param"]').attr("content")]=e('META[name="csrf-token"]').attr("content");var n=function(t){o instanceof Function&&o(t),u=a};u=e.post(t,i,n),u.then(f.onSuccess,f.onFail)}window.EVENT_WISHLIST_LOGIN_MODAL_SHOW="wish-list-login-modal:show",window.EVENT_WISHLIST_LOGIN_MODAL_HIDDEN="wish-list-login-modal:hidden",window.EVENT_WISHLIST_END_ADD_BUTTON_CLICK="wish-list-btn:end-click",window.setAddWishlistButtonTargetWishlist=function(t,e){d===t.data(n)&&t.data(i,[e])},window.setDisableUpdateCurrentWishlist=function(t,e){t.data(r,e)};var i="wishlistIds",n="state",r="disable-wishlist-update",d="add",l=void 0,s=void 0,c=e('<div id="wishlist-login-modal" class="modal wishlist-login-modal fade" tabindex="-1" role="dialog" data-can-show="true"><div class="modal-dialog" role="document"><div class="arrow"></div> <div class="modal-content"><p><b>Товар добавлен в Избранное</b></p><p>Войдите в профиль, чтобы сохранить список. Несохраненный список будет очищен через 7 дней.</p><div class="row"><div class="btn modal-button btn-wishlist-modal-close pull-left" data-role="modal-button">Понятно, закрыть</div><div class="btn modal-button btn-wishlist-modal-login pull-right" data-role="modal-button" data-type="login-button">Войти</div></div></div> </div></div>'),u=void 0,f={onSuccess:function(t){!0===t.result&&(s.applySets(t.data.count>0?"active":"default",{totalCount:t.data.count}),e(window).trigger(window.EVENT_UPDATE_WISHLIST,t),e(window).trigger(window.EVENT_MOBILE_UPDATE_NOTIFIER,{activity:window.NOTIFY_ACTIVITY_WISHLIST,count:t.data.count}))},onFail:function(){e(window.SELECTOR_WISHLIST_BTN).attr("disabled",!1)}};e(t.body).ready(function(){l=e(window.SELECTOR_WISHLIST_BTN),s=e(window.SELECTOR_WISHLIST_BTN_GLOBAL),0!==s.length&&(s.initSets(!1),e(t.body).on("click",window.SELECTOR_WISHLIST_BTN,function(){var t=e(this),l=t.data("wishlist-url");return a!==t.data(i)&&t.data(i).length&&(l+="&"+t.data("wishlist-ids-param")+"="+JSON.stringify(t.data(i))),t.attr("disabled",!0),o(l,function(o){var l=c.find(".modal-dialog"),s=t.offset().top-e(window).scrollTop(),u=t.offset().left,f=t.outerHeight(),p=t.outerWidth(),h=0,v=0;e(window.SELECTOR_WISHLIST_BTN).attr("disabled",!1),d===t.data(n)&&t.data("show-login-modal")&&c.data("can-show")&&!1==(void 0!==t.data(i)&&void 0!==t.data("user-is-guest"))?(t.tooltip("hide"),c.data("wishist-button",t),e("body").prepend(c),window.SCREEN_MOBILE_MAX_WIDTH<e(window).width()&&(h=s+f+11+"px",v=u-l.outerWidth()+Math.round(p/2)+29+"px"),c.find(".modal-dialog").css({top:h,left:v}),c.modal("show",t)):d===t.data(n)?(t.attr("data-original-title",o.message||"Добавлен в избранное").tooltip("fixTitle").tooltip("show").data(i,[]),setTimeout(function(){t.tooltip("hide")},2e3)):"remove"===t.data(n)&&(t.attr("data-original-title",o.message||"Товар удален из списка").tooltip("fixTitle").tooltip("show").data(i,o.data.wishlistIds||[]),setTimeout(function(){t.tooltip("hide")},2e3)),t.setNextState(),!1!==t.data(r)&&a!==t.data(r)||t.trigger(window.EVENT_UPDATE_WISHLIST,o),e(window).trigger(window.EVENT_WISHLIST_END_ADD_BUTTON_CLICK,t.attr("id"))}),!1}),e(window).on(window.EVENT_PRODUCTS_LOADED,function(){var t=e(window.SELECTOR_WISHLIST_BTN),a=t.not(l);a.length&&(a.initSets(),l=t)}),c.on("hidden.bs.modal",function(){c.detach(),e(window).trigger(window.EVENT_WISHLIST_LOGIN_MODAL_HIDDEN)}),c.on("show.bs.modal",function(){c.detach(),e(window).trigger(window.EVENT_WISHLIST_LOGIN_MODAL_SHOW)}),c.on("click","[data-role=modal-button]",function(){var t=e(this);return e.ajax({url:c.data("wishist-button").data("remember-modal-closing-url"),type:"POST",success:function(t){if(!1===t.result)return!1;c.data("can-show",!1),l.data("show-login-modal",!1)},complete:function(){c.modal("hide"),t.is("[data-type=login-button]")&&(window.location.href=c.data("wishist-button").data("login-url"))}}),!1}))})}(document,jQuery),function(t){window.EVENT_INIT_WISHLIST_CHANGE_CITY_WIDGET="wishlist:changeCity_init",window.EVENT_WISHLIST_CITY_DELETED="wishlist:changeCity_cityDeleted",window.EVENT_WISHLIST_CITY_CHANGED="wishlist:changeCity_cityChanged",window.EVENT_WISHLIST_CITY_CONFIRMED="wishlist:changeCity_cityConfirmed";var e=function(){t("[data-role=wishlist-change-city-widget]").each(function(){var e=t(this),a=e.find("[data-role=dialog]"),o=e.find("[data-role=show-dialog]"),i=e.attr("data-wishlist-id"),n=e.attr("data-city-id"),r=e.attr("data-param-list-id"),d=e.attr("data-param-city-id"),l=e.attr("data-remove-url"),s=e.attr("data-update-url");if(!e.data("inited")){e.data("inited",!0);var c=function(){e.toggleClass("show-dialog",!1).toggleClass("confirm-remove",!1)};e.find("[data-role=confirm]").on("click",function(){return t(window).trigger(EVENT_WISHLIST_CITY_CONFIRMED,[i]),c(),!1}),o.on("click",function(){return e.toggleClass("show-dialog",!0),!1}),e.find("[data-role=show-remove-dialog]").on("click",function(){return e.toggleClass("confirm-remove",!0),!1});var u=function(){toggleLoaderVisibility(!1),alert("Не удалось изменить город подписки"),window.location.reload()},f=function(e){toggleLoaderVisibility(!0);var a={};return a[r]=i,a[d]=e,t.ajax({url:s,dataType:"JSON",type:"POST",data:a,success:function(e){!0===e.result?t(window).trigger(EVENT_WISHLIST_CITY_CHANGED,[i]):u()},error:u}).always(c),!1};e.find("[data-role=select-city]").on("click",function(){return window.showSelectCityModal(f,function(){},u,n),!1}),e.find("[data-role=remove-city]").on("click",function(){toggleLoaderVisibility(!0);var e=function(){toggleLoaderVisibility(!1),alert("Не удалось удалить город подписки"),window.location.reload()},a={};return a[r]=i,t.ajax({url:l,dataType:"JSON",type:"POST",data:a,success:function(a){!0===a.result?t(window).trigger(EVENT_WISHLIST_CITY_DELETED,[i]):e()},error:e}).always(c),!1}),t(window).on(window.EVENT_CHANGE_SCREEN_TYPE,function(){!1===window.checkScreenType(window.SCREEN_MOBILE)&&(a.css({width:"",left:""}),a.find(".corner").css({left:""}))}).on("resize",function(){!0===window.checkScreenType(window.SCREEN_MOBILE)&&(a.css({width:t(window).width()-1,left:-e.offset().left}),a.find(".corner").css({left:o.find("i").offset().left-4}))}).trigger(window.EVENT_CHANGE_SCREEN_TYPE).trigger("resize")}})};t(function(){e(),t(window).on(EVENT_INIT_WISHLIST_CHANGE_CITY_WIDGET,e)})}(jQuery),function(t){var e="[data-role=wishlist-share-widget]";t(function(){t(window).on("click",function(a){var o=t(a.target);!1===o.is(e)&&0===o.closest(e).length?t(e+" [data-role=show-input]").removeClass("active"):o.is("[data-role=show-input]")&&(t(e+" [data-role=show-input]").addClass("active"),window.checkScreenType(window.SCREEN_MOBILE,window.SCREEN_TABLET)&&(t(e+" [data-role=clipboard-button]").click(),t(e+" [data-role=show-input]").removeClass("active"),alert("Ссылка скопирована")))})})}(jQuery);